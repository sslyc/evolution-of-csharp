<center><font size=7>C#çš„è¿›åŒ–</font></center> 
<center><font size=4>C#å‘å±•å²ã€C#1.0-10.0è¯­æ³•ç³»ç»Ÿæ€§æ¢³ç†ã€C#ä¸JAVAçš„å¯¹æ¯”</font></center>

# å‰è¨€

C#ä¹Ÿä½¿ç”¨äº†åå¹´æœ‰ä½™äº†ã€‚

ä¸€è·¯èµ°æ¥ï¼Œè§è¯äº†å¾®è½¯ä»å°é—­èµ°å‘å¼€æ”¾ï¼Œä»å¹³å°æ†ç»‘ï¼Œåˆ°æˆä¸ºæ´»è·ƒäºGithubçš„é‡è¦è´¡çŒ®è€…ã€‚äº²å†äº†C#çš„å¼€åˆ›æ€§å¼•é¢†å’Œå½±å“äº†è¯¸å¤šè¯­è¨€ï¼Œä¹Ÿçœ‹åˆ°äº†å…¶ä»–è¯­è¨€çš„ä¼˜ç§€æœºåˆ¶è¢«æœ‰æœºçš„èåˆè¿›C#ï¼ˆå¥½å§ï¼Œæˆ‘æ‰¿è®¤è¯­è¨€ä¹‹é—´éƒ½åœ¨äº’ç›¸æŠ„ï¼‰ã€‚åœ¨å¾®è½¯çš„â€œå¼€å‘è€…è‡³ä¸Šâ€ç†å¿µåŠ æŒä¸‹ï¼ŒC#å˜å¾—è¶Šæ¥è¶Šå¥½ç”¨ã€‚å¦‚ä»Šï¼Œ\.Net 6å·²ç»å‘å¸ƒï¼Œè¿™æ˜¯\.Netå®¶æ—ç»“æŸæ··ä¹±çš„å‰²æ®ï¼Œç»Ÿä¸€åçš„ç¬¬ä¸€ä¸ªLTSç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯å·ç§°è¿„ä»Šä¸ºæ­¢æœ€å¿«çš„\.Netã€‚å›é¡¾C#çš„å‘å±•å†å²ï¼Œä¸€è·¯èµ°æ¥æ„Ÿæ…¨ä¸‡åƒã€‚æœ¬ç€æ¸©æ•…è€ŒçŸ¥æ–°çš„ç²¾ç¥ï¼Œå’ŒCShaperé‚£è¯¥æ­»çš„æƒ³è¦â€œå®‰åˆ©â€çš„å†²åŠ¨ï¼Œæ„Ÿè§‰æ˜¯æ—¶å€™å¯¹C#åšä¸ªå…¨é¢çš„æ€»ç»“äº†ã€‚

å†™æœ¬æ–‡è¿˜æœ‰ä¸€ä¸ªç°å®åŸå› ï¼šåœ¨å¦‚ä»Šçš„å„å¤§æŠ€æœ¯åŒºä¸­ï¼Œé²œæœ‰ç»†è‡´åœ°è®²è§£C#å…¨ç‰ˆæœ¬è¯­æ³•ç‰¹ç‚¹ï¼ˆFeatureï¼‰çš„æ–‡ç« ã€‚è€Œæˆ‘ä¹Ÿå‘ç°æœ‰ä¸å°‘åšä¸»å¯¹ä¸€äº›è¯­æ³•ç†è§£æœ‰æ‰€åå·®ï¼Œä¾‹å¦‚ï¼šå¤§å¤šæ•°çš„æ–‡ç« éƒ½æ²¡èƒ½å¾ˆå¥½çš„é˜è¿°C#ä¸­æšä¸¾å™¨ï¼ˆIEnumeratorï¼‰å’Œè¿­ä»£å™¨ï¼ˆIteratorï¼‰çš„åŒºåˆ«ï¼Œä¹Ÿæ²¡æœ‰å¾ˆå¥½çš„è¯´æ˜LINQå’Œè¿­ä»£å™¨çš„ç´§å¯†è”ç³»ã€‚è€Œå¯¹C#è¯­æ³•å’ŒJavaè¯­æ³•åšå‡ºå…¨é¢å¯¹æ¯”çš„æ–‡ç« ä¹Ÿä¸æ˜¯å¾ˆå¤šã€‚ä½œè€…å¸Œæœ›é€šè¿‡æ­¤ä¸€æ–‡å¡«è¡¥è¿™äº›ç©ºç¼ºã€‚

æœ¬æ–‡å°†ä»¥C#ç‰ˆæœ¬ä¸ºæ—¶é—´çº¿ï¼Œä»C#1.0åˆ°C#10.0æ¢³ç†æ¯ä¸ªç‰ˆæœ¬çš„è¯­æ³•ã€‚å¹¶å°½å¯èƒ½**ä¸Javaåšå‡ºå¯¹æ¯”**ã€‚

æœ¬æ–‡**ç›®æ ‡äººç¾¤**ä¸»è¦æ˜¯ï¼š

1. **CShaper**ï¼š
    1. æƒ³å¯¹C#ä»1.0åˆ°10.0çš„è¯­æ³•ç‰¹ç‚¹è¿›è¡Œç³»ç»Ÿæ¢³ç†çš„äººã€‚
    2. è®¡åˆ’è½¬Javaï¼Œæˆ–è€…çº¯ç²¹å¥½å¥‡ï¼Œæƒ³äº†è§£C#ä¸Javaæœ‰å“ªäº›å¼‚åŒçš„äººã€‚
2. **Javaer**ï¼Œæˆ–è€…å…¶ä»–éC#çš„å¼€å‘è€…ï¼š
    1. å¯¹C#å¥½å¥‡ï¼Œæƒ³å¯¹C#åšä¸ªå…¨é¢äº†è§£çš„äººã€‚
    2. è®¡åˆ’è½¬C#ï¼Œé€šè¿‡æ­¤æ–‡å¯ä»¥ç›´æ¥ä¸Šæ‰‹å¼€å‘çš„äººã€‚ï¼ˆæˆ‘çŸ¥é“æ²¡æœ‰ğŸ˜”ï¼‰

æœ¬æ–‡æ—¨åœ¨ï¼š

1. å¯¹C#æ¯ä¸ªç‰ˆæœ¬å¼•å…¥çš„è¯­æ³•åšç³»ç»Ÿæ€§æ¢³ç†ã€‚
    - å¯¹äºè€ç‰ˆæœ¬ï¼Œå‘æ˜å®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚ï¼Œçº æ­£ç†è§£ä¸Šçš„è°¬è¯¯ã€‚
    - å¯¹äºæ–°ç‰ˆæœ¬ï¼Œå¸®åŠ©é‚£äº›å¯¹å®˜æ–¹æ–‡æ¡£æŠ±æœ‰â€œè‹±æ–‡æ‡’å¾—çœ‹ï¼Œä¸­æ–‡çœ‹ä¸æ‡‚â€æ€åº¦çš„äººï¼Œæ•´ç†å’Œæç‚¼æ–°ç‰ˆæœ¬çš„è¯­æ³•ç‰¹ç‚¹ã€‚
2. ä»‹ç»C#çš„åŒæ—¶ï¼Œå°±è¯­è¨€æœºåˆ¶ä¸Javaåšå‡ºå¯¹æ¯”ã€‚è®©è¯»è€…èƒ½å¤Ÿä¸€æ¬¡æ€§æŒæ¡ä¸¤ç§è¯­è¨€çš„ç‰¹ç‚¹å’Œå·®å¼‚ã€‚
3. ç”¨è¯å°½é‡ä¸¥è°¨ã€è§„èŒƒã€‚éƒ¨åˆ†å…³é”®åè¯ç»™å‡ºç¿»è¯‘å‰çš„åŸå§‹è‹±æ–‡ã€‚ä»¥å…äº§ç”Ÿè°¬è¯¯è€Œè¯¯å¯¼è¯»è€…ã€‚
4. åŒæ—¶ç…§é¡¾CShaperå’Œæ²¡æœ‰C#å¼€å‘ç»éªŒçš„äººï¼Œè®©ä¸¤è€…éƒ½æœ‰æ‰€æ”¶è·ã€‚

æœ¬æ–‡å‡è®¾é˜…è¯»è€…å·²æœ‰ä¸€å®šè¯­è¨€åŸºç¡€ï¼Œå› è€Œä¸ä¼šè®²è¿‡äºåŸºç¡€ä¸”ä¸Javaæ— å¼‚çš„éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œå¦‚æœåŸºç¡€éƒ¨åˆ†ä¸Javaæœ‰æ‰€ä¸åŒï¼Œä¼šæŒ‡å‡ºä¸Javaçš„ä¸åŒä¹‹å¤„ã€‚**ä¸Javaçš„å¯¹æ¯”éƒ¨åˆ†å°†ä½¿ç”¨ä¸‹é¢çš„æ ¼å¼**ï¼š

> åœ¨è¯­æ³•çš„æ›´è¿›ä¸Šï¼ŒC#ä¸Javaçš„é‡‡ç”¨å®Œå…¨ä¸åŒçš„ç­–ç•¥ï¼šC#çš„æ›´æ–°ç›¸å¯¹æ¿€è¿›ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½ä¼šæœ‰ä¸å°‘çš„æ›´æ–°å‡çº§ï¼Œä¹Ÿå¤§é‡å¼•å…¥äº†å·²åœ¨å…¶ä»–è¯­è¨€ä¸Šå®ç°äº†çš„ä¼˜ç§€æœºåˆ¶ï¼›Javaåˆ™ä»¥ç¨³å­—å½“å¤´ï¼Œæ¯ä¸ªç‰ˆæœ¬å…³äºè¯­æ³•å±‚é¢çš„æ›´æ–°å†…å®¹éƒ½ä¸æ˜¯å¾ˆå¤šï¼Œè€Œä¸”å¾€å¾€æ–°çš„è¯­æ³•éƒ½æ˜¯å…ˆå‘å¸ƒé¢„è§ˆç‰ˆï¼Œåœ¨å‡ ä¸ªJavaç‰ˆæœ¬ä¹‹åæ‰ä¼šå‘å¸ƒæ­£å¼ç‰ˆã€‚

æœ¬æ–‡å¯¹C#çš„è¯­æ³•æè¿°æ—¶ï¼Œå¦‚æœéœ€è¦æåŠæ›´é«˜ç‰ˆæœ¬çš„C#æ‰æ”¯æŒçš„è¯­æ³•ï¼Œä¼šæ˜¾è‘—çš„æ ‡æ˜æ”¯æŒçš„C#ç‰ˆæœ¬ã€‚è€Œä¸Javaå¯¹æ¯”æ—¶ï¼Œå› ä¸ºåœ¨å¦‚ä»Šçš„ä½¿ç”¨åœºæ™¯ä¸­ï¼Œå¼€å‘è€…åŸºæœ¬ä¸Šè‡³å°‘ä¼šä½¿ç”¨Java 8ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥ä»…åœ¨æ‰€æ¶‰åŠçš„Javaè¯­æ³•éœ€è¦9ä»¥ä¸Šçš„ç‰ˆæœ¬æ—¶ï¼Œæ‰ä¼šæ˜ç¡®æ ‡æ³¨æ‰€éœ€çš„Javaç‰ˆæœ¬ã€‚

ä¸ºäº†åŒæ—¶ç…§é¡¾Javaerå’ŒCShaperç”šè‡³å…¶ä»–è¯­è¨€å¼€å‘è€…ï¼Œæœ¬æ–‡ç¯‡å¹…ä¼šè¾ƒé•¿ï¼ˆæ¥è¿‘15ä¸‡å­—ï¼‰ã€‚ä½†æ˜¯æ¯ä¸ªçŸ¥è¯†ç‚¹çš„æ–‡å­—å…¶å®å¹¶ä¸å¤šã€‚è¯»è€…å¯ä»¥æ ¹æ®éœ€è¦ä»ç›®å½•å¿«é€Ÿå®šä½åˆ°å…³æ³¨çš„ç« èŠ‚ï¼ˆå…¶å®ä½ è¿˜å¯ä»¥ä½¿ç”¨æœç´¢å¤§æ³•ï¼‰ã€‚ä¸è¿‡ï¼Œæœ¬æ–‡çš„æ’°å†™æ–¹å¼ï¼Œå…·æœ‰çŸ¥è¯†å»¶ç»­æ€§ï¼šæ¯ä¸ªç« èŠ‚çš„ä»‹ç»ä¼šå‡è®¾ä¹‹å‰ç« èŠ‚ä»‹ç»çš„å†…å®¹è¯»è€…å·²ç»æŒæ¡ã€‚å› è€Œå¯¹äºéCShaperè€Œè¨€ï¼Œè·³è¿‡ç« èŠ‚éœ€è¦æ…é‡ï¼Œå¯èƒ½ä¼šä½¿ç›¸åº”ç« èŠ‚çš„éƒ¨åˆ†åè¯å’Œä»£ç éš¾ä»¥ç†è§£ã€‚

---

# ç›®å½•

<!-- TOC -->

- [å‰è¨€](#%E5%89%8D%E8%A8%80)
- [ç›®å½•](#%E7%9B%AE%E5%BD%95)
- [æ­£æ–‡ä¹‹å‰](#%E6%AD%A3%E6%96%87%E4%B9%8B%E5%89%8D)
    - [åŸºæœ¬æ¦‚å¿µ](#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5)
        - [C#](#c)
        - [\.Net](#%5Cnet)
    - [\.Netå’ŒC#å‘å±•å²](#%5Cnet%E5%92%8Cc%E5%8F%91%E5%B1%95%E5%8F%B2)
    - [æœ¬æ–‡çš„é‡ç‚¹æ˜¯è¯­æ³•ï¼Œè€Œéç±»åº“](#%E6%9C%AC%E6%96%87%E7%9A%84%E9%87%8D%E7%82%B9%E6%98%AF%E8%AF%AD%E6%B3%95%E8%80%8C%E9%9D%9E%E7%B1%BB%E5%BA%93)
- [Hello World](#hello-world)
    - [å‘½åç©ºé—´ï¼ˆNamespaceï¼‰](#%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4namespace)
    - [usingè¯­å¥](#using%E8%AF%AD%E5%8F%A5)
- [C# 1.0 â€”â€” Javaçš„æ›¿ä»£å“](#c-10--java%E7%9A%84%E6%9B%BF%E4%BB%A3%E5%93%81)
    - [ç±»ï¼ˆClassï¼‰å’Œç»“æ„ï¼ˆStructï¼‰](#%E7%B1%BBclass%E5%92%8C%E7%BB%93%E6%9E%84struct)
        - [Classä¸Structçš„åŒºåˆ«](#class%E4%B8%8Estruct%E7%9A%84%E5%8C%BA%E5%88%AB)
        - [ä¿®é¥°ç¬¦ï¼ˆModifierï¼‰](#%E4%BF%AE%E9%A5%B0%E7%AC%A6modifier)
            - [å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼ˆAccess Modifierï¼‰](#%E5%8F%AF%E8%AE%BF%E9%97%AE%E6%80%A7%E4%BF%AE%E9%A5%B0%E7%AC%A6access-modifier)
            - [å…¶ä»–ä¿®é¥°ç¬¦](#%E5%85%B6%E4%BB%96%E4%BF%AE%E9%A5%B0%E7%AC%A6)
        - [ç±»å‹åˆ«å](#%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D)
        - [éšå¼ç»§æ‰¿ã€Objectç±»](#%E9%9A%90%E5%BC%8F%E7%BB%A7%E6%89%BFobject%E7%B1%BB)
        - [å€¼ç±»å‹ vs å¼•ç”¨ç±»å‹](#%E5%80%BC%E7%B1%BB%E5%9E%8B-vs-%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B)
        - [å€¼ç±»å‹ï¼ˆValue Typeï¼‰](#%E5%80%BC%E7%B1%BB%E5%9E%8Bvalue-type)
            - [ç»“æ„](#%E7%BB%93%E6%9E%84)
            - [è£…ç®±ï¼ˆBoxingï¼‰å’Œæ‹†ç®±ï¼ˆUnboxingï¼‰](#%E8%A3%85%E7%AE%B1boxing%E5%92%8C%E6%8B%86%E7%AE%B1unboxing)
            - [æšä¸¾ï¼ˆEnumï¼‰](#%E6%9E%9A%E4%B8%BEenum)
        - [å¼•ç”¨ç±»å‹ï¼ˆReference Typeï¼‰](#%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8Breference-type)
            - [æ•°ç»„ï¼ˆArrayï¼‰](#%E6%95%B0%E7%BB%84array)
            - [ç±»ï¼ˆClassï¼‰](#%E7%B1%BBclass)
                - [ç±»çš„ç»§æ‰¿](#%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF)
                - [åµŒå¥—ç±»](#%E5%B5%8C%E5%A5%97%E7%B1%BB)
        - [æ–¹æ³•ï¼ˆMethodï¼‰](#%E6%96%B9%E6%B3%95method)
            - [æ–¹æ³•çš„å‚æ•°](#%E6%96%B9%E6%B3%95%E7%9A%84%E5%8F%82%E6%95%B0)
                - [outå’Œrefå…³é”®è¯](#out%E5%92%8Cref%E5%85%B3%E9%94%AE%E8%AF%8D)
                - [å‚æ•°é»˜è®¤å€¼](#%E5%8F%82%E6%95%B0%E9%BB%98%E8%AE%A4%E5%80%BC)
                - [å¯å˜å‚æ•°](#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0)
            - [æ„é€ å™¨ï¼ˆConstructorï¼‰ã€ç»ˆç»“å™¨ï¼ˆFinalizerï¼‰](#%E6%9E%84%E9%80%A0%E5%99%A8constructor%E7%BB%88%E7%BB%93%E5%99%A8finalizer)
                - [é™æ€æ„é€ å™¨ï¼ˆStatic Constructorï¼‰](#%E9%9D%99%E6%80%81%E6%9E%84%E9%80%A0%E5%99%A8static-constructor)
                - [æ„é€ å™¨ä¸²è”](#%E6%9E%84%E9%80%A0%E5%99%A8%E4%B8%B2%E8%81%94)
                - [ç»ˆç»“å™¨ï¼ˆFinalizerï¼‰](#%E7%BB%88%E7%BB%93%E5%99%A8finalizer)
            - [å¤šæ€ï¼ˆPolymorphismï¼‰](#%E5%A4%9A%E6%80%81polymorphism)
        - [å±æ€§ï¼ˆPropertyï¼‰](#%E5%B1%9E%E6%80%A7property)
    - [æ¥å£ï¼ˆInterfaceï¼‰](#%E6%8E%A5%E5%8F%A3interface)
        - [å¯é‡Šæ”¾æ¥å£ï¼ˆIDisposableï¼‰](#%E5%8F%AF%E9%87%8A%E6%94%BE%E6%8E%A5%E5%8F%A3idisposable)
            - [usingè‡ªåŠ¨é‡Šæ”¾è¯­å¥](#using%E8%87%AA%E5%8A%A8%E9%87%8A%E6%94%BE%E8%AF%AD%E5%8F%A5)
            - [IDisposableé‡Šæ”¾æ¨¡å¼](#idisposable%E9%87%8A%E6%94%BE%E6%A8%A1%E5%BC%8F)
        - [æšä¸¾å™¨æ¥å£ï¼ˆIEnumeratorï¼‰ å’Œ å¯æšä¸¾æ¥å£ï¼ˆIEnumerableï¼‰](#%E6%9E%9A%E4%B8%BE%E5%99%A8%E6%8E%A5%E5%8F%A3ienumerator-%E5%92%8C-%E5%8F%AF%E6%9E%9A%E4%B8%BE%E6%8E%A5%E5%8F%A3ienumerable)
    - [å§”æ‰˜ï¼ˆDelegateï¼‰](#%E5%A7%94%E6%89%98delegate)
        - [å¤šæ’­å§”æ‰˜ï¼ˆMulticast Delegateï¼‰](#%E5%A4%9A%E6%92%AD%E5%A7%94%E6%89%98multicast-delegate)
    - [äº‹ä»¶ï¼ˆEventï¼‰](#%E4%BA%8B%E4%BB%B6event)
    - [è¿ç®—ç¬¦ï¼ˆOperatorï¼‰](#%E8%BF%90%E7%AE%97%E7%AC%A6operator)
        - [ç‰¹è‰²è¿ç®—ç¬¦](#%E7%89%B9%E8%89%B2%E8%BF%90%E7%AE%97%E7%AC%A6)
            - [@ç¬¦å·](#%E7%AC%A6%E5%8F%B7)
            - [defaultè¿ç®—ç¬¦](#default%E8%BF%90%E7%AE%97%E7%AC%A6)
            - [nullåˆ¤æ–­è¿ç®—ç¬¦](#null%E5%88%A4%E6%96%AD%E8%BF%90%E7%AE%97%E7%AC%A6)
        - [è¿ç®—ç¬¦çš„ç‰¹è‰²è¯­æ³•](#%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E7%89%B9%E8%89%B2%E8%AF%AD%E6%B3%95)
            - [ç´¢å¼•å™¨ï¼ˆIndexerï¼‰](#%E7%B4%A2%E5%BC%95%E5%99%A8indexer)
            - [è¿ç®—ç¬¦é‡è½½ï¼ˆOperator Overloadingï¼‰](#%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BDoperator-overloading)
                - [stringçš„==](#string%E7%9A%84)
                - [DateTimeçš„+ã€-ã€>ã€<ã€>=ã€<=](#datetime%E7%9A%84-)
            - [è‡ªå®šä¹‰ç±»å‹è½¬æ¢ï¼ˆUser-Defined Conversion Operatorï¼‰](#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2user-defined-conversion-operator)
    - [è¯­å¥ï¼ˆStatementï¼‰](#%E8%AF%AD%E5%8F%A5statement)
        - [lock](#lock)
        - [è¯´æ˜æ³¨é‡Šï¼ˆæ–‡æ¡£æ€§æ³¨é‡Šï¼ŒDocumentation Commentï¼‰](#%E8%AF%B4%E6%98%8E%E6%B3%A8%E9%87%8A%E6%96%87%E6%A1%A3%E6%80%A7%E6%B3%A8%E9%87%8Adocumentation-comment)
        - [é¢„å¤„ç†æŒ‡ä»¤ï¼ˆPreprocessor Directiveï¼‰](#%E9%A2%84%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4preprocessor-directive)
            - [#defineå’Œ#if](#define%E5%92%8Cif)
            - [#region](#region)
    - [ç‰¹æ€§ï¼ˆAttributeï¼‰](#%E7%89%B9%E6%80%A7attribute)
        - [æ˜¾å¼æŒ‡å®šç‰¹æ€§çš„ç›®æ ‡](#%E6%98%BE%E5%BC%8F%E6%8C%87%E5%AE%9A%E7%89%B9%E6%80%A7%E7%9A%84%E7%9B%AE%E6%A0%87)
        - [ç‰¹æ€§ä¸­çš„@ç¬¦å·](#%E7%89%B9%E6%80%A7%E4%B8%AD%E7%9A%84%E7%AC%A6%E5%8F%B7)
    - [åå°„ï¼ˆReflectionï¼‰](#%E5%8F%8D%E5%B0%84reflection)
        - [Typeç±»](#type%E7%B1%BB)
        - [isè¿ç®—ç¬¦](#is%E8%BF%90%E7%AE%97%E7%AC%A6)
        - [asè¿ç®—ç¬¦](#as%E8%BF%90%E7%AE%97%E7%AC%A6)
    - [unsafeä¸Šä¸‹æ–‡](#unsafe%E4%B8%8A%E4%B8%8B%E6%96%87)
- [C# 2.0 â€”â€” è¿½èµ¶ + åˆ›æ–°](#c-20--%E8%BF%BD%E8%B5%B6--%E5%88%9B%E6%96%B0)
    - [æ³›å‹ï¼ˆGenericï¼‰](#%E6%B3%9B%E5%9E%8Bgeneric)
        - [æ³›å‹çº¦æŸ](#%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F)
        - [æ³›å‹æ–¹æ³•çš„æ³›å‹ç±»å‹çš„è‡ªåŠ¨æ¨æ–­](#%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95%E7%9A%84%E6%B3%9B%E5%9E%8B%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%87%AA%E5%8A%A8%E6%8E%A8%E6%96%AD)
    - [åˆ†éƒ¨ç±»å‹ï¼ˆPartial Typeï¼‰](#%E5%88%86%E9%83%A8%E7%B1%BB%E5%9E%8Bpartial-type)
    - [åŒ¿åæ–¹æ³•ï¼ˆAnonymous Methodï¼‰](#%E5%8C%BF%E5%90%8D%E6%96%B9%E6%B3%95anonymous-method)
        - [å¼ºç±»å‹å§”æ‰˜ï¼ˆStrongly Typed Delegateï¼‰](#%E5%BC%BA%E7%B1%BB%E5%9E%8B%E5%A7%94%E6%89%98strongly-typed-delegate)
    - [å¯nullå€¼ç±»å‹ï¼ˆNullable\<T>ï¼‰](#%E5%8F%AFnull%E5%80%BC%E7%B1%BB%E5%9E%8Bnullable%5Ct)
        - [å¯nullå€¼ç±»å‹çš„ç±»å‹åˆ¤æ–­](#%E5%8F%AFnull%E5%80%BC%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD)
    - [è¿­ä»£å™¨ï¼ˆIteratorï¼‰](#%E8%BF%AD%E4%BB%A3%E5%99%A8iterator)
    - [C# 2.0çš„å…¶ä»–æ”¹è¿›](#c-20%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
- [C# 3.0 â€”â€” åˆ†é“æ‰¬é•³ã€æ”¾é£è‡ªæˆ‘ã€è·¨æ—¶ä»£åˆ›æ–°](#c-30--%E5%88%86%E9%81%93%E6%89%AC%E9%95%B3%E6%94%BE%E9%A3%9E%E8%87%AA%E6%88%91%E8%B7%A8%E6%97%B6%E4%BB%A3%E5%88%9B%E6%96%B0)
    - [è‡ªåŠ¨å±æ€§ï¼ˆAuto-Implemented Propertyï¼‰](#%E8%87%AA%E5%8A%A8%E5%B1%9E%E6%80%A7auto-implemented-property)
    - [éšå¼ç±»å‹ï¼ˆImplicitly Typedï¼‰](#%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8Bimplicitly-typed)
    - [åˆå§‹åŒ–å™¨ï¼ˆInitailizerï¼‰](#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%99%A8initailizer)
    - [åŒ¿åç±»å‹ï¼ˆAnonymous Typeï¼‰](#%E5%8C%BF%E5%90%8D%E7%B1%BB%E5%9E%8Banonymous-type)
        - [åŒ¿åç±»å‹çš„å±æ€§åç§°æ¨æ–­](#%E5%8C%BF%E5%90%8D%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%B1%9E%E6%80%A7%E5%90%8D%E7%A7%B0%E6%8E%A8%E6%96%AD)
    - [Lambdaè¡¨è¾¾å¼](#lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F)
    - [åˆ†éƒ¨æ–¹æ³•ï¼ˆPartial Methodï¼‰](#%E5%88%86%E9%83%A8%E6%96%B9%E6%B3%95partial-method)
    - [æ‰©å±•æ–¹æ³•ï¼ˆExtension Methodï¼‰](#%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95extension-method)
    - [è¡¨è¾¾å¼æ ‘ï¼ˆExpression Treeï¼‰](#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%A0%91expression-tree)
        - [ç”Ÿæˆã€ç¼–è¯‘å’Œæ‰§è¡Œè¡¨è¾¾å¼æ ‘](#%E7%94%9F%E6%88%90%E7%BC%96%E8%AF%91%E5%92%8C%E6%89%A7%E8%A1%8C%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%A0%91)
        - [Expression\<TDelegate>å’Œä»£ç åˆ†æ](#expression%5Ctdelegate%E5%92%8C%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90)
        - [ç”Ÿæˆè¡¨è¾¾å¼æ ‘çš„ä¸€ä¸ªæƒ…æ™¯åŒ–çš„ä¾‹å­](#%E7%94%9F%E6%88%90%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%A0%91%E7%9A%84%E4%B8%80%E4%B8%AA%E6%83%85%E6%99%AF%E5%8C%96%E7%9A%84%E4%BE%8B%E5%AD%90)
    - [LINQ](#linq)
        - [æŸ¥è¯¢è¡¨è¾¾å¼ï¼ˆQuery Expressionï¼‰](#%E6%9F%A5%E8%AF%A2%E8%A1%A8%E8%BE%BE%E5%BC%8Fquery-expression)
        - [æŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼ˆQuery Extension Methodï¼‰](#%E6%9F%A5%E8%AF%A2%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95query-extension-method)
            - [é’ˆå¯¹IEnumerable\<T>çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•](#%E9%92%88%E5%AF%B9ienumerable%5Ct%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95)
            - [é’ˆå¯¹IQuerayable\<T>çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•](#%E9%92%88%E5%AF%B9iquerayable%5Ct%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95)
- [C# 4.0 â€”â€” ç‹¬ç«‹å‘å±•](#c-40--%E7%8B%AC%E7%AB%8B%E5%8F%91%E5%B1%95)
    - [åŠ¨æ€ç±»å‹ï¼ˆDynamic Typeï¼‰](#%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8Bdynamic-type)
    - [å‘½åå‚æ•°ï¼ˆNamed Argumentï¼‰](#%E5%91%BD%E5%90%8D%E5%8F%82%E6%95%B0named-argument)
        - [å¯é€‰å‚æ•°ï¼ˆOptional Argumentï¼‰](#%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0optional-argument)
    - [åå˜ï¼ˆCovariantï¼‰ã€é€†å˜ï¼ˆContravariantï¼‰](#%E5%8D%8F%E5%8F%98covariant%E9%80%86%E5%8F%98contravariant)
- [C# 5.0 â€”â€” å­—æ•°è¶Šå°‘ï¼Œäº‹å„¿å°±è¶Šå¤§](#c-50--%E5%AD%97%E6%95%B0%E8%B6%8A%E5%B0%91%E4%BA%8B%E5%84%BF%E5%B0%B1%E8%B6%8A%E5%A4%A7)
    - [è°ƒç”¨è€…ä¿¡æ¯ï¼ˆCaller Informationï¼‰](#%E8%B0%83%E7%94%A8%E8%80%85%E4%BF%A1%E6%81%AFcaller-information)
    - [å¼‚æ­¥ç¼–ç¨‹ï¼ˆAsynchronous Programmingï¼‰](#%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8Basynchronous-programming)
        - [ä¸ºä»€ä¹ˆè¦ç”¨å¼‚æ­¥](#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E5%BC%82%E6%AD%A5)
        - [å¦‚ä½•ç†è§£å¼‚æ­¥å’Œçº¿ç¨‹çš„å…³ç³»](#%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%BC%82%E6%AD%A5%E5%92%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%85%B3%E7%B3%BB)
        - [Taskã€Task\<TResult>å’Œå¼‚æ­¥æ–¹æ³•](#tasktask%5Ctresult%E5%92%8C%E5%BC%82%E6%AD%A5%E6%96%B9%E6%B3%95)
        - [ä½¿ç”¨æ–°çº¿ç¨‹å¯åŠ¨ä»»åŠ¡](#%E4%BD%BF%E7%94%A8%E6%96%B0%E7%BA%BF%E7%A8%8B%E5%90%AF%E5%8A%A8%E4%BB%BB%E5%8A%A1)
        - [ç­‰å¾…å¤šä¸ªä»»åŠ¡](#%E7%AD%89%E5%BE%85%E5%A4%9A%E4%B8%AA%E4%BB%BB%E5%8A%A1)
        - [å¼‚æ­¥çš„ä¼˜åŠ¿](#%E5%BC%82%E6%AD%A5%E7%9A%84%E4%BC%98%E5%8A%BF)
        - [å¼‚æ­¥çš„æ­»é”ï¼ˆdeadlockï¼‰é—®é¢˜](#%E5%BC%82%E6%AD%A5%E7%9A%84%E6%AD%BB%E9%94%81deadlock%E9%97%AE%E9%A2%98)
        - [å¼‚æ­¥çš„Javaå¯¹ç…§](#%E5%BC%82%E6%AD%A5%E7%9A%84java%E5%AF%B9%E7%85%A7)
- [C# 6.0 â€”â€” è¯­æ³•ç³–æœºæª](#c-60--%E8%AF%AD%E6%B3%95%E7%B3%96%E6%9C%BA%E6%9E%AA)
    - [å¼‚å¸¸ç­›é€‰å™¨](#%E5%BC%82%E5%B8%B8%E7%AD%9B%E9%80%89%E5%99%A8)
    - [å±æ€§åˆå§‹åŒ–è¡¨è¾¾å¼](#%E5%B1%9E%E6%80%A7%E5%88%9D%E5%A7%8B%E5%8C%96%E8%A1%A8%E8%BE%BE%E5%BC%8F)
    - [nullä¼ æ’­è¿ç®—ç¬¦](#null%E4%BC%A0%E6%92%AD%E8%BF%90%E7%AE%97%E7%AC%A6)
    - [å­—ç¬¦ä¸²å†…æ’ï¼ˆString Interpolationï¼‰](#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%86%85%E6%8F%92string-interpolation)
    - [nameofè¿ç®—ç¬¦](#nameof%E8%BF%90%E7%AE%97%E7%AC%A6)
    - [ç´¢å¼•åˆå§‹åŒ–è¡¨è¾¾å¼](#%E7%B4%A2%E5%BC%95%E5%88%9D%E5%A7%8B%E5%8C%96%E8%A1%A8%E8%BE%BE%E5%BC%8F)
    - [C# 6.0çš„å…¶ä»–æ”¹è¿›](#c-60%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
- [C# 7.0â€”â€” Pythonæ˜¯ä¸ªå¥½ä¸œè¥¿](#c-70-python%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B8%9C%E8%A5%BF)
    - [outå˜é‡å£°æ˜](#out%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E)
    - [å…ƒç»„ï¼ˆTuple Typeï¼‰](#%E5%85%83%E7%BB%84tuple-type)
        - [å…ƒç»„çš„èµ‹å€¼](#%E5%85%83%E7%BB%84%E7%9A%84%E8%B5%8B%E5%80%BC)
        - [å…ƒç»„çš„è§£æ„ï¼ˆDeconstructionï¼‰](#%E5%85%83%E7%BB%84%E7%9A%84%E8%A7%A3%E6%9E%84deconstruction)
        - [è‡ªå®šä¹‰ç±»çš„è§£æ„æ–¹æ³•](#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E7%9A%84%E8%A7%A3%E6%9E%84%E6%96%B9%E6%B3%95)
        - [ä½•æ—¶ä½¿ç”¨å…ƒç»„](#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8%E5%85%83%E7%BB%84)
    - [C# 7.0çš„æ¨¡å¼åŒ¹é…ï¼ˆPattern Matchingï¼‰](#c-70%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8Dpattern-matching)
        - [å¸¸é‡æ¨¡å¼](#%E5%B8%B8%E9%87%8F%E6%A8%A1%E5%BC%8F)
        - [å£°æ˜æ¨¡å¼](#%E5%A3%B0%E6%98%8E%E6%A8%A1%E5%BC%8F)
        - [varæ¨¡å¼](#var%E6%A8%A1%E5%BC%8F)
        - [caseçš„whenå­å¥](#case%E7%9A%84when%E5%AD%90%E5%8F%A5)
    - [æœ¬åœ°å‡½æ•°ï¼ˆLocal Functionï¼‰](#%E6%9C%AC%E5%9C%B0%E5%87%BD%E6%95%B0local-function)
    - [è¡¨è¾¾å¼ä¸»ä½“ï¼ˆExpression-Bodied Memberï¼‰](#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%BB%E4%BD%93expression-bodied-member)
    - [refè¿”å›å€¼ã€refå±€éƒ¨å˜é‡](#ref%E8%BF%94%E5%9B%9E%E5%80%BCref%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F)
    - [å¼ƒå…ƒï¼ˆDiscardï¼‰](#%E5%BC%83%E5%85%83discard)
    - [throwè¡¨è¾¾å¼](#throw%E8%A1%A8%E8%BE%BE%E5%BC%8F)
    - [æ›´å¤šçš„å¯ç­‰å¾…ç±»å‹](#%E6%9B%B4%E5%A4%9A%E7%9A%84%E5%8F%AF%E7%AD%89%E5%BE%85%E7%B1%BB%E5%9E%8B)
        - [å¼‚æ­¥æ–¹æ³•æ„å»ºå™¨](#%E5%BC%82%E6%AD%A5%E6%96%B9%E6%B3%95%E6%9E%84%E5%BB%BA%E5%99%A8)
    - [C# 7.0çš„å…¶ä»–æ”¹è¿›](#c-70%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
- [C# 7.1ã€7.2ã€7.3 â€”â€” å°ç¢æ­¥](#c-717273--%E5%B0%8F%E7%A2%8E%E6%AD%A5)
    - [C# 7.1çš„æ”¹è¿›](#c-71%E7%9A%84%E6%94%B9%E8%BF%9B)
    - [C# 7.2çš„æ”¹è¿›](#c-72%E7%9A%84%E6%94%B9%E8%BF%9B)
        - [inå‚æ•°ã€readonly structã€ref structã€ref readonlyè¿”å›å€¼ã€ref readonly struct](#in%E5%8F%82%E6%95%B0readonly-structref-structref-readonly%E8%BF%94%E5%9B%9E%E5%80%BCref-readonly-struct)
        - [Span\<T>ã€ReadOnlySpan\<T>](#span%5Ctreadonlyspan%5Ct)
        - [æ–°å¢äº†å‡ ç§æ³›å‹çº¦æŸç±»å‹](#%E6%96%B0%E5%A2%9E%E4%BA%86%E5%87%A0%E7%A7%8D%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F%E7%B1%BB%E5%9E%8B)
        - [å‘½åå‚æ•°ä¸å¿…è·Ÿåœ¨å°¾éƒ¨](#%E5%91%BD%E5%90%8D%E5%8F%82%E6%95%B0%E4%B8%8D%E5%BF%85%E8%B7%9F%E5%9C%A8%E5%B0%BE%E9%83%A8)
        - [C# 7.2çš„å…¶ä»–æ”¹è¿›](#c-72%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
    - [C# 7.3çš„æ”¹è¿›](#c-73%E7%9A%84%E6%94%B9%E8%BF%9B)
        - [å…ƒç»„çš„==å’Œ!=æ”¯æŒ](#%E5%85%83%E7%BB%84%E7%9A%84%E5%92%8C%E6%94%AF%E6%8C%81)
        - [é’ˆå¯¹outå˜é‡å£°æ˜çš„æ”¹è¿›](#%E9%92%88%E5%AF%B9out%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E7%9A%84%E6%94%B9%E8%BF%9B)
        - [stackallocåˆå§‹åŒ–å™¨](#stackalloc%E5%88%9D%E5%A7%8B%E5%8C%96%E5%99%A8)
        - [ç‰¹æ€§å¯ä½œç”¨äºè‡ªåŠ¨å±æ€§çš„å­—æ®µ](#%E7%89%B9%E6%80%A7%E5%8F%AF%E4%BD%9C%E7%94%A8%E4%BA%8E%E8%87%AA%E5%8A%A8%E5%B1%9E%E6%80%A7%E7%9A%84%E5%AD%97%E6%AE%B5)
        - [å«inå‚æ•°çš„æ–¹æ³•çš„æ”¹è¿›](#%E5%90%ABin%E5%8F%82%E6%95%B0%E7%9A%84%E6%96%B9%E6%B3%95%E7%9A%84%E6%94%B9%E8%BF%9B)
        - [C# 7.3çš„å…¶ä»–æ”¹è¿›](#c-73%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
- [C# 8.0 â€”â€” å½“è¯­æ³•å‡çº§æˆä¸ºæ—¥å¸¸](#c-80--%E5%BD%93%E8%AF%AD%E6%B3%95%E5%8D%87%E7%BA%A7%E6%88%90%E4%B8%BA%E6%97%A5%E5%B8%B8)
    - [readonlyæˆå‘˜](#readonly%E6%88%90%E5%91%98)
    - [æ¥å£çš„é»˜è®¤å®ç°](#%E6%8E%A5%E5%8F%A3%E7%9A%84%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0)
    - [C# 8.0çš„æ¨¡å¼åŒ¹é…](#c-80%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D)
        - [switchè¡¨è¾¾å¼](#switch%E8%A1%A8%E8%BE%BE%E5%BC%8F)
        - [å¼ƒå…ƒæ¨¡å¼](#%E5%BC%83%E5%85%83%E6%A8%A1%E5%BC%8F)
        - [å±æ€§æ¨¡å¼](#%E5%B1%9E%E6%80%A7%E6%A8%A1%E5%BC%8F)
        - [å…ƒç»„æ¨¡å¼](#%E5%85%83%E7%BB%84%E6%A8%A1%E5%BC%8F)
        - [ä½ç½®æ¨¡å¼](#%E4%BD%8D%E7%BD%AE%E6%A8%A1%E5%BC%8F)
    - [usingå£°æ˜](#using%E5%A3%B0%E6%98%8E)
    - [å¯nullå¼•ç”¨ç±»å‹](#%E5%8F%AFnull%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B)
    - [å¼‚æ­¥è¿­ä»£å™¨](#%E5%BC%82%E6%AD%A5%E8%BF%AD%E4%BB%A3%E5%99%A8)
    - [å¼‚æ­¥å¯é‡Šæ”¾](#%E5%BC%82%E6%AD%A5%E5%8F%AF%E9%87%8A%E6%94%BE)
    - [ç´¢å¼•ï¼ˆIndexï¼‰ã€èŒƒå›´ï¼ˆRangeï¼‰](#%E7%B4%A2%E5%BC%95index%E8%8C%83%E5%9B%B4range)
        - [ç´¢å¼•å®šä½](#%E7%B4%A2%E5%BC%95%E5%AE%9A%E4%BD%8D)
        - [èŒƒå›´åˆ‡ç‰‡](#%E8%8C%83%E5%9B%B4%E5%88%87%E7%89%87)
        - [è‡ªå®šä¹‰ç±»å‹æ”¯æŒç´¢å¼•å’ŒèŒƒå›´](#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%94%AF%E6%8C%81%E7%B4%A2%E5%BC%95%E5%92%8C%E8%8C%83%E5%9B%B4)
            - [æ˜¾å¼æ”¯æŒIndexå’ŒRange](#%E6%98%BE%E5%BC%8F%E6%94%AF%E6%8C%81index%E5%92%8Crange)
            - [éšå¼æ”¯æŒIndexå’ŒRange](#%E9%9A%90%E5%BC%8F%E6%94%AF%E6%8C%81index%E5%92%8Crange)
    - [nullåˆå¹¶èµ‹å€¼è¿ç®—ç¬¦](#null%E5%90%88%E5%B9%B6%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6)
    - [C# 8.0çš„å…¶ä»–æ”¹è¿›](#c-80%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
- [C# 9.0 â€”â€” æ–°çš„å¾ç¨‹](#c-90--%E6%96%B0%E7%9A%84%E5%BE%81%E7%A8%8B)
    - [initè®¿é—®å™¨](#init%E8%AE%BF%E9%97%AE%E5%99%A8)
    - [è®°å½•ï¼ˆRecordï¼‰](#%E8%AE%B0%E5%BD%95record)
        - [è®°å½•çš„ç»§æ‰¿](#%E8%AE%B0%E5%BD%95%E7%9A%84%E7%BB%A7%E6%89%BF)
        - [è®°å½•ä¸structæ¯”è¾ƒ](#%E8%AE%B0%E5%BD%95%E4%B8%8Estruct%E6%AF%94%E8%BE%83)
        - [withè¡¨è¾¾å¼](#with%E8%A1%A8%E8%BE%BE%E5%BC%8F)
    - [é¡¶çº§è¯­å¥](#%E9%A1%B6%E7%BA%A7%E8%AF%AD%E5%8F%A5)
    - [C# 9.0çš„æ¨¡å¼åŒ¹é…](#c-90%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D)
        - [ç±»å‹æ¨¡å¼](#%E7%B1%BB%E5%9E%8B%E6%A8%A1%E5%BC%8F)
        - [å…³ç³»æ¨¡å¼](#%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%BC%8F)
        - [é€»è¾‘æ¨¡å¼](#%E9%80%BB%E8%BE%91%E6%A8%A1%E5%BC%8F)
        - [æ¨¡å¼åŒ¹é…çš„æ€»ç»“](#%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E7%9A%84%E6%80%BB%E7%BB%93)
    - [ç›®æ ‡ç±»å‹newè¡¨è¾¾å¼](#%E7%9B%AE%E6%A0%87%E7%B1%BB%E5%9E%8Bnew%E8%A1%A8%E8%BE%BE%E5%BC%8F)
    - [åå˜è¿”å›ç±»å‹](#%E5%8D%8F%E5%8F%98%E8%BF%94%E5%9B%9E%E7%B1%BB%E5%9E%8B)
    - [Lambdaçš„å¼ƒå…ƒå‚æ•°](#lambda%E7%9A%84%E5%BC%83%E5%85%83%E5%8F%82%E6%95%B0)
    - [æ¨¡å—çš„åˆå§‹åŒ–æ–¹æ³•](#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95)
    - [æ¡ä»¶è¡¨è¾¾å¼çš„ç›®æ ‡ç±»å‹ä¼˜åŒ–](#%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E7%9B%AE%E6%A0%87%E7%B1%BB%E5%9E%8B%E4%BC%98%E5%8C%96)
    - [C# 9.0çš„å…¶ä»–æ”¹è¿›](#c-90%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
- [C# 10.0 â€”â€” å­¦æ— æ­¢å°½](#c-100--%E5%AD%A6%E6%97%A0%E6%AD%A2%E5%B0%BD)
    - [è®°å½•ç»“æ„ï¼ˆRecord Structï¼‰](#%E8%AE%B0%E5%BD%95%E7%BB%93%E6%9E%84record-struct)
    - [å±æ€§æ¨¡å¼çš„æ”¹è¿›](#%E5%B1%9E%E6%80%A7%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%94%B9%E8%BF%9B)
    - [Lambdaè¡¨è¾¾å¼çš„æ”¹è¿›](#lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E6%94%B9%E8%BF%9B)
    - [constå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å†…æ’](#const%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%86%85%E6%8F%92)
    - [å…ƒç»„è§£æ„å£°æ˜çš„ä¼˜åŒ–](#%E5%85%83%E7%BB%84%E8%A7%A3%E6%9E%84%E5%A3%B0%E6%98%8E%E7%9A%84%E4%BC%98%E5%8C%96)
    - [è°ƒç”¨è€…ä¿¡æ¯æ”¹è¿›](#%E8%B0%83%E7%94%A8%E8%80%85%E4%BF%A1%E6%81%AF%E6%94%B9%E8%BF%9B)
    - [C# 10.0çš„å…¶ä»–æ”¹è¿›](#c-100%E7%9A%84%E5%85%B6%E4%BB%96%E6%94%B9%E8%BF%9B)
- [ç›¸é¡¾å›çœ¸](#%E7%9B%B8%E9%A1%BE%E5%9B%9E%E7%9C%B8)
    - [æœ‰ä»€ä¹ˆæ˜¯Javaæœ‰ä½†æ˜¯C#æ²¡æœ‰çš„](#%E6%9C%89%E4%BB%80%E4%B9%88%E6%98%AFjava%E6%9C%89%E4%BD%86%E6%98%AFc%E6%B2%A1%E6%9C%89%E7%9A%84)
    - [C# Style](#c-style)
        - [æ€æ ·çœ‹èµ·æ¥åƒä¸€ä¸ªåŸç”Ÿçš„CShaper](#%E6%80%8E%E6%A0%B7%E7%9C%8B%E8%B5%B7%E6%9D%A5%E5%83%8F%E4%B8%80%E4%B8%AA%E5%8E%9F%E7%94%9F%E7%9A%84cshaper)
- [é™„å½•](#%E9%99%84%E5%BD%95)
    - [å‚è€ƒèµ„æ–™](#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99)
    - [ä½œè€…æŒ‰](#%E4%BD%9C%E8%80%85%E6%8C%89)

<!-- /TOC -->

# æ­£æ–‡ä¹‹å‰

## åŸºæœ¬æ¦‚å¿µ

è¿™é‡Œåˆ—å‡ºC#å’Œ\.Netçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œä¾›å‚è€ƒï¼š

### C# ###

- C#æ˜¯ä¸€é—¨è¯­è¨€ï¼Œä»–çš„è¯­æ³•ç±»ä¼¼C++å’ŒJavaã€‚
- C#æ˜¯å®Œå…¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œç¨‹åºå…¥å£ç‚¹ä¹Ÿåœ¨ç±»ä¸­ï¼ˆMainæ–¹æ³•ï¼‰ã€‚
- C#ç”¨äºç¼–å†™\.Netç¨‹åºï¼Œä½†ä¸æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚é™¤äº†C#ä¹‹å¤–ï¼Œè¿˜æœ‰F#ã€VB\.Netç­‰ç­‰è¯­è¨€ï¼Œä¹Ÿå¯ç”¨äºç¼–å†™\.Netç¨‹åºã€‚

### \.Net

ä¸‹é¢æ˜¯ä¸€äº›å’Œ\.Netæœ‰å…³çš„åè¯ã€‚ï¼ˆåè¯è§£é‡Šä¸­å‡ºç°çš„è‹±æ–‡ç¼©å†™ï¼Œä¹Ÿä¼šåœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°ç›¸å…³è§£é‡Šã€‚ï¼‰

- **\.Net**ï¼Œæ˜¯ä¸€å¥—æ¡†æ¶ï¼Œå®ƒä¸»è¦ç”±CLRå’ŒFCLç»„æˆã€‚å› ä¸º\.Netç¨‹åºä¸ä»…ä»…æ”¯æŒä¸€ç§è¯­è¨€ç¼–å†™ï¼Œæ‰€ä»¥ä¸‹é¢çš„å„æ¡æœ¯è¯­éƒ½æœ‰å‰ç¼€Commonã€‚Commonç¿»è¯‘ä¸ºå…¬å…±ï¼Œä½“ç°çš„æ˜¯è·¨è¯­è¨€ã€é€šç”¨ã€‚
- **CLR**ï¼ˆå…¬å…±è¿è¡Œæ—¶ï¼ŒCommon Language Runtimeï¼‰ï¼Œæ˜¯CLIçš„å…·ä½“å®ç°ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯ç›®å‰ä¸ºæ­¢çš„å”¯ä¸€å®ç°ã€‚å®ƒåŒ…å«JITç¼–è¯‘å™¨ç­‰ç»„ä»¶ã€‚CLRæœ‰å¾ˆå¤šï¼ŒåŒ…æ‹¬\.NetFrameworkï¼Œ\.NetCoreï¼ŒMono\.Netï¼Œä»¥åŠæœ€æ–°çš„\.Netç­‰ã€‚

    > CLRç›¸å½“äºJavaçš„JVMã€‚CLRä¸JVMçš„æœ€ä¸»è¦åŒºåˆ«åœ¨äºï¼šCLRè¢«è®¾è®¡ä¸ºä¸è¯­è¨€æ— å…³ï¼Œè€ŒJVMè¢«è®¾è®¡ä¸ºç‰¹å®šäºJavaã€‚

- **CLI**ï¼ˆå…¬å…±è¯­è¨€åŸºç¡€è®¾æ–½ï¼ŒCommon Language Infrastructureï¼‰ï¼Œæ˜¯å¾®è½¯å…¬å¸å‘ECMAæäº¤çš„ä¸€ä»½è¯­è¨€å’Œæ•°æ®æ ¼å¼è§„èŒƒã€‚åŒ…æ‹¬CTSã€CILç­‰ã€‚CLRå®ç°äº†è¯¥è§„èŒƒã€‚
- **CTS**ï¼ˆå…¬å…±ç±»å‹ç³»ç»Ÿï¼ŒCommon Types Systemï¼‰ï¼Œå®šä¹‰äº†èƒ½å¤Ÿåœ¨CLRä¸Šè¿è¡Œçš„è¯­è¨€è§„èŒƒã€‚å®ƒå®šä¹‰äº†é€šç”¨çš„æ•°æ®ç±»å‹ã€‚
- **CIL**ï¼ˆå…¬å…±ä¸­é—´è¯­è¨€ï¼ŒCommon Intermediate Languageï¼Œæˆ–ç®€ç§°ILï¼‰ï¼Œæ˜¯ä¸€ç§ä¸­é—´ä»£ç ï¼Œæ˜¯\.NETæ¡†æ¶çš„ä½é˜¶äººç±»å¯è¯»è¯­è¨€ï¼Œä¸”ä¸å¼€å‘æ—¶æ‰€ç”¨çš„ä¸Šå±‚è¯­è¨€æ— å…³ã€‚ä¸Šå±‚çš„è¯­è¨€ï¼Œå¦‚C#ç­‰ï¼Œä¼šåœ¨ç”Ÿæˆdllå’Œexeæ—¶è¢«ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºCILä»£ç ï¼Œè€Œéç›´æ¥ç¼–è¯‘ä¸ºæœºå™¨ç ã€‚è¿™ç§ä»£ç ä¸åº•å±‚ç¡¬ä»¶è®¾æ–½æ— å…³ï¼Œå¯ä»¥ç”±CLRä¸­çš„JITç¼–è¯‘å™¨ç¿»è¯‘ä¸ºæœºå™¨è¯­è¨€æ‰§è¡Œã€‚ç”±äºè¿™æ ·çš„è®¾è®¡ï¼Œä½¿å¾—ä¸åŒä¸Šå±‚è¯­è¨€è°ƒç”¨å…¶ä»–è¯­è¨€ç¼–å†™çš„åº“æ—¶ï¼Œä¸ä¼šé‡åˆ°éšœç¢ã€‚

    > CILå¯¹åº”Javaçš„å­—èŠ‚ç ã€‚

- **JITç¼–è¯‘å™¨**ï¼ˆå³æ—¶ç¼–è¯‘ï¼ŒJust-In-Time Compilationï¼‰ï¼Œæ˜¯CLRçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç”¨äºå°†CILä»£ç ç¿»è¯‘æˆæœºå™¨ç ã€‚JITç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰å·¥ä½œã€‚åœ¨ILä»£ç ç¬¬ä¸€æ¬¡è¢«æ‰§è¡Œæ—¶ï¼Œä¼šæŒ‰ç…§å…·ä½“çš„CPUç±»å‹ã€æ“ä½œç³»ç»Ÿç±»å‹ç­‰å°†ILç¿»è¯‘æˆæœºå™¨ç å¹¶æ‰§è¡Œã€‚JITå¯¹åŒä¸€æ®µILä»£ç çš„ç¼–è¯‘åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œç¬¬äºŒæ¬¡ä»¥åæ‰§è¡Œä¾¿ä¼šç›´æ¥ä½¿ç”¨æœºå™¨ç ï¼Œä¸å†æ‰§è¡Œç¼–è¯‘è¿‡ç¨‹ï¼Œä»¥ä¼˜åŒ–æ•ˆç‡ã€‚
- **æ‰˜ç®¡ä»£ç **ï¼ˆManaged Codeï¼‰å’Œ**éæ‰˜ç®¡ä»£ç **ï¼ˆUnmanaged Codeï¼‰ï¼šæ‰˜ç®¡ä»£ç ä¸ºå¯ç”±ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºCILçš„ä»£ç ã€‚æ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬ç¼–å†™çš„C#ä»£ç éƒ½æ˜¯æ‰˜ç®¡ä»£ç ã€‚è°ƒç”¨å…¶ä»–é\.Netè¯­è¨€ï¼ˆå¦‚C++ï¼‰ç¼–å†™çš„åº“ï¼Œæˆ–ä½¿ç”¨unsafeä¸Šä¸‹æ–‡ç¼–å†™å«æŒ‡é’ˆæ“ä½œçš„ä»£ç ï¼Œå±äºéæ‰˜ç®¡ä»£ç ã€‚æ‰˜ç®¡ä»£ç æ˜¯å†…å­˜å®‰å…¨çš„ï¼Œå¯¹å·²åˆ†é…çš„å†…å­˜ç©ºé—´ç”±GCè¿›è¡Œç®¡ç†ã€‚
- **GC**ï¼ˆåƒåœ¾å›æ”¶å™¨ï¼ŒGarbage Collectorï¼‰ï¼Œå®ƒé€šè¿‡å¯¹è±¡å¼•ç”¨è®¡æ•°å™¨ç®¡ç†å¯¹è±¡çš„å¼•ç”¨æƒ…å†µï¼Œå¹¶åœ¨å¯¹è±¡å¤±å»æ‰€æœ‰å¼•ç”¨åæ‰§è¡Œè‡ªåŠ¨çš„å†…å­˜å›æ”¶å·¥ä½œï¼Œå› è€Œä¸å¿…åƒC++ä¸€æ ·æ‰‹åŠ¨freeæ‰åˆ†é…çš„å†…å­˜ç©ºé—´ã€‚GCæ˜¯æ‰€æœ‰é«˜çº§è¯­è¨€ä¸­éå¸¸é‡è¦çš„å†…å­˜ç®¡ç†æœºåˆ¶ã€‚
- **FCL**ï¼ˆæ¡†æ¶ç±»åº“ï¼ŒFramework Class Libraryï¼‰ï¼Œä¸CLRå¹¶åˆ—ï¼Œæ˜¯\.Netçš„é‡è¦ä¿ƒæˆéƒ¨åˆ†ã€‚å¤§å®¶éƒ½æ˜ç™½ï¼Œè¯­è¨€å’Œè¯­æ³•åªæ˜¯ä¸€æ–¹é¢ï¼ŒçœŸæ­£è¦å®Œæˆå…·ä½“ä»»åŠ¡ï¼Œç¦»ä¸å¼€å„ç§ç±»åº“çš„å¸®åŠ©ã€‚è€Œ\.Netæä¾›äº†å¤§é‡å®˜æ–¹çš„ç±»åº“ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä¸”è¦†ç›–æå¹¿ã€‚ä»å‰ï¼ŒCShaperæœ‰æ—¶å€¾å‘äºé€‰æ‹©å®˜æ–¹ç±»åº“è€Œéç¬¬ä¸‰æ–¹ç±»åº“ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šä¹Ÿæ˜¯ç”±äºå®˜æ–¹ç±»åº“è¿‡äºå¼ºå¤§è€ŒåŸ¹å…»å‡ºæ¥çš„ä¹ æƒ¯ï¼Œç®—æ˜¯ä¸€ç§æ€ç»´å®šå¼ï¼ˆä¿—ç§°ï¼šå¾®è½¯å¤§æ³•å¥½ï¼‰ã€‚å½“ç„¶ï¼Œéšç€\.Netæœ¬èº«çš„èµ°å‘å¼€æ”¾ï¼ŒCShaperä»¬çš„å¿ƒæ€ç°åœ¨ä¹Ÿå¾ˆå¼€æ”¾äº†ã€‚å› è€Œgithubä¸ŠC#çš„ä¼˜ç§€å¼€æºé¡¹ç›®ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚FCLå…·ä½“åˆå¯ä»¥åˆ’åˆ†ä¸ºBCLå’ŒAppModelã€‚
- **BCL**ï¼ˆåŸºç¡€ç±»åº“ï¼ŒBasic Class Libraryï¼‰ï¼Œ\.Netè¾ƒä¸ºåº•å±‚çš„ç±»åº“ï¼Œä¸åº”ç”¨ç±»å‹æ— å…³ã€‚åŸºç¡€ç±»åº“å¯ç”¨äºå„ç§ç±»å‹çš„å¼€å‘åœºæ™¯ä¸­ã€‚
- **AppModel**ï¼Œæ˜¯\.Netå®˜æ–¹ç±»åº“ä¸­ï¼Œç”¨äºå†³å®šåº”ç”¨å½¢æ€çš„æ¡†æ¶æ€§ç±»åº“ã€‚åŒ…æ‹¬ **WCFã€WPFã€WinFormã€Webformã€ASP\.NET MVCã€ASP\.NET Core**ç­‰ç­‰ç­‰ç­‰ã€‚ä¾‹å¦‚ï¼šWCFç”¨äºç¼–å†™æœåŠ¡ï¼Œå¹¶ä»¥å„ç§æ–¹å¼ï¼ˆç»ˆç»“ç‚¹ï¼‰æš´éœ²æœåŠ¡ï¼ˆå‡ ä¹å·²ç»æ·˜æ±°ï¼‰ï¼›WPFã€Winformç”¨äºç¼–å†™çª—ä½“åº”ç”¨ï¼›ASP\.NETç³»åˆ—ç”¨äºç¼–å†™Webåº”ç”¨ç­‰ã€‚

    > å¯ä»¥ç±»æ¯”Javaçš„SpringBootï¼ŒSpringMVCç­‰ã€‚ä¸åŒç‚¹æ˜¯\.Netçš„è¿™éƒ¨åˆ†åº“éƒ½æ˜¯å®˜æ–¹çš„ï¼Œè€Œéç¬¬ä¸‰æ–¹æä¾›ã€‚

- **Debugæ¨¡å¼**å’Œ**Releaseæ¨¡å¼**ï¼šåœ¨ç¼–è¯‘æ—¶å¯ä»¥é€‰æ‹©Debugå’ŒReleaseæ¨¡å¼ã€‚
    - Debugæ¨¡å¼ä¸€èˆ¬ç”¨äºè°ƒè¯•ï¼Œè¿™ç§æ¨¡å¼ä¼šåœ¨ç”Ÿæˆçš„CILä¸­æ’å…¥å¤§é‡è°ƒè¯•ç¬¦å·ï¼ˆDebugging Symbolsï¼‰ã€‚Debugæ¨¡å¼ä¸‹ç”Ÿæˆçš„CILä»£ç ä¾ç„¶å…·æœ‰è¾ƒé«˜å¯è¯»æ€§ã€‚å®ƒä¿ç•™äº†æºç ä¸­çš„ä»£ç æ‰€å¤„ç±»å‹ã€æ–¹æ³•ã€è¡Œå·ç­‰ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥å‡†ç¡®çš„æ•æ‰å’Œå®šä½å¼‚å¸¸ã€‚Debugæ¨¡å¼ä¸ä¼šå¯¹ä»£ç åšç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œä¹Ÿä¸ä¼šè°ƒæ•´ä»£ç æ‰§è¡Œé¡ºåºã€‚è¡¨ç°ä¸ºç¨‹åºå®Œå…¨æŒ‰ç…§ä¹¦å†™å†…å®¹æ‰§è¡Œã€‚ä¾‹å¦‚ï¼šç»™ä¸€ä¸ªä»æœªè¢«ä½¿ç”¨è¿‡çš„ä¸´æ—¶å˜é‡èµ‹å€¼å¸¸é‡å€¼ï¼ŒDebugæ¨¡å¼çš„ç¨‹åºä¼šç…§åšã€‚
    - Releaseæ¨¡å¼ï¼Œç”¨äºç”Ÿäº§ã€‚æ˜¯ç¨‹åºæ‰§è¡Œå‘å¸ƒï¼ˆPublishï¼‰æ“ä½œæ—¶é»˜è®¤çš„æ¨¡å¼ã€‚Releaseæ¨¡å¼æ‰“å‡ºæ¥çš„åº”ç”¨ç¨‹åºé›†æ–‡ä»¶ï¼ˆdllã€exeï¼‰è¦æ¯”Debugæ¨¡å¼å°çš„å¤šã€‚Releaseæ¨¡å¼ä¼šå¯¹ä»£ç åšç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œä¾‹å¦‚å°†æ•°ä¸ªç®€å•èµ‹å€¼è¯­å¥åˆå¹¶æˆä¸€å¥ç­‰ç­‰ã€‚å› è€Œå¯èƒ½ä¼šä¸¢å¤±åŸå§‹çš„ä»£ç è¡Œå·ç­‰ä¿¡æ¯ã€‚åœ¨IDEä¸­ä½¿ç”¨Releaseæ¨¡å¼è¿è¡Œè°ƒè¯•æ—¶ï¼Œå¯èƒ½æ— æ³•å‡†ç¡®å‘½ä¸­æ–­ç‚¹ï¼Œä¹Ÿæœ‰å¯èƒ½æ— æ³•å‡†ç¡®æ•è·æœªè¢«catchçš„å¼‚å¸¸ã€‚Releaseæ¨¡å¼ä¸‹ï¼Œä½¿ç”¨Reflectorç­‰å·¥å…·è¿›è¡Œåç¼–è¯‘ï¼Œä¼šå‘ç°æœ‰äº›ä»£ç å˜å¾—è·ŸåŸå§‹ä»£ç æœ‰å·®å¼‚ï¼Œè¿™åŒ…æ‹¬ä½†ä¸é™äºæœ¬åœ°å˜é‡åè¢«æŠ¹é™¤ã€è¯­å¥é¡ºåºè°ƒæ•´ç­‰ã€‚å› è€Œï¼Œè°ƒç”¨ç¬¬ä¸‰æ–¹å‘è¡Œç‰ˆåŒ…æ—¶ï¼Œå¾ˆéš¾é€šè¿‡åç¼–è¯‘è¿›è¡ŒåŒ…å†…æ–¹æ³•çš„è°ƒè¯•ã€‚
- **Module**(æ¨¡å—ï¼Œæˆ–Managed Moduleï¼Œæ‰˜ç®¡æ¨¡å—)ã€‚æ˜¯ç¼–è¯‘åçš„ä¸€ä¸ªä»£ç å•å…ƒï¼Œæ˜¯Assemblyçš„ç»„æˆéƒ¨åˆ†ã€‚ä¸€ä¸ªæ¨¡å—ä¸»è¦åŒ…å«å…ƒæ•°æ®å’ŒILä»£ç ã€‚å…ƒæ•°æ®ä¸»è¦æ˜¯ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€éƒ¨åˆ†æ˜¯æ¨¡å—ä¸­æ‰€å®šä¹‰çš„æ‰€æœ‰ç±»å‹æè¿°ã€æ–¹æ³•æ‰€åœ¨ä½ç½®ç­‰ä¿¡æ¯ï¼›å¦ä¸€éƒ¨åˆ†æ˜¯æ‰€å¼•ç”¨å¹¶ä¸”ä½¿ç”¨åˆ°çš„å…¶ä»–åº“ä¸­ç±»å‹çš„æè¿°ï¼Œè¿™éƒ¨åˆ†ä¿¡æ¯ä½¿å¾—JITå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ è½½è¿™äº›ç±»åº“ï¼Œè€Œä¸ç”¨é¢„å…ˆå°†æ‰€å¼•ç”¨çš„åº“ä¹Ÿç¼–è¯‘è¿›æ¨¡å—ä¸­ã€‚ILåˆ™æ˜¯ç”±JITç¼–è¯‘å¹¶æ‰§è¡Œçš„ä»£ç ã€‚æ³¨æ„ï¼šæ¨¡å—ä¸å‘½åç©ºé—´ä¹‹é—´æ²¡æœ‰å¿…ç„¶è¿ç³»ã€‚
- **Assembly**(åº”ç”¨ç¨‹åºé›†)ï¼Œæ˜¯\.Netç¨‹åºçš„ç»„æˆå•å…ƒï¼Œä¹Ÿæ˜¯ç‰ˆæœ¬æ§åˆ¶çš„æœ€å°å•å…ƒã€‚å®ƒç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—ã€èµ„æºå®šä¹‰æ–‡ä»¶ï¼ˆManifestï¼‰ã€èµ„æºæ–‡ä»¶ç»„ç»„æˆã€‚èµ„æºå®šä¹‰æ–‡ä»¶åŒ…å«CLRç‰ˆæœ¬ä¿¡æ¯ã€åº”ç”¨å½¢æ€ä¿¡æ¯ã€ç¨‹åºå…¥å£ç‚¹ä½ç½®ç­‰ã€‚èµ„æºæ–‡ä»¶ç»„å¯åŒ…å«ä¸€å †è¢«æ‰“åŒ…è¿›Assemblyçš„èµ„æºæ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥åŒ…å«dllã€‚Assemblyä¸€èˆ¬è¢«æ‰“åŒ…ä¸ºç‹¬ç«‹çš„dllï¼ˆç±»åº“ï¼‰æˆ–è€…exeï¼ˆå«å…¥å£ç‚¹çš„ç¨‹åºï¼‰æ–‡ä»¶ã€‚\.Netçš„ç¨‹åºæ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šæŠŠä¸åŒçš„dllã€exeæ‰“åŒ…æˆç‹¬ç«‹æ–‡ä»¶ï¼Œä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„\.Netç¨‹åºå¤§éƒ½ç”±å¤šä¸ªexeå’Œdllæ–‡ä»¶ç»„æˆï¼Œä»–ä»¬é€šè¿‡å¼•ç”¨å…³è”èµ·æ¥ã€‚å¸¸è§çš„ä¾‹å¦‚ï¼šç”±ä¸€ä¸ªexeæ–‡ä»¶ä½œä¸ºå…¥å£ç‚¹ï¼Œåœ¨è¯¥exeä¸­è°ƒç”¨äº†å…¶ä»–çš„å¤šä¸ªdllæ–‡ä»¶ä¸­çš„åŠŸèƒ½ï¼Œå®ƒä»¬å…±åŒç»„æˆäº†ä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„\.Netç¨‹åºã€‚è¿™é‡Œçš„æ¯ä¸ªexeæˆ–dllæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºé›†ã€‚åº”ç”¨ç¨‹åºé›†æ˜¯è‡ªæè¿°çš„ï¼Œå› è€Œåªéœ€è¦å¼•ç”¨dllæ–‡ä»¶å³å¯ä½¿ç”¨ï¼Œä¸åƒC++ç­‰å¯èƒ½è¿˜éœ€è¦\.defã€\.hæ–‡ä»¶çš„é…åˆï¼Œä¹Ÿä¸åƒComç»„ä»¶é‚£æ ·éœ€è¦é…åˆæ³¨å†Œè¡¨ä½¿ç”¨ã€‚åº”ç”¨ç¨‹åºé›†é‡‡ç”¨ä½¿ç”¨æ—¶åŠ è½½çš„ç­–ç•¥ï¼šä»£ç ä¸­å¼•ç”¨äº†æŸä¸ªdllï¼Œåœ¨Runtimeå®é™…ä½¿ç”¨è¯¥dllä¸­çš„ä»»ä½•ç±»æˆ–å®šä¹‰ä¹‹å‰ï¼Œåº”ç”¨ç¨‹åºé›†å¹¶ä¸ä¼šè¢«å®é™…åŠ è½½ã€‚åº”ç”¨ç¨‹åºé›†æ—¢æ”¯æŒåœ¨é¡¹ç›®ä¸­**é™æ€å¼•ç”¨**ï¼Œä»¥ä¾¿åœ¨ç¼–å†™æ—¶æä¾›è¯­æ³•æç¤ºå’Œæ‰§è¡Œç¼–è¯‘å™¨æ£€æŸ¥ï¼Œå¹¶åœ¨æ‰“åŒ…æ—¶å°†è¢«å¼•ç”¨çš„åº”ç”¨ç¨‹åºé›†ç±»å‹å®šä¹‰æè¿°å†™è¿›å…ƒæ•°æ®å†…ï¼›ä¹Ÿæ”¯æŒé€šè¿‡Assemblyç±»åœ¨è¿è¡Œæ—¶**åŠ¨æ€åŠ è½½**ï¼Œç”šè‡³å¯ä»¥ä»èµ„æºæ–‡ä»¶ä¸­åŠ è½½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªé¡¹ç›®åœ¨ç¼–è¯‘æ—¶ä¼šç”Ÿæˆä¸€ä¸ªä»…åŒ…å«ä¸€ä¸ªæ¨¡å—çš„åº”ç”¨ç¨‹åºé›†ï¼Œå› è€Œå¤§éƒ¨åˆ†æ—¶å€™é¡¹ç›®ã€æ¨¡å—ã€åº”ç”¨ç¨‹åºé›†æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ä½†æ˜¯ï¼Œä½ ä»ç„¶å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå·¥å…·å°†ä¸€ä¸ªé¡¹ç›®ã€ç”šè‡³ä¸€ä¸ªä»£ç æ–‡ä»¶ç¼–è¯‘æˆä¸€ä¸ªæ¨¡å—ï¼Œç„¶åå†ä½¿ç”¨å·¥å…·å°†å¤šä¸ªæ¨¡å—æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œæ‰“åŒ…æˆä¸€ä¸ªåº”ç”¨ç¨‹åºé›†æ–‡ä»¶ã€‚è¿™æ ·åšæ—¶ï¼Œä½ ç”šè‡³å¯ä»¥ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™è¿™äº›æ¨¡å—ã€‚æ³¨æ„ï¼šåº”ç”¨ç¨‹åºé›†ä¸å‘½åç©ºé—´ä¹‹é—´ä¹Ÿæ²¡æœ‰å¿…ç„¶è¿ç³»ã€‚

    > è¯»è€…å¯ä»¥è‡ªè¡Œå°†Assemblyå’ŒModuleï¼Œä¸Javaçš„å¤šModuleé¡¹ç›®åšä¸‹ç±»æ¯”ã€‚

- **Nuget**ï¼šNugetæ˜¯\.Netçš„åŒ…ç®¡ç†å·¥å…·ã€‚nuget.orgä¹Ÿæ˜¯æ”¯æŒç¬¬ä¸‰æ–¹\.Netçš„åŒ…å‘å¸ƒå¹³å°ã€‚Nugetå¾ˆå¥½çš„è§£å†³äº†ç‰ˆæœ¬æ§åˆ¶çš„é—®é¢˜ã€‚å› ä¸ºç±»åº“çš„dllæ–‡ä»¶å¹¶ä¸ä¼šè·Ÿéšå¼•ç”¨å®ƒçš„åº”ç”¨ç¨‹åºæ‰“åŒ…è¿›exeï¼Œè€Œæ˜¯ä¿æŒç‹¬ç«‹çš„dllï¼Œæ‰€ä»¥å½“ä½ çš„è§£å†³æ–¹æ¡ˆä¸­ï¼Œä¸€ä¸ªé¡¹ç›®å¼•ç”¨äº†å¦ä¸€ä¸ªé¡¹ç›®ï¼Œè€Œè¿™ä¸¤ä¸ªé¡¹ç›®åˆéƒ½å¼•ç”¨äº†åŒä¸€ä¸ªåŒ…ï¼Œä½†æ˜¯åŒ…çš„ç‰ˆæœ¬å´ä¸åŒæ—¶ï¼ŒNugetå¯ä»¥æ ¹æ®ä¸€å®šçš„ç­–ç•¥ä¿è¯æ‰€å¼•ç”¨çš„åŒ…ç‰ˆæœ¬æœ€ç»ˆä¸€è‡´ï¼Œå¹¶åœ¨æ— æ³•è°ƒå’Œç‰ˆæœ¬æ—¶åœ¨ç¼–è¯‘æ—¶ä¾¿ç»™å‡ºæŠ¥é”™ã€‚æ·»åŠ Nugetçš„åŒ…å¯ä»¥ç›´æ¥é€šè¿‡IDEçš„NugetåŒ…ç®¡ç†ç•Œé¢ï¼Œæˆ–è€…é€šè¿‡å¼€å‘å‘½ä»¤è¡Œçš„Install-Packageå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹é¡¹ç›®æ–‡ä»¶ï¼ˆä¸€èˆ¬ä¸º.xxxxprojæ ¼å¼ï¼Œå¦‚C#é¡¹ç›®ä¸º.csprojï¼‰ã€‚æ‰“åŒ…è‡ªå·±å¼€å‘çš„ç¨‹åºä¸ºNugetåŒ…ï¼Œå¯ä»¥é€šè¿‡IDEç›´æ¥è¿›è¡Œæ“ä½œï¼›ä¹Ÿå¯ä»¥éµå¾ªNugetåŒ…ç»“æ„æ„å»ºç›®å½•ï¼Œç„¶åä½¿ç”¨Nugetå‘½ä»¤è¡Œå·¥å…·ã€NugetåŒ…ç®¡ç†å·¥å…·è¿›è¡Œæ‰“åŒ…ã€‚ä½¿ç”¨IDEçš„è‡ªåŠ¨æ‰“åŒ…æ—¶ï¼Œå¦‚æœè¢«æ‰“åŒ…çš„é¡¹ç›®åŒ…å«å¯¹è§£å†³æ–¹æ¡ˆå†…å…¶ä»–é¡¹ç›®çš„å¼•ç”¨ï¼Œåˆ™æ‰“åŒ…æˆNugetåŒ…åï¼Œä¼šè‡ªåŠ¨è½¬æ¢ä¸ºå¯¹NugetåŒ…çš„å¼•ç”¨ã€‚

    > Nugetç±»ä¼¼äºJavaçš„Mavenã€‚å®ƒä»¬çš„ä¸»è¦å·®å¼‚ï¼š
    >
    > - Nugetå¹¶ä¸åŒºåˆ†å¼€å‘ä»“åº“å’Œå‘å¸ƒä»“åº“ã€‚NugetåŒ…åŒä¸€ç‰ˆæœ¬ä¸æ”¯æŒé‡å¤æ¨é€ï¼Œå·²ä¸‹è½½è¿‡çš„åŒ…æœ¬åœ°ä¼šæœ‰ç¼“å­˜ã€‚å› è€Œæ¨åˆ°Nugetä»“åº“çš„åŒ…ï¼Œä¸ä¾¿äºä½¿ç”¨åŒä¸€ä¸ªç‰ˆæœ¬å·ä¸æ–­æ›´æ–°ã€‚å¯¹äºéç¨³å®šç‰ˆåŒ…ï¼Œä¸€èˆ¬ä½¿ç”¨ç‰ˆæœ¬å·+åç¼€çš„å½¢å¼æ¨é€ã€‚å¦‚ï¼š1.0-previewï¼Œ1.2-rc3.1ç­‰ã€‚IDEä¸­æœç´¢æ—¶ï¼Œå¯ä»¥è¿‡æ»¤è¿™äº›éç¨³å®šç‰ˆæœ¬çš„åŒ…ã€‚
    > - è€ŒMavenåˆ™åŒºåˆ†Snapshotä»“åº“å’ŒReleaseä»“åº“ã€‚Mavençš„Snapshotä»“åº“æ‹¥æœ‰æ›´çµæ´»çš„ç­–ç•¥ï¼šåŒä¸€ä¸ªç‰ˆæœ¬å·çš„MavenåŒ…å¯ä»¥é‡å¤æ¨é€ï¼Œè€Œå¼•ç”¨è¯¥Snapshotç‰ˆæœ¬çš„åŒ…çš„ä»£ç ï¼Œä¹Ÿä¼šæ ¹æ®Mavenä»“åº“çš„æ¨é€ï¼Œæ‹‰å–æœ€æ–°çš„åŒ…ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„ä¹‹å‰æ‹‰å–å¾—åŒ…ã€‚è¿™ç‚¹ä¸ŠMavenè¦æ›´ä¸ºå¼ºå¤§ã€‚

## \.Netå’ŒC#å‘å±•å²

C#ç‰ˆæœ¬å‘å¸ƒæ—¶é—´ï¼ŒåŠä¸\.Netçš„å¯¹åº”å…³ç³»ï¼Œå¦‚ä¸‹è¡¨ï¼š

| C#ç‰ˆæœ¬ | \.NETç‰ˆæœ¬ | å‘å¸ƒæ—¥æœŸ |
| --- | --- | --- |
| C# 1.0 | \.NET Framework 1.0 | 2002å¹´2æœˆ13æ—¥ |
| C# 1.1 | \.NET Framework 1.1 | 2003å¹´4æœˆ24æ—¥ |
| C# 2.0 | \.NET Framework 2.0 | 2005å¹´11æœˆ7æ—¥ |
| C# 3.0 | \.NET Framework 3.0 | 2007å¹´11æœˆ6æ—¥ |
| | \.NET Framework 3.5 | 2007å¹´11æœˆ19æ—¥ |
| C# 4.0 | \.NET Framework 4.0 | 2010å¹´4æœˆ12æ—¥ |
| C# 5.0 | \.NET Framework 4.5 | 2012å¹´8æœˆ15æ—¥ |
| C# 6.0 | \.NET Framework 4.6 | 2015å¹´7æœˆ20æ—¥ |
| | \.NET Core 1.0 | 2016å¹´6æœˆ27æ—¥ |
| C# 7.0 | \.NET Framework 4.6.2 | 2016å¹´8æœˆ2æ—¥ |
| C# 7.1 | \.NET Framework 4.7 | 2017å¹´4æœˆ5æ—¥ |
| | \.NET Core 2.0 | 2016å¹´8æœˆ14æ—¥ |
| C# 7.2 | \.NET Framework 4.7.1 | 2017å¹´10æœˆ17æ—¥ |
| C# 7.3 | \.NET Framework 4.7.2 | 2018å¹´4æœˆ30æ—¥ |
| | \.NET Core 2.1 | 2018å¹´5æœˆ30æ—¥|
| | \.NET Core 2.2 | 2018å¹´12æœˆ4æ—¥|
| C# 8.0 | \.NET Framework 4.8 | 2019å¹´4æœˆ18æ—¥ |
| | \.NET Core 3.0 | 2019å¹´9æœˆ23æ—¥ |
| | \.NET Core 3.1 | 2019å¹´12æœˆ3æ—¥ |
| C# 9.0 | \.NET 5 | 2020å¹´9æœˆ4æ—¥ |
| C# 10.0 | \.NET 6 | 2021å¹´11æœˆ9æ—¥ |

C#å’Œ\.Netå‘å±•ï¼Œ**å…³é”®èŠ‚ç‚¹**ç®€è¦ä»‹ç»ï¼š

1. **J++**

    - 1995å¹´ï¼Œç”±äºäº’è”ç½‘å…´èµ·ã€‚Sunå…¬å¸æ¨å‡ºçš„Javaå¤§ç«ã€‚å› ä¸ºå…¶è·¨å¹³å°ç‰¹ç‚¹ï¼Œå¾®è½¯æ„Ÿå—åˆ°å±æœºã€‚ä¸ºäº†å°†ç”¨æˆ·ç•™åœ¨Windowsï¼Œå¾®è½¯å¯åŠ¨äº†J++é¡¹ç›®ã€‚å…¶å«ä¹‰ä¸ºJavaå¢å¼ºç‰ˆï¼Œæ—¨åœ¨ä¼˜åŒ–Javaå¼€å‘ä½“éªŒå’Œæ‰§è¡Œæ€§èƒ½ã€‚
    - 1997å¹´ï¼ŒVisual Studio 97å‘å¸ƒï¼Œé¦–æ¬¡åŒ…å«J++ã€‚
    - 1998å¹´ï¼Œå¤§åé¼é¼çš„Visual Studio 6.0å‘å¸ƒï¼ˆå¯¹ï¼Œå°±æ˜¯é‚£ä¸ªæ›¾ç»å¤§å­¦å¿…å­¦çš„VS6ï¼‰ã€‚æ­¤æ—¶çš„J++ï¼Œä¸ä»…æ€§èƒ½æ¯”Sunçš„Javaæ›´é«˜ï¼Œè¿˜æ”¯æŒäº†WindowsAPIã€‚å…¶æ˜“ç”¨æ€§è¿…é€ŸæŠ¢å äº†Javaçš„å¸‚åœºï¼Œæˆä¸ºä¸šå†…å…¬è®¤çš„ä¼˜ç§€Javaç¼–è¯‘å™¨ã€‚å› å…¶åªèƒ½åœ¨Windowsä¸‹ç”¨ï¼Œä¹Ÿå¸®åŠ©å¾®è½¯å äº†æ“ä½œç³»ç»Ÿå¸‚åœºã€‚
    - åŒå¹´ï¼ŒSunå¿æ— å¯å¿ï¼Œå°†å¾®è½¯å‘Šä¸Šæ³•åº­ã€‚
    - å®˜å¸ä¸€ç›´æ‰“åˆ°2001å¹´ã€‚æ³•é™¢æœ€ç»ˆåˆ¤å®šå¾®è½¯æœªèƒ½éµå¾ªJavaè§„èŒƒï¼ŒSunå…¬å¸èƒœè¯‰ã€‚åŒå¹´ï¼ŒSunå’Œå¾®è½¯è¾¾æˆå’Œè§£ï¼šå¾®è½¯åœæ­¢J++é¡¹ç›®ï¼ŒSunä¸å†è¿½ç©¶ç»æµæŸå¤±ã€‚

2. **\.NetFramework 1.0**

    - å¾®è½¯ä¹‹æ‰€ä»¥ç”˜å¿ƒæ”¾å¼ƒJ++é¡¹ç›®ï¼Œä¹Ÿæ˜¯å› å…¶æ—©å°±å¯åŠ¨äº†æ–°çš„é¡¹ç›®ï¼Œç”¨äºæ›¿ä»£Javaã€‚è¿™ä¾¿æ˜¯\.Netã€‚åŒæ—¶ï¼Œå‚è€ƒäº†Javaå’ŒC++çš„è¯­æ³•ï¼Œè®¾è®¡äº†å…¨æ–°çš„è¯­è¨€ï¼šC#ã€‚
    - 2002å¹´ï¼Œ\.NetFramework1.0è·ŸéšVisual Studio \.NET 2002ä¸€åŒå‘å¸ƒã€‚æ­¤æ—¶çš„\.Netæ”¯æŒä¸¤ç§è¯­è¨€:C#å’ŒVB\.Netã€‚æ”¯æŒVB\.Netä¹Ÿæ˜¯ä¸ºäº†è®©æ—¢æœ‰çš„VBå¼€å‘äººå‘˜å¯ä»¥å¿«é€Ÿä¸Šæ‰‹ã€‚ä»æ­¤ï¼Œ\.Netæ—¶ä»£æ­£å¼å¼€å¯äº†ã€‚
    - æœ‰ä¸ªç©ç¬‘è¯´ï¼šC#çš„å«ä¹‰ï¼Œæœ‰å¯èƒ½æ˜¯C++++ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼ŒJavaå’ŒC#éƒ½æ˜¯C++è¯­æ³•ç³»ç»Ÿçš„ã€‚æ‰€ä»¥ï¼Œè¿™ç§è¯´æ³•æœ‰å¯èƒ½æ˜¯çœŸçš„ã€‚ğŸ˜Š

3. **C#3.0** å’Œ **\.NetFramework3.5**

    - C#3.0ä¹‹æ‰€ä»¥ç‰¹æ®Šï¼Œæ˜¯å› ä¸º3.0ä¹‹å‰C#ä¸»è¦æ˜¯æ¨¡ä»¿Javaã€‚è€Œ3.0å¼€å§‹ï¼ŒC#æ­£å¼ä¸è€å¸ˆåˆ†é“æ‰¬é•³ï¼Œå¼€å§‹æ”¾é£è‡ªæˆ‘äº†ã€‚
    - 2007å¹´C#3.0è·ŸéšVisual Sudio 2008ä¸€åŒå‘å¸ƒã€‚è¿™ä¸ªç‰ˆæœ¬å¸¦æ¥äº†è¯¸å¤šé‡å¤§æ›´æ–°ã€‚å®ƒå¼•å…¥äº†Lambdaè¡¨è¾¾å¼ã€è¡¨è¾¾å¼æ ‘ã€æ‰©å±•æ–¹æ³•ã€éšå¼ç±»å‹å˜é‡ã€åˆå§‹åŒ–å™¨ï¼ˆInitializerï¼‰ç­‰ç­‰é‡è¦æœºåˆ¶ã€‚åŒæ—¶è¿˜å¼•å…¥äº†LINQè¿™ä¸ªé‡ç£…ç‚¸å¼¹ â€”â€” å®ƒè¢«è§†ä½œCShaperçš„å¿«ä¹ä¹‹æºã€‚
    - åˆ°\.NetFramework3.5å‘å¸ƒï¼Œ\.Netçš„ç¬¬ä¸€ä¸ªé«˜åº¦æˆç†Ÿçš„ç‰ˆæœ¬å½¢æˆäº†ã€‚\.Net3.5å¸®åŠ©å¾®è½¯å æ®äº†å¤§é‡å¸‚åœºã€‚

4. **C#5.0**

    - 2010å¹´\.NetFramework4.0ï¼ˆå¯¹åº”C#4.0ï¼‰æ­£å¼å‘å¸ƒã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ\.NetFramework3.5å’Œä¹‹å‰çš„ç‰ˆæœ¬ä¸€ç›´åšäº†å‘ä¸‹å…¼å®¹ã€‚3.5å…¼å®¹ä»2.0åˆ°3.5çš„æ‰€æœ‰ç‰ˆæœ¬ã€‚ä½†æ˜¯åˆ°äº†\.NetFramework4ï¼Œè¿™ç§å…¼å®¹è¢«æ‰“ç ´äº†ã€‚åœ¨è¿™ä¹‹åï¼Œ3.xå’Œ4.xæˆä¸ºä¸¤ä¸ªäº’ä¸å…¼å®¹ã€ç›¸äº’ç‹¬ç«‹çš„CLRç‰ˆæœ¬ã€‚å› è€Œï¼Œæ­¤åå¾ˆé•¿ä¸€æ®µæ—¶é—´å†…ï¼Œä½ çš„æœºå™¨ä¸Šå¯èƒ½è¦è£…åŒæ—¶è£…3.xå’Œ4.xä¸¤ä¸ªç‰ˆæœ¬çš„\.NetFrameworkï¼Œæ‰èƒ½åº”å¯¹å„ç§\.Netåº”ç”¨ã€‚
    - åˆ°äº†C#5.0å‘å¸ƒæ—¶ï¼Œæ­£å¼äº†å¼•å…¥å¼‚æ­¥ç¼–ç¨‹ã€‚è¿™åˆæ˜¯ä¸€é¡¹è·¨æ—¶ä»£çš„æŠ€æœ¯ã€‚å¯¹jsåæ¥çš„å‘å±•ä¹Ÿäº§ç”Ÿäº†æ·±è¿œçš„å½±å“ã€‚è€ŒC#5.0å¯¹åº”çš„\.NetFramework4.5ï¼Œä¹Ÿæˆä¸ºäº†ç»§3.5ä¹‹åç¬¬äºŒä¸ªé«˜åº¦æˆç†Ÿç‰ˆæœ¬ã€‚

5. **\.Net Standard**

    - ç”±äºLinuxåœ¨æœåŠ¡é¢†åŸŸçš„ä¸€éª‘ç»å°˜ï¼Œ\.Netä¸èƒ½è·¨å¹³å°çš„å¼Šç«¯é€æ¸æ˜¾ç°å‡ºæ¥ã€‚ç»ˆäºï¼Œæœ‰äººçœ‹ä¸æƒ¯\.Netçš„ä¸è·¨å¹³å°äº†ã€‚Monoé¡¹ç›®ä¸ä¾èµ–\.NetFrameworkçš„æºç ï¼ˆä¹Ÿæ²¡æ³•ä¾èµ–ï¼Œ\.NetFrameworkå¹¶ä¸å¼€æºï¼‰ï¼Œé‡æ–°å®ç°äº†\.Net CLRï¼Œå³è·¨å¹³å°çš„Mono\.Netã€‚å†åˆ°åæ¥çš„Unity3Dã€Xamarinï¼Œ\.Netçš„ç¬¬ä¸‰æ–¹å®ç°å¼€å§‹å é¢†å¸‚åœºã€‚
    - åŒæ—¶ï¼Œå¾®è½¯è‡ªå®¶ä¹Ÿåœ¨é¢ä¸´å¤šç‰ˆæœ¬é—®é¢˜ï¼Œé¦–å…ˆæœ‰äº’ä¸å…¼å®¹çš„3.5å’Œ4.5ï¼›å…¶æ¬¡ï¼Œä»–ä»¬è¿˜ä¸ºä¸åŒçš„ç³»ç»Ÿå®šåˆ¶äº†ä¸åŒçš„\.Netã€‚æ¯”å¦‚ï¼Œä»–ä»¬ä¸ºç§»åŠ¨è®¾å¤‡å’ŒXBOXå®šåˆ¶äº†é˜‰å‰²ç‰ˆ\.Net Portableã€‚
    - ç»è¿‡äº†æ¼«é•¿çš„å°é—­ã€æœåŠ¡å™¨é¢†åŸŸå¸‚åœºçš„ä¸æ–­è¡°é€€å’ŒWindows Phoneçš„æƒ¨è´¥ä¹‹åã€‚2014å¹´ï¼Œå¾®è½¯ç»ˆäºè¿æ¥äº†ä¸€ä½é è°±çš„CEOã€‚ä»–æ„è¯†åˆ°äº†å¼€æ”¾çš„é‡è¦æ€§ï¼Œå¼€å§‹ç§¯ææ‹¥æŠ±å¼€æºå’Œè·¨å¹³å°ã€‚å¾®è½¯å¼€å§‹ç§¯æç­¹å¤‡è‡ªå®¶çš„è·¨å¹³å°\.Netã€‚å½“æ—¶è¿˜ä»…ä»…è€ƒè™‘ç½‘ç«™å¼€å‘ï¼Œè®¡åˆ’å‘½åä¸ºAsp\.Net MVC 6ã€‚åæ¥éšç€é¡¹ç›®çš„è¿›è¡Œï¼Œå¾®è½¯æ”¹å˜ç­–ç•¥ï¼Œå†³å¿ƒåšæˆä¸€ä¸ªå…¨é¢ã€é€šç”¨çš„ã€è·¨å¹³å°çš„\.Netï¼Œå¹¶å–å‘½\.Net Coreã€‚
        - æåˆ°è¿™ä½CEOï¼Œä¸å¾—ä¸åæ§½ä¸¤å¥ã€‚ç”±äºä»–æ˜¯ä¸ªå°åº¦è£”ï¼ˆç¡…è°·å·²ç»è¢«å°åº¦CEOè£”å é¢†äº†ï¼‰ï¼Œå¯¼è‡´ä»–ä¸Šä»»åå¾®è½¯å°åº¦è£”çš„å¼€å‘äººå‘˜æ•°é‡å¤§å¹…ä¸Šå‡ã€‚å› è€Œï¼Œæˆ‘ä»¬ç°åœ¨ç»å¸¸èƒ½åœ¨å¾®è½¯ç³»çš„è½¯ä»¶ä¸­ï¼Œæ„Ÿå—åˆ°å„å¼å„æ ·æ»¡æ»¡å’–å–±é£å‘³çš„BUGã€‚
    - \.Net CLRçš„æ··ä¹±å±€é¢ç”±æ­¤ä¾¿å½¢æˆäº†ã€‚å„å¼å„æ ·çš„CLRï¼Œäº’ä¸å…¼å®¹ã€‚å¦‚æœæƒ³è¦é‡ç”¨ä½ çš„ä»£ç ï¼Œåªèƒ½é’ˆå¯¹ç›®æ ‡ç‰ˆæœ¬é‡æ–°ç¼–è¯‘ã€‚è€Œä¸”ï¼Œè¿˜éœ€è¦è€ƒè™‘å„ç‰ˆæœ¬çš„æ¡†æ¶ç»“æ„å’Œç±»åº“ã€è¯­æ³•æ”¯æŒåº¦é—®é¢˜ï¼Œéš¾å…è¦é’ˆå¯¹ä¸åŒCLRç‰ˆæœ¬åšå‡ºä¸åŒç¨‹åº¦çš„ä»£ç ä¿®æ”¹ã€‚åœ¨å½“æ—¶ï¼Œç»™äººå°è±¡æ·±åˆ»çš„ä¸€ç‚¹æ˜¯ï¼šä½ ä¸‹è½½çš„NugetåŒ…é‡Œçš„libç›®å½•ä¸‹ï¼Œä¼šæœ‰è®¸å¤šå¹¶åˆ—çš„å­ç›®å½•ï¼ŒåŒ…æ‹¬net30ã€net35ã€net45ã€net46ã€net461ã€netcoreapp2.2ç­‰ç­‰ç­‰ç­‰ã€‚æ¯ä¸ªç›®å½•å‡ç”±ç›¸ä¼¼çš„æ–‡ä»¶æ„æˆï¼šéƒ½åŒ…å«ç±»åº“çš„dllå’Œxmlç­‰æ–‡ä»¶ã€‚ä¸åŒçš„æ˜¯æ¯ä¸ªdllæ˜¯é¢å‘ä¸åŒçš„ç›®æ ‡CLRç¼–è¯‘çš„ã€‚è€Œä½ è‡ªå·±å†™çš„ç±»åº“ï¼Œå¾ˆå¤šæ—¶å€™ä¹Ÿä¸å¾—ä¸ç¼–è¯‘æˆå„ç§ä¸åŒçš„ç›®æ ‡æ¡†æ¶ç‰ˆæœ¬ï¼Œä»¥é€‚åº”ä¸åŒç›®æ ‡ç‰ˆæœ¬CLRçš„ç¨‹åºã€‚
    - å› æ­¤ï¼Œå¾®è½¯æå‡ºäº†\.Net Standardã€‚è¿™æ˜¯ä¸€å¥—æ ‡å‡†ï¼Œè€ŒéCLRçš„å®ç°ã€‚å…¶ç›®çš„æ˜¯å°†ä¸€ä¼—\.Netæ¡†æ¶ç»Ÿä¸€èµ·æ¥ï¼Œæé«˜ä»–ä»¬çš„ä¸€è‡´æ€§ï¼Œä»è€Œå¯ä»¥å…±äº«ä»£ç ã€‚\.Net Standardå…¶å®æ˜¯ä¸€å¥—APIè§„èŒƒï¼Œç›®æ ‡ä»£ç çš„è¿è¡Œéœ€è¦ç”±å„ä¸ª\.Net CLRæ¥å…·ä½“å®ç°ã€‚å› è€Œï¼Œ\.Net Standardåªèƒ½ç”¨æ¥ç¼–å†™é€šç”¨ç±»åº“ï¼Œè€Œä¸èƒ½ç¼–å†™æœ‰å…¥å£çš„å®Œæ•´ç¨‹åºã€‚ä½¿ç”¨\.Net Standardç¼–è¯‘çš„ç±»åº“ï¼Œå¯ä»¥è·‘åœ¨æ”¯æŒ\.Net Standardçš„ä»»æ„\.Netå®ç°ä¸Šï¼Œåªè¦CLRæ”¯æŒçš„\.Net Standardç‰ˆæœ¬ä¸ä½äºä½ çš„åº“çš„ç›®æ ‡\.Net Standardç‰ˆæœ¬ã€‚ä»è€Œå®ç°äº†Mono\.Netï¼Œ\.NetFrameworkï¼Œ\.Net Coreç­‰ä¸åŒç‰ˆæœ¬çš„\.Netä¹‹é—´å¯ä»¥å…±äº«ä»£ç ã€‚æœ‰è¶£çš„æ˜¯ï¼Œ\.Net Standardç”Ÿæˆçš„dllæ‰“åŒ…è¿›Nugetï¼Œä¹Ÿè¦æ”¾åˆ°libç›®å½•ä¸‹çš„netstandardx.xçš„å­ç›®å½•é‡Œã€‚é’ˆå¯¹å¤šç§ç›®æ ‡CLRå’Œé’ˆå¯¹Standardçš„dllè¿˜æ˜¯å¯ä»¥å¹¶å­˜ã€‚
    - \.Net Standardæ˜¯å¾®è½¯çš„æ— å¥ˆä¹‹ä¸¾ã€‚è¿™ä¸ªå°´å°¬çš„å¢ƒåœ°ï¼Œåˆ°\.Net5åè¢«ä½¿ç”¨æ–°çš„æ–¹å¼å½»åº•ç ´è§£ã€‚

6. **\.Net Core**
    - 2016å¹´ï¼Œ\.Netçš„å®˜æ–¹è·¨å¹³å°ç‰ˆæœ¬ç»ˆäºæ¥äº†ã€‚\.Net Core 1.0æ­£å¼å‘å¸ƒã€‚å®ƒä¸ä»…è·¨å¹³å°ï¼Œè¿˜æ˜¯å¼€æºçš„ã€‚æœ€æ—©å¼€æºäºå¾®è½¯è‡ªå®¶çš„å¼€æ”¾ä»£ç å¹³å°CodePlexï¼Œåæ¥è¿ç§»è‡³å¾®è½¯è‡ªå®¶çš„å¼€æ”¾ä»£ç å¹³å°GitHubğŸ™‚ã€‚\.Net Coreçš„å‘å¸ƒæ ‡å¿—ç€å¾®è½¯ç»ˆäºç»“æŸäº†å°é—­ï¼Œå½»åº•èµ°å‘äº†å¼€æ”¾ã€‚
    - \.Net Coreçš„ç‰ˆæœ¬å‡çº§ç­–ç•¥ä¹Ÿå‘ç”Ÿäº†è½¬å˜ã€‚è·Ÿè¯¸å¤šå¸¸è§å¼€æºé¡¹ç›®ä¸€æ ·ï¼Œè™½ç„¶å®ƒä»ç„¶ä¼šå°½é‡åšåˆ°å‘ä¸‹å…¼å®¹ï¼Œä½†æ˜¯è¿™å·²ç»ä¸å†é‚£ä¹ˆé‡è¦äº†ã€‚æ¯å½“æ–°çš„å¤§ç‰ˆæœ¬å‘å¸ƒï¼Œå¯èƒ½éƒ½ä¼šä»åº”ç”¨ç¨‹åºæ¡†æ¶ç»“æ„ä¸Šåšå‡ºäº›è°ƒæ•´ã€‚å› æ­¤ï¼Œä¸ºäº†å‡çº§åˆ°æ–°ç‰ˆæœ¬ï¼Œå¼€å‘è€…å¯èƒ½éœ€è¦å°‘é‡ä¿®æ”¹ä»£ç ï¼Œè€Œä¸åƒä¹‹å‰\.NetFrameworkæ—¶ä»£é‚£æ ·ä»…ä»…éœ€è¦æ”¹ä¸€ä¸‹ç‰ˆæœ¬å·ã€‚ä¸è¿‡å¯¹äºå…·ä½“çš„å‡çº§æ”¹åŠ¨ï¼Œå®˜æ–¹ä¹Ÿä¼šåœ¨æ–‡æ¡£ä¸­ç»™å‡ºæŒ‡å—ã€‚
    - éšç€æ¡†æ¶ä¸æ–­å®Œå–„ï¼Œ2019å¹´åº•ï¼Œ\.Net Core 3.1å‘å¸ƒã€‚\.Net Coreè¿æ¥äº†ç¬¬ä¸€ä¸ªLTSï¼ˆLong Term Supportï¼Œé•¿æœŸæ”¯æŒï¼‰ç‰ˆæœ¬ã€‚
    - \.Netçš„åç»­å‘å¸ƒè®¡åˆ’ä¹Ÿåœ¨æ­¤åˆ»ç¡®å®šäº†ã€‚\.Net Core 3.1çš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¸ä¼šæ˜¯\.Net Core 4.0ï¼Œè€Œæ˜¯å†³å®šåç»­å°†\.NetFrameworkå’Œ\.NetCoreåˆå¹¶ï¼Œä¸å†åŒºåˆ†å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶ç»Ÿä¸€å‘½åä¸º\.Netã€‚

7. **\.Net**
    - \.Netçš„å‘å¸ƒæ—¶é—´è¡¨ï¼ˆTime Scheduleï¼‰ç¡®å®šä¸ºï¼šä»2020å¹´å¼€å§‹ï¼Œæ¯å¹´çš„å¹´æœ«ä¼šå‘å¸ƒä¸€ä¸ªå¤§ç‰ˆæœ¬çš„\.Netã€‚å¹¶ä¸”ï¼Œå¶æ•°åºå·\.Netå°†è·å¾—LTSã€‚
    - å› ä¸ºåˆå¹¶ï¼Œä»¥åä¸ä¼šå†æœ‰\.Net Frameworkå’Œ\.Net Coreä¹‹åˆ†ï¼Œæ‰€ä»¥æ–°çš„\.Net CLRæ›´åä¸º\.Netã€‚åˆå¹¶åçš„ç¬¬ä¸€ä¸ª\.Netï¼Œå®é™…ä¸Šå°±æ˜¯\.Net Core 4.0ã€‚ä½†ä¸ºäº†é¿å…è·Ÿ\.NetFramework 4æ··æ·†ï¼Œè·³è¿‡äº†4.0çš„å‘½åï¼Œç›´æ¥ä½¿ç”¨äº†\.Net5ã€‚
    - \.Net6æ˜¯\.Netåˆå¹¶æˆå•ä¸€æ¡†æ¶åçš„ç¬¬ä¸€ä¸ªLTSç‰ˆæœ¬ã€‚ä¹Ÿæ˜¯åˆšåˆšå‘å¸ƒæ²¡å¤šä¹…çš„ç‰ˆæœ¬ã€‚å®ƒä¸Visual Studio 2022ä¸€åŒå‘å¸ƒã€‚

æ›¾ç»å› ä¸ºå°é—­ï¼Œå¾®è½¯å°åˆ°äº†ç”œå¤´ï¼Œå°é—­çš„å¼€å‘ã€è¿è¡Œç¯å¢ƒå’Œå°é—­çš„æ“ä½œç³»ç»Ÿäº’ç›¸ä¿ƒè¿›ï¼Œå¥ å®šäº†å¾®è½¯çš„å¸‚åœºéœ¸æƒã€‚

ä½†æ˜¯ï¼ŒåŒæ ·ä¹Ÿæ˜¯å› ä¸ºå°é—­ï¼Œåœ¨å¼€æºç¤¾åŒºå¤§è¡Œå…¶é“çš„201xå¹´ä»£ï¼ŒLinuxé€æ¸å–ä»£Windowsæˆä¸ºæœåŠ¡å™¨é¦–é€‰ç³»ç»Ÿã€‚\.Netå› ä¸ºä¸å…·å¤‡è·¨å¹³å°çš„èƒ½åŠ›ï¼Œä¹Ÿé”™å¤±å…ˆæœºï¼Œè¢«JavaæŠ¢å äº†å¤§é‡å¸‚åœºä»½é¢ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œå¾—ç›Šäºå¤§é‡ä¼˜ç§€çš„å¼€å‘è€…çš„å‚ä¸è´¡çŒ®ã€å¤§é‡ä¼˜è´¨å¼€æºé¡¹ç›®çš„æ”¯æ’‘ï¼Œå¦‚ä»ŠJavaç”Ÿæ€è¦å¥½äº\.Netã€‚è¿™åœ¨å›½å†…æ›´ç”šï¼Œäº’è”ç½‘å¤§å‚ä¸­Javaå æœ‰ç»å¯¹ç»Ÿæ²»åœ°ä½ã€‚

è™½ç„¶\.Netçš„å¼€æ”¾æ¥çš„è¿Ÿäº†äº›ï¼Œä½†æ˜¯æ™šåˆ°çš„æ€»èƒœè¿‡æ²¡æœ‰ã€‚éšç€ä¼˜è´¨çš„å¼€æºé¡¹ç›®çš„ä¸æ–­åŠ å…¥ï¼Œç›¸ä¿¡\.Netè¿˜æ˜¯æœªæ¥å¯æœŸçš„ã€‚å°¤å…¶æ˜¯åœ¨LoTç›¸å…³é¢†åŸŸï¼Œåœ¨å½“å‰è¿˜æ²¡æœ‰å“ªä¸ªè¯­è¨€åç¨³å„æ–­åœ°ä½ã€å±€åŠ¿è¿˜ä¸æ˜æœ—çš„æƒ…å†µä¸‹ï¼Œå®ƒä¾ç„¶è¿˜æœ‰æœºä¼šã€‚

\.Netæ­£å¼åˆå¹¶åï¼Œä¹‹å‰çš„è¿™äº›ç†Ÿæ‚‰çš„åç§°ï¼Œå°†æˆä¸ºè¿‡å»æ—¶ã€‚è®©æˆ‘ä»¬è®°ä½å®ƒä»¬æœ€åå®šæ ¼çš„ç‰ˆæœ¬ï¼š

- \.Net Standard å®šæ ¼åœ¨ 2.1
- \.Net Framework å®šæ ¼åœ¨ 4.8
- \.Net Core å®šæ ¼åœ¨ 3.1ã€‚

\.Net åŠ æ²¹ã€‚

æœ€åå¤šçµ®å¨ä¸¤å¥ã€‚å°é—­çš„åå¤„æ˜¾è€Œæ˜“è§ã€‚å¾®è½¯å°å°½äº†å°é—­çš„è‹¦æœã€‚åè§‚å¦‚ä»Šçš„æ°´æœï¼Œæ€»è§‰å¾—ä¼¼æ›¾ç›¸è¯†ã€‚è¯šç„¶ï¼Œæ°´æœåœ¨å¾ˆå¤šæ–¹é¢æ¯”å¾®è½¯é«˜æ˜å¾—å¤šï¼Œè€Œå®ƒçš„ç”¨æˆ·çš„ç²˜æ€§ä¹Ÿè¦å¼ºçš„å¤šã€‚ä½†æ˜¯ï¼Œè¿‘å¹´æ¥ä¸€æ¬¡åˆä¸€æ¬¡éœ¸é“ä¸“æ¨ªçš„éªšæ“ä½œï¼Œç»™æ¶ˆè´¹è€…å¸¦æ¥çš„å†²å‡»ï¼Œè¿˜æ˜¯åœ¨ä¸æ–­æ¶ˆè€—å®ƒçš„ç”Ÿå‘½åŠ›ã€‚å†å²æ€»æ˜¯æƒŠäººå¾—ç›¸ä¼¼ï¼Œæˆ‘ä»¬éƒ½ä¸å¸Œæœ›çœ‹åˆ°å¾®è½¯å¼æ‚²å‰§åœ¨æ°´æœä¸Šå†æ¬¡é‡æ¼”ï¼Œå¸Œæœ›æ°´æœèƒ½æ—©æ—¥æ”¶èµ·æˆ¾æ°”ã€æ‹¥æŠ±å¼€æ”¾ï¼ŒçœŸæ­£å°Šé‡æ¶ˆè´¹è€…ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ¬¡è®©æ¶ˆè´¹è€…æ— è¯­ã€‚

## æœ¬æ–‡çš„é‡ç‚¹æ˜¯è¯­æ³•ï¼Œè€Œéç±»åº“

è¿›å…¥ä»£ç ä¹‹å‰ï¼Œè¿˜æœ‰äº›è¯æƒ³è¯´ï¼š

æœ¬æ–‡çš„ä¸»é¢˜æ˜¯C#**è¯­è¨€**ï¼Œè€Œé\.Netçš„**ç±»åº“**ã€‚å› è€Œå¤§éƒ¨åˆ†ç¯‡å¹…åªå…³æ³¨äºè¯­æ³•çº§åˆ«çš„æ¼”è¿›ã€‚

- è­¬å¦‚ï¼šTaskç±»åœ¨\.NetFramework 4.0ï¼ˆå¯¹åº”C#4.0ï¼‰å·²ç»å¼•å…¥ã€‚ä½†æ˜¯æ­¤æ—¶è¿˜ä¸æ”¯æŒasync/awaitå…³é”®è¯ã€‚å› æ­¤ï¼Œæ­¤æ—¶çš„Taskç±»ä»…ä»…æ˜¯\.Netç±»åº“çš„æ›´æ–°è€Œå·²ï¼Œå¹¶æœªå¼•èµ·C#è¯­æ³•çš„å˜åŠ¨ã€‚è€Œåˆ°äº†C#5æ¨å‡ºï¼ˆ\.NetFramework4.5ï¼‰ï¼Œå¼•å…¥äº†async/awaitï¼Œæ‰ä½“ç°åœ¨C#è¯­æ³•ä¸Šã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨C#4.0çš„ç« èŠ‚ä»‹ç»Taskç±»ï¼Œè€Œä¼šåœ¨C#5.0ä»‹ç»å¼‚æ­¥ç¼–ç¨‹ã€‚

- å†æ¯”å¦‚ï¼šå…ƒç»„çš„æ¦‚å¿µä¹Ÿæ˜¯\.NetFramwork 4.0ï¼ˆå¯¹åº”C#4.0ï¼‰å°±æœ‰äº†ã€‚ä½†æ˜¯ï¼Œå®ƒåœ¨å½“æ—¶è¡¨ç°ä¸ºTupleç±»ï¼Œå¹¶ä¸æ”¯æŒç‹¬ç‰¹çš„åœ†æ‹¬å·è¯­æ³•ï¼Œä¹Ÿæ²¡æœ‰æ”¯æŒè§£æ„ã€‚ç›´åˆ°C#7.0å¼•å…¥ValueTupleæ—¶ï¼Œæ‰åœ¨äº§ç”Ÿäº†C#çš„æ–°è¯­æ³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¼šåœ¨C#4.0æ—¶çš„ç« èŠ‚ä»‹ç»å¼•ç”¨ç±»å‹çš„å…ƒç»„ç±»ï¼Œè€Œä¼šåœ¨C#7.0çš„ç« èŠ‚ä»‹ç»å€¼ç±»å‹çš„å…ƒç»„çš„è¯­æ³•ã€‚

- å¯¹äºç‰¹åˆ«é‡è¦çš„ç±»åº“ï¼Œæœ¬æ–‡ä¹Ÿä¼šç”¨é€‚å½“ç¯‡å¹…æ¥ä»‹ç»ã€‚æ¯”å¦‚ï¼šLINQï¼ˆC#3.0ï¼‰çš„å®ç°æ—¢æœ‰è¯­æ³•å±‚é¢çš„ï¼ˆæŸ¥è¯¢è¡¨è¾¾å¼ï¼‰ï¼Œä¹Ÿæœ‰ç±»åº“å±‚é¢çš„ï¼ˆæŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼‰ã€‚å› ä¸ºæŸ¥è¯¢è¡¨è¾¾å¼æœ¬è´¨ä¸Šä¾èµ–æŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼Œåˆå› ä¸ºè¿™äº›æ‰©å±•æ–¹æ³•åŒæ—¶ä½¿ç”¨äº†C#3.0çš„æ‰©å±•æ–¹æ³•ã€è¡¨è¾¾å¼æ ‘ä¸¤ç§è¯­æ³•ï¼ŒåŠ ä¹‹å…¶åœ¨æ—¥å¸¸å¼€å‘ä¸­çš„æé«˜ä½¿ç”¨é¢‘ç‡ï¼Œä¹Ÿä¼šç€é‡åšå‡ºä»‹ç»ã€‚

# Hello World

ä¸‹é¢çš„ç¨‹åºå±•ç¤ºäº†ä¸€ä¸ªC#ç¨‹åºå¤§ä½“é•¿ä»€ä¹ˆæ ·ï¼š

```c#
//Program.csæ–‡ä»¶ï¼š
using System;  //å¼•ç”¨å‘½åç©ºé—´ï¼Œç›¸å½“äºJavaçš„import
namespace Sample //å®šä¹‰å‘½åç©ºé—´ï¼Œç›¸å½“äºJavaçš„å®šä¹‰package
{
    class Program //å®šä¹‰ç±»
    {
        static void Main(string[] args) //å®šä¹‰æ–¹æ³•ã€‚Mainæ–¹æ³•æ˜¯ç¨‹åºçš„å…¥å£ç‚¹
        {
            Console.WriteLine("Hello World.");  //æ‰“å°Hello World.åˆ°å±å¹•
        }
    }
}
```

- é¦–å…ˆï¼ŒC#æ˜¯å®Œå…¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä¸å­˜åœ¨æ’é™¤åœ¨ä»»ä½•ç±»ä¹‹å¤–çš„è£¸éœ²è¯­å¥ã€‚ç¨‹åºå…¥å£ç‚¹ä¹Ÿå®šä¹‰åœ¨ç±»é‡Œã€‚ï¼ˆC#10.0ä¹‹å‰ï¼‰
- ä¸€èˆ¬è€Œè¨€ï¼Œä¸€ä¸ªç¨‹åºéœ€è¦æœ‰ä¸€ä¸ªç¨‹åºå…¥å£ç‚¹ï¼Œæ‰èƒ½æ‰§è¡Œã€‚ç¨‹åºå…¥å£ç‚¹ä¸€èˆ¬ä¸ºProgram.csé‡Œçš„Mainçš„æ–¹æ³•ã€‚

## å‘½åç©ºé—´ï¼ˆNamespaceï¼‰

C#é‡‡ç”¨å‘½åç©ºé—´æ¥ç»„ç»‡ç±»ï¼Œç±»ä¼¼äºJavaçš„åŒ…ï¼Œä½†æ¯”Javaçš„åŒ…æ›´çµæ´»ã€‚

> **ä¸Javaçš„packageçš„ä¸»è¦å¯¹æ¯”**ï¼š
>
> - namespaceä¸å¿…è·Ÿç›®å½•å¯¹åº”ï¼Œå¯ä»¥éšæ„æŒ‡å®šã€‚åªè¦ä½ æ„¿æ„ï¼Œä½ çš„ç±»å¯ä»¥å…¨éƒ¨æ”¾åœ¨Systemç©ºé—´ä¸‹ã€‚è€ŒJavaçš„åŒ…åå¿…é¡»è·Ÿç›®å½•å¯¹åº”ã€‚
> - namespaceæ˜¯å—ç»“æ„ï¼Œç”±èŠ±æ‹¬å·åŒ…è£¹ï¼ˆC#10.0ä¹‹å‰ï¼‰ã€‚å®ƒåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ä»»æ„ä½ç½®å¯ä»¥å‡ºç°å¤šæ¬¡ï¼Œå³ä¸€ä¸ªæ–‡ä»¶å¯ä»¥åŒ…å«å¤šä¸ªå‘½åç©ºé—´ã€‚è€ŒJavaçš„å•ä¸ªæ–‡ä»¶å¿…é¡»å¯¹åº”å•ä¸ªåŒ…åï¼Œä¸”åŒ…å£°æ˜å¿…é¡»æ”¾åœ¨ç¬¬ä¸€å¥ã€‚
> - ä¹ æƒ¯ä¸åŒï¼Œnamespaceä¸€èˆ¬æ¯ä¸€æ®µéƒ½æ˜¯å¤§å†™å­—æ¯å¼€å¤´ï¼Œå¹¶ä¸”æ²¡æœ‰ä»¥comå¼€å¤´çš„ä¹ æƒ¯ã€‚Javaçš„åŒ…åä¸€èˆ¬å…¨éƒ¨ç”¨å°å†™ï¼Œä¸”å¤§å¤šæ•°å…¬å¸çš„ä¹ æƒ¯ä¸ºä»¥com.å¼€å¤´ï¼ˆçœ‹å„å…¬å¸è¦æ±‚ï¼‰ã€‚

## usingè¯­å¥

usingè¯­å¥ï¼Œä¸»è¦ç”¨æ³•ï¼š

- ç›´æ¥å¼•ç”¨

    ```c#
    using System.IO;
    ```

- åˆ«å

    ```c#
    using io = System.IO; //ç»™å‘½åç©ºé—´æŒ‡å®šåˆ«å

    //ä½¿ç”¨ï¼š
    io.FileStream fs;  //ä½¿ç”¨åˆ«å
    ```

- é™æ€å¼•ç”¨ï¼ˆC#6.0å¼•å…¥ï¼‰

    ```c#
    using static System.IO.File; //æ³¨æ„ï¼šé™æ€å¼•ç”¨åªèƒ½å¼•ç”¨ç±»ï¼Œè€Œéå‘½åç©ºé—´ã€‚

    //ä½¿ç”¨ï¼š
    FileStream fs = Open("test.txt", FileMode.Open);  //ç›´æ¥ä½¿ç”¨Fileç±»çš„é™æ€æ–¹æ³•Openï¼Œæ›¿ä»£File.Open
    ```

- é‡Šæ”¾æ¨¡å¼
    usingè¿˜æœ‰ä¸€ä¸ªè·Ÿå‘½åç©ºé—´æ— å…³çš„ç”¨æ³•ã€‚ç”¨äºè‡ªåŠ¨é‡Šæ”¾å¯é‡Šæ”¾èµ„æºã€‚è¯·å‚é˜…[usingè‡ªåŠ¨é‡Šæ”¾è¯­å¥](#usingè‡ªåŠ¨é‡Šæ”¾è¯­å¥)

> ä¸Javaçš„importè¯­å¥å¯¹æ¯”
>
> - C#çš„usingçš„ç›®æ ‡æ˜¯å‘½åç©ºé—´ï¼Œä¸èƒ½æ˜¯å…·ä½“ç±»å‹ï¼ˆé™æ€å¼•ç”¨é™¤å¤–ï¼‰ã€‚ç›´æ¥å¼•ç”¨ç±»å‹ä¼šæŠ¥é”™ã€‚
> - Java importçš„ç›®æ ‡æ˜¯ç±»å‹ã€‚ç›´æ¥importåŒ…ä¼šæŠ¥é”™ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡`åŒ…å.*`æ¥ä¸€æ¬¡æ€§å¼•å…¥åŒ…ä¸‹æ‰€æœ‰ç±»å‹ã€‚
> - C#çš„`using xxxx;`ï¼Œå®é™…ç­‰äºJavaçš„`import xxxx.*;`ã€‚

å¯ä»¥é€šè¿‡æ˜¾å¼æŒ‡å®šå‘½åç©ºé—´è·¯å¾„ï¼Œæ¥ä½¿ç”¨å‘½åç©ºé—´ä¸‹çš„ç±»ï¼Œå³ä»£ç ä¸­ç›´æ¥ä½¿ç”¨`å‘½åç©ºé—´.ç±»å`ã€‚æ˜¾å¼å¼•ç”¨æ—¶ï¼Œå¯ä»¥ä¸ç”¨usingã€‚

```c#
System.IO.FileStream fs;
```

---

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¿›å…¥æœ¬æ–‡çš„ä¸»é¢˜ã€‚æŒ‰ç…§C#ç‰ˆæœ¬æ—¶é—´çº¿ï¼Œä¸€æ­¥æ­¥ä»‹ç»C#çš„è¯­æ³•æ¼”åŒ–ã€‚

# C# 1.0 â€”â€” Javaçš„æ›¿ä»£å“

C# 1.0ï¼Œæ·±åº¦å‚è€ƒäº†Javaï¼Œå¹¶æ›´å¤šçš„ä¿ç•™äº†C++ä¸­è¢«Javaå‰”é™¤çš„ç‰¹æ€§ã€‚åŒæ—¶ï¼Œé’ˆå¯¹Javaåšå‡ºäº†ä¸€äº›æ”¹è¿›ã€‚å› æ­¤ï¼ŒC#è¯­æ³•ä¸Šä¸Javaç±»ä¼¼ï¼Œä½†æ˜¯åˆæ¯”Javaå¤šäº†ä¸€äº›è¯­æ³•ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œå±æ€§å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åˆ›æ–°ã€‚

C# 1.0ï¼Œå®ç°äº†ä»¥ä¸‹åŠŸèƒ½

## ç±»ï¼ˆClassï¼‰å’Œç»“æ„ï¼ˆStructï¼‰

ç±»å’Œç»“æ„æ˜¯C#ä»£ç çš„åŸºæœ¬ç»„æˆå•å…ƒã€‚

> å¯¹æ¯”Javaï¼ŒC#çš„ç±»å®šä¹‰æ–‡ä»¶ä¹Ÿè¾ƒä¸ºçµæ´»ï¼š
>
> - C#å•ä¸ªæ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªç±»ï¼Œä¸”å¯ä»¥ä»»æ„æŒ‡å®šå¯è®¿é—®æ€§ï¼Œæ”¯æŒå¤šä¸ªpublicç±»ï¼Œå¹¶ä¸”ç±»å¯ä»¥åˆ†æ•£åœ¨ä¸åŒå‘½åç©ºé—´ä¸­ã€‚è€ŒJavaå•ä¸ªæ–‡ä»¶åªèƒ½æœ‰ä¸€ä¸ªpublicçš„ç±»ã€‚
> - C#æ–‡ä»¶åä¸ç±»åä¸å¿…ç›¸åŒï¼Œè€ŒJavaæ–‡ä»¶ä¸­publicçš„ç±»å¿…é¡»ä¸æ–‡ä»¶åä¸€è‡´ã€‚

### Classä¸Structçš„åŒºåˆ«

1. classæ˜¯[å¼•ç”¨ç±»å‹](#å€¼ç±»å‹%20vs%20å¼•ç”¨ç±»å‹)ï¼Œstructä¸º[å€¼ç±»å‹](#å€¼ç±»å‹%20vs%20å¼•ç”¨ç±»å‹)ã€‚classå¯ä»¥ä¸ºnullï¼Œstructä¸å¯ä»¥ã€‚classçš„èµ‹å€¼ä¸ºå¤åˆ¶å¼•ç”¨åœ°å€ï¼Œstructçš„èµ‹å€¼ä¸ºå…ƒç´ æ‹·è´ã€‚
2. classä¸å¯ä»¥ä½¿ç”¨Nullable<>ç±»å°è£…ã€‚structå¯ä»¥ã€‚ç®€å†™ä½œ â€œç±»å‹?â€(C#2.0å¼•å…¥ã€‚8.0ä¹‹åæ–°å¢äº†å¯nullå¼•ç”¨ç±»å‹ï¼Œè¿™æ¡ä¸å†æ™®éæˆç«‹)
3. classå¯ä»¥ç»§æ‰¿ï¼Œstructä¸å¯ä»¥ï¼Œå®ƒæ˜¯å¯†å°çš„(sealed)ã€‚å…³äºå¯†å°ç±»è¯·æŸ¥çœ‹[å…¶ä»–ä¿®é¥°ç¬¦](#å…¶ä»–ä¿®é¥°ç¬¦)
4. classå¦‚æœä¸æ˜¾å¼å£°æ˜æ„é€ å™¨ï¼Œé»˜è®¤æ‹¥æœ‰æ— å‚æ„é€ å™¨ï¼Œä½†åœ¨å£°æ˜æ„é€ å™¨åï¼Œé»˜è®¤æ„é€ å™¨ä¼šè¢«åˆ é™¤ã€‚å¦‚æœä»éœ€è¦æ— å‚æ„é€ å™¨ï¼Œéœ€è¦æ˜¾å¼å£°æ˜ã€‚ç»“æ„ä¸å¯ä»¥å£°æ˜æ— å‚æ„é€ å™¨ï¼ˆåœ¨C#10.0å–æ¶ˆäº†è¿™ä¸ªé™åˆ¶ï¼‰ï¼Œå®ƒé»˜è®¤æ‹¥æœ‰æ— å‚æ„é€ å™¨ï¼Œå¹¶ä¸”æ— æ³•è¢«åˆ é™¤ã€‚

### ä¿®é¥°ç¬¦ï¼ˆModifierï¼‰

#### å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼ˆAccess Modifierï¼‰

C#æ”¯æŒçš„å¯è®¿é—®ä¿®é¥°ç¬¦ï¼š

- public
- private
- protect
- internal

    - åªèƒ½åœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºé›†ä¸‹å¯è§ã€‚åœ¨ç¼–å†™ç±»åº“æ—¶ï¼Œinternalçš„ç±»åœ¨ç±»åº“å†…ç›¸å½“äºpublicï¼Œä½†æ˜¯å¯¹äºå¼•ç”¨è¯¥ç±»åº“çš„ä½¿ç”¨è€…ï¼Œå®ƒä¸å¯è§ã€‚

- protected internal

    - ç›¸å½“äºprotected or internal

- private protectedï¼ˆC#7.2å¼•å…¥ï¼‰

    - ç›¸å½“äºprotected and internalã€‚å› ä¸ºprotected internalç»„åˆå·²ç»ç”¨æ¥è¡¨ç¤ºorçš„å…³ç³»ï¼Œè€Œä¿®é¥°ç¬¦çš„é¡ºåºæ˜¯æ— å…³ç´§è¦çš„ã€‚å› è€Œï¼Œåªå¾—é‡‡ç”¨è¿™ä¹ˆä¸ªè¹©è„šçš„å…³é”®è¯ç»„åˆæ¥æŒ‡ä»£andçš„å…³ç³»ã€‚

ç›´è§‚çš„å¯¹æ¯”ï¼Œè¯·çœ‹å¦‚ä¸‹è¡¨æ ¼ï¼š

| è°ƒç”¨æ–¹çš„ä½ç½® | public | protected | internal | protected internal | private protected | private |
| ------- | --- | --- | --- | --- | --- | --- |
| åœ¨ç±»å†… | âœ”ï¸ | âœ”ï¸ | âœ”ï¸ | âœ”ï¸ | âœ”ï¸ | âœ”ï¸ |
| æ´¾ç”Ÿç±»ï¼ˆç›¸åŒç¨‹åºé›†ï¼‰ | âœ”ï¸ | âœ”ï¸ | âœ”ï¸ | âœ”ï¸ | âœ”ï¸ | âŒ |
| éæ´¾ç”Ÿç±»ï¼ˆç›¸åŒç¨‹åºé›†ï¼‰| âœ”ï¸ | âœ”ï¸ | âŒ | âœ”ï¸ | âŒ | âŒ |
| æ´¾ç”Ÿç±»ï¼ˆä¸åŒç¨‹åºé›†ï¼‰| âœ”ï¸ | âœ”ï¸ | âœ”ï¸ | âŒ | âŒ | âŒ |
| éæ´¾ç”Ÿç±»ï¼ˆä¸åŒç¨‹åºé›†ï¼‰ | âœ”ï¸ | âŒ | âŒ | âŒ | âŒ | âŒ |

å¦‚æœä»£ç ä¸­æœªä¹¦å†™å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼Œåˆ™ï¼š

- å¯¹äºç±»ï¼Œé»˜è®¤çš„å¯è®¿é—®æ€§æ˜¯internal
- å¯¹äºç±»çš„æˆå‘˜ï¼Œé»˜è®¤çš„å¯è®¿é—®æ€§æ˜¯private
    - ç‰¹åˆ«çš„ï¼Œå¯¹äºåµŒå¥—çš„ç±»ï¼Œå†…éƒ¨ç±»çš„é»˜è®¤å¯è®¿é—®æ€§ä¹Ÿæ˜¯private

> Javaæ²¡æœ‰ç±»ä¼¼internalçš„ä¿®é¥°ç¬¦ã€‚

> Javaçš„ç±»ä¸ä¹¦å†™ä»»ä½•ä¿®é¥°ç¬¦æ—¶ï¼Œæ­¤ç±»ä¼šè¢«é™åˆ¶åœ¨ä»…Packageå†…å¯è®¿é—®ï¼Œè¢«ç§°ä½œfriendlyçš„ï¼ˆæ³¨æ„friedlyå¹¶ä¸æ˜¯å…³é”®è¯ï¼‰ã€‚éœ€è¦æ³¨æ„ï¼Œæ˜¯é™åˆ¶åœ¨Packageå†…ï¼Œè€ŒéModuleå†…ã€‚ä»C#è§’åº¦ç†è§£ï¼Œå°±æ˜¯é™åˆ¶åœ¨å‘½åç©ºé—´å†…å¯è®¿é—®ã€‚C#ä¹Ÿæ²¡æœ‰è¿™ç§æœºåˆ¶çš„ä¿®é¥°ç¬¦ã€‚

#### å…¶ä»–ä¿®é¥°ç¬¦

- staticï¼šé™æ€æˆå‘˜ã€é™æ€ç±»ï¼ˆC# 2.0å¼•å…¥é™æ€ç±»ï¼‰

- abstractï¼šæŠ½è±¡ç±»æˆ–æŠ½è±¡æ–¹æ³•
- sealedï¼š
    - ä¿®é¥°ç±»ï¼Œè¡¨ç¤ºå¯†å°ç±»ã€‚å¯†å°ç±»ä¸å¯è¢«ç»§æ‰¿ã€‚
    - ä¿®é¥°æ–¹æ³•ï¼Œè¡¨ç¤ºå¯†å°çš„æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¸å¯å†è¢«æ´¾ç”Ÿç±»é‡å†™ã€‚
- constï¼šå®šä¹‰å¸¸é‡ã€‚
    - æ³¨æ„ï¼šå€¼å¿…é¡»æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼ˆå¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µè®¡ç®—å‡ºç»“æœçš„è¡¨è¾¾å¼ï¼‰ã€‚ä¹Ÿå°±æ˜¯å¿…é¡»æ˜¯**å­—é¢é‡**ï¼ˆLiteralï¼‰ï¼Œæˆ–è€…ç”±å­—é¢é‡å’Œç®€å•è¿ç®—ç¬¦ç»„æˆçš„è¡¨è¾¾å¼ã€‚ç‰¹åˆ«çš„ï¼Œstringç±»å‹å› ä¸ºå…¶ä¸å¯å˜æ€§ï¼Œæ˜¯å¯ä»¥ä½œä¸ºå¸¸é‡çš„ã€‚å¦‚æœå€¼éœ€è¦newè¿ç®—ç¬¦ï¼Œåˆ™ä¸èƒ½å®šä¹‰ä¸ºå¸¸é‡ã€‚è¿™ç§æƒ…å†µä¸€èˆ¬ç”¨static readonlyçš„ç»„åˆã€‚
- readonlyï¼šç”¨äºä¿®é¥°å­—æ®µï¼Œè¡¨ç¤ºåªè¯»å­—æ®µã€‚æ˜¯æŒ‡ä»…èƒ½é€šè¿‡æ„é€ æ–¹æ³•ã€å­—æ®µåˆå§‹åŒ–è¡¨è¾¾å¼(C#2.0å¼•å…¥)èµ‹å€¼çš„å­—æ®µã€‚è¯¥å­—æ®µåœ¨å…¶ä»–ä½ç½®åªè¯»ã€‚
- volatileï¼šç”¨äºä¿®é¥°å­—æ®µï¼Œæ ‡è¯†ä¸€ä¸ªå­—æ®µå¯èƒ½ä¼šç”±å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ã€‚åœ¨å¤šå¤„ç†å™¨çš„ç³»ç»Ÿä¸­ï¼Œå¯¹åŒä¸€å—å†…å­˜åŒºåŸŸçš„è¯»å†™é¡ºåºï¼Œæœ‰æ—¶ä¼šä¸ºäº†æå‡æ€§èƒ½è€Œè¢«ç¼–è¯‘å™¨ã€è¿è¡Œæ—¶ç”šè‡³ç¡¬ä»¶é‡æ–°æ’åˆ—ã€‚æ ‡è®°ä¸ºvolatileçš„å­—æ®µï¼Œå¯ä»¥é¿å…è¯»å†™é¡ºåºè¢«é‡æ’ï¼Œç¡®ä¿å®Œå…¨æŒ‰ç…§ä¹¦å†™çš„é¡ºåºæ‰§è¡Œã€‚

> C#çš„sealed classå¯¹åº”çš„æ˜¯Javaçš„final classï¼ˆæœ€ç»ˆç±»ï¼‰ï¼Œè¡¨ç¤ºè¯¥ç±»ä¸å¯ä»¥è¢«ä»»ä½•ç±»ç»§æ‰¿ã€‚æ³¨æ„ï¼šJava 15ä¸­ä¹Ÿå¼•å…¥äº†sealed classé¢„è§ˆç‰ˆï¼Œå¹¶åœ¨17æ—¶å˜ä¸ºæ­£å¼è¯­æ³•ã€‚ä½†æ˜¯å…¶å«ä¹‰ä¸C#çš„ä¸åŒã€‚Javaçš„sealedç±»çš„æ¡ä»¶æ›´å®½æ¾ä¸€äº›ï¼šå®ƒå…è®¸å£°æ˜çš„å·²çŸ¥çš„å­ç±»ç»§æ‰¿ï¼Œé™¤æ­¤ä¹‹å¤–å…¶ä»–çš„ç±»ä¸å¯ç»§æ‰¿ã€‚

> ç”¨äºä¿®é¥°å­—æ®µæ—¶ï¼ŒC#çš„constå’Œreadonlyï¼Œç›¸å½“äºJavaçš„finalã€‚

### ç±»å‹åˆ«å

å¤§éƒ¨åˆ†çš„å…³é”®è¯ç±»å‹ï¼Œéƒ½æ˜¯åˆ«åï¼š

- int -> System.Int32
- uint -> System.UInt32
- long -> System.Int64
- double -> System.Double
- byte -> System.Byte
- char -> System.Char
- decimal -> System.Decimal
- bool -> System.Boolean
- string -> System.String
- object -> System.Object
- ...

ç‰¹åˆ«æ³¨æ„ï¼šåœ¨C#ä¸­ä¸Šè¿°åˆ«å**å®Œå…¨ç­‰ä»·**ã€‚

> Javaä¸­ä¸€èˆ¬å¤§ã€å°å†™çš„ç±»å‹å«ä¹‰å¹¶ä¸ç›¸åŒã€‚å¤§å†™å¼€å¤´çš„ç±»å‹æ˜¯åŒ…è£…ç±»ã€‚åŸºæœ¬ç­‰ä»·äºC#ä¸­çš„Nullable\<T\>ï¼ˆC#2.0å¼•å…¥ï¼‰ã€‚
> > ä¾‹å¦‚ï¼šJavaä¸­çš„Doubleï¼Œç›¸å½“äºC#ä¸­çš„double?ã€‚è€ŒC#ä¸­çš„Doubleå’Œdoubleå®Œå…¨ç­‰ä»·ã€‚

### éšå¼ç»§æ‰¿ã€Objectç±»

å…³äº**éšå¼ç»§æ‰¿**ï¼Œä¸¾ä¾‹è¯´æ˜ï¼šenumï¼ˆæšä¸¾ï¼‰éƒ½éšå¼ç»§æ‰¿Enumç±»ï¼Œdelegateï¼ˆå§”æ‰˜ï¼‰éƒ½éšå¼ç»§æ‰¿Delegateç±»ï¼Œå€¼ç±»å‹å‡éšå¼ç»§æ‰¿ValueTypeç±»ï¼Œæ•°ç»„éƒ½éšå¼ç»§æ‰¿Arrayç±»ã€‚æŸ¥çœ‹è¿™äº›åŸºç±»ï¼Œä¼šå‘ç°å…¶å®šä¹‰éƒ½æ˜¯classã€‚ä½†æ˜¯ç¼–è¯‘å™¨å¤„ç†è¿™ç§éšå¼ç»§æ‰¿æ—¶ï¼Œå¹¶ä¸ä¼šéƒ½æŠŠå®ƒä»¬éƒ½å˜æˆå¼•ç”¨ç±»å‹ï¼Œè€Œæ˜¯æŒ‰ç…§è¯­æ³•çº¦å®šç¡®å®šæ˜¯å€¼ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ã€‚è¿™ç§éšå¼ç»§æ‰¿å…³ç³»æ˜¯ç¼–è¯‘å™¨å˜çš„é­”æœ¯ï¼Œä½ æ— æ³•ç›´æ¥åœ¨ä»£ç ä¸­æ˜¾å¼å£°æ˜è¿™ç§ç»§æ‰¿å…³ç³»ã€‚éšå¼ç»§æ‰¿çš„å¥½å¤„æ˜¯ï¼Œæ‰€æœ‰å¯¹åº”ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨åŸºç±»å®šä¹‰çš„æ–¹æ³•ï¼Œå¦‚enuméƒ½å¯ä»¥ä½¿ç”¨Enumç±»å®šä¹‰çš„HasFlagæ–¹æ³•ç­‰ã€‚

objectç±»æ˜¯æå…¶ç‰¹æ®Šçš„ç±»ã€‚C#ä¸­çš„ä»»ä½•ç±»å‹ï¼Œéƒ½éšå¼ç»§æ‰¿è‡ªobjectã€‚ä»»ä½•ç±»å‹çš„å¯¹è±¡éƒ½èƒ½ä¸objectå¯¹è±¡äº’è½¬ã€‚è¿™ä¹ŸåŒ…æ‹¬å€¼ç±»å‹ã€‚

objectç±»å®šä¹‰äº†ToStringã€GetTypeã€Equalsã€GetHashCodeç­‰æ–¹æ³•ã€‚æ‰€æœ‰ç±»å‹å‡å¯ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥é‡å†™è¿™äº›æ–¹æ³•ã€‚

> è¿™ä¸Javaä¸åŒã€‚Javaä¸­Objectè¢«è®¤ä¸ºæ˜¯å¼•ç”¨ç±»å‹çš„åŸºç±»ï¼Œintå±äºåŸºæœ¬ç±»å‹ï¼Œä¸æ˜¯Objectã€‚

### å€¼ç±»å‹ vs å¼•ç”¨ç±»å‹

å€¼ç±»å‹ä¸¾ä¾‹ï¼š

- bool
- char
- int
- æ‰€æœ‰struct
- æ‰€æœ‰enum
- å…ƒç»„ï¼ˆC# 7.0ï¼‰

å¼•ç”¨ç±»å‹ä¸¾ä¾‹ï¼š

- string
- æ•°ç»„
- å§”æ‰˜
- æ‰€æœ‰class
- recordï¼ˆC# 9.0ï¼‰

å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ç‰¹ç‚¹ç±»ä¼¼äºC++ã€‚

- å­˜å‚¨
    - å€¼ç±»å‹å˜é‡åœ¨æ ˆç©ºé—´ä¸­ç›´æ¥å­˜å‚¨å˜é‡å€¼ã€‚å¯¹äºstructï¼ŒåŒ…å«çš„æ‰€æœ‰å­—æ®µéƒ½åœ¨æ ˆä¸­å ç”¨ç›¸åº”å¤§å°æ ˆç©ºé—´ã€‚structä¸­çš„å¼•ç”¨ç±»å‹å­—æ®µä»…åœ¨æ ˆä¸Šå ç”¨ä¸€ä¸ªæŒ‡é’ˆçš„å¤§å°ã€‚å½“structåµŒå¥—æ—¶ï¼Œå ç”¨çš„ç©ºé—´ä¹Ÿä¼šç­‰åŒäºæ¯ä¸ªstructå±•å¼€çš„å¤§å°ã€‚é™¤äº†structä¹‹å¤–çš„å€¼ç±»å‹å’Œä»…åŒ…å«éå¼•ç”¨å­—æ®µçš„structåˆåˆç§°**éæ‰˜ç®¡ç±»å‹**ï¼ˆUnmanaged Typeï¼‰ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šé€šè¿‡GCæ¥å›æ”¶èµ„æºã€‚æ ˆä¸Šçš„ç©ºé—´æœ‰ç€ç›¸å¯¹å›ºå®šçš„å›æ”¶æ—¶æœºï¼šè·Ÿéšæ–¹æ³•çš„è°ƒç”¨è¿›è¡Œå‹æ ˆå’Œå¼¹æ ˆã€‚è¿™ç‚¹å­¦è¿‡C++çš„äººåº”è¯¥å¯ä»¥ç†è§£ã€‚éæ‰˜ç®¡ç±»å‹å¯ä»¥ç”¨æ¥ä¸C++ç­‰è¯­è¨€ç¼–å†™çš„åº“ä¼ é€’å‚æ•°å’Œç»“æœï¼Œä¹Ÿèƒ½ç”¨äºç¼–å†™unsafeä»£ç ã€‚ä¸è¿‡ç”±äºæ ˆçš„å¤§å°æœ‰é™ï¼Œä½¿ç”¨è¿‡å¤§çš„structå¹¶ä¸æ˜¯å¾ˆå¥½çš„ä¸»æ„ã€‚å°¤å…¶åœ¨å¤šé‡é€’å½’çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨ä¸å½“å¯èƒ½å¿«é€Ÿè€—å°½æ ˆç©ºé—´ã€‚
    - å¼•ç”¨ç±»å‹åˆ™åªåœ¨æ ˆå†…å­˜å‚¨å †ç©ºé—´çš„åœ°å€ä¿¡æ¯ï¼Œå®é™…æ•°æ®åˆ™å­˜å‚¨äº**æ‰˜ç®¡å †**ï¼ˆManaged Heapï¼Œä»¥ä¸‹æ‰€æåˆ°çš„å †ç©ºé—´ï¼Œå‡æŒ‡æ‰˜ç®¡å †ï¼‰ç©ºé—´ä¸­ã€‚å †çš„å¯ç”¨ç©ºé—´è¦å¤§å¾—å¤šï¼Œå‡ ä¹å¯ä»¥ä½¿ç”¨å…¨éƒ¨å†…å­˜ã€‚å¼•ç”¨ç±»å‹åˆå«**æ‰˜ç®¡ç±»å‹**ï¼ˆManaged Typeï¼‰ï¼Œå…¶å†…å­˜èµ„æºé€šè¿‡GCæœºåˆ¶å›æ”¶ã€‚

- èµ‹å€¼å’Œä¼ å‚
    - å€¼ç±»å‹åœ¨èµ‹å€¼æ“ä½œã€ä½œä¸ºå‚æ•°ä¼ å…¥æ–¹æ³•æ—¶ï¼Œä¼šå¼•å‘æ•°æ®æ‹·è´ã€‚ä¸€ä¸ªstructåœ¨èµ‹å€¼æ—¶ï¼Œä¼šæ‹·è´æ¯ä¸ªå­—æ®µçš„å€¼ï¼ˆå¦‚æœå­—æ®µæœ¬èº«ä¹Ÿæ˜¯structï¼Œä¼šè¿›ä¸€æ­¥æ·±æ‹·è´ï¼‰ã€‚å¯¹è¢«èµ‹å€¼æˆ–ä¼ å…¥æ–¹æ³•åçš„å˜é‡ä¿®æ”¹ä¸ä¼šå½±å“åˆ°åŸå˜é‡ã€‚
    - å¼•ç”¨ç±»å‹çš„èµ‹å€¼å’Œå‚æ•°ä¼ å…¥åªæ˜¯æ‹·è´åœ°å€ä¿¡æ¯ï¼Œå¯¹è¢«èµ‹å€¼åå¼•ç”¨å¯¹è±¡çš„ä¿®æ”¹éƒ½ä¼šå¯¼è‡´ç”¨æ¥èµ‹å€¼çš„å¯¹è±¡çš„å˜æ›´ã€‚

> Javaå¹¶æ²¡æœ‰å€¼ç±»å‹çš„æ¦‚å¿µï¼Œå¯¹åº”çš„æ¦‚å¿µæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ã€‚åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬booleanã€floatã€charã€byteã€shortã€intã€longå…±8ç§ã€‚å…¶ä½™å‡ä¸ºå¼•ç”¨ç±»å‹ã€‚è€ŒåŸºæœ¬ç±»å‹å…¨éƒ½æœ‰å¯¹åº”çš„åŒ…è£…ç±»ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†åˆ«ä»‹ç»ä¸‹è¿™ä¸¤ç§ç±»å‹ï¼š

### å€¼ç±»å‹ï¼ˆValue Typeï¼‰

#### ç»“æ„

ç»“æ„ï¼ˆStructï¼‰æ˜¯å€¼ç±»å‹çš„ã€‚

é™¤äº†å‰é¢ç« èŠ‚æåˆ°çš„ä¸åŒç‚¹ä¹‹å¤–ï¼Œç»“æ„ä¸ç±»è¿˜æ˜¯å¾ˆç›¸ä¼¼çš„ã€‚ç»“æ„ä¸­ä¹Ÿå¯ä»¥å®šä¹‰å­—æ®µã€å±æ€§ã€æ–¹æ³•ç­‰ã€‚ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬åœ¨C#çš„æ•™ç¨‹ä¸­ï¼Œ**æ›´å¤šæåŠçš„æ˜¯ç±»å‹ï¼ˆTypeï¼‰è€Œä¸æ˜¯ç±»ï¼ˆClassï¼‰**ã€‚

intã€doubleç­‰å…³é”®è¯ç±»å‹ï¼Œæ˜¯Int32ã€Doubleç­‰çš„åˆ«åã€‚é€šè¿‡å®šä¹‰å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬æœ¬è´¨ä¸Šéƒ½æ˜¯Structã€‚å› è€Œï¼Œintç­‰å€¼ç±»å‹ä¹Ÿèƒ½å¤Ÿå®šä¹‰è‡ªå·±çš„æ–¹æ³•ã€‚åŠ ä¸Šéšå¼ç»§æ‰¿è‡ªValueTypeå’ŒObjectã€‚å› è€Œintå¯ä»¥ä½¿ç”¨Equalsã€ToStringç­‰æ–¹æ³•ï¼›ä¹Ÿèƒ½ä½¿ç”¨GetTypeæ–¹æ³•è·å–Typeå¯¹è±¡ä»è€Œä½¿ç”¨åå°„ï¼›è¿˜å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•ï¼šå¦‚Parseï¼Œç”¨äºå°†stringè½¬æˆintã€‚

äº‹å®ä¸Šï¼ŒStructå¯ä»¥ç”¨äºæŒ‡ä»£ä¸€åˆ‡å€¼ç±»å‹ï¼ŒåŒ…æ‹¬æšä¸¾ã€‚

> Javaæ²¡æœ‰Structç±»å‹ã€‚

> Javaçš„åŸºæœ¬ç±»å‹ï¼ŒçœŸçš„ååˆ†â€œåŸºæœ¬â€ã€‚å®ƒä»¬æ²¡æœ‰æˆå‘˜æ–¹æ³•å¯ç”¨ã€‚å¦‚ä¸Šä¾‹ï¼Œè¦å°†Stringè½¬æˆæ•´æ•°ï¼Œéœ€è¦ç”¨åŒ…è£…ç±»Integerçš„parseIntæ–¹æ³•ã€‚

#### è£…ç®±ï¼ˆBoxingï¼‰å’Œæ‹†ç®±ï¼ˆUnboxingï¼‰

å¦‚æœå°†å€¼ç±»å‹ä¸objectäº’è½¬ï¼Œæˆ–è€…ä¸å…¶éšå¼ç»§æ‰¿ç±»å‹äº’è½¬ï¼Œä¼šå¼•å‘è£…ç®±ï¼ˆæˆ–ç§°ä¸ºå°ç®±ï¼‰å’Œæ‹†ç®±ï¼ˆæˆ–ç§°å–æ¶ˆè£…ç®±ï¼‰

è£…ç®±ï¼š

```c#
int x = 9;
object y = (object)x;  //å¼•å‘è£…ç®±
ValueType z = (ValueType)x;  //å¼•å‘è£…ç®±
Status status = Status.OK;  //Statusæ˜¯æšä¸¾ç±»å‹
Enum statusBoxing = (Enum)code;  //å¼•å‘è£…ç®±
```

æ‹†ç®±

```c#
//æ¥ä¸Šä¸ªä¾‹å­
x = (int)y;  //å¼•å‘æ‹†ç®±
x = (int)z;  //å¼•å‘æ‹†ç®±
status = (Status)statusBoxing;  //å¼•å‘æ‹†ç®±
```

åœ¨è£…ç®±å‰åï¼Œè°ƒç”¨GetTypeè·å–ç±»å‹æè¿°ä¼šå¾—åˆ°ç›¸åŒçš„ç±»å‹ã€‚ä¸Šä¾‹ä¸­ï¼Œ`x.GetType()`å’Œ`y.GetType()`è·å–åˆ°çš„ç±»å‹ç›¸åŒï¼Œéƒ½æ˜¯Int32ï¼›`status.GetType()`å’Œ`statusBoxing.GetType()`è·å¾—åˆ°çš„ç±»å‹ç›¸åŒï¼Œéƒ½æ˜¯Statusã€‚

éœ€è¦æ³¨æ„ï¼Œè£…ç®±å’Œæ‹†ç®±éœ€è¦å¤§é‡è®¡ç®—ï¼Œå› è€Œä¸æ˜¯æœ€ä¼˜é€‰æ‹©ã€‚å¦‚éœ€æ¥æ”¶æˆ–è€…ä¼ é€’ä»»æ„ç±»å‹å‚æ•°ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘[æ³›å‹](#æ³›å‹ï¼ˆGenericï¼‰)ï¼ˆC#2.0å¼•å…¥ï¼‰ï¼Œè€Œéä½¿ç”¨Object

> Javaå°†intèµ‹å€¼ç»™Objectå¯¹è±¡ï¼Œä¹Ÿä¼šè¿›è¡Œè£…ç®±æ“ä½œã€‚å®ƒäº‹å®ä¸Šæ˜¯å°†intè½¬æˆåŒ…è£…ç±»Integeråèµ‹å€¼ç»™Objectã€‚è£…ç®±åçš„å¯¹è±¡äº‹å®ä¸Šå‘ç”Ÿäº†ç±»å‹å˜åŒ–ï¼ŒåŸå…ˆä¸ºintç±»å‹ï¼Œè£…ç®±åä¸ºIntegerã€‚

> Javaçš„æ³›å‹ç±»å‹å¹¶ä¸å…è®¸åŸºæœ¬ç±»å‹ã€‚å› æ­¤ï¼Œä½¿ç”¨æ³›å‹æ—¶ï¼Œä¸ä¼šå› ä¸ºå¯ä»¥æ˜¯åŸºæœ¬ç±»å‹è€ŒèŠ‚çœè£…ç®±çš„æ“ä½œï¼Œå› æ­¤ä½¿ç”¨Objectä¼ é€’å‚æ•°å’Œä½¿ç”¨æ³›å‹ç±»å‹ä¼ é€’å‚æ•°ç›¸åŒï¼Œå¹¶ä¸ä¼šå¯¼è‡´æ•ˆç‡å·®å¼‚ã€‚

#### æšä¸¾ï¼ˆEnumï¼‰

æšä¸¾æ˜¯å€¼ç±»å‹çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ç­‰ä»·äºintç±»å‹ï¼Œä¸”å¯ä»¥ä¸intç±»å‹æ˜¾å¼äº’è½¬ã€‚è¿™ç‚¹ä¸Javaçš„æšä¸¾ç±»ä¸åŒã€‚C#çš„enumå®šä¹‰æ›´åƒC++ã€‚

æšä¸¾å®šä¹‰ä¸­åˆ—ä¸¾å¯èƒ½å‡ºç°çš„æšä¸¾é¡¹åç§°ï¼Œè¿™äº›åç§°åˆ†åˆ«å¯¹åº”ä¸€ä¸ªintå€¼ã€‚å…¶å€¼é»˜è®¤ä»0å¼€å§‹ï¼Œæ¯é¡¹é€’å¢ã€‚

ä½†æ˜¯ä½ ä»ç„¶å¯ä»¥æŒ‡å®šæšä¸¾é¡¹å¯¹åº”çš„å€¼ï¼Œæ–¹æ³•æ˜¯åœ¨æšä¸¾é¡¹åé¢ä¹¦å†™ `= å€¼` ã€‚ä½ è¿˜å¯ä»¥åªæŒ‡å®šä¸€éƒ¨åˆ†æšä¸¾é¡¹çš„å€¼è€Œçœç•¥å¦ä¸€éƒ¨åˆ†ï¼ŒæœªæŒ‡å®šå€¼çš„æšä¸¾é¡¹ä¼šä»ä¸Šä¸€ä¸ªæŒ‡å®šäº†å€¼çš„æšä¸¾é¡¹é¡ºåºé€’å¢ä¸‹æ¥ã€‚

æšä¸¾è¿˜å…è®¸èµ‹å€¼ä¸ºæœªåœ¨æšä¸¾é¡¹ä¸­åˆ—å‡ºçš„intå€¼ã€‚å³ï¼šå¯ä»¥å°†ä»»æ„intå€¼æ˜¾å¼è½¬æ¢æˆæšä¸¾ç±»å‹ï¼Œå¹¶èµ‹å€¼ç»™è¯¥ç±»å‹å¯¹è±¡ï¼Œä¸ä¼šæŠ¥é”™ã€‚

æšä¸¾çš„ToStringæ–¹æ³•ï¼Œè¿”å›çš„æ˜¯è¯¥é¡¹çš„å®šä¹‰æ–‡æœ¬ã€‚ä½†æ˜¯å¦‚æœå€¼æœªå¯¹åº”å·²å®šä¹‰çš„é¡¹ï¼Œåˆ™ToStringç›´æ¥è¾“å‡ºæ•°å­—ã€‚

```c#
public enum StatusCode //å®šä¹‰æšä¸¾
{
    Success = 0,  //æ˜¾å¼æŒ‡å®šSuccessé¡¹å€¼ä¸º0
    DatabaseError,  //æœªæŒ‡å®šDatabaseErrorå€¼ï¼Œå› è€Œå…¶å€¼ä¸ºå‰ä¸€é¡¹åŠ 1ï¼Œä¸º1
    SystemError  //åŒå‰ï¼Œæ­¤é¡¹å€¼ä¸ºä¸Šä¸€é¡¹åŠ 1ï¼Œä¸º2
}

//æµ‹è¯•
StatusCode code = StatusCode.Success;
Console.WriteLine((int)code); //è¾“å‡ºä¸º 0 
Console.WriteLine(code.ToString()); //è¾“å‡ºä¸º Success
code = (StatusCode)100;  //æœ‰æ•ˆèµ‹å€¼ï¼Œä¸ä¼šæŠ¥é”™
Console.WriteLine(code.ToString()); //è¾“å‡ºä¸º 100
```

æšä¸¾ä¹Ÿå¯ä»¥æŒ‡å®šå…¶å®ç°ç±»å‹ã€‚æ–¹æ³•æ˜¯ç”¨ç±»ä¼¼ç»§æ‰¿çš„è¯­æ³•ï¼Œæšä¸¾å®šä¹‰æ—¶åœ¨æšä¸¾ååé¢ä½¿ç”¨ `:` æŒ‡æ˜å®ç°ç±»å‹ã€‚å®ç°ç±»å‹åªèƒ½æ˜¯byteã€sbyteã€shortã€ushortã€intã€uintã€longã€ulongè¿™å‡ ä¸ª**æ•´æ•°ç±»å‹**ã€‚è™½ç„¶è¿™é‡Œæ˜¯ `:` ç¬¦å·ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ç§°ä¹‹ä¸ºç»§æ‰¿ï¼Œæ¯•ç«ŸStructæœ¬å°±æ— æ³•ç»§æ‰¿ï¼Œå¹¶ä¸”æšä¸¾æ—¢ä¸èƒ½é‡å†™æ–¹æ³•ï¼Œä¹Ÿæ— æ³•å®šä¹‰å…¶ä»–æ–¹æ³•ã€‚

```c#
public enum StatusCode : ulong //å®šä¹‰æšä¸¾ï¼Œå¹¶æŒ‡å®šæšä¸¾ä¸ºulongç±»å‹
{
    Success = 0uL,  //é¡ºä¾¿æä¸€å˜´ï¼šæ•°å­—åé¢çš„Lï¼Œä»è§„èŒƒä¸Šæ¥è®²è¦ç”¨å¤§å†™ï¼Œé¿å…è·Ÿ1æ··æ·†ã€‚
    DatabaseError,
    SystemError
}
```

> ä¸Javaæšä¸¾çš„å¯¹æ¯”ï¼š
>
> - C#æšä¸¾ä¸ºå€¼ç±»å‹ï¼Œç­‰ä»·äºintï¼ˆæˆ–å…¶ä»–æ•´æ•°ç±»å‹ï¼‰ã€‚Javaçš„æšä¸¾å®é™…æ˜¯æšä¸¾ç±»ï¼Œå› è€Œæ˜¯å¼•ç”¨ç±»å‹ã€‚
> - C#æšä¸¾å®šä¹‰ä»…èƒ½åˆ—ä¸¾æšä¸¾é¡¹ï¼Œä¸æ”¯æŒç¼–å†™æˆå‘˜æ–¹æ³•ã€ä¸èƒ½ç¼–å†™æ„é€ å™¨ï¼Œè™½ç„¶ä»èƒ½ä½¿ç”¨objectç±»ã€ValueTypeç±»ã€Enumç±»å®šä¹‰çš„æ–¹æ³•ï¼Œä½†æ˜¯å´ä¸èƒ½é‡å†™å®ƒä»¬ã€‚Javaæšä¸¾å®šä¹‰å®é™…æ˜¯å®šä¹‰äº†æšä¸¾ç±»å’Œè¯¥ç±»çš„å¸¸é‡å¯¹è±¡ã€‚Javaçš„æšä¸¾å®šä¹‰ä¸­å¯ä»¥æ’å…¥æ„é€ å™¨ã€æ–¹æ³•ç­‰ï¼Œä¹Ÿå¯ä»¥é‡å†™toStringæ–¹æ³•ã€‚
> - C#çš„æšä¸¾ä»…èƒ½æŒ‡å®šå®ç°ç±»å‹ï¼Œå¹¶ä¸”å¿…é¡»ä¸ºæ•´æ•°ç±»å‹ã€‚Javaçš„æšä¸¾è™½æ— æ³•ç»§æ‰¿ç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°æ¥å£ã€‚
> - C#æšä¸¾å¯ä»¥ä¸intç­‰æ•´æ•°ç±»å‹ç›´æ¥äº’è½¬ï¼Œå¹¶ä¸”æ”¯æŒå°†æœªåœ¨æšä¸¾ä¸­å®šä¹‰çš„æ•´æ•°å€¼èµ‹å€¼ç»™æšä¸¾å¯¹è±¡ã€‚è€ŒJavaä¸intç­‰ç±»å‹äº’è½¬ï¼Œéœ€è¦é€šè¿‡æšä¸¾ç±»å®šä¹‰çš„å­—æ®µå’Œgetã€setæ–¹æ³•æ¥å®ç°ï¼Œå¹¶ä¸”ä¸å­˜åœ¨è¶…å‡ºæšä¸¾å®šä¹‰é¡¹çš„èµ‹å€¼ã€‚
> - C#å¯ä»¥ç»™æ¯ä¸ªæšä¸¾é¡¹ç›´æ¥æŒ‡å®šå€¼ï¼Œè¯­æ³•ä¸º `æšä¸¾é¡¹=å€¼` ï¼Œå€¼ä¸ºæ‰€æŒ‡å®šç±»å‹ï¼Œé»˜è®¤æ˜¯intã€‚è€ŒJavaå¿…é¡»é€šè¿‡æ„é€ å™¨æ¥å®ç°ï¼Œå¹¶åœ¨å®šä¹‰æšä¸¾é¡¹æ—¶æŒ‡å®šè¯¥é¡¹å¦‚ä½•ä½¿ç”¨æ„é€ å™¨ï¼Œå› è€Œè¯­æ³•æ˜¯ `æšä¸¾é¡¹(æ„é€ å™¨å‚æ•°åˆ—è¡¨)` ã€‚
> - Javaçš„æšä¸¾éƒ½æœ‰ä¸ªoriginalæ–¹æ³•ï¼Œå®ƒè¿”å›çš„æ˜¯è¯¥æšä¸¾é¡¹çš„åºå·ï¼Œä¸”å›ºå®šé¡ºåºä¸º0ã€1ã€2...ã€‚ä»æ¦‚å¿µã€ç”¨æ³•æ¥è®²ï¼Œå®ƒå¹¶ä¸ç­‰åŒäºC#æ„ä¹‰ä¸Šçš„æšä¸¾å€¼ã€‚
> - C#æ”¯æŒä½æšä¸¾ï¼Œè€ŒJavaä¸æ”¯æŒã€‚ï¼ˆé©¬ä¸Šæˆ‘ä»¬ä¼šè®²åˆ°ä½æšä¸¾ã€‚ï¼‰
> - æœ€ååˆæ˜¯ä¹ æƒ¯é—®é¢˜ã€‚C#çš„æšä¸¾é¡¹ä¸€èˆ¬ä»æ—§æŒ‰ç…§Pascalè§„åˆ™å‘½åï¼Œè€ŒJavaçš„æšä¸¾é¡¹ä¹ æƒ¯äºå…¨å¤§å†™å­—æ¯ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿è¿æ¥ã€‚

> C#å’ŒJavaçš„æšä¸¾ï¼Œå¯ä»¥è¯´å„æœ‰ä¼˜åŠ£ã€‚
>
> - C#çš„æšä¸¾å¯ä»¥ç›´æ¥ç”¨æ¥æ¥æ”¶æ•°æ®åº“ã€WebApiä¼ å…¥ä¼ å‡ºå‚æ•°ç­‰ä¸­intçš„å€¼ï¼Œä½¿å…¶åœ¨ç¨‹åºä»£ç å†…è¢«èµ‹äºˆæ˜ç¡®çš„æšä¸¾å«ä¹‰ã€‚è€ŒJavaè¦æŠŠæ•°æ®åº“å­—æ®µè½¬ä¸ºæšä¸¾éœ€è¦æ›´å¤šé¢å¤–æ“ä½œã€‚
> - Javaçš„æšä¸¾é¡¹å¯ä»¥æºå¸¦æ›´å¤šä¿¡æ¯ï¼Œä¾‹å¦‚å¯ä»¥åŒæ—¶åŒ…å«ä¸€ä¸ªintç±»å‹çš„idã€ä¸€ä¸ªStringç±»å‹çš„nameã€‚è¿™åœ¨ç‰¹å®šåœºæ™¯ä¸‹ååˆ†å¥½ç”¨ã€‚è€ŒC#çš„æšä¸¾åªæœ‰æ•´æ•°ä¿¡æ¯ï¼Œå¦‚æœè¦é™„å¸¦å…¶ä»–ä¿¡æ¯éœ€è¦é€šè¿‡ä¸­æ–‡æšä¸¾åï¼ˆä¸ºäº†ä½¿ç”¨ToStringï¼Œä¸æ¨èï¼‰ã€ç¼–å†™æ‰©å±•æ–¹æ³•ï¼ˆC#3.0ï¼‰ã€ä½¿ç”¨Dictionaryæ˜ å°„ã€å°è£…Structç­‰æ‰‹æ®µã€‚

> é¢å¤–To CShaper â€”â€” Javaçš„æšä¸¾é•¿è¿™æ ·ï¼š
>
> ```java
> //==Java==
> public enum StatusCode { //å®šä¹‰æšä¸¾
>     SUCCESS, DATABASE_ERROR, SYSTEM_ERROR; //æšä¸¾é¡¹ï¼Œæ­¤å¤„åˆ†å·å¯ä»¥çœç•¥
> }
> ```
>
> æˆ–è€…ï¼š
>
> ```java
> //==Java==
> public enum StatusCode { //å®šä¹‰æšä¸¾
>     SUCCESS(0), DATABASE_ERROR(1), SYSTEM_ERROR(2); //æšä¸¾é¡¹ï¼Œè°ƒç”¨æ„é€ å™¨ã€‚å› ä¸ºä¸‹é¢è¿˜æœ‰å®šä¹‰å†…å®¹ï¼Œæ­¤å¤„åˆ†å·ä¸èƒ½çœç•¥
>     // æˆå‘˜å­—æ®µ
>     private int statusCodeValue;
>     // æ„é€ å™¨ï¼ˆæ³¨æ„ï¼Œæšä¸¾çš„æ„é€ å™¨åªèƒ½æ˜¯ç§æœ‰çš„ï¼‰ï¼Œæšä¸¾ä¸å¯ä»¥newï¼Œåªèƒ½ä½¿ç”¨å·²å®šä¹‰çš„é¡¹
>     private StatusCode(int statusCodeValue) {
>       this.statusCodeValue = statusCodeValue;
>     }
>     //å­—æ®µå€¼çš„getæ–¹æ³•
>     public int getStatusCodeValue() {
>         return statusCodeValue;
>     }
> }
> ```
>
> ä½¿ç”¨
>
> ```java
> //==Java==
> StatusCode code = StatusCode.SUCCESS;
> StatusCode cod2 = StatusCode.valueOf("SYSTEM_ERROR");
> boolean eq = code == code2;  //å› ä¸ºæšä¸¾é¡¹æ˜¯å¸¸é‡ï¼Œæ‰€ä»¥==ä¹Ÿå¯ä»¥ç”¨äºåˆ¤æ–­ç›¸ç­‰
> ```

C#è¿˜æ”¯æŒ**ä½æšä¸¾**:

ä½æšä¸¾ä¸€èˆ¬æ¯ä¸ªæšä¸¾é¡¹éƒ½æ˜¯2çš„æ•´æ¬¡å¹‚ã€‚

è™½ç„¶ä¸æ˜¯å¿…é¡»ï¼Œä½†æ˜¯å®šä¹‰ä½æšä¸¾æ—¶ï¼Œä¸€èˆ¬æ·»åŠ `FlagsAttribute`ç‰¹æ€§ã€‚è¿™æ ·ä¼šå½±å“ToStringçš„è¾“å‡ºã€‚

ä½æšä¸¾å¯ä»¥æ–¹ä¾¿å•ä¸ªæšä¸¾å˜é‡åŒæ—¶åŒ…å«å¤šä¸ªæšä¸¾é¡¹ã€‚æ–¹æ³•æ˜¯ä½¿ç”¨æŒ‰ä½ä¸è¿ç®—ç¬¦`|`æ¥åˆå¹¶æšä¸¾é¡¹ã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨æšä¸¾ç±»å‹å†…å°çš„HasFlagæ–¹æ³•ï¼Œè½»æ¾åˆ¤æ–­æšä¸¾å˜é‡æ˜¯å¦åŒ…å«äº†ç‰¹å®šä½æšä¸¾é¡¹ï¼š

```c#
[Flags]
public enum Operation //å®šä¹‰ä½æšä¸¾
{
    Add = 0x01,
    Modify = 0x02,
    Remove = 0x04,
    Execute = 0x08
}
//...
Operation operation = Operation.Execute | Operation.Add; //èµ‹å€¼ä½æšä¸¾ä¸ºå¤šä¸ªå€¼
Console.WriteLine(operation.ToString());  //è¾“å‡ºä¸º Add, Executeã€‚å¦‚æœæœªæ ‡è®°FlagsAttributeï¼Œåˆ™è¾“å‡ºä¸º 9
bool haveRemove = operation.HasFlag(Operation.Remove); //æŸ¥è¯¢ä½æšä¸¾æ˜¯å¦åŒ…å«æšä¸¾é¡¹
```

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šä»»ä½•æšä¸¾éƒ½å¯ä»¥ä½¿ç”¨HasFlagæ–¹æ³•ï¼Œå³ä½¿æœªæ ‡æ³¨ `FlagsAttribute` ã€‚

### å¼•ç”¨ç±»å‹ï¼ˆReference Typeï¼‰

#### æ•°ç»„ï¼ˆArrayï¼‰

æ•°ç»„æ˜¯å¼•ç”¨ç±»å‹çš„ã€‚å› è€ŒC#çš„æ•°ç»„ä¸C++ä¸åŒï¼Œå®ƒè¢«åˆ†é…åœ¨å †ç©ºé—´ä¸Šï¼Œè€Œä¸æ˜¯æ ˆç©ºé—´ä¸Šã€‚æ•°ç»„çš„åˆå§‹åŒ–ä¹Ÿä½¿ç”¨newå…³é”®è¯ã€‚è¿™ç‚¹ä¸Javaä¸€è‡´ã€‚

æ•°ç»„éšå¼ç»§æ‰¿è‡ªArrayç±»ï¼Œå› è€ŒArrayå…·æœ‰çš„æ–¹æ³•ã€[å±æ€§](#å±æ€§ï¼ˆPropertyï¼‰)ç­‰ï¼Œæ•°ç»„éƒ½å¯ä»¥ç”¨ã€‚æ¯”å¦‚Lengthå±æ€§ï¼Œç”¨äºè·å–æ•°ç»„é•¿åº¦ã€‚ä¸è¿‡ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨Arrayç±»æ¥å£°æ˜æ•°ç»„ã€‚

```c#
//ä¸€ç»´æ•°ç»„
int[] t = new int[10];
t[0] = 1;

//äºŒç»´çŸ©å½¢æ•°ç»„
int[,] a = new int[10,10];
a[0,0] = 1;

//å¯å˜é•¿åº¦çš„äºŒç»´æ•°ç»„
int [][] b = new int[10][];
b[0] = new int[10];
b[1] = new int[6];
b[0][0] = 1;
```

> ä¸Javaä¸åŒï¼ŒC#å®šä¹‰æ•°ç»„æ—¶ï¼Œ[]åªèƒ½æ”¾åˆ°å˜é‡åå‰é¢ã€‚è€ŒJavaåˆ™æ—¢å¯ä»¥æ”¾åœ¨å‰é¢ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨åé¢ã€‚
>
> - `byte [] bytes= new byte[100]; //åˆæ³•`
> - `byte bytes [] = new byte[100]; //ä¸åˆæ³•`

#### ç±»ï¼ˆClassï¼‰

##### ç±»çš„ç»§æ‰¿

C#çš„ç»§æ‰¿ä½¿ç”¨`:`

> Javaä½¿ç”¨`extends`å…³é”®è¯

C#ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼ˆå®ç°æ¥å£æ•°é‡åˆ™ä¸é™åˆ¶ï¼‰ï¼Œè¿™ç‚¹ä¸C++ä¸åŒï¼Œä½†æ˜¯ä¸Javaä¸€è‡´ã€‚

##### åµŒå¥—ç±»

ç±»æ”¯æŒåµŒå¥—ï¼Œä¸”åµŒå¥—ç±»æ”¯æŒprotectedã€privateç­‰ä¿®é¥°ç¬¦

```c#
public class AA
{
    public class BB //publicçš„åµŒå¥—ç±»ï¼Œå…¶ä»–ç±»é‡Œå¯è§
    {
    }
    protected class CC //protectedçš„åµŒå¥—ç±»ï¼Œä»…å…¶æ´¾ç”Ÿç±»å¯è§
    {
    }
}
public class DD
{
    public AA.BB bb; //ok
    public AA.CC cc; //not okï¼Œç¼–è¯‘å™¨æŠ¥é”™
}
```

### æ–¹æ³•ï¼ˆMethodï¼‰

æ–¹æ³•ä¸å‡½æ•°ã€è¿‡ç¨‹æ˜¯åŒä¹‰è¯ï¼Œæ˜¯ç±»æˆ–ç»“æ„çš„æˆå‘˜ï¼Œç”¨äºæè¿°ä¸€æ®µæ‰§è¡Œè¿‡ç¨‹ï¼Œå¹¶è¿”å›æˆ–è€…ä¸è¿”å›ç»“æœã€‚

C#çš„å‘½åè§„èŒƒä¸­ï¼Œæ–¹æ³•åä»¥å¤§å†™å¼€å¤´ï¼ˆå³Pascalå‘½åæ³•ï¼‰

> Javaç¼–ç è§„èŒƒä¸­ï¼Œæ–¹æ³•åæ˜¯å°å†™å­—æ¯å¼€å¤´ï¼ˆé©¼å³°å‘½åæ³•ï¼‰ã€‚

#### æ–¹æ³•çš„å‚æ•°

##### outå’Œrefå…³é”®è¯

C#çš„æ–¹æ³•ï¼Œæ”¯æŒ`out`å’Œ`ref`ä¸¤ä¸ªç‰¹æ®Šä¿®é¥°ç¬¦ï¼Œæ¥ä¿®é¥°å‚æ•°ã€‚

è™½ç„¶è¯­æ³•ä¸Šå¹¶ä¸ç¦æ­¢è¿™ä¸¤ä¸ªå…³é”®è¯ç”¨äºå¼•ç”¨ç±»å‹ï¼Œä½†æ˜¯å®é™…ä¸Šå®ƒå‡ ä¹åªè¢«ç”¨äºå€¼ç±»å‹ã€‚

å®ƒä»¬è¡¨æ˜ï¼Œä¼ é€’å‚æ•°æ—¶ï¼Œä¸åº”å¤åˆ¶å€¼ï¼Œè€Œæ˜¯ä¼ é€’å€¼å˜é‡çš„å¼•ç”¨ã€‚

ä¼ é€’ä¸º`out`å’Œ`ref`å‚æ•°ï¼Œå¿…é¡»æ˜¯å·¦å€¼ç±»å‹çš„ã€‚æ‰€è°“**å·¦å€¼ç±»å‹**ï¼Œæ˜¯æŒ‡å¯ä»¥è¢«æ”¾åœ¨èµ‹å€¼å·`=`çš„å·¦ä¾§â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œåªèƒ½æ˜¯å˜é‡ï¼ˆunsafeæ¨¡å¼ä¸‹è¿˜å¯ä»¥æ˜¯æŒ‡é’ˆå–å€¼è¡¨è¾¾å¼ï¼‰ã€‚

- `out`è¡¨ç¤ºè¾“å‡ºå‚æ•°ï¼Œè¡¨æ˜è¯¥æ–¹æ³•ä¼šå°†æ­¤å‚æ•°ä½œä¸ºè¾“å‡ºã€‚outå‚æ•°ä¼ å…¥æ–¹æ³•å‰ä¸å¿…èµ‹åˆå§‹å€¼ã€‚å¯¹äºåŒ…å«outå‚æ•°çš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥æ–¹æ³•ä½“å†…æ¯ä¸ªåˆ†æ”¯è·¯å¾„ï¼Œç¡®ä¿æ¯ä¸€æ¡åˆ†æ”¯åœ¨returnä¹‹å‰éƒ½å¯¹æ­¤å‚æ•°åšäº†èµ‹å€¼ã€‚å¦‚æœæœ‰åˆ†æ”¯è·¯å¾„æ²¡æœ‰èµ‹å€¼ï¼Œä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥å‡ºç¼–è¯‘é”™è¯¯ã€‚è¿™è·Ÿæ£€æŸ¥æ¯ä¸ªåˆ†æ”¯è·¯å¾„éƒ½æœ‰returnè¯­å¥ä¸€æ ·ã€‚
- `ref`è¡¨ç¤ºå¼•ç”¨å‚æ•°ã€‚æ–¹æ³•ä½“å†…å¯ä»¥å¯¹è¯¥å˜é‡å€¼è¿›è¡Œèµ‹å€¼ï¼Œå¹¶å®é™…æ”¹å˜è°ƒç”¨æ—¶ä¼ é€’å¾—å˜é‡çš„å€¼ã€‚refå˜é‡ä¸è¦æ±‚ä¸€å®šè¦åœ¨æ–¹æ³•ä½“å†…æ›´æ”¹ï¼Œä¹Ÿä¸ä¼šåšåˆ†æ”¯è·¯å¾„æ£€æŸ¥ã€‚ä½œä¸ºrefå‚æ•°çš„å˜é‡ï¼Œåœ¨ä¼ å…¥æ–¹æ³•ä¹‹å‰ï¼Œå¿…é¡»å·²ç»èµ‹å€¼ã€‚

å…·æœ‰`out`å’Œ`ref`ä¿®é¥°çš„å‚æ•°ï¼Œåœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå‚æ•°å‰ä¹Ÿå¿…é¡»æ˜¾å¼æ·»åŠ `out`å’Œ`ref`å…³é”®è¯

```c#
//å®˜æ–¹åº“ä¸­intçš„TryParseæ–¹æ³•å®šä¹‰
public struct Int32 
{
    public static bool TryParse(string str, out int outValue);
}
//ä½¿ç”¨ï¼š
int value; //ä¸å¿…èµ‹åˆå€¼
bool success = int.TryParse("1", out value); //valueçš„å€¼ç”±æ–¹æ³•è¾“å‡º
Console.WriteLine(value); //è¾“å‡ºä¸º 1
```

> Javaä¸æ”¯æŒä¸Šè¿°ç‰¹æ€§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è‡ªå·±å®šä¹‰ä¸€ä¸ªç±»å®ç°åŒ…è£…å™¨çš„åŠŸèƒ½ï¼Œä»è€Œå˜ç›¸å®ç°å¼•ç”¨ä¼ é€’ã€‚æ³¨æ„ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„åŒ…è£…ç±»ï¼Œå› ä¸ºIntegerç­‰åŒ…è£…ç±»å†…çš„æ•°æ®æ˜¯åªè¯»çš„ã€‚

##### å‚æ•°é»˜è®¤å€¼

åƒC++ä¸€æ ·ï¼ŒC#æ”¯æŒå‚æ•°çš„é»˜è®¤å€¼ã€‚

æœ‰é»˜è®¤å€¼çš„å‚æ•°ï¼Œåœ¨æ–¹æ³•è°ƒç”¨æ—¶å¯ä»¥çœç•¥ã€‚

```c#
public class Class
{
    public List<Student> GetStudents(int limit = 20) //limitå«é»˜è®¤å€¼20
    {
        //çœç•¥
    }
}
//ä½¿ç”¨ï¼š
Class oneClass = new Class();
List<Student> students = oneClass.GetStudents(); //å¯ä»¥ä¸æŒ‡å®šlimitå€¼
```

> Javaä¸æ”¯æŒå‚æ•°é»˜è®¤å€¼ã€‚å› è€Œæƒ³è¦å®ç°å°‘ä¼ å‚æ•°çš„ç®€å†™å½¢å¼ï¼Œåªèƒ½é€šè¿‡æ–¹æ³•é‡è½½ã€‚
> > äº‹å®ä¸Šï¼Œåç»­C#è¿˜æ”¯æŒäº†ä»¥å‘½åçš„å½¢å¼æŒ‡å®šå‚æ•°çš„å€¼ï¼Œè€Œå¯¹äºæœªæŒ‡å®šå€¼çš„æœ‰é»˜è®¤å€¼çš„å‚æ•°ä½¿ç”¨é»˜è®¤å€¼ã€‚è¿™ä¸ªç‰¹æ€§è¢«ç§°ä¸º[å¯é€‰å‚æ•°](#å¯é€‰å‚æ•°ï¼ˆOptional%20Argumentï¼‰)ï¼ˆC# 4.0å¼•å…¥ï¼‰ã€‚è€ŒJavaè¯­æ³•æ— æ³•æ”¯æŒæ­¤æ“ä½œã€‚

##### å¯å˜å‚æ•°

C#ä½¿ç”¨paramså…³é”®è¯æ ‡è®°å¯å˜æ•°é‡çš„å‚æ•°

paramsåªèƒ½ä¿®é¥°æ•°ç»„ç±»å‹

```c#
//å®˜æ–¹åº“å…³äºstringçš„Formatæ–¹æ³•çš„å®šä¹‰
public class String 
{
    public static string Format(stirng format, params object[] args);
}
//ä½¿ç”¨
string.Format("ä½ å¥½"); //0ä¸ªå¯å˜å‚æ•°
string.Format("ä½ å¥½ï¼Œ{0}", "å¸…å“¥"); //1ä¸ªå¯å˜å‚æ•°
string.Format("ä½ å¥½ï¼Œ{0}ã€‚ç°åœ¨æ˜¯{1}å¹´ã€‚ä»Šæ—¥å¤©æ°”ï¼š{2}ã€‚å‡ºè¡Œå»ºè®®ï¼š{3}ã€‚", "å¸…å“¥", 2021, "æ™´", "é€‚åˆå‡ºå»æµª"); //4ä¸ªå¯å˜å‚æ•°
```

> Javaå¯å˜å‚æ•°çš„å…³é”®è¯ä¸º`...`ã€‚ä»–ä»¬åœ¨è¯­æ³•ä¸Šçš„åŒºåˆ«ï¼š
>
> 1. C#å£°æ˜å¯é€‰å‚æ•°æ—¶ï¼Œéœ€è¦æ­£å¸¸å¸¦ä¸Š`[]`ç¬¦å·ï¼Œè¡¨ç¤ºè¯¥å‚æ•°æ˜¯ä¸ªæ•°ç»„ã€‚è€ŒJavaï¼Œè™½ç„¶å¯é€‰å‚æ•°å˜é‡å®é™…ä¸ºæ•°ç»„ç±»å‹ï¼Œä½†æ˜¯å£°æ˜æ—¶ä¸å¸¦ä¸Š`[]`ç¬¦å·ã€‚
> 2. C#çš„paramsæ”¾åœ¨ç±»å‹å‰é¢ï¼Œè€ŒJavaçš„`...`æ”¾åœ¨ç±»å‹åé¢ã€‚

#### æ„é€ å™¨ï¼ˆConstructorï¼‰ã€ç»ˆç»“å™¨ï¼ˆFinalizerï¼‰

æ„é€ æ–¹æ³•åˆå«æ„é€ å™¨ã€‚ç±»å’Œç»“æ„éƒ½å¯ä»¥æ‹¥æœ‰æ„é€ å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç±»å’Œç»“æ„éƒ½æ‹¥æœ‰æ— å‚æ•°çš„æ„é€ å™¨ã€‚ç±»å¦‚æœä¸»åŠ¨å£°æ˜äº†æ„é€ å™¨ï¼Œåˆ™é»˜è®¤çš„æ— å‚æ„é€ å™¨ä¼šè¢«åˆ é™¤ã€‚ç»“æ„åˆ™å§‹ç»ˆæ‹¥æœ‰æ— å‚æ„é€ å™¨ã€‚

##### é™æ€æ„é€ å™¨ï¼ˆStatic Constructorï¼‰

é™æ€æ„é€ æ–¹æ³•çš„è¯­æ³•æ˜¯`static ç±»å() { ... }`ã€‚å®ƒä¸èƒ½æ‹¥æœ‰å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼Œä¸èƒ½æŒ‡å®šè¿”å›ç±»å‹ã€‚å¹¶ä¸”ä¸èƒ½æ‹¥æœ‰å‚æ•°ã€‚

å®ƒä¼šè®¿é—®ç±»å‹çš„ä»»ä½•å¯è®¿é—®æˆå‘˜ä¹‹å‰è¢«æ‰§è¡Œã€‚

- åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨å¹¶è®¿é—®ä»»ä½•é™æ€æˆå‘˜ä¹‹å‰
- å®ä¾‹çš„æ„é€ å™¨è¢«æ‰§è¡Œä¹‹å‰

å®ƒåªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚

```c#
public class What
{
    static What()
    {
        Console.WriteLine("ä½œç”š");
    }
    
    public What()
    {
        Console.WriteLine("å¹²å•¥");
    }
}

What what = new What();  //å…ˆæ‰“å° ä½œç”šï¼Œå†æ‰“å° å¹²å•¥
What what2 = new What(); //åªä¼šæ‰“å° å¹²å•¥
```

æ³¨æ„ï¼šä»…ä»…å£°æ˜Whatç±»å‹çš„å˜é‡whatï¼Œè€Œä¸ç”¨`new`åˆå§‹åŒ–ï¼Œæ˜¯ä¸ä¼šå¼•èµ·é™æ€æ„é€ å™¨è¢«è°ƒç”¨çš„ã€‚

é™æ€æ„é€ å™¨ä¸­æ— æ³•è®¿é—®éé™æ€æˆå‘˜ã€‚

> Javaçš„å«åšç±»åˆå§‹åŒ–å™¨ï¼ˆClass Initializerï¼‰ï¼Œå®ƒçš„è¯­æ³•æ˜¯`static { ... }`ã€‚åŠŸç”¨å®Œå…¨ä¸€è‡´ï¼Œè¯­æ³•æ›´åŠ ç®€æ´ã€‚

##### æ„é€ å™¨ä¸²è”

C#æ”¯æŒæœ¬ç±»æ„é€ å™¨æˆ–è€…åŸºç±»æ„é€ å™¨çš„ä¸²è”ï¼Œè¿™è¢«ç§°ä¸º**æ„é€ å™¨è°ƒç”¨**ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†å…¶å½¢è±¡çš„ç§°ä¸ºæ„é€ å™¨ä¸²è”ã€‚è¯­æ³•ä¸ºï¼šæ„é€ æ–¹æ³•å£°æ˜ä¹‹åã€æ–¹æ³•ä½“ä¹‹å‰ä½¿ç”¨`:this(å‚æ•°åˆ—è¡¨)`æˆ–è€…`:base(å‚æ•°åˆ—è¡¨)`

```c#
public class ArtBook : Book
{
    private string Name;
    public ArtBook()
        : base()    //baseä¸²è”ï¼Œè°ƒç”¨åŸºç±»æ„é€ æ–¹æ³•
    {
    }
}
public class NovelBook : Book
{
    private string Name;
    public NovelBook()
        : this("æ— å")  //thisä¸²è”ï¼Œè°ƒç”¨æœ¬ç±»å…¶ä»–æ„é€ æ–¹æ³•
    {
    }
    public NovelBook(string name)
    {
        Name = name;
    }
}
```

> Javaä¸­çš„æ„é€ å™¨è°ƒç”¨ä½¿ç”¨`super();`å’Œ`this();`è¯­å¥ï¼Œç›´æ¥åœ¨æ„é€ æ–¹æ³•ä½“å†…è°ƒç”¨ã€‚è™½ç„¶æ˜¯ç›´æ¥å†™è¿›æ–¹æ³•ä½“å†…çš„è¯­å¥ï¼Œä½†è§„å®šäº†åªèƒ½æ”¾åœ¨ç¬¬ä¸€å¥ï¼Œå› æ­¤ä¸C#çš„æœºç†å¹¶æ— ä¸åŒã€‚å¯¹æ¯”ä¹‹ä¸‹ï¼ŒC#çš„å†™æ³•æ›´å¥½çš„è¡¨è¾¾äº†å…¶è‡ªç„¶å«ä¹‰ã€‚

##### ç»ˆç»“å™¨ï¼ˆFinalizerï¼‰

ç±»ä¼¼äºC++ï¼ŒC#æ”¯æŒç±»çš„ææ„æ–¹æ³•ï¼Œåˆå«ç»ˆç»“å™¨ã€‚

ç»ˆç»“å™¨å‘½åä¸ºç±»åå‰é¢åŠ ä¸Š`~`

ç»ˆç»“å™¨ä¸èƒ½åŠ ä»»ä½•ä¿®é¥°ç¬¦ï¼ŒåŒ…æ‹¬publicã€privateç­‰ã€‚

ä¸€èˆ¬ä¸ä¼šå•ç‹¬é‡å†™ç»ˆç»“å™¨ã€‚å¦‚æœç±»ä¸­åŒ…å«éœ€è¦é‡Šæ”¾çš„èµ„æºï¼Œä¸€èˆ¬ä½¿ç”¨[IDisposableé‡Šæ”¾æ¨¡å¼](#IDisposableé‡Šæ”¾æ¨¡å¼)ã€‚

#### å¤šæ€ï¼ˆPolymorphismï¼‰

C#æ”¯æŒçš„å¤šæ€åŒ…æ‹¬**é‡è½½**(Overload)ã€**é‡å†™**(Overrideï¼Œåˆå«è¦†ç›–)å’Œ**éšè—**(Hidding)ï¼š

- é‡è½½
    1. åŒä¸€ä¸ªç±»ä¸­ï¼Œç›¸åŒæ–¹æ³•åï¼Œä¸åŒå‚æ•°çš„æ–¹æ³•é‡è½½ã€‚
    2. åŒä¸€ä¸ªç±»ä¸­ï¼Œç›¸åŒæ–¹æ³•åï¼Œå‚æ•°ä¹Ÿç›¸åŒï¼Œæ³›å‹å’Œéæ³›å‹çš„æ–¹æ³•é‡è½½ã€‚ï¼ˆC#2.0ä»¥åï¼‰
    3. åŒä¸€ä¸ªç±»ä¸­ï¼Œç›¸åŒæ–¹æ³•åï¼Œå‚æ•°ä¹Ÿç›¸åŒï¼Œæ³›å‹å‚æ•°æ•°é‡ä¸åŒçš„æ³›å‹çš„æ–¹æ³•é‡è½½ã€‚ï¼ˆC#2.0ä»¥åï¼‰
- é‡å†™
    - çˆ¶ç±»å£°æ˜ä¸º`virtual`çš„è™šæ–¹æ³•ï¼Œå­ç±»å¯ä»¥é€šè¿‡`override`å…³é”®è¯è¿›è¡Œé‡å†™ã€‚å¦‚æœæ²¡æœ‰æ ‡è®°ä¸ºè™šæ–¹æ³•ï¼Œåˆ™å­ç±»æ— æ³•å¯¹å…¶è¿›è¡Œé‡å†™ã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼šå¿…é¡»åŠ ä¸Š`override`å…³é”®è¯æ‰æ˜¯é‡å†™ï¼Œå¦åˆ™å°±æ˜¯éšè—ï¼Œè¯·å‚è€ƒä¸‹æ¡ã€‚
- éšè—
    - ä»»ä½•æ–¹æ³•ï¼ˆåŒ…æ‹¬`virtual`å’Œé`virtual`çš„æ–¹æ³•ï¼‰ï¼Œå­ç±»éƒ½å¯ä»¥å¯¹å…¶è¿›è¡Œéšè—ã€‚ä½¿ç”¨éšè—è¯­æ³•æ—¶ï¼Œçˆ¶ç±»çš„æ–¹æ³•æ²¡æœ‰è¢«è¦†ç›–ï¼Œè€Œæ˜¯è¢«éšè—äº†ã€‚åœ¨è°ƒç”¨åŒååŒå‚æ–¹æ³•æ—¶ï¼Œå¦‚æœè°ƒç”¨çš„å¯¹è±¡å£°æ˜ä¸ºå­ç±»å‹ï¼Œåˆ™æ­£å¸¸è°ƒç”¨å­ç±»å®šä¹‰çš„æ–¹æ³•ï¼›è€Œå¦‚æœå£°æ˜ä¸ºçˆ¶ç±»å‹ï¼Œä½†å®é™…ç±»å‹ä¸ºå­ç±»å‹ï¼Œåˆ™ä¼šå–æ¶ˆéšè—ï¼Œè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚
        - éšè—ä¸è¦æ±‚ä¸çˆ¶ç±»æ–¹æ³•æ‹¥æœ‰ä¸€æ ·çš„è®¿é—®çº§åˆ«ï¼Œä¹Ÿä¸è¦æ±‚å…¶è¿”å›ç±»å‹å¿…é¡»ç›¸åŒã€‚
        - éšè—ä¸€èˆ¬ä½¿ç”¨`new`å…³é”®è¯ä¿®é¥°æ–¹æ³•ã€‚è™½ç„¶`new`å¯ä»¥çœç•¥ï¼Œä½†æ˜¯ä»å¼ºçƒˆå»ºè®®æ˜¾å¼åŠ ä¸Š`new`ï¼Œä»¥æé«˜ä»£ç å¯è¯»æ€§ã€‚

ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸¾ä¾‹ï¼Œçœ‹çœ‹å­ç±»å¯¹çˆ¶ç±»çš„æ–¹æ³•é‡å†™å’Œéšè—çš„åŒºåˆ«ï¼š

```c#
public class Book
{
    public virtual int GetPage() //å£°æ˜ä¸ºè™šæ–¹æ³•
    {
        return 0;
    }
}
public class NovelBook : Book 
{
    public override int GetPage() //é‡å†™çˆ¶ç±»æ–¹æ³•
    {
        return 1;
    }
}
public class MathBook : Book
{
    public new int GetPage() //éšè—è€Œä¸è¦†ç›–çˆ¶ç±»æ–¹æ³•ï¼Œæ­¤å¤„å…³é”®è¯newå¯ä»¥çœç•¥ï¼Œä½†æ¨èåŠ ä¸Š
    {
        return 2;
    }
}
```

ç„¶åï¼Œæˆ‘ä»¬çœ‹çœ‹è°ƒç”¨ï¼š

```c#
Book oneBook;

NovelBook novelBook = new NovelBook(); //NovelBookçš„GetPageæ–¹æ³•æ˜¯é‡å†™
oneBook = novelBook;
Console.WriteLine(novelBook.GetPage()); //è¾“å‡º 1
Console.WriteLine(oneBook.GetPage());   //è¾“å‡º 1

MathBook mathBook = new MathBook();  //MathBookçš„GetPageæ–¹æ³•æ˜¯éšè—
oneBook = mathBook;
Console.WriteLine(mathBook.GetPage());  //è¾“å‡º 2
Console.WriteLine(oneBook.GetPage());   //è¾“å‡º 0
```

å¯è§ï¼š

- è°ƒç”¨é‡å†™çš„æ–¹æ³•ï¼Œä¼šæ ¹æ®è°ƒç”¨å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè°ƒç”¨å…¶ç±»å‹çš„é‡å†™æ–¹æ³•ã€‚å­ç±»å¯¹è±¡å’Œèµ‹å€¼ä¸ºå­ç±»å¯¹è±¡çš„çˆ¶ç±»å¯¹è±¡ï¼Œè°ƒç”¨çš„éƒ½æ˜¯å­ç±»çš„æ–¹æ³•ã€‚ä¸Šä¾‹ä¸­ï¼ŒnovelBookå¯¹è±¡å’ŒoneBookå¯¹è±¡ï¼Œè°ƒç”¨çš„éƒ½æ˜¯å­ç±»NovelBookå®šä¹‰çš„æ–¹æ³•ã€‚
- è°ƒç”¨éšè—çš„æ–¹æ³•ï¼Œä¼šæ ¹æ®å½“å‰å¯¹è±¡çš„å£°æ˜ç±»å‹ï¼Œè°ƒç”¨å£°æ˜ç±»å‹çš„æ–¹æ³•ã€‚æ­¤æ—¶ï¼Œå­ç±»å¯¹è±¡è°ƒç”¨çš„ä¸ºå­ç±»çš„æ–¹æ³•ï¼Œèµ‹å€¼ä¸ºå­ç±»å¯¹è±¡çš„çˆ¶ç±»å¯¹è±¡è°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„æ–¹æ³•ã€‚ä¸Šä¾‹ä¸­ï¼ŒmathBookå¯¹è±¡è°ƒç”¨çš„æ˜¯MathBookå®šä¹‰çš„æ–¹æ³•ï¼Œè€ŒoneBookå¯¹è±¡è°ƒç”¨çš„æ˜¯Bookä¸­å®šä¹‰çš„æ–¹æ³•ã€‚

ä¸è¿‡ï¼Œæ— è®ºé‡å†™è¿˜æ˜¯éšè—ï¼Œå…¶å†…éƒ¨å‡å¯ä»¥ä½¿ç”¨`base.æ–¹æ³•`æ¥è°ƒç”¨åŸºç±»çš„æ–¹æ³•ã€‚

PSï¼šä¸Šè¿°é‡å†™å’Œéšè—æè¿°çš„éƒ½æ˜¯éé™æ€çš„æ–¹æ³•ã€‚é™æ€æ–¹æ³•æ— æ³•è¢«é‡å†™ï¼Œæ‰€ä»¥å®é™…ä¸Šåªèƒ½è¢«éšè—ã€‚

> Javaæ²¡æœ‰`virtual`å’Œ`override`å…³é”®è¯ã€‚ä½†æ˜¯ï¼ŒJavaçš„æ–¹æ³•è¢«è®¾è®¡æˆé»˜è®¤å°±æ˜¯è™šçš„ã€‚ç›´æ¥åœ¨å­ç±»ä¸­å®šä¹‰å¯¹çˆ¶ç±»æ–¹æ³•çš„é‡å†™å³å¯ã€‚ä½†ä¹Ÿå¯ä»¥é€šè¿‡`@Override`æ³¨è§£ï¼Œæ¥æ ‡æ³¨å­ç±»çš„æ–¹æ³•æ˜¯é‡å†™æ–¹æ³•ã€‚æ ‡æ³¨æ­¤æ³¨è§£åŒæ ·å¯ä»¥å®ç°ç¼–è¯‘é˜¶æ®µçš„æ£€æŸ¥åŠŸèƒ½ï¼Œä»¥ç¡®ä¿çˆ¶ç±»åŒ…å«æ­¤æ–¹æ³•ã€‚(Javaçš„æ³¨è§£ä¸C#çš„ç‰¹æ€§æ˜¯åŒä¹‰è¯)

> Javaæ²¡æœ‰C#æ„ä¹‰ä¸Šçš„æ–¹æ³•éšè—æœºåˆ¶ã€‚ä½†æ˜¯åŒæ ·å¯ä»¥å®ç°é™æ€æ–¹æ³•çš„éšè—ã€‚

### å±æ€§ï¼ˆPropertyï¼‰

å±æ€§ï¼Œæ˜¯C#1.0å¯¹Javaçš„ä¸€ä¸ªè¾ƒä¸ºæ˜æ˜¾çš„ä¼˜åŒ–ã€‚

> å¯¹äºJavaçš„ç±»ï¼Œä¸ºäº†æå‡å¯æ§æ€§ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç›´æ¥å°†å­—æ®µæ ‡è®°ä¸º`public`ï¼Œæš´éœ²ç»™å¤–ç•Œæ“ä½œã€‚æˆ‘ä»¬ä¼šå°†å­—æ®µæ ‡è®°ä¸º`private`ã€`protected`ï¼Œé€šè¿‡æš´éœ²publicçš„getå’Œsetæ–¹æ³•æ¥è·å–å’Œè®¾ç½®è¯¥å­—æ®µã€‚è¿™æ ·åšå¯ä»¥æ–¹ä¾¿è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€æƒé™æ§åˆ¶ä»¥åŠæ‰§è¡Œé¢å¤–æ“ä½œã€‚
>
> ä¾‹å¦‚ï¼š
>
> ```java
> //==Java==
> public class Person
> {
>     private String name;
>     public void setName(String name) {
>         this.name = name;
>     }
>     public String getName() {
>         return this.name;
>     }
> }
> ```

è€ƒè™‘åˆ°getã€setæ¨¡å¼çš„é€šç”¨æ€§ï¼ŒC#æå‡ºäº†ä¸€ç§æ–°çš„æˆå‘˜ç±»å‹ï¼šå±æ€§ï¼Œç”¨äºç­‰ä»·æ›¿ä»£ä¸Šè¿°æ¨¡å¼ã€‚

ä¸Šè¿°åŠŸèƒ½ï¼Œç”¨å±æ€§å®ç°é•¿è¿™æ ·ï¼š

```c#
public class Person
{
    private string name;
    public string Name
    {
        get { return name; }  //getter
        set { name = value; } //setter
    }
}
```

ä¸Šè¿°ä»£ç ä¸­ï¼ŒNameå°±æ˜¯ä¸€ä¸ªstringç±»å‹çš„å±æ€§ã€‚å…¶ä¸­ï¼Œ`get`å’Œ`set`æ–¹æ³•è¢«ç§°ä¸º**è®¿é—®å™¨**ã€‚å®ƒä»¬åˆåˆ†åˆ«è¢«ç§°ä¸ºgetterå’Œsetterï¼Œå®ç°äº†ä¸Javaä¸­ä½¿ç”¨getå’Œsetæ–¹æ³•æ“ä½œå­—æ®µä¸€æ ·çš„åŠŸèƒ½ã€‚

åœ¨setterä¸­ï¼Œå¯ä»¥ä½¿ç”¨`value`å…³é”®è¯ï¼Œæ¥æŒ‡ä»£è¦èµ‹å€¼çš„å†…å®¹ã€‚

ç”±äºå±æ€§æœ¬è´¨ä¸Šç­‰ä»·äºgetå’Œsetæ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥è§†ä½œæ–¹æ³•ã€‚å±æ€§å¯ä»¥å‡ºç°åœ¨æ¥å£ä¸­ï¼Œä¹Ÿèƒ½è¢«å­ç±»é‡å†™ï¼ˆOverrideï¼‰å’Œéšè—ã€‚

ä»è¯­æ³•ä¸Šï¼Œå±æ€§å¸¦æ¥äº†æ›´å¤šä¾¿æ·ã€‚ä½¿ç”¨å±æ€§æ—¶ï¼Œè¯­æ³•å½¢æ€è·Ÿç›´æ¥ä½¿ç”¨å­—æ®µç±»ä¼¼ï¼š

```c#
person.Name = "ä½ å¥½"; //è°ƒç”¨setterï¼Œç»™å±æ€§èµ‹å€¼
string name = person.Name; //è°ƒç”¨getter
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå±æ€§éœ€è¦é€šè¿‡èƒŒåçš„å®ç°å­—æ®µæ¥è¿›è¡Œèµ‹å€¼å’Œè·å–æ“ä½œã€‚å¦‚æœåœ¨å±æ€§çš„`get`ã€`set`æ–¹æ³•ä¸­æ“ä½œå±æ€§æœ¬èº«ï¼Œå¯èƒ½ä¼šå¼•èµ·æ— é™é€’å½’ã€‚

C#3.0å¼•å…¥äº†[è‡ªåŠ¨å®ç°çš„å±æ€§](#è‡ªåŠ¨å±æ€§ï¼ˆAuto-Implemented%20Propertyï¼‰)ï¼Œè‡ªåŠ¨å±æ€§æ‰æ˜¯å±æ€§çš„æœ€å¸¸è§å®šä¹‰æ–¹å¼ã€‚

> å¯¹æ¯”Javaï¼š
>
> - å±æ€§ç»™ä¸äº†C#æ›´åŠ ç®€æ´çš„è¯­æ³•ã€‚æ—¢ç®€åŒ–äº†getå’Œsetæ–¹æ³•çš„å®šä¹‰ï¼Œåˆåœ¨ä½¿ç”¨æ—¶é¿å…äº†Javaé‚£æ ·çš„å¤§é‡çš„åœ†æ‹¬å·ï¼Œä»£ç æ›´ä¸ºç¾è§‚ã€‚
> - æ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œå±æ€§å¯ä»¥ä½œä¸ºè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œä½¿å¾—å±æ€§å¯ä»¥åµŒå…¥åˆ°æ›´å¤šåœºæ™¯ä¸­ã€‚å…·ä½“è¯´æ¥ï¼Œåœ¨ä½¿ç”¨å±æ€§çš„setteræ—¶ï¼ˆä»£ç è¡¨ç°ä¸ºèµ‹å€¼è¡¨è¾¾å¼ï¼‰ï¼Œè¡¨è¾¾å¼ä»å…·æœ‰è¿”å›å€¼ï¼ˆå³èµ‹å€¼è¡¨è¾¾å¼çš„å€¼ï¼‰ã€‚
> - åœ¨åç»­C#æ”¯æŒçš„[åˆå§‹åŒ–å™¨](#åˆå§‹åŒ–å™¨ï¼ˆInitializerï¼‰)ï¼ˆC#2.0å¼•å…¥ï¼‰ç­‰è¯­æ³•ä¸­ï¼Œå› ä¸ºæœ‰å±æ€§çš„å­˜åœ¨ï¼Œä¹Ÿä½¿å¾—åˆå§‹åŒ–å¯¹è±¡æ—¶ä»£ç ç®€æ´ä¸å°‘ã€‚è¿™åœ¨å¤šé‡åµŒå¥—çš„æƒ…å†µä¸‹å°¤ä¸ºæ˜æ˜¾ã€‚è€ŒJavaè™½ç„¶æœ‰åŒæ‹¬å·åˆå§‹åŒ–è¯­æ³•ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨ï¼Œè€Œä¸”ä»£ç ä¹Ÿè¦å•°å—¦çš„å¤šã€‚

## æ¥å£ï¼ˆInterfaceï¼‰

C#çš„æ¥å£ä¹ æƒ¯äºä»¥å•ä¸ªå¤§å†™å­—æ¯Iä½œä¸ºå‰ç¼€ã€‚è€Œæ¥å£çš„å®ç°ç±»ï¼Œä¸€èˆ¬æ²¡æœ‰å›ºå®šå‰åç¼€ã€‚

> ä½œä¸ºå¯¹æ¯”ï¼Œä¸€èˆ¬Javaçš„æ¥å£åæ— å›ºå®šå‰åç¼€ã€‚è€Œæ¥å£å®ç°ç±»ï¼Œä¹ æƒ¯åŠ Implåç¼€ã€‚

æ¥å£çš„å®ç°ï¼Œè¯­æ³•ä¸º`ç±»:æ¥å£`ï¼Œä¸ç±»çš„ç»§æ‰¿ä½¿ç”¨ç›¸åŒçš„ç¬¦å·ã€‚

> Javaåˆ™ä½¿ç”¨äº†ä¸åŒçš„å…³é”®è¯ï¼Œç±»çš„ç»§æ‰¿ä¸º`extends`ï¼Œæ¥å£çš„å®ç°ä¸º`implement`ã€‚

è¿™é‡Œä»‹ç»ä¸¤ç»„æ¯”è¾ƒé‡è¦çš„æ¥å£ï¼š

### å¯é‡Šæ”¾æ¥å£ï¼ˆIDisposableï¼‰

IDisposableæŒ‡å®šäº†Disposeæ–¹æ³•ï¼Œç”¨äºé‡Šæ”¾èµ„æºã€‚

#### usingè‡ªåŠ¨é‡Šæ”¾è¯­å¥

å®ç°äº†IDisposableæ¥å£çš„ç±»å¯¹è±¡ï¼ŒC#åœ¨è¯­æ³•ä¸Šå…è®¸ä½¿ç”¨`using`è¯­å¥è‡ªåŠ¨é‡Šæ”¾ï¼š

```c#
using (FileStream fs = File.OpenRead("test.txt"))  //fsä¼šåœ¨usingå—ç»“æŸåè‡ªåŠ¨è°ƒç”¨Disposeæ–¹æ³•é‡Šæ”¾èµ„æº
{
    //çœç•¥
}
```

å®ƒç­‰ä»·äºä¸‹é¢çš„ä»£ç ï¼š

```c#
FileStream fs = File.OpenRead("test.txt");
try
{
    //çœç•¥
}
finally
{
    fs.Dispose();  //é‡Šæ”¾
}
```

éœ€è¦æ³¨æ„ï¼Œusingçš„æ‹¬å·å†…æ˜¯è¡¨è¾¾å¼ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¯é‡Šæ”¾çš„å¯¹è±¡ã€‚å› è€Œï¼Œusingå¹¶ä¸è¦æ±‚ä¸€å®šè¦åœ¨usingçš„åŒæ—¶å£°æ˜å˜é‡ï¼Œä¹Ÿå¯ä»¥usingå·²æœ‰çš„å¯¹è±¡ã€‚

```c#
FileStream fs = File.OpenRead("test.txt");
using (fs)   //åˆæ³•
{
    //çœç•¥
}
```

å¯¹äºå®ç°äº†IDisposableçš„ç±»ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨usingï¼Œä¹Ÿæ²¡æœ‰ä¸»åŠ¨è°ƒç”¨Disposeæ–¹æ³•ã€‚åˆ™ä¼šåœ¨å¤±å»æ‰€æœ‰å¼•ç”¨åï¼ŒäºGCå›æ”¶æ—¶è¢«é‡Šæ”¾ã€‚æ³¨æ„ï¼Œè¿™ç§æƒ…å†µä¸‹å…·ä½“çš„é‡Šæ”¾æ—¶æœºå¯èƒ½å˜å¾—ä¸å¯æ§ã€‚å¦‚æœç¨‹åºä¸­æœ‰å¾ªç¯ç­‰å¤§é‡äº§ç”Ÿèµ„æºçš„è¯­å¥ï¼ŒæœªåŠæ—¶çš„é‡Šæ”¾å¯èƒ½å¼•èµ·èµ„æºå› æ— æ³•åŠæ—¶å›æ”¶è€Œå¿«é€Ÿæ¶ˆè€—ï¼ˆä¾‹å¦‚TCPè¿æ¥ï¼‰ã€‚

> IDisaposableç›¸å½“äºJavaçš„AutoClosableæ¥å£

> usingè¯­å¥ç›¸å½“äºJavaçš„try-with-resourcesè¯­å¥ã€‚ä¸è¿‡ï¼Œä»–ä»¬ä¹Ÿæœ‰ç”¨æ³•çš„åŒºåˆ«
>
> - C#çš„usingè¯­å¥ï¼Œåœ†æ‹¬å·å†…ä¸ºè¡¨è¾¾å¼è€Œéè¯­å¥ã€‚å› æ­¤ï¼Œusingè¯­å¥çš„åœ†æ‹¬å·å†…åªèƒ½æŒ‡å®šä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœè¦åŒæ—¶å¯¹å¤šä¸ªå¯¹è±¡è‡ªåŠ¨é‡Šæ”¾ï¼Œéœ€è¦ä½¿ç”¨usingåµŒå¥—ã€‚ï¼ˆC#8.0ä»¥åæ”¯æŒæ›´ä¸ºç¾è§‚çš„å†™æ³•ï¼Œä½†å…¶æœ¬è´¨æ²¡æœ‰å˜åŒ–ï¼‰
> - Javaçš„try-with-resourcesï¼Œtryåé¢çš„åœ†æ‹¬å·ä¸ºå¤šä¸ªå£°æ˜äº†å¯é‡Šæ”¾èµ„æºçš„è¯­å¥ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªtryè¯­å¥å†…ä¸€æ¬¡æ€§åŒæ—¶æŒ‡å®šå¤šä¸ªèµ„æºåœ¨å—ç»“æŸåè‡ªåŠ¨é‡Šæ”¾ã€‚
> - C#æ—¢å¯ä»¥åœ¨usingæ‹¬å·å†…åŒæ­¥å£°æ˜å˜é‡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å·²å£°æ˜è¿‡çš„å˜é‡ã€‚è€ŒJavaåˆ™å¿…é¡»åœ¨tryæ‹¬å·å†…åŒæ­¥å£°æ˜èµ„æºï¼ˆåœ¨Java 9ä¹‹åï¼Œä¸å†æœ‰æ­¤é™åˆ¶ï¼‰ã€‚ 

> åœ¨è¿™ä¸€ç‚¹ä¸Šï¼ŒJavaæ¯”C#è¦æ›´çµæ´»ã€‚

> To CShaperï¼šJavaçš„è‡ªåŠ¨é‡Šæ”¾ç¤ºä¾‹
>
> ```java
> //==Java==
> try (
>     //åŒæ—¶é‡Šæ”¾ä¸¤ä¸ªèµ„æº
>     ZipFile zf = new ZipFile(zipPath);
>     BufferedWriter writer = Files.newBufferedWriter(outputPath, outputCharset); //æœ€åä¸€ä¸ªèµ„æºåé¢çš„åˆ†å·å¯ä»¥çœç•¥
> ) {
>     //çœç•¥
> } catch (IOException e) {
>     e.printStackTrace();
> }
> ```

#### IDisposableé‡Šæ”¾æ¨¡å¼

ä¸€èˆ¬åœ¨å®ç°IDisposableæ¥å£æ—¶ï¼Œä¸æ˜¯ç®€å•å®ç°Disposeæ–¹æ³•ï¼Œè€Œæ˜¯ä¼šéµå¾ªâ€œé‡Šæ”¾æ¨¡å¼â€ã€‚

é‡Šæ”¾æ¨¡å¼å¯ä»¥åœ¨Visual Sudioä¸­è‡ªåŠ¨ç”ŸæˆèŒƒå¼ä»£ç ã€‚å®ƒé•¿è¿™æ ·ï¼š

```c#
public class ChatRoom : IDisposable
{
    private bool disposedValue;

    protected virtual void Dispose(bool disposing)
    {
        if (!disposedValue)
        {
            if (disposing)
            {
                // TODO: é‡Šæ”¾æ‰˜ç®¡çŠ¶æ€(æ‰˜ç®¡å¯¹è±¡)
            }

            // TODO: é‡Šæ”¾æœªæ‰˜ç®¡çš„èµ„æº(æœªæ‰˜ç®¡çš„å¯¹è±¡)å¹¶é‡å†™ç»ˆç»“å™¨
            // TODO: å°†å¤§å‹å­—æ®µè®¾ç½®ä¸º null
            disposedValue = true;
        }
    }

    // // TODO: ä»…å½“â€œDispose(bool disposing)â€æ‹¥æœ‰ç”¨äºé‡Šæ”¾æœªæ‰˜ç®¡èµ„æºçš„ä»£ç æ—¶æ‰æ›¿ä»£ç»ˆç»“å™¨
    // ~ChatRoom()
    // {
    //     // ä¸è¦æ›´æ”¹æ­¤ä»£ç ã€‚è¯·å°†æ¸…ç†ä»£ç æ”¾å…¥â€œDispose(bool disposing)â€æ–¹æ³•ä¸­
    //     Dispose(disposing: false);
    // }

    void IDisposable.Dispose()
    {
        // ä¸è¦æ›´æ”¹æ­¤ä»£ç ã€‚è¯·å°†æ¸…ç†ä»£ç æ”¾å…¥â€œDispose(bool disposing)â€æ–¹æ³•ä¸­
        Dispose(disposing: true);
        GC.SuppressFinalize(this);
    }
}
```

å…·ä½“æ¥è¯´ï¼š

- åœ¨é‡Šæ”¾æ¨¡å¼ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªå«å¸ƒå°”å‚çš„Disposeæ–¹æ³•é‡è½½ï¼Œæ¥å®é™…å¤„ç†é‡Šæ”¾èµ„æºã€‚æ¥å£å®šä¹‰çš„æ— å‚Disposeæ–¹æ³•ï¼Œè°ƒç”¨è¯¥é‡è½½æ–¹æ³•ï¼Œå¹¶è°ƒç”¨GCæ–¹æ³•å®Œæˆé‡Šæ”¾ã€‚
- é‡Šæ”¾æ¨¡å¼ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªæ ‡è®°å­—æ®µdisposedValueï¼Œç”¨äºé¿å…é‡å¤é‡Šæ”¾ã€‚
- å¼€å‘è€…å¯ä»¥æ ¹æ®TODOä»»åŠ¡æç¤ºï¼Œå°†ç±»ä¸­åŒ…å«çš„ä¸åŒç±»å‹çš„èµ„æºçš„é‡Šæ”¾é€»è¾‘å†™åœ¨ç›¸åº”ä½ç½®ã€‚
- å½“ç±»ä¸­åŒ…å«æœªæ‰˜ç®¡èµ„æºæ—¶ï¼Œè¿˜éœ€è¦é‡å†™ç»ˆç»“å™¨ã€‚æ–¹æ³•æ˜¯æŠŠä¸Šè¿°ç»ˆç»“å™¨çš„æ³¨é‡Šè§£å¼€å³å¯ã€‚

ä½¿ç”¨é‡Šæ”¾æ¨¡å¼ï¼Œå¯ä»¥æ›´å¥½çš„å¤„ç†æ‰˜ç®¡ã€éæ‰˜ç®¡èµ„æºçš„é‡Šæ”¾ã€‚

å…³äºéæ‰˜ç®¡èµ„æºå’Œéå®‰å…¨ä¸Šä¸‹æ–‡ï¼Œè¯·å‚è€ƒ[unsafeä¸Šä¸‹æ–‡](#unsafeä¸Šä¸‹æ–‡)

### æšä¸¾å™¨æ¥å£ï¼ˆIEnumeratorï¼‰ å’Œ å¯æšä¸¾æ¥å£ï¼ˆIEnumerableï¼‰

IEnumeratorï¼š**æšä¸¾å™¨æ¥å£**ï¼Œå®ƒå®šä¹‰äº†MoveNextæ–¹æ³•ã€Resetæ–¹æ³•å’ŒCurrentå±æ€§ï¼Œç”¨äºç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ã€ç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ å’Œè·å–å½“å‰å…ƒç´ ã€‚IEnumeratorä¹Ÿæœ‰å…¶æ³›å‹ç‰ˆæœ¬IEnumerator\<T\>ï¼ˆC#2.0å¼•å…¥ï¼‰ï¼Œæ³›å‹ç‰ˆæœ¬çš„Currentç±»å‹ä¸æ˜¯objectè€Œæ˜¯æ³›å‹æŒ‡å®šçš„ç±»å‹ã€‚

IEnumerableï¼š**å¯æšä¸¾æ¥å£**ï¼Œå®ƒå®šä¹‰äº†GetEnumeratorï¼Œç”¨äºè·å–è¯¥ç±»çš„IEnumeratorå¯¹è±¡ã€‚IEnumerableä¹Ÿæœ‰å…¶æ³›å‹ç‰ˆæœ¬IEnumerable\<T\>ï¼ˆC#2.0å¼•å…¥ï¼‰ã€‚æ³›å‹ç±»å‹çš„GetEnumeratorè¿”å›ç±»å‹ä¹Ÿæ˜¯IEnumerator\<T\>ã€‚

å®ç°äº†IEnumerableï¼ˆæˆ–IEnumerable\<T>ï¼‰æ¥å£çš„ç±»ï¼Œå¯ä»¥ä½¿ç”¨`foreach`è¯­å¥è¿›è¡Œéå†ã€‚

foreachè¯­å¥çš„å…³é”®è¯ä¸ºforeachå’Œinï¼š

```c#
foreach (object item in list)
{
    //çœç•¥
}
```

æˆ‘ä»¬å¯ä»¥æŠŠä¸Šè¿°æšä¸¾è¿‡ç¨‹å«åšè¿­ä»£ï¼ˆIterateã€Iteratingï¼‰ã€‚ä½†æ˜¯ä¸€å®šä¸€å®šè¦æ³¨æ„ï¼Œå®ƒä¸[è¿­ä»£å™¨](#è¿­ä»£å™¨ï¼ˆIteratorï¼‰)ï¼ˆC#2.0å¼•å…¥ï¼‰ä¸æ˜¯ä¸€å›äº‹ï¼Œåè€…åœ¨C#ä¸­ç‰¹æŒ‡è¿­ä»£å™¨æ–¹æ³•ï¼ˆIterator Methodï¼‰ã€‚

ç‰¹åˆ«çš„ï¼šå®šä¹‰äº†è¿”å›ç±»å‹ä¸ºIEnumeratorä¸”åç§°ä¸ºGetEnumeratorçš„æ–¹æ³•çš„ç±»ï¼Œå³ä½¿æœªæŒ‡æ˜å®ç°IEnumerableæ¥å£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨foreachã€‚è¿™ä¸ªç‰¹ç‚¹åœ¨C#9.0æ—¶è¢«å¼ºåŒ–ï¼šGetEnumeratorå³ä½¿æ˜¯æ‰©å±•æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨foreachã€‚ï¼ˆæ³›å‹ç‰ˆæœ¬åŒç†ï¼‰

IEnumeratorå’ŒIEnumerableï¼ˆåŠå®ƒä»¬çš„æ³›å‹ç‰ˆæœ¬ï¼‰éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä»¬ï¼š

- å¯ä»¥ç”¨æ¥å®ç°è¿­ä»£å™¨æ–¹æ³•ï¼ˆC#2.0å¼•å…¥ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æœºåˆ¶ã€‚
- å¯ä»¥æ”¯æŒLINQï¼ˆC#3.0å¼•å…¥ï¼Œä¸”LINQå»ºç«‹åœ¨è¿­ä»£å™¨ä¹‹ä¸Šï¼‰ã€‚LINQå¯ä»¥ç®—å¾—ä¸ŠCShaperçš„å¿«ä¹æºæ³‰ã€‚

è¿™ä¸¤ä¸ªæ¥å£éƒ½åº”è¯¥**ä¼˜å…ˆä½¿ç”¨æ³›å‹ç‰ˆæœ¬**ï¼ˆC#2.0ï¼‰ã€‚

> C#çš„æšä¸¾å™¨ç›¸å½“äºJavaçš„è¿­ä»£å™¨ï¼ˆIteratorï¼‰ï¼ŒJavaä½¿ç”¨è¿­ä»£å™¨éå†çš„foreachè¯­æ³•ä¸º`for (object item : list)`ã€‚

> C#åœ¨2.0ç‰ˆæœ¬å¼•å…¥äº†è¿­ä»£å™¨ï¼Œä½†æ˜¯å®ƒä¸Javaçš„è¿­ä»£å™¨æ˜¯ä¸¤ç§ä¸åŒçš„æ¦‚å¿µã€‚C#çš„è¿­ä»£å™¨æ˜¯ç‹¬æœ‰çš„ç‰¹è‰²è¯­æ³•ï¼Œå®ƒé€šè¿‡ç¼–è¯‘å™¨è¿›è¡Œè¯­åºé‡æ’ï¼Œå› è€Œå…·æœ‰å»¶è¿Ÿæ‰§è¡Œã€æ‰§è¡Œé¡ºåºåå¸¸è¯†çš„ç‰¹ç‚¹ã€‚

## å§”æ‰˜ï¼ˆDelegateï¼‰

å§”æ‰˜ç±»ä¼¼äºC++çš„å‡½æ•°æŒ‡é’ˆï¼Œç”¨äºæŒ‡ä»£æ–¹æ³•ã€‚å§”æ‰˜è·Ÿç±»ä¸€æ ·ï¼Œæ˜¯ä¸€ç§ç±»å‹å®šä¹‰ã€‚

å£°æ˜å§”æ‰˜æ—¶å®šä¹‰äº†ä¸€ç§ç±»å‹ï¼Œè¿™ä¸ªç±»å‹è§„å®šè¯¥å§”æ‰˜ç±»å‹çš„å¯¹è±¡æ‰€æŒ‡ä»£çš„æ–¹æ³•å¿…é¡»æ»¡è¶³çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ã€‚

å§”æ‰˜ä½¿ç”¨`delegate`å…³é”®è¯å£°æ˜ã€‚

```c#
public delegate int Compare(int a, int b); 
```

ä¸Šè¿°ä»£ç å®šä¹‰äº†ä¸€ä¸ªå§”æ‰˜ç±»å‹Compareï¼Œè¯¥å§”æ‰˜ç±»å‹æè¿°äº†ä¸€ç§éœ€è¦ä¸¤ä¸ªintç±»å‹å‚æ•°ï¼Œä¸”è¿”å›intç±»å‹å€¼çš„æ–¹æ³•ã€‚

å‡è®¾ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•å®šä¹‰ï¼Œå¦‚ä¸‹

```c#
//æ¥ä¸Šä¾‹
public int CompareMethod(int left, int right)
{
    return left - right;
}
```

æˆ‘ä»¬çœ‹åˆ°ï¼Œè¯¥æ–¹æ³•çš„å‚æ•°æ•°é‡ã€æ¯ä¸ªå‚æ•°çš„ç±»å‹ã€è¿”å›å€¼ç±»å‹éƒ½ä¸Compareè¿™ä¸ªå§”æ‰˜ç±»å‹çš„å®šä¹‰ç›¸åŒã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå®šä¹‰ä¸€ä¸ªCompareç±»å‹çš„å§”æ‰˜å˜é‡compareï¼Œå¯ä»¥é€šè¿‡èµ‹å€¼ä½¿å¾—compareæŒ‡ä»£CompareMethodæ–¹æ³•ï¼š

```c#
//æ¥ä¸Šä¾‹
Compare compare;
compare = CompareMethod;
```

è¿™æ—¶æˆ‘ä»¬ç§°ï¼Œcompareå°†å®ç°**å§”æ‰˜ç»™**äº†CompareMethodæ–¹æ³•ï¼›CompareMethodæ˜¯**è¢«**compare**å§”æ‰˜**çš„æ–¹æ³•ï¼Œæˆ–è€…è¯´CompareMethodæ˜¯compareçš„**å§”æ‰˜å®ç°**ã€‚

èµ‹å€¼è¿ç®—ç¬¦çš„å³ä¾§ï¼Œå¯ä»¥æ˜¯æ–¹æ³•åã€åŒ¿åæ–¹æ³•å®ç°æˆ–è€…å¦ä¸€ä¸ªå§”æ‰˜å¯¹è±¡ã€‚

è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œèµ‹å€¼æ–¹æ³•ç»™å§”æ‰˜æ—¶ï¼Œéœ€è¦æ»¡è¶³é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•çš„è¦æ±‚ï¼šåœ¨é™æ€æ–¹æ³•ä¸­ï¼Œæ— æ³•ç»™å§”æ‰˜å˜é‡ã€é™æ€æˆå‘˜èµ‹å€¼ä¸ºéé™æ€çš„æ–¹æ³•ã€‚

å¦‚æœèµ‹å€¼ç»™å§”æ‰˜çš„æ–¹æ³•åœ¨å¦ä¸€ä¸ªç±»ä¸­ï¼Œåˆ™å¯ä»¥ä½¿ç”¨`å¯¹è±¡.æ–¹æ³•å`æˆ–è€…`ç±»å.æ–¹æ³•å`èµ‹å€¼ï¼Œå…·ä½“ç”¨æ³•ä¹ŸåŒæ ·éœ€è¦æ»¡è¶³ä¸Šä¸€æ¡çš„è¦æ±‚ã€‚

```c#
//æ¥ä¸Šä¾‹
Compare compare2 = compare;  //å°†å§”æ‰˜èµ‹å€¼ç»™å¦ä¸€ä¸ªå§”æ‰˜
```

åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæ³¨æ„åˆ°ï¼šåœ¨ä¸Šé¢ä¾‹å­ä¸­ï¼Œå§”æ‰˜è§„å®šçš„å‚æ•°åå’Œæ‰€æŒ‡ä»£çš„æ–¹æ³•æ‰€å®šä¹‰çš„å‚æ•°åå¹¶ä¸ç›¸åŒã€‚è¿™ç§æƒ…å†µä¸‹ä»ç„¶å¯ä»¥ç”¨å§”æ‰˜æŒ‡ä»£è¯¥æ–¹æ³•ã€‚ç”±æ­¤å¯è§ï¼Œæ–¹æ³•è¦èµ‹å€¼ç»™å§”æ‰˜æ—¶ï¼Œå‚æ•°çš„åç§°å¹¶ä¸é‡è¦ã€‚è¿™åŒæ–¹æ³•ç­¾åæ˜¯ä¸€è‡´çš„ã€‚

å¦‚ä¸Šå£°æ˜è¿‡åï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å§”æ‰˜å¯¹è±¡ï¼Œè¿›è¡Œæ–¹æ³•è°ƒç”¨äº†ï¼š

```c#
//æ¥ä¸Šä¾‹
int result1 = compare(1, 2);         //ç¬¬ä¸€ç§è°ƒç”¨æ–¹å¼
int result2 = compare.Invoke(4, 2);  //ç¬¬äºŒç§è°ƒç”¨æ–¹å¼
```

ä¸Šè¿°ä»£ç å®é™…è°ƒç”¨äº†è¢«å§”æ‰˜çš„CompareMethodæ–¹æ³•ã€‚

è¿™é‡Œç‰¹åˆ«æä¸€ä¸‹ï¼Œæ²¡å‡†ä½ å¯èƒ½ä¼šå¯¹ä¸‹é‡Œé¢çš„è¯­æ³•æ„Ÿåˆ°æ–°é²œï¼Œä½†æ˜¯å…¶å®å®ƒå¾ˆå¥½ç†è§£ï¼š

```c#
//æ¥ä¸Šä¾‹
int result3 = someObject.GetCompareDelegate()(3, 7);  //someObjectçš„GetCompareDelegateè¿”å›äº†Compareç±»å‹çš„å§”æ‰˜å¯¹è±¡ã€‚æ­¤å¤„åœ¨æ‹¿åˆ°å§”æ‰˜å¯¹è±¡åç«‹å³è°ƒç”¨ï¼Œå› è€Œå‡ºç°è¿ç»­ä¸¤ä¸ª()
```

ä½¿ç”¨å§”æ‰˜çš„å¥½å¤„æ˜¯ï¼šå¯ä»¥å…ˆå£°æ˜æ–¹æ³•çš„è§„æ ¼ï¼Œä¸“å¿ƒäºä½¿ç”¨è€…ä»£ç çš„ä¹¦å†™ã€‚è€Œè¯¥æ–¹æ³•è§„æ ¼å…·ä½“çš„å®ç°ï¼Œåˆ™å¯ä»¥åœ¨è¿è¡Œæ—¶å†ç»‘å®šåˆ°å…·ä½“çš„æ–¹æ³•ã€‚

æ³¨æ„ï¼Œå§”æ‰˜ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œå¯ä»¥ä¸ºnullã€‚

> è®¸å¤šè¯­è¨€éƒ½æœ‰å§”æ‰˜æœºåˆ¶ã€‚å¦‚ï¼šç”¨äºç¼–å†™IOSç¨‹åºçš„Object-Cè¯­è¨€ï¼Œä¹Ÿæœ‰å§”æ‰˜æœºåˆ¶ï¼Œè¢«ç§°ä¸ºåè®®ï¼ˆprotocolï¼‰ã€‚JSå°±æ›´ä¸ç”¨è¯´äº†ï¼Œ`var func = function(){}`å¤§ä¼™éƒ½å†™è¿‡å§ã€‚

> Javaä¸­æ²¡æœ‰å§”æ‰˜ç±»å‹ã€‚å¦‚æœè¦åœ¨Javaä¸­å®ç°ç±»ä¼¼å§”æ‰˜çš„æ•ˆæœï¼Œéœ€è¦åˆ©ç”¨åå°„ã€‚
> > è¿™é‡Œæä¾›ä¸€ç§å¯è¡Œçš„å®ç°æ–¹æ³•ï¼š
> >
> > - å®šä¹‰ä¸€ä¸ªæ–¹æ³•ã€‚è¯¥æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šä¸€ä¸ªObjectå‚æ•°ï¼Œä½œä¸ºæä¾›è¢«å§”æ‰˜æ–¹æ³•çš„å¯¹è±¡ï¼Œå®šä¹‰ä¸ºobjï¼›ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œç”¨äºæä¾›è¢«å§”æ‰˜çš„æ–¹æ³•åï¼Œå®šä¹‰ä¸ºmethodNameï¼›ä¸€ä¸ªObjectç±»å‹çš„æ•°ç»„ã€Mapæˆ–è€…å¯å˜å‚æ•°ï¼Œç”¨äºæä¾›è°ƒç”¨è¯¥æ–¹æ³•æ—¶çš„å‚æ•°åˆ—è¡¨ï¼Œå®šä¹‰ä¸ºargsã€‚
> > - å®ç°æ­¤æ–¹æ³•ï¼šå…ˆé€šè¿‡åå°„æ‰¾åˆ°objå¯¹è±¡çš„ã€åç§°ä¸ºmethodNameçš„æ–¹æ³•ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶å°†argsä½œä¸ºå‚æ•°ä¼ å…¥ã€‚
>
> å› ä¸ºJavaæ²¡æœ‰è¯­æ³•å±‚é¢çš„æ”¯æŒï¼Œä¸Šè¿°å¥—è·¯è™½ç„¶ä¹Ÿèƒ½å¤Ÿå®ç°ç±»ä¼¼åŠŸèƒ½ï¼Œä½†æ˜¾ç„¶ï¼Œè¿™ä¸å¤Ÿä¼˜ç¾ã€‚

### å¤šæ’­å§”æ‰˜ï¼ˆMulticast Delegateï¼‰

äº‹å®ä¸Šï¼Œæˆ‘ä»¬å®šä¹‰çš„å§”æ‰˜ç±»å‹ï¼Œå±äºå¤šæ’­å§”æ‰˜ï¼ˆå¤šè·¯å¹¿æ’­å§”æ‰˜ï¼ŒMulticastDelegateï¼‰ã€‚å¯¹äºè¢«å§”æ‰˜çš„æ–¹æ³•ã€å§”æ‰˜å¯¹è±¡ï¼Œæ˜¯å¯ä»¥ç»„åˆèµ·æ¥çš„ã€‚è¿™è¢«ç§°ä¸º**å§”æ‰˜ç»„åˆ**ï¼ˆDelegate Combinationï¼‰ï¼š

```c#
Compare compare; //å®šä¹‰å§”æ‰˜å˜é‡
compare = CompareMethod1 + CompareMethod2; //å§”æ‰˜ç»™CompareMethod1å’ŒCompareMethod2çš„ç»„åˆ
```

`+`è¿ç®—ç¬¦ä¸¤ä¾§çš„æ“ä½œæ•°ï¼ŒåŒæ ·å¯ä»¥æ˜¯æ–¹æ³•åã€åŒ¿åçš„æ–¹æ³•å®ç°ã€å§”æ‰˜å¯¹è±¡ç­‰ã€‚å®ƒç”¨äºç»„åˆä¸¤ä¸ªç¬¦åˆåŒä¸€ä¸ªå§”æ‰˜å®šä¹‰çš„æ“ä½œæ•°ã€‚å¦‚æœå…¶ä¸­åŒ…å«nullï¼Œåˆ™ä»…ä»…è¿”å›å¦ä¸€ä¸ªæ“ä½œæ•°ï¼ˆä¹Ÿå¯èƒ½æ˜¯nullï¼‰ã€‚ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå§”æ‰˜å¯¹è±¡compareå°†å§”æ‰˜ç»™ä¸¤ä¸ªæ–¹æ³•CompareMethod1ã€CompareMethod2å…±åŒå¤„ç†ã€‚æ‰§è¡Œçš„é¡ºåºä¼šæŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºã€‚

å¦‚æœè¦åˆ é™¤ä¸€ä¸ªå§”æ‰˜å®ç°ï¼Œåˆ™ä½¿ç”¨`-`è¿ç®—ç¬¦ã€‚

äº‹å®ä¸Šï¼Œé™¤äº†`+`å’Œ`-`ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨`+=`å’Œ`-=`è¿ç®—ç¬¦ã€‚å› è€Œæˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·ä½¿ç”¨å§”æ‰˜ï¼š

```c#
Compare compare; //å®šä¹‰å§”æ‰˜å˜é‡
compare = CompareMethod1; 
compare += CompareMethod2;
```

æœ‰è¶£çš„æ˜¯ï¼Œå§”æ‰˜å¯¹è±¡å³ä½¿ä¸ºnullï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨`+=`ï¼š

```c#
Compare compare = null; 
compare += CompareMethod1; 
```

> Javaä¸­å¦‚æœè¦å®ç°å¤šæ’­å§”æ‰˜ï¼Œéœ€è¦è®°å½•**ä¸€ç»„**è¢«å§”æ‰˜å¯¹è±¡ï¼Œå¹¶åœ¨å§”æ‰˜è°ƒç”¨æ—¶éå†æ‰€æœ‰å¯¹è±¡ï¼Œé€šè¿‡åå°„æŒ¨ä¸ªè°ƒç”¨è¿™äº›å¯¹è±¡çš„æŒ‡å®šæ–¹æ³•ã€‚å…·ä½“å®ç°æˆ‘å°±ä¸ä¸¾ä¾‹äº†ã€‚è¯»è€…å¯è‡ªè¡Œæ€è€ƒã€‚ï¼ˆæˆ–è€…é—®åº¦å¨˜ï¼‰

## äº‹ä»¶ï¼ˆEventï¼‰

äº‹ä»¶æ˜¯C#å¼•å…¥çš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒçš„è‡ªç„¶å«ä¹‰ä¸ºå›è°ƒï¼šå½“æœ‰äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè®¢é˜…è¯¥äº‹ä»¶çš„ç±»ä¼šæ¥åˆ°å›è°ƒé€šçŸ¥ï¼Œå¹¶å…è®¸è®¢é˜…è€…æ‰§è¡Œé¢å¤–çš„å¤„ç†è¿‡ç¨‹ã€‚

C#ä¸­çš„äº‹ä»¶æ˜¯åŸºäºå§”æ‰˜çš„ã€‚æœ‰äº†å§”æ‰˜ï¼Œæ‰æœ‰äº‹ä»¶ã€‚

ä¸å±æ€§ä¸€æ ·ï¼Œäº‹ä»¶æ˜¯ç±»çš„æˆå‘˜ã€‚

**äº‹ä»¶æ˜¯ä¸€ç§ç‰¹æ®Šçš„å§”æ‰˜ç±»å‹æˆå‘˜**ã€‚

è¿™å¥è¯æœ‰ä¸‰é‡å«ä¹‰ï¼š

1. å§”æ‰˜æ˜¯ç±»å‹å®šä¹‰èŒƒç•´çš„ï¼Œè€Œäº‹ä»¶æ˜¯ç±»æˆå‘˜å£°æ˜èŒƒç•´çš„ã€‚
2. äº‹ä»¶æ˜¯å§”æ‰˜ç±»å‹çš„ã€‚
3. äº‹ä»¶æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„å§”æ‰˜æˆå‘˜ï¼Œå®ƒä¸€èˆ¬ä¸ºEventHandlerç±»å‹æˆ–EventHandler\<T>(C# 2.0å¼•å…¥)ç±»å‹ã€‚

ä¸ºäº†ç»™äº‹ä»¶èµ‹äºˆè‡ªç„¶å«ä¹‰ï¼Œæˆ‘ä»¬ç»™å¯¹äº‹ä»¶å§”æ‰˜çš„æ“ä½œèµ·äº†æ›´åˆ©äºäººç±»ç†è§£çš„åˆ«åï¼šæˆ‘ä»¬æŠŠå¯¹äº‹ä»¶çš„`=`ã€`+=`æ“ä½œç§°ä¸ºè®¢é˜…ã€æ·»åŠ è®¢é˜…ã€ç»‘å®šå›è°ƒï¼›å¯¹äº‹ä»¶å§”æ‰˜çš„è°ƒç”¨ï¼Œç§°ä¸ºè§¦å‘äº‹ä»¶ã€ä¸‹å‘äº‹ä»¶é€šçŸ¥ã€å›è°ƒç»™è®¢é˜…è€…ã€‚

äº‹ä»¶åˆ©ç”¨äº†å§”æ‰˜çš„ç‰¹ç‚¹ï¼Œé‡‡ç”¨åæœŸç»‘å®šæœºåˆ¶ã€‚å£°æ˜äº†æŸä¸ªäº‹ä»¶çš„ç±»ï¼Œæœ¬èº«ä¸å¿…æä¾›è¯¥äº‹ä»¶çš„å®ç°ã€‚å®ƒå¯ä»¥æ”¾å¿ƒçš„é¢„å…ˆç¼–å†™ä»£ç ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶æœºè§¦å‘è¯¥äº‹ä»¶ã€‚

äº‹ä»¶è¿˜åˆ©ç”¨äº†å§”æ‰˜çš„å¤šæ’­æ€§è´¨ï¼Œå…è®¸ä¸æ­¢ä¸€ä¸ªè®¢é˜…è€…è®¢é˜…è¯¥äº‹ä»¶ã€‚å³ï¼šå•ä¸ªäº‹ä»¶å§”æ‰˜å¯ä»¥æä¾›å¤šä¸ªå®ç°æ–¹æ³•ã€‚äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œå¤šä¸ªå®ç°æ–¹æ³•ä¼šè¢«ä¾æ¬¡è°ƒç”¨ã€‚

äº‹ä»¶çš„å…¸å‹çš„åº”ç”¨åœºæ™¯æœ‰ï¼šæŸä¸ªæŒ‰é’®è¢«ç‚¹å‡»ã€è®¾å¤‡è¿æ¥çš„è¿ä¸Šä¸æ–­å¼€ã€æ”¶åˆ°æœ‰äººç»™ä½ å‘çš„æ¶ˆæ¯ç­‰ç­‰ã€‚

å¦‚ä½•å£°æ˜äº‹ä»¶ï¼š

- åªèƒ½ç”¨ä½œç±»çš„æˆå‘˜
- æ·»åŠ `event`å…³é”®è¯
- è¯¥æˆå‘˜çš„ç±»å‹å¿…é¡»æ˜¯ä¸€ç§å§”æ‰˜ç±»å‹

ä¾‹å¦‚ï¼š

```c#
public event EventHandler OnConnected; //å£°æ˜OnConnectedäº‹ä»¶
```

ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸ºOnConnectedçš„äº‹ä»¶ã€‚è¯¥äº‹ä»¶ç”¨äºåœ¨è®¾å¤‡å»ºç«‹è¿æ¥æ—¶ï¼Œå‘äº‹ä»¶çš„è®¢é˜…è€…å‘èµ·å›è°ƒã€‚

æˆ‘ä»¬æ¥æŸ¥çœ‹EventHandlerçš„å®šä¹‰ï¼š

```c#
public delegate void EventHandler(object sender, EventArgs e);
```

å¯è§ï¼ŒEventHandleræ˜¯ä¸€ä¸ªå§”æ‰˜ç±»å‹ã€‚å®ƒæè¿°äº†ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼ï¼ŒåŒ…å«ä¸¤ä¸ªå‚æ•°çš„æ–¹æ³•ã€‚ä¸¤ä¸ªå‚æ•°ä¸­ï¼Œç¬¬ä¸€ä¸ªobjectç±»å‹çš„å‚æ•°ï¼Œä¸ºå¼•å‘è¯¥äº‹ä»¶çš„å¯¹è±¡ï¼›ç¬¬äºŒä¸ªEventArgsç±»å‹çš„å‚æ•°ï¼Œä¸ºå¼•å‘è¯¥äº‹ä»¶æ—¶çš„é¢å¤–å‚æ•°ã€‚

è™½ç„¶ä»»ä½•å§”æ‰˜ç±»å‹éƒ½å¯ä»¥ç”¨äºå®šä¹‰äº‹ä»¶ï¼Œä½†æ˜¯**ä¸€èˆ¬è€Œè¨€ï¼Œäº‹ä»¶æ˜¯EventHandlerç±»å‹æˆ–è€…EventHandler\<TEventArgs>(C#2.0)ç±»å‹çš„**ã€‚

EventHandler\<TEventArgs>ä½œä¸ºæ³›å‹ç‰ˆæœ¬ï¼Œè¢«æ›´å¤šçš„ä½¿ç”¨ã€‚å…¶ä¸­ï¼Œæ³›å‹å‚æ•°TEventArgsçš„çº¦æŸæ¡ä»¶ï¼ˆC#2.0ï¼Œ[æ³›å‹çº¦æŸ](#æ³›å‹çº¦æŸ)ï¼‰ä¸ºï¼šå¿…é¡»æ˜¯EventArgsç±»çš„å­ç±»ã€‚æˆ‘ä»¬çœ‹åˆ°EventArgsç±»äº‹å®ä¸Šæ˜¯ä¸€ä¸ªç©ºç±»ï¼Œä¸åŒ…å«ä»»ä½•æˆå‘˜ã€‚é€šå¸¸æˆ‘ä»¬ä¼šç»§æ‰¿EventArgsç±»ï¼Œå¹¶ä½¿ç”¨æ³›å‹å‚æ•°ä¸ºè¯¥æ´¾ç”Ÿç±»çš„æ³›å‹ç‰ˆæœ¬çš„EventHandler\<å­ç±»>æ¥å£°æ˜äº‹ä»¶ï¼Œä»¥ä¾¿åœ¨äº‹ä»¶è§¦å‘æ—¶ä½¿ç”¨è¯¥æ´¾ç”Ÿç±»ä¼ é€’é¢å¤–å‚æ•°ã€‚

å›åˆ°ä¸Šé¢çš„ä¾‹å­ã€‚å£°æ˜OnConnectedäº‹ä»¶åï¼Œåœ¨ç¼–å†™ç±»åº“çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨è®¾å¤‡è¿æ¥æˆåŠŸçš„æ—¶å€™è§¦å‘è¯¥äº‹ä»¶ï¼Œé€šçŸ¥åˆ°æ‰€æœ‰è®¢é˜…è€…ï¼š

```c#
//ä»£ç è¿è¡Œåˆ°æ­¤å¤„ï¼Œå·²ç»æˆåŠŸè¿æ¥äº†è®¾å¤‡
if (OnConnected != null)
{
    OnConnected(this, EventArgs.Empty);
}
```

åœ¨å£°æ˜äº†äº‹ä»¶çš„ç±»ä¸­ï¼Œä¸€èˆ¬ä¸å¿…æä¾›æ­¤äº‹ä»¶å§”æ‰˜çš„å…·ä½“å®ç°ã€‚

è€Œå¯¹äºè¯¥ç±»çš„ä½¿ç”¨è€… â€”â€” ä¸€èˆ¬ä¸ºå…¶ä»–ç±»ï¼Œåœ¨åˆ›å»ºäº†è¯¥ç±»çš„å¯¹è±¡åï¼Œå¯ä»¥ç»™è¯¥äº‹ä»¶æ·»åŠ å®ç°æ–¹æ³•ï¼Œä»è€Œå®ç°å¯¹äº‹ä»¶çš„è®¢é˜…ã€‚æ¥ä¸Šä¾‹ï¼š

```c#
Device device = new Device("SomeID"); //å£°æ˜è®¾å¤‡ç±»çš„å¯¹è±¡ï¼Œè¯¥ç±»å®šä¹‰äº†OnConnectedäº‹ä»¶
device.OnConnected += ConnectedMethod;  //ConnectedMethodæ˜¯ä¸€ä¸ªç¬¦åˆEventHandlerå§”æ‰˜å®šä¹‰çš„æ–¹æ³•
device.Open(); //è°ƒç”¨Openæ–¹æ³•åï¼Œè®¾å¤‡ä¼šå¼€å§‹å»ºç«‹è¿æ¥ã€‚åœ¨å»ºç«‹æˆåŠŸæ—¶ï¼Œå°†å¼•å‘OnConnectedäº‹ä»¶ã€‚æ­¤æ—¶ï¼Œæ­¤å¤„æŒ‡å®šçš„ConnectedMethodæ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ã€‚
```

ç”±äºå§”æ‰˜å³ä½¿ä¸ºnullä¹Ÿå¯ä»¥ä½¿ç”¨`+=`è¿ç®—ç¬¦ï¼Œå› è€Œäº‹ä»¶çš„è®¢é˜…è€…ä¸å¿…ç¡®å®šè‡ªå·±æ˜¯å¦ä¸ºç¬¬ä¸€ä¸ªè®¢é˜…è¯¥äº‹ä»¶çš„ã€‚å®é™…ä¸Šï¼Œç”±äºä½¿ç”¨`=`è¿ç®—ç¬¦ä¼šè¦†ç›–æ‰€æœ‰çš„å…¶ä»–è®¢é˜…ï¼Œå› è€Œä¸€èˆ¬ä¸æ¨èä½¿ç”¨`=`è¿›è¡Œç»‘å®šå›è°ƒçš„æ“ä½œã€‚

äº‹ä»¶ä¹Ÿå…·æœ‰è®¿é—®å™¨ï¼Œå¹¶ä¸”å¯ä»¥é‡å†™è®¿é—®å™¨ã€‚ä½†æ˜¯æ³¨æ„ï¼Œäº‹ä»¶ä¸å±æ€§ä¸åŒï¼Œå®ƒä¸å…·å¤‡getå’Œsetè®¿é—®å™¨ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå®ƒæ‹¥æœ‰`add`å’Œ`remove`è®¿é—®å™¨ã€‚

é‡å†™`add`å’Œ`remove`è®¿é—®å™¨ï¼Œä½¿ç”¨è¿™ç§å½¢å¼çš„å®šä¹‰ï¼š

```c#
private EventHandler onConnected; //äº‹ä»¶èƒŒåçš„å®ç°å­—æ®µ
public event EventHandler OnConnected  //å®šä¹‰äº‹ä»¶ï¼Œå¹¶é‡å†™è®¿é—®å™¨
{
    add { onConnected += value; }
    remove { onConnected -= value; }
}
```

åœ¨`add`å’Œ`remove`è®¿é—®å™¨å†…éƒ½å¯ä»¥ä½¿ç”¨`value`å…³é”®è¯ã€‚

åŒå±æ€§ä¸€æ ·ï¼Œé‡å†™äº†è®¿é—®å™¨çš„äº‹ä»¶ï¼Œä¹Ÿéœ€è¦èƒŒåçš„å®ç°å­—æ®µæ”¯æ’‘ã€‚è®¿é—®å™¨å†…ç›´æ¥è°ƒç”¨äº‹ä»¶çš„è®¿é—®å™¨ä¹Ÿå¯èƒ½å¼•å‘æ— é™é€’å½’ã€‚

å¦å¤–ä¸€ç‚¹ï¼Œä¸€æ—¦ä½ é‡å†™äº†`add`ã€`remove`è®¿é—®å™¨ï¼Œäº‹ä»¶æœ¬èº«ä¾¿åªèƒ½è¢«æ”¾åœ¨`+=`å’Œ`-=`çš„å·¦ä¾§äº†ï¼Œç”šè‡³æ— æ³•æ”¾åœ¨`=`çš„å·¦ä¾§ã€‚è€Œå¦‚æœéœ€è¦è°ƒç”¨ï¼ˆè§¦å‘ï¼‰äº‹ä»¶ï¼Œåªèƒ½é€šè¿‡èƒŒåçš„å§”æ‰˜ç±»å‹çš„å®ç°å­—æ®µæ¥æ“ä½œã€‚

> å› ä¸ºæ²¡æœ‰å§”æ‰˜çš„æ¦‚å¿µï¼ŒJavaåŒæ ·ä¹Ÿæ²¡æœ‰äº‹ä»¶çš„è¯­æ³•æ¦‚å¿µã€‚å¯ä»¥å‚è€ƒå‰é¢ä¾‹å­ä¸­å®ç°å¤šæ’­å§”æ‰˜çš„æ–¹å¼å®ç°äº‹ä»¶ã€‚

## è¿ç®—ç¬¦ï¼ˆOperatorï¼‰

è¿™é‡Œä»…ä»…åˆ—å‡ºä¸€äº›C#ç‹¬ç‰¹çš„è¿ç®—ç¬¦è¯­æ³•

### ç‰¹è‰²è¿ç®—ç¬¦

#### @ç¬¦å·

`@`ç¬¦å·çš„ä¸¤ä¸ªç”¨é€”ï¼š

1. å¯ä»¥ä½œä¸ºå˜é‡çš„åç§°å‰ç¼€ã€‚å¯ä»¥ç”¨æ¥è§£å†³å˜é‡åä¸ç³»ç»Ÿå…³é”®è¯å†²çªçš„é—®é¢˜ã€‚

    æ³¨æ„ï¼š`@`ä¸è¢«è§†ä½œå˜é‡åç§°çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨nameofè¿ç®—ç¬¦ï¼ˆC#6.0å¼•å…¥ï¼‰è®¡ç®—å˜é‡åç§°æ—¶ï¼Œæˆ–è€…åšå¯¹å˜é‡åšJSONåºåˆ—åŒ–æ—¶ï¼Œ`@for`éƒ½ä¼šè¢«è§†ä¸ºåç§°ä¸º`for`ã€‚

2. `@`ä½œä¸ºå­—ç¬¦ä¸²å¸¸é‡çš„å‰ç¼€ï¼Œè¡¨ç¤ºéè½¬ä¹‰å­—ç¬¦ä¸²ã€‚

    éè½¬ä¹‰å­—ç¬¦ä¸²ï¼ˆæˆ–ç§°åŸä¹‰å­—ç¬¦ä¸²ï¼‰ï¼Œä¸ä¼šè½¬ä¹‰\ç¬¦å·ï¼Œä¹Ÿæ”¯æŒåœ¨å­—ä¸²å†…æ¢è¡Œã€‚`@`å­—ç¬¦ä¸²ä»…ä»…ä¼šè½¬ä¹‰ä¸¤ä¸ªåŒå¼•å· â€”â€” `""`ã€‚

    ```c#
    string originString = @"Dear å¤§å®¶:
        æ¬¢è¿æ¥åˆ°""C#çš„ä¸–ç•Œ""
    è¯·æŸ¥çœ‹æ ·ä¾‹ï¼šD:\Sample\";
    Console.WriteLine(originString);
    //è¾“å‡ºç»“æœä¸ºï¼š
    //Dear å¤§å®¶:
    //    æ¬¢è¿æ¥åˆ°"C#çš„ä¸–ç•Œ"
    //è¯·æŸ¥çœ‹æ ·ä¾‹ï¼šD:\Sample\
    ```

    > è¿™ä¸Javaåœ¨12ç‰ˆæœ¬å¼•å…¥çš„æ–‡æœ¬å—æœ‰äº›ç±»ä¼¼ï¼Œæ–‡æœ¬å—ä½¿ç”¨ä¸‰ä¸ªè¿ç»­çš„`"`åŒ…è£¹ï¼Œä¸­é—´å¯ä»¥æ¢è¡Œã€‚è¿™æ˜æ˜¾æ˜¯å‚è€ƒäº†pythonçš„è¯­æ³•ã€‚ä¸è¿‡æ–‡æœ¬å—å¹¶ä¸åƒpythoné‚£æ ·æ”¯æŒå†…æ’ã€‚C#ä¹Ÿè¦åˆ°C#6.0ä»¥åæ‰æ”¯æŒå­—ç¬¦ä¸²å†…æ’ã€‚

#### defaultè¿ç®—ç¬¦

`default`è¿ç®—ç¬¦å¯ä»¥ç”¨äºè®¡ç®—ä»»æ„ç±»å‹çš„é»˜è®¤å€¼ï¼š

```c#
int a = default(int);  //ç»“æœä¸º 0
string b = default(string);  //ç»“æœä¸º null
```

defaultä½œç”¨äºå€¼ç±»å‹ï¼Œè¿”å›è¯¥å€¼ç±»å‹çš„`0`å€¼ï¼ˆä¾‹å¦‚ï¼šintä¸º0ï¼Œboolä¸ºfalseï¼‰ï¼›ä½œç”¨äºå¼•ç”¨ç±»å‹ï¼Œè¿”å›nullã€‚

defaultè¿ç®—ç¬¦ä½œç”¨äºstructç±»å‹æ—¶ï¼Œå°†å¾—åˆ°æ‰€æœ‰å­—æ®µå‡ä¸ºdefaultå€¼çš„è¯¥ç»“æ„ç±»å‹å¯¹è±¡ã€‚structåŒ…å«åµŒå¥—æ—¶ï¼Œæ¯ä¸€å±‚structä¹Ÿéƒ½ä¼šå¦‚æ­¤ã€‚

defaultè¿ç®—ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½œç”¨äºæ¥å£ã€‚å®ƒå°†è¿”å›`null`ã€‚

defaultè¿ç®—ç¬¦ï¼Œåœ¨ç»™æ³›å‹ç±»å‹èµ‹åˆå€¼æ—¶ååˆ†æœ‰ç”¨ã€‚åœ¨æ³›å‹ç±»å‹ä¸ºå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹æ—¶å¯è·å–åˆ°ä¸åŒçš„é»˜è®¤å€¼ã€‚ï¼ˆC#2.0ï¼‰

C#7.1ä¹‹åï¼Œæ”¯æŒ[defaultæ–‡æœ¬](#C#%207.1çš„æ”¹è¿›)ï¼Œå¯ä»¥è‡ªåŠ¨è¿›è¡Œç±»å‹æ¨æ–­ã€‚

> å› ä¸ºJavaçš„æ³›å‹ç±»å‹ä¸èƒ½æ˜¯intã€booleanç­‰åŸºæœ¬ç±»å‹ï¼Œå› è€ŒJavaçš„æ³›å‹å¯¹è±¡å¹¶ä¸å­˜åœ¨é»˜è®¤å€¼ä¸åŒçš„æƒ…å†µï¼ˆå› ä¸ºæ³›å‹å¯¹è±¡ä¸€å®šå¯nullï¼Œæ‰€ä»¥é»˜è®¤å€¼å¿…ç„¶ä¸ºnullï¼‰ã€‚å› æ­¤ï¼ŒJavaæ²¡æœ‰ï¼Œä¹Ÿæ²¡å¿…è¦æœ‰defaultè¿ç®—ç¬¦ã€‚

#### nullåˆ¤æ–­è¿ç®—ç¬¦

`??`æ˜¯ä¸€ä¸ªäºŒå…ƒè¿ç®—ç¬¦ï¼Œå·¦å€¼å¿…é¡»ä¸ºå¯nullç±»å‹

å®ƒçš„å«ä¹‰ä¸ºï¼š

1. å·¦å€¼å¦‚æœä¸ºnullï¼Œåˆ™è¡¨è¾¾å¼è¿”å›å³ä¾§çš„å€¼
2. å·¦å€¼å¦‚æœä¸ä¸ºnullï¼Œåˆ™è¡¨è¾¾å¼è¿”å›å·¦ä¾§çš„å€¼

æ³¨æ„ï¼Œå·¦ä¾§ç±»å‹éœ€ä¸ºå³å€¼ç±»å‹çš„åå˜ç±»å‹ã€æˆ–è€…å¯éšå¼è½¬æ¢ä¸ºçš„ç±»å‹ã€‚è¡¨è¾¾å¼è¿”å›çš„ç±»å‹ä¸ºå·¦å€¼çš„ç±»å‹ã€‚

```c#
int? a = null; //Nullable<int>ç±»å‹ï¼ŒC#2.0å¼•å…¥
int? b = a ?? 1;  //bçš„å€¼ä¸º1
```

### è¿ç®—ç¬¦çš„ç‰¹è‰²è¯­æ³•

ç›¸è¾ƒäºJavaï¼ŒC#æœ‰ä»¥ä¸‹ç‰¹è‰²è¯­æ³•ï¼š

#### ç´¢å¼•å™¨ï¼ˆIndexerï¼‰

C#å…è®¸å¼€å‘è€…ï¼Œä½¿ç”¨ç±»ä¼¼è®¿é—®æ•°ç»„çš„æ–¹å¼ï¼Œæ¥è®¿é—®å¯¹è±¡å†…çš„å…ƒç´ 

ç´¢å¼•å™¨çš„å®šä¹‰ï¼Œå¦‚ä¸‹å½¢å¼ï¼š

```c#
public class SomeList
{
    object[] objs = new object[100];
    public object this[int index] 
    {
        get { return objs[index]; }
        set { objs[index] = value; }
    }
}
```

å…¶ä¸­ï¼Œ`this[]`æ˜¯ç´¢å¼•å™¨å®šä¹‰çš„å…³é”®è¯­æ³•ã€‚

ç´¢å¼•å™¨å†…å¿…é¡»è¦æŒ‡å®šgetterå’Œsetterã€‚

ä¸Šè¿°ä¾‹å­å®šä¹‰äº†ä¸€ä¸ªä½¿ç”¨å•ä¸ªintç±»å‹çš„ç´¢å¼•é”®ï¼ˆkeyï¼‰ã€æ•°æ®ç±»å‹ä¸ºobjectçš„ç´¢å¼•å™¨ã€‚å…¶ä¸­ï¼Œç´¢å¼•é”®çš„æ•°é‡å¯ä»¥æ˜¯å¤šä¸ªï¼Œä½¿ç”¨è¯­æ³•ä¸ä½¿ç”¨å¤šç»´çŸ©é˜µæ•°ç»„ç›¸åŒã€‚

ä¸€ä¸ªç±»æ”¯æŒåŒæ—¶å®šä¹‰å¤šä¸ªç´¢å¼•å™¨ã€‚ä¸åŒçš„keyæ•°é‡ï¼Œæˆ–è€…ä¸åŒçš„keyç±»å‹ï¼Œè§†ä½œä¸åŒç´¢å¼•å™¨ï¼Œå¯ä»¥å¹¶å­˜ã€‚

å®šä¹‰äº†ç´¢å¼•å™¨ä¹‹åï¼Œå°±å¯ä»¥åƒä½¿ç”¨æ•°ç»„ä¸€æ ·ï¼Œä½¿ç”¨ç´¢å¼•å™¨æ¥æ“ä½œå¯¹è±¡ï¼š

```c#
SomeList someList = new SomeList();  //è¿™é‡Œå‡è®¾someListå·²ç»åŒ…å«äº†ä¸€äº›å…ƒç´ 
object firstItem = someList[0];  //è°ƒç”¨ç´¢å¼•å™¨çš„getterï¼Œè·å–å…ƒç´ 
someList[0] = new object();      //è°ƒç”¨ç´¢å¼•å™¨setterï¼Œè®¾ç½®å…ƒç´ 
```

å¯¹äºäº†å®ç°å¤šç§ç´¢å¼•å™¨çš„ç±»ï¼Œå¤šç§ç´¢å¼•å™¨å¯ä»¥åŒæ—¶ä½¿ç”¨ï¼š

```c#
SomeCollection someCollection = new SomeCollection();   //è¿™é‡Œå‡è®¾someCollectionå·²ç»åŒ…å«äº†ä¸€äº›å…ƒç´ 
string item0 = somecollection[0]; //ç´¢å¼•é”®ä¸ºintç±»å‹ï¼Œæ•°æ®ç±»å‹ä¸ºstringçš„ç´¢å¼•å™¨
bool itemA = someCollection["a"]; //ç´¢å¼•é”®ä¸ºstringç±»å‹ï¼Œæ•°æ®ç±»å‹ä¸ºboolçš„ç´¢å¼•å™¨
somecollection['c', 1.0] = 7;     //ç´¢å¼•é”®ä¸ºcharå’Œfloatç±»å‹ï¼Œæ•°æ®ç±»å‹ä¸ºintçš„ç´¢å¼•å™¨
```

> ä»åŠŸèƒ½ä¸Šè®²ï¼Œç´¢å¼•å™¨ä¸Javaçš„Listç­‰æ¥å£çš„getï¼Œsetæ–¹æ³•ä½œç”¨ç›¸åŒã€‚å› ä¸ºæœ‰ç´¢å¼•å™¨è¯­æ³•ï¼Œä¸”C#çš„Listã€Dictionaryç­‰ç³»ç»Ÿç±»å‡å®ç°äº†ç´¢å¼•å™¨ï¼Œåœ¨ä½¿ç”¨Listã€Dictionaryç­‰åˆ—è¡¨ã€é›†åˆç±»å‹è·å–å’Œè®¾ç½®å…ƒç´ æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ›´ç®€æ´çš„è¯­æ³•ï¼Œæé«˜ä»£ç ç¾è§‚åº¦ã€‚è€Œåœ¨åˆå§‹åŒ–å™¨ï¼ˆC#2.0å¼•å…¥ï¼‰å’Œç´¢å¼•åˆå§‹åŒ–è¡¨è¾¾å¼ï¼ˆC#6.0å¼•å…¥ï¼‰è¯­æ³•ä¸­ï¼Œè¿™ç§ä»£ç è¡¨ç°åŠ›çš„å·®å¼‚æ›´åŠ æ˜æ˜¾ã€‚

#### è¿ç®—ç¬¦é‡è½½ï¼ˆOperator Overloadingï¼‰

è·ŸC++ä¸€æ ·ï¼ŒC#å…è®¸ç±»å¯¹è¿ç®—ç¬¦è¿›è¡Œé‡è½½

**å¯é‡è½½**çš„è¿ç®—ç¬¦æœ‰ï¼š

- `+`, `-`, `!`, `~`, `++`, `--`, `true`, `false` ç­‰ä¸€å…ƒè¿ç®—ç¬¦
- `+`, `-`, `*`, `/`, `%`, `|`, `&`, `^`, `<<`, `>>` ç­‰äºŒå…ƒè¿ç®—ç¬¦
- `==`, `!=`, `<`, `>`, `<=`, `>=` ç­‰äºŒå…ƒæ¯”è¾ƒè¿ç®—ç¬¦

**ä¸å¯é‡è½½**çš„è¿ç®—ç¬¦ï¼š

- `&&`å’Œ`||`ä½œä¸ºå…³ç³»è¿ç®—ç¬¦ï¼Œä¸å¯ä»¥é‡è½½ã€‚
- åˆå¹¶èµ‹å€¼è¿ç®—ç¬¦ï¼š`+=`, `-=`, `*=`, `/=`, `%=`, `&=`, `|=`, `^=`, `<<=`, `>>=`ï¼Œä¸å¯è¢«é‡è½½ã€‚
- `^x`, `x=y`, `x.y`, `x?.y`, `c?t:f`, `x??y`, `x??=y`, `x..y`, `x->y`, `=>`, `f(x)`, `as`, `await`, `checked`, `unchecked`, `default`, `delegate`, `is`, `nameof`, `new`, `sizeof`, `stackalloc`, `switch`, `typeof`, `with`è¿™äº›è¿ç®—ç¬¦ä¸èƒ½è¢«é‡è½½ã€‚

è¿ç®—ç¬¦é‡è½½æ–¹æ³•ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

- å¿…é¡»æ˜¯`static`æ–¹æ³•
- æ–¹æ³•åä¸º`operator`å…³é”®è¯åé¢è·Ÿä¸Šè¿ç®—ç¬¦ï¼ˆå¯ä»¥æœ‰ç©ºæ ¼ï¼‰
- ä¸èƒ½è¿”å›`void`
- å‚æ•°ä¸ªæ•°å¿…é¡»ä¸åŸè¿ç®—ç¬¦çš„å‚æ•°ä¸ªæ•°ç›¸åŒï¼Œå³ä¸€å…ƒè¿ç®—ç¬¦å‚æ•°åªèƒ½æ˜¯1ä¸ªï¼ŒäºŒå…ƒè¿ç®—ç¬¦å‚æ•°åªèƒ½æ˜¯2ä¸ª
- å‚æ•°ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ˜¯æœ¬ç±»çš„ç±»å‹
- å¦‚æœé‡è½½äº†`==`ï¼Œåˆ™å¿…é¡»ä¹Ÿé‡è½½`!=`ï¼›åŒç†`<`å’Œ`>`ä¹Ÿå¿…é¡»ä¸€èµ·é‡è½½ï¼Œ`<=`å’Œ`>=`ä¹Ÿå¿…é¡»ä¸€èµ·é‡è½½ã€‚å¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚

é‡è½½è¿ç®—ç¬¦çš„è¿”å›ç±»å‹ï¼Œä¸å¿…æ˜¯æœ¬ç±»ç±»å‹ã€‚

å¦å¤–ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæœ‰è¶£çš„ç»†èŠ‚ï¼š`true`å’Œ`false`çš„operatorä¹Ÿæ˜¯å¯ä»¥é‡è½½çš„ã€‚é…åˆæ¯”è¾ƒè¿ç®—ç¬¦çš„é‡è½½ï¼ˆäº‹å®ä¸Šæ¯”è¾ƒè¿ç®—ç¬¦ä¹Ÿå¯ä»¥è¿”å›éboolç±»å‹ï¼‰ã€‚å¯ä»¥è®©ç±»å‹è¿›è¡Œé€»è¾‘è¿ç®—ã€‚ä½†æ˜¯ï¼Œé™¤éä½ æ˜¯ç”¨ä½œç§‘å­¦è¿ç®—ï¼Œå¹¶ä¸”æœ‰æ˜ç¡®çš„æ•°å­¦å·¥å…·ä½œä¸ºæ”¯æ’‘ï¼Œå¦åˆ™éå¸¸ä¸å»ºè®®è¿™ä¹ˆå¹²ï¼Œè¿™ä¼šé™ä½ä»£ç å¯è¯»æ€§ã€‚

åœ¨é‡è½½`==`æ—¶ï¼Œä¸€èˆ¬å»ºè®®åŒæ­¥é‡å†™Equalsæ–¹æ³•ï¼Œä»¥ä¾¿ç¬¦åˆä¸€è‡´æ€§è¦æ±‚ã€‚å¦‚æœé‡è½½`==`è€Œä¸é‡å†™Equalsæ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºè­¦å‘Šï¼Œä½†ä¸æ˜¯æŠ¥é”™ã€‚

> **è¿ç®—ç¬¦çš„é‡è½½ç‰¹æ€§ï¼Œæ˜¯å¤§å¤šæ•°å¼€å‘è€…åœ¨æœ€åˆå¯¹æ¯”Javaå’ŒC#æ—¶ï¼Œæœ€å¿«æ„Ÿå—åˆ°çš„è¯­æ³•å·®å¼‚å†²å‡»ã€‚**

ä»¥ä¸¤ä¸ªä¾‹å­æ¥çœ‹çœ‹ï¼Œè¿ç®—ç¬¦é‡è½½å¸¦æ¥çš„é…£ç•…æ·‹æ¼“çš„å¥½å¤„ï¼š

##### stringçš„`==`

ç³»ç»Ÿç±»åº“å·²ç»å¯¹stringç±»åšäº†`==`è¿ç®—ç¬¦çš„é‡è½½ã€‚å› æ­¤ï¼Œåœ¨C#ä¸­ï¼Œä½¿ç”¨`str1 == str2`æ¥åˆ¤æ–­å­—ç¬¦ä¸²ç›¸ç­‰æ—¶æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚è¿™ä¹Ÿç¬¦åˆå¤§å¤šæ•°è¯­è¨€çš„è¯­ä¹‰ä¹ æƒ¯ã€‚

> ä½œä¸ºC#å¼€å‘è€…ï¼Œé¦–æ¬¡æ¥è§¦Javaæ—¶ï¼Œéå¸¸å®¹æ˜“çŠ¯çš„é”™è¯¯å°±æ˜¯ç”¨`==`æ¥åˆ¤æ–­å­—ç¬¦ä¸²ç›¸ç­‰ã€‚å› ä¸ºJavaä¸­å¯¹äºå¼•ç”¨ç±»å‹ï¼Œ`==`äº‹å®ä¸Šä»…ä»…åˆ¤æ–­äº†ä¸¤ä¸ªå¼•ç”¨å¯¹è±¡æ˜¯å¦æŒ‡å‘åŒä¸€å—å†…å­˜åŒºåŸŸã€‚åœ¨Javaä¸­ï¼Œåªèƒ½ç”¨equalsæ–¹æ³•è¿›è¡Œå­—ç¬¦ä¸²ç›¸ç­‰åˆ¤æ–­ã€‚è¿™ä¹Ÿæ˜¯è®¸å¤šCShaperåˆšåˆšè½¬Javaæ—¶ï¼Œåæ§½æœ€å¤šçš„åœ°æ–¹ã€‚

##### DateTimeçš„`+`ã€`-`ã€`>`ã€`<`ã€`>=`ã€`<=`

ä¸¤ä¸ªDateTimeå¯¹è±¡ç›¸å‡ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªTimeSpanç±»å‹çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¡¨ç¤ºåº¦è¿‡äº†å¤šé•¿æ—¶é—´ã€‚

DateTimeå¯¹è±¡`+`æˆ–è€…`-`ä¸€ä¸ªTimeSpanå¯¹è±¡ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„DateTimeå¯¹è±¡ï¼Œä¸ºåŠ å‡æ—¶é—´å·®ä¹‹åçš„æ—¶é—´ã€‚

ä¸¤ä¸ªDateTimeå¯¹è±¡å¯ä»¥ç›´æ¥é€šè¿‡`>`ã€`<`ã€`>=`ã€`<=`ç­‰æ¥æ¯”è¾ƒå…ˆåã€‚

```c#
DateTime now = DateTime.Now;  
DateTime timeSince = new DateTime(2021, 12, 24, 18, 0, 0);  
TimeSpan ts = now - timeSince;  //è·å–æ—¶é—´å·®
Console.WriteLine(ts.TotalSeconds); //æ‰“å°åº¦è¿‡äº†å¤šå°‘ç§’ï¼ŒåŒ…å«å°æ•°

TimeSpan addOneDay = new TimeSpan(1, 0, 0, 0); //ä¸€å¤©å
DateTime tomorrowSameTime = now + addOneDay;  //åŠ ä¸Š1å¤©
Console.WriteLine(tomorrowSameTime.ToString("yyyy-MM-dd HH:mm-ss")); //æ‰“å°æ˜å¤©çš„è¿™ä¸ªæ—¶é—´

bool isBefore = tomorrowSameTime < now;  //ä½¿ç”¨<å·æ¯”è¾ƒæ—¶é—´å…ˆå
```

PS: äº‹å®ä¸Šï¼Œç°åœ¨çš„é¡¹ç›®ä¸­ï¼Œå¤§å¤šç”¨DateTimeOffsetç»“æ„æ¥æ›¿ä»£DateTimeã€‚DateTimeOffsetæ‹¥æœ‰æ›´å¼ºçš„æ—¶åŒºæ§åˆ¶ï¼Œå¯ä»¥é¿å…ä¸€äº›å› ä¸ºæ—¶åŒºå¯¼è‡´çš„é—®é¢˜ã€‚

> Javaè¦å®ç°æ—¶é—´çš„åŠ å‡æ³•ï¼Œå¤§ä½“æœ‰ä¸‰ç§æ–¹å¼ï¼š
>
> - ä½¿ç”¨Dateç±»æ—¶ï¼Œä»…é Dateç±»ä¸å¤Ÿï¼Œè¿˜å¿…é¡»ä½¿ç”¨Calendarç±»ã€‚Calendarç±»åœ¨è°ƒç”¨æ–¹æ³•è¿›è¡Œæ—¶é—´åŠ å‡æ—¶ï¼Œå…¶è¡¨è¾¾æ–¹æ³•ç›¸å½“åäººç±»ï¼Œä½ æ— æ³•åªè°ƒç”¨ä¸€ä¸ªæ–¹æ³•å°±å°†æ—¶é—´å¢åŠ 1å¤©é›¶3å°æ—¶21åˆ†7ç§’ã€‚
> - ä½¿ç”¨æ—¶é—´æˆ³ï¼Œå¯¹æ—¶é—´æˆ³ç›´æ¥è®¡ç®—ã€‚æ˜¾ç„¶ï¼Œè¿™ä¹Ÿä¸å¤Ÿhumanityã€‚
> - ä½¿ç”¨java.timeåŒ…ä¸‹é¢çš„ç±»ï¼Œä¾‹å¦‚LocalDateTimeã€‚è¯¥åŒ…ä¸‹é¢çš„ç±»ç›¸å¯¹äººæ€§åŒ–ä¸€ç‚¹ã€‚ä½†æ˜¯å®ƒçš„åŠ å‡è®¡ç®—ä»ç„¶éœ€è¦é€šè¿‡æ–¹æ³•è°ƒç”¨ã€‚ç”±äºè¯­è¨€çš„æœºåˆ¶æ— æ³•æ”¯æŒ`+`/`-`è¿ç®—ç¬¦ã€‚

ç»¼ä¸Šï¼Œé€šè¿‡è¿ç®—ç¬¦é‡è½½ï¼Œå¯ä»¥ä¹¦å†™å‡ºæ›´è´´è¿‘è‡ªç„¶è¯­è¨€çš„ä»£ç ã€‚ä»è€Œä½¿å¾—ä»£ç æ›´åŠ æ˜“äºç†è§£ï¼Œæ›´æœ‰åˆ©äºç»´æŠ¤ã€‚

#### è‡ªå®šä¹‰ç±»å‹è½¬æ¢ï¼ˆUser-Defined Conversion Operatorï¼‰

è‡ªå®šä¹‰ç±»å‹è½¬æ¢ï¼Œä¹Ÿæ˜¯å¾ˆå¥½ç”¨çš„è¯­æ³•ã€‚æ˜¯çœäº‹å„¿çš„åˆ©å™¨ã€‚

å…ˆçœ‹ä¸‹ç³»ç»Ÿé»˜è®¤çš„ç±»å‹è½¬æ¢ï¼š

```c#
int x = 0;
double y = x;  //éšå¼ç±»å‹è½¬æ¢
double z = (double)x;  //æ˜¾å¼ç±»å‹è½¬æ¢
```

è€Œå¯¹äºè‡ªå®šä¹‰çš„ç±»ï¼ŒC#ä¹Ÿå…è®¸å¼€å‘è€…å®šä¹‰è‡ªå®šä¹‰çš„ç±»å‹è½¬æ¢

ç±»å‹è½¬æ¢æ–¹æ³•çš„å®šä¹‰å½¢å¦‚ï¼š

```c#
public static implicit operator SomeClass(byte byteValue) { ... }  //éšå¼ç±»å‹è½¬æ¢
public static explicit operator int(SomeClass someClassObject) { ... }  //æ˜¾å¼ç±»å‹è½¬æ¢
```

ç±»å‹è½¬æ¢æ–¹æ³•éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

- å¿…é¡»æ˜¯`static`æ–¹æ³•
- å¿…é¡»æŒ‡å®šæ˜¯éšå¼ï¼ˆ`implicit`ï¼‰è¿˜æ˜¯æ˜¾å¼ï¼ˆ`explicit`ï¼‰
- åŒ…å«`opertaor`å…³é”®è¯
- `operetor`å…³é”®è¯åé¢è·Ÿè¦è½¬æ¢è¿”å›çš„ç±»å‹åç§°ï¼Œè¯¥æ–¹æ³•ä¸å¿…åƒå…¶ä»–æ–¹æ³•ä¸€æ ·å£°æ˜è¿”å›ç±»å‹ï¼Œæ–¹æ³•åç§°å°±æ˜¯è¿”å›ç±»å‹ã€‚
- å‚æ•°åªèƒ½æœ‰ä¸€ä¸ª
- å‚æ•°æˆ–è€…æ–¹æ³•åï¼ˆå³è¿”å›ç±»å‹ï¼‰ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ˜¯æœ¬ç±»ç±»å‹

æ³¨æ„ï¼š

- ä½œä¸ºæ–¹æ³•åå…¼è¿”å›ç±»å‹ï¼Œåˆ«åä¸å®Œæ•´åç§°æ˜¯ç­‰æ•ˆçš„ã€‚ä»¥ä¸‹ä¸‰è€…æ˜¯åŒä¸€ä¸ªç±»å‹è½¬æ¢æ–¹æ³•ï¼š
    - `public static implicit operator int(MyClass obj)`
    - `public static implicit operator Int32(MyClass obj)`
    - `public static implicit operator System.Int32(MyClass obj)`
- ä»ä¸€ä¸ªç±»å‹åˆ°å¦ä¸€ä¸ªç±»å‹çš„è½¬æ¢ï¼Œåªèƒ½æŒ‡å®šéšå¼çš„æˆ–è€…æ˜¾å¼å…¶ä¸­ä¹‹ä¸€ï¼Œä¸èƒ½åŒæ—¶å£°æ˜ä¸¤è€…ï¼Œä¼šå†²çªã€‚

ä¸‹é¢æˆ‘ä»¬æ¥ä¸¾ä¸ªå¸¸è§çš„åº”ç”¨åœºæ™¯ä½œä¸ºä¾‹å­ã€‚

è€ƒè™‘å¸¸è§çš„Resultç±»:

```c#
public class Result
{
    public int Code { get; set; }  //æ­¤å¤„å†™æ³•ä¸ºè‡ªåŠ¨å±æ€§ï¼ŒC#2.0ä¼šè®²åˆ°ã€‚ä¸”æ­¤å¤„ç”¨æšä¸¾ä¼šæ›´å¥½ã€‚è¿™é‡Œä»…ä½œç¤ºä¾‹
    public string Message{ get; set; }  
}
```

å¸¸ç”¨æ¥ä½œä¸ºWebæ¥å£çš„è¿”å›ï¼š

```c#
public Result SomeOperation()
{
    Result rsl = new Result();
    bool successful = doSomeThing();
    if (successful)
    {
        rsl.Code = 0;
        rsl.Message = "æ“ä½œæˆåŠŸ";
    }
    else
    {
        rsl.Code = -1;
        rsl.Message = "æ“ä½œå¤±è´¥";
    }
    return rsl;
}
```

ä¸Šè¿°ä¾‹å­æå…·ä»£è¡¨æ€§ã€‚æˆ‘ä»¬å¯èƒ½å¤§éƒ¨åˆ†æ—¶å€™åªä¼šè¿”å›å›ºå®šçš„ä¸¤ç§ç»„åˆï¼šè¿”å›Codeä¸º0ï¼Œä¸”Messageä¸ºâ€œæ“ä½œæˆåŠŸâ€ï¼›è¿”å›Codeä¸º-1ï¼Œä¸”Messageä¸ºâ€œæ“ä½œå¤±è´¥â€ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘ç»™Resultç±»å¢åŠ å¦‚ä¸‹çš„éšå¼ç±»å‹è½¬æ¢

```c#
public static implicit operator Result(bool success)
{
    //æ­¤å¤„ä½¿ç”¨äº†åˆå§‹åŒ–å™¨ï¼Œç”¨äºåœ¨newå‡ºä¸€ä¸ªå¯¹è±¡çš„åŒæ—¶ï¼Œç»™å¯¹è±¡çš„å±æ€§èµ‹å€¼ã€‚C#2.0å¼•å…¥ï¼Œä»¥åæˆ‘ä»¬ä¼šè®²åˆ°
    return success 
        ? new Result { Code = 0, Message = "æ“ä½œæˆåŠŸ" }
        : new Result { Code = -1, Message = "æ“ä½œå¤±è´¥" };   
}
```

äºæ˜¯ï¼ŒResultç±»å°±å®ç°äº†ä»boolç±»å‹åˆ°Resultç±»å‹çš„éšå¼ç±»å‹è½¬æ¢ã€‚å¯¹äºåŸå…ˆçš„SomeOperationæ–¹æ³•ï¼Œä¾¿å¯ä»¥ç®€åŒ–æˆè¿™æ ·ï¼š

```c#
public Result SomeOperation()
{
    bool successful = doSomeThing();
    return successful;  //ä¼šè§¦å‘éšå¼ç±»å‹è½¬æ¢
}
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç±»å‹è½¬æ¢ï¼Œåœ¨é€‚å½“åœºæ™¯ä¸‹å‡å°‘ä»£ç é‡ã€‚

> Javaä¸æ”¯æŒç±»å‹è‡ªå®šä¹‰è½¬æ¢ã€‚è¦è¾¾åˆ°ç±»ä¼¼æ•ˆæœï¼Œè¯·å®ç°ä¸€ä¸ªä¸“ç”¨å¤„ç†æ–¹æ³•ï¼Œç”¨äºå°†ä¼ å…¥çš„boolè½¬æ¢æˆResultã€‚åœ¨æ¯ä¸ªéœ€è¦åšç±»å‹è½¬æ¢çš„åœ°æ–¹è°ƒç”¨è¯¥æ–¹æ³•ã€‚

> ä»…ä»…é’ˆå¯¹ä¸Šè¿°ä¾‹å­çš„è¯ï¼ŒJavaå¯ä»¥ç›´æ¥ä½¿ç”¨æšä¸¾ç±»å‹å®ç°ã€‚ä½†æ˜¯ï¼Œå¯¹äºæ›´æ™®éä½¿ç”¨çš„ â€”â€” åŒ…å«æ•°æ®è¿”å›çš„Resultï¼Œåˆ™æ— æ³•ç”¨æšä¸¾å®ç°ã€‚å› ä¸ºè¦ç”¨åˆ°æ³›å‹ï¼Œè¿™é‡Œå°±ä¸ä¸¾ä¾‹äº†ã€‚

## è¯­å¥ï¼ˆStatementï¼‰

### lock

ä¹‹æ‰€ä»¥æåˆ°`lock`è¯­å¥å—ï¼Œä¸€æ˜¯å› ä¸ºå®ƒæ˜¯è¯­æ³•çº§åˆ«çš„å¤šçº¿ç¨‹äº’æ–¥é”ã€‚äºŒæ˜¯å‡ ä¹\.Netçš„é¢è¯•éƒ½ä¼šè¢«é—®åˆ°ã€‚

lockå—æ˜¯ä¸€æ®µè¯­å¥å—ï¼Œå®ƒåœ¨åŒä¸€æ—¶é—´ä»…å…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¯¥å—ã€‚

```c#
lock (x)
{
    //åšä¸€äº›åªèƒ½å•çº¿ç¨‹è¿›è¡Œçš„æ“ä½œ
}
```

lockä¸ºè¯­æ³•çº§åˆ«çš„ï¼Œä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œæ‰€ä»¥æ·±å—æ¬¢è¿ã€‚

åœ¨ä½¿ç”¨lockæ—¶ï¼Œä»ç„¶æœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š

1. ç”¨äºlockçš„å¯¹è±¡åªèƒ½æ˜¯å¼•ç”¨ç±»å‹
2. ç”¨äºlockçš„å¯¹è±¡åº”å½“é¿å…æ˜¯publicçš„ï¼Œä»¥å…è¶…å‡ºé¢„æœŸæ§åˆ¶èŒƒå›´
3. é¿å…lock stringç±»å‹çš„å¯¹è±¡ã€‚è¿™æ˜¯\.Netçš„æœºåˆ¶æ‰€å†³å®šçš„ã€‚åœ¨\.Netä¸­ï¼Œç›¸åŒçš„å­—ç¬¦ä¸²ä¼šæŒ‡å‘åŒä¸€å—å­˜å‚¨åŒºåŸŸï¼Œå³ä½¿æ˜¯è®¡ç®—åå¾—æ¥çš„å­—ä¸²ï¼ˆå› ä¸ºstringæ˜¯ä¸å¯å˜ç±»å‹ï¼‰ã€‚
4. é¿å…lock(this)ã€‚

> Javaçš„å¯¹ç…§ç‰©ä¸º`synchronized`ï¼Œè€Œä¸”å®ƒå¯ä»¥ä½¿ç”¨åœ¨æ›´å¤šçš„åœ°æ–¹ã€‚
>
> - synchronizedå¯ç”¨ä½œå¼€å¯è¯­å¥å—ï¼Œç”¨æ³•äºlockç›¸åŒï¼Œä½œç”¨ä¹Ÿä¸€è‡´ã€‚ä¸åŒäºlockä¸€èˆ¬è¦é¿å…lock(this)ï¼Œsynchronizedåˆ™ä¸€èˆ¬ç›´æ¥synchronized(this)ã€‚
> - synchronizedè¿˜å¯ä»¥ç”¨äºä¿®é¥°æ–¹æ³•ï¼Œè¡¨æ˜æ•´ä¸ªæ–¹æ³•å‡æ»¡è¶³çº¿ç¨‹äº’æ–¥ï¼Œç›¸å½“äºæ•´ä¸ªæ–¹æ³•è¢«synchronized(this)åŒ…è£¹ã€‚
> - synchronizedè¿˜å¯ç”¨äºä¿®é¥°é™æ€çš„æ–¹æ³•ï¼ŒåŒæ ·è¡¨æ˜æ•´ä¸ªæ–¹æ³•å‡æ»¡è¶³çº¿ç¨‹äº’æ–¥ã€‚ä½†æ­¤æ—¶ä¸å†é™åˆ¶åœ¨å¯¹è±¡å†…ï¼Œä»»ä½•å¯¹è¯¥æ–¹æ³•çš„è°ƒç”¨éƒ½æ˜¯äº’æ–¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨å¯¹è±¡è°ƒç”¨çš„æ­¤é™æ€æ–¹æ³•ï¼Œå®ƒè¡¨ç°ä¸ºå¯¹æ‰€æœ‰å¯¹è±¡éƒ½äº’æ–¥ã€‚
> - synchronizedè¿˜å¯ä»¥ä½¿ç”¨synchronized(ç±»å.class)ï¼Œæ­¤æ—¶è¿™ä¸ªç±»çš„æ‰€æœ‰é™æ€æ–¹æ³•éƒ½ä¼šä½¿ç”¨äº’æ–¥é”ã€‚

### è¯´æ˜æ³¨é‡Šï¼ˆæ–‡æ¡£æ€§æ³¨é‡Šï¼ŒDocumentation Commentï¼‰

C#çš„è¯´æ˜æ³¨é‡Šï¼Œæ ¼å¼ä¸º///å¼€å¤´çš„ä¸€æ®µXML

- è¯´æ˜æ³¨é‡Šçš„æ¯ä¸€è¡Œéƒ½æ˜¯ä»¥ä¸‰ä¸ª/å¼€å¤´ï¼ˆå¯ä»¥å¤šï¼Œä½†ä¸å¯ä»¥å°‘ï¼‰
- è¯´æ˜æ³¨é‡Šçš„æ˜¯XMLæ ¼å¼çš„ï¼Œéœ€è¦ç¬¦åˆXMLå®šä¹‰ã€‚ä¾‹å¦‚ï¼šæ ‡ç­¾éœ€è¦æœ‰å¼€å’Œå…³ã€‚

ä½¿ç”¨äº†è¯´æ˜æ³¨é‡Šæè¿°çš„ç±»ã€æ–¹æ³•ã€å‚æ•°ç­‰ï¼Œåœ¨è¢«å¼•ç”¨æ—¶ï¼ŒIDEä¼šç»™å‡ºè¯´æ˜æç¤ºã€‚

è¯´æ˜æ³¨é‡Šä¸¾ä¾‹ï¼š

```c#
/// <summary>
/// éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ æ ·æœ¬
/// </summary>
/// <typeparam name="T">å…ƒç´ ç±»å‹</typeparam>
/// <param name="source">å¾…é€‰æ‹©æ ·æœ¬</param>
/// <returns>éšæœºé€‰æ‹©çš„æ ·æœ¬</returns>
public static T SelectRandom<T>(this IEnumerable<T> source) { ... } //æ­¤å¤„å®šä¹‰äº†æ‰©å±•æ–¹æ³•ï¼Œæ‰©å±•æ–¹æ³•åœ¨C#3.0å¼•å…¥
```

è¯´æ˜æ³¨é‡Šå¯åœ¨ç¼–è¯‘è®¾ç½®ä¸­å¯ç”¨ç”ŸæˆXMLæ–‡æ¡£çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨ç”ŸæˆXMLæè¿°æ–‡æ¡£ã€‚è¯¥æ–‡æ¡£æœ‰å¾ˆå¤šç”¨é€”ï¼Œä¾‹å¦‚ï¼š

- æ‰“æˆNugetåŒ…åï¼Œå¦‚æœå­˜åœ¨XMLæ–‡æ¡£ï¼Œå¼•ç”¨è€…åœ¨ä½¿ç”¨ç±»åº“æ—¶ï¼ŒIDEä¼šç»™å‡ºè¯´æ˜æç¤ºã€‚
- Swaggerç»„ä»¶å¯ä»¥ç›´æ¥è¯»å–XMLæ–‡æ¡£å†…å®¹ï¼Œè‡ªåŠ¨ç”ŸæˆSwaggeræ–‡æ¡£ã€‚

> To CShaperï¼šåšä¸ºå¯¹æ¯”ï¼ŒJavaçš„è¯´æ˜æ³¨é‡Šä¸º /**å¼€å¤´ï¼Œ */ç»“å°¾çš„ä¸€æ®µã€‚æ¯ä¸€è¡Œéƒ½æ˜¯\*å¼€å¤´ï¼Œå…·ä½“sectionåˆ™ä»¥@å¼€å¤´çš„ã€‚

> ```java
> //==Java==
> /**
> * è®¡ç®—å¹³æ–¹
> * @param num è¦è®¡ç®—çš„æ•°
> * @return numçš„å¹³æ–¹
> */
> public double square(double num) { ... }
> ```

### é¢„å¤„ç†æŒ‡ä»¤ï¼ˆPreprocessor Directiveï¼‰

ä¸C++çš„å®æŒ‡ä»¤ä¸€æ ·ï¼Œä»¥`#`å¼€å¤´çš„æŒ‡ä»¤ä¸ºé¢„å¤„ç†æŒ‡ä»¤ï¼Œæ˜¯å·¥ä½œåœ¨ç¼–è¯‘é˜¶æ®µçš„æŒ‡ä»¤ã€‚è¯¥æŒ‡ä»¤åªä¼šå½±å“ç¼–è¯‘å™¨å·¥ä½œï¼Œä¸ä¼šç”Ÿæˆä¸ºILä»£ç ã€‚ä½œç”¨æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨åº”è¯¥æ€ä¹ˆåšã€‚

è¿™é‡Œåªè®²ä¸¤ç»„å¸¸ç”¨çš„æŒ‡ä»¤ï¼š

#### #defineå’Œ#if

`#define`æŒ‡ä»¤ç”¨äºå®šä¹‰æ ‡è®°ï¼ˆç±»ä¼¼äºC++çš„å®å®šä¹‰ï¼‰

`#if`æŒ‡ä»¤ç”¨äºåˆ¤æ–­æ ‡è®°æ˜¯å¦å­˜åœ¨ï¼Œå¯¹åº”çš„æŒ‡ä»¤è¿˜æœ‰`#else`ã€`#endif`

å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼šDebugæ¨¡å¼åˆ¤æ–­ã€‚

åœ¨Debugæ¨¡å¼ä¸‹ï¼Œå½“å‰ç¼–è¯‘ä¸Šä¸‹æ–‡ä¼šå®šä¹‰`DEBUG`æ ‡è®°ã€‚å¯ä»¥åˆ©ç”¨`#if`æ¥æ’å…¥ä»…Debugæ¨¡å¼ä¸‹å¯è§çš„è°ƒè¯•ä»£ç ã€‚

ä¾‹å¦‚ï¼š

```c#
#if DEBUG
bool flag = true;
#else
bool flag = false;
#endif
```

åˆ™åœ¨Debugæ¨¡å¼ä¸‹ï¼Œflagä¸ºtrueã€‚

å†æ¬¡å¼ºè°ƒä¸€ä¸‹ï¼š#ifçš„åˆ¤æ–­å‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µã€‚å› è€Œï¼Œåˆ†æ”¯æœªå‘½ä¸­çš„é‚£éƒ¨åˆ†ä»£ç ï¼Œæ ¹æœ¬ä¸ä¼šè¢«ç¼–è¯‘è¿›dllæˆ–exeã€‚å¦‚ä¸Šä¾‹ä¸­ï¼ŒILä¸­åªä¼šå‡ºç°`bool flag = true;`ç¼–è¯‘åçš„ä»£ç ã€‚`bool flag = false;`åˆ™ä¸ä¼šè¢«ç¼–è¯‘ã€‚

#### #region

`#region`ä¸ºåŒºåŸŸæŠ˜å æ ‡è®°ï¼Œå¯¹åº”çš„ç»“æŸæ ‡è®°ä¸º`#endregion`ã€‚åŒºåŸŸå¯ä»¥æä¾›åç§°ã€‚

è¢«åŒºåŸŸæŠ˜å æ ‡è®°åŒ…è£¹çš„ä»£ç ï¼Œåœ¨IDEä¸­å¯ä»¥ä½œä¸ºä¸€ä¸ªæ•´ä½“æŠ˜å èµ·æ¥ã€‚

è¿™åœ¨æ‹†åˆ†è¾ƒå¤§çš„ç±»æ—¶éå¸¸å¥½ç”¨ã€‚å¯ä»¥ä½¿ä»£ç çœ‹èµ·æ¥æ›´æ•´æ´ã€‚

```c#
//åœ¨IDEä¸­ï¼Œä¸‹é¢çš„#regionåˆ°#endregionä¹‹é—´çš„ä»£ç å¯ä»¥æŠ˜å ä¸ºä¸€è¡Œã€‚æŠ˜å åçš„ä½ç½®ä»…æ˜¾ç¤ºåŒºåŸŸåç§°â€œç§æœ‰æ–¹æ³•â€
#region ç§æœ‰æ–¹æ³•
//åœ¨è¿™é‡Œå®šä¹‰ä¸€äº›ç§æœ‰æ–¹æ³•
#endregion
```

## ç‰¹æ€§ï¼ˆAttributeï¼‰

C#ä¸­çš„ç‰¹æ€§ï¼Œä¸Javaçš„æ³¨è§£ï¼ˆAnnotationï¼‰æ˜¯åŒä¹‰è¯ã€‚

ç‰¹æ€§æ˜¯ä¸€ç±»ç‰¹æ®Šçš„ç±»ã€‚å®ƒæ ‡è®°åœ¨ç‰¹å®šä½ç½®ï¼Œç”¨æ¥ç»™ç±»ã€æ–¹æ³•ã€å‚æ•°ã€è¿”å›å€¼ç­‰æ·»åŠ é¢å¤–çš„å£°æ˜ã€å…ƒæ•°æ®ä¿¡æ¯ã€‚

å®šä¹‰ç‰¹æ€§ï¼š

- å£°æ˜ä¸€ä¸ªç±»ï¼Œç»§æ‰¿è‡ªAttributeç±»ï¼Œè¯¥ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ˜¯æ‰€æœ‰ç‰¹æ€§çš„åŸºç±»ã€‚
- åœ¨è¯¥ç±»ä¸Šæ ‡æ³¨AttributeUsageAttributeç‰¹æ€§ï¼Œè¯¥ç‰¹æ€§ç”¨äºæŒ‡æ˜æ‰€å£°æ˜çš„ç‰¹æ€§ç±»çš„ä½œç”¨ç›®æ ‡ã€æ˜¯å¦å…è®¸å¤šé‡æ ‡æ³¨ã€æ˜¯å¦å…è®¸æ´¾ç”Ÿç±»ç»§æ‰¿ç­‰ä¿¡æ¯ã€‚
    - AttributeUsageAttributeçš„æ„é€ å™¨å«ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå…è®¸çš„ä½œç”¨ç›®æ ‡ã€‚å®ƒæ˜¯ä¸€ä¸ªAttributeTargetsç±»å‹çš„ä½æšä¸¾ï¼š
        - Assemblyï¼Œå€¼ä¸º0x1ï¼Œä½œç”¨äºåº”ç”¨ç¨‹åºé›†
        - Moduleï¼Œå€¼ä¸º0x2ï¼Œä½œç”¨äºæ¨¡å—
        - Classï¼Œå€¼ä¸º0x4ï¼Œä½œç”¨äºç±»
        - Structï¼Œå€¼ä¸º0x8ï¼Œä½œç”¨äºç»“æ„
        - Enumï¼Œå€¼ä¸º0x10ï¼Œä½œç”¨äºæšä¸¾
        - Constructorï¼Œå€¼ä¸º0x20ï¼Œä½œç”¨äºæ„é€ å™¨
        - Methodï¼Œå€¼ä¸º0x40ï¼Œä½œç”¨äºæ–¹æ³•
        - Propertyï¼Œå€¼ä¸º0x80ï¼Œä½œç”¨äºå±æ€§
        - Fieldï¼Œå€¼ä¸º0x100ï¼Œä½œç”¨äºå­—æ®µ
        - Eventï¼Œå€¼ä¸º0x200ï¼Œä½œç”¨äºäº‹ä»¶
        - Interfaceï¼Œå€¼ä¸º0x400ï¼Œä½œç”¨äºæ¥å£
        - Parameterï¼Œå€¼ä¸º0x800ï¼Œä½œç”¨äºå‚æ•°
        - Delegateï¼Œå€¼ä¸º0x1000ï¼Œä½œç”¨äºå§”æ‰˜
        - ReturnValueï¼Œå€¼ä¸º0x2000ï¼Œä½œç”¨äºæ–¹æ³•çš„è¿”å›å€¼
        - GenericParameterï¼Œå€¼ä¸º0x4000ï¼Œä½œç”¨äºæ³›å‹ç±»å‹å‚æ•°ï¼ˆC#2.0ï¼‰
        - Allï¼Œå€¼ä¸º0x7FFFï¼Œå³ç­‰äºä¸Šè¿°æ‰€æœ‰ä½æšä¸¾çš„æŒ‰ä½æˆ–ï¼Œä½œç”¨äºä¸Šè¿°ä»»ä½•ç›®æ ‡
    - AttributeUsageAttributeåŒ…å«boolç±»å‹å±æ€§AllowMultipleï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸åœ¨åŒä¸ªå…ƒç´ ä¸Šæ ‡æ³¨å¤šæ¬¡
    - AttributeUsageAttributeåŒ…å«boolç±»å‹å±æ€§Inheritedï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸æ´¾ç”Ÿç±»æˆ–æ´¾ç”Ÿç±»å¯¹åº”å…ƒç´ ç»§æ‰¿æ­¤ç‰¹æ€§
- è§„èŒƒè€Œè¨€ï¼Œç‰¹æ€§ç±»çš„ç±»åï¼Œä¸€èˆ¬ä»¥Attributeç»“å°¾

```c#
[AttributeUsage(AttributeTargets.Property | AttributeTargets.Field | AttributeTargets.Parameter, Inherited = false)] //æŒ‡æ˜AllowNullAttributeçš„ä½œç”¨å¯¹è±¡ä¸ºå±æ€§ã€å­—æ®µæˆ–è€…æ–¹æ³•çš„å‚æ•°ã€‚å¹¶æŒ‡å®šä¸å…è®¸æ´¾ç”Ÿç±»ç»§æ‰¿è¯¥ç‰¹æ€§
public sealed class AllowNullAttribute : Attribute
{
}
```

ä½¿ç”¨ç‰¹æ€§:

- ä½¿ç”¨ç‰¹æ€§çš„è¯­æ³•ä¸º`[ç‰¹æ€§]`ï¼Œæ ‡æ³¨åœ¨ä¿®é¥°ç›®æ ‡ä¹‹å‰ã€‚
- å¦‚æœè¦åŒæ—¶ä½¿ç”¨å¤šä¸ªç‰¹æ€§ï¼Œæ—¢å¯ä»¥ä½¿ç”¨`[ç‰¹æ€§1][ç‰¹æ€§2]`çš„è¯­æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨`[ç‰¹æ€§1, ç‰¹æ€§2]`çš„è¯­æ³•
- å¦‚æœç‰¹æ€§ç±»æœ‰å«å‚æ„é€ æ–¹æ³•ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¯­æ³•`[ç‰¹æ€§(æ„é€ å™¨å‚æ•°åˆ—è¡¨)]`è°ƒç”¨ã€‚
- å¦‚æœç‰¹æ€§ç±»åŒ…å«å…¬å¼€å±æ€§ï¼Œå¯ä»¥åœ¨ä½¿ç”¨ç‰¹æ€§æ—¶æŒ‡å®šå±æ€§å€¼ï¼Œè¯­æ³•ä¸º`[ç‰¹æ€§(æ„é€ å™¨å‚æ•°åˆ—è¡¨, å±æ€§1 = å€¼1, å±æ€§2 = å€¼2, ...)]`ã€‚ä½†æ˜¯éœ€æ³¨æ„ï¼Œèƒ½å¤Ÿç”¨æ­¤è¯­æ³•æŒ‡å®šçš„å±æ€§å€¼ï¼Œåªèƒ½æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€æˆ–è€…æ•°ç»„çš„åˆå§‹åŒ–è¡¨è¾¾å¼ï¼ˆC#2.0ï¼Œ[åˆå§‹åŒ–å™¨](#åˆå§‹åŒ–å™¨ï¼ˆInitializerï¼‰)ã€‚ä¸çŸ¥ä¸ºä½•ï¼Œå¯¹äºæ•°ç»„ï¼Œæ­¤å¤„ä¸æ”¯æŒç›´æ¥ä½¿ç”¨`{}`è¿™ç§æœ€ç®€å½¢å¼ï¼‰ã€‚å¦‚æœå±æ€§çš„ç±»å‹æ— æ³•ä½¿ç”¨å¸¸é‡è¿›è¡Œèµ‹å€¼ï¼Œåˆ™æ— æ³•é€šè¿‡ä¸Šè¿°æ–¹æ³•åœ¨ä½¿ç”¨æ—¶æŒ‡å®šå±æ€§å€¼ã€‚
- å¦‚æœç‰¹æ€§ç±»ä»¥Attributeç»“å°¾ï¼Œåˆ™ä½¿ç”¨ç‰¹æ€§æ—¶å¯ä»¥ç®€å†™ï¼šçœç•¥Attributeåç¼€ã€‚

```c#
public class Test
{
    [AllowNull]  //çœç•¥äº†Attributeåç¼€
    private string name;

    [AllowNullAttribute, CheckPhone] //åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªç‰¹æ€§
    private string phone;

    [JsonProperty("no")] //ä½¿ç”¨å…·æœ‰å«å‚æ„é€ å™¨çš„ç‰¹æ€§
    private int number;

    [Document("objçš„æ–‡æ¡£", Url = "http://doc.somedomain.com/obj")] //é‡‡ç”¨DocumentAttributeçš„ä¸€ä¸ªstringå‚æ•°çš„æ„é€ å™¨ï¼ŒåŒæ—¶æŒ‡å®šå…¶å±æ€§Urlçš„å€¼
    private object obj;
}

```

> Javaçš„æ³¨è§£ï¼Œè™½ç„¶ä¸C#çš„ç‰¹æ€§åŒä¹‰ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸å°‘å·®å¼‚ã€‚
> Javaçš„è‡ªå®šä¹‰æ³¨è§£çš„å£°æ˜å’Œä½¿ç”¨ï¼š
> - å£°æ˜è‡ªå®šä¹‰æ³¨è§£ï¼š
>     - é€šè¿‡`@interface`å…³é”®è¯ï¼Œå› è€Œæ³¨è§£æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»å‹ï¼Œè€Œéclassã€‚å®ƒé»˜è®¤ç»§æ‰¿Annotationæ¥å£ï¼Œå¹¶ä¸”ä¸èƒ½ç»§æ‰¿å’Œå®ç°å…¶ä»–ç±»å’Œæ¥å£ã€‚
>     - æ³¨è§£ç±»åªèƒ½æ˜¯publicæˆ–è€…friedlyï¼ˆå³æ— ä¿®é¥°ç¬¦ï¼‰çš„ï¼Œ
>     - å®šä¹‰æ³¨è§£æœ‰è€…ç‹¬ç‰¹çš„è¯­æ³•ã€‚æ³¨è§£ä¸­çš„å­—æ®µè¢«ç§°ä¹‹ä¸ºå…ƒç´ ã€‚å®šä¹‰æ—¶ä»¥`()`ç»“å°¾ï¼Œåœ†æ‹¬å·å†…ä¸èƒ½æœ‰å‚æ•°ã€‚å¹¶ä¸”å¯ä»¥åœ¨å…¶åé¢ç´§è·Ÿdefaultå…³é”®è¯æä¾›é»˜è®¤å€¼ã€‚å…ƒç´ çš„ç±»å‹åªèƒ½æ˜¯ç®€å•æ•°æ®ç±»å‹ã€Stringã€Classç±»ï¼ˆå¤§ä½“ç›¸å½“äºC#çš„Typeç±»ï¼‰ã€æšä¸¾ã€æ³¨è§£å’Œä¸Šè¿°ç±»å‹çš„æ•°ç»„ã€‚
>     - ä½¿ç”¨`@Target`æ ‡æ³¨æ³¨è§£çš„ä½œç”¨ç›®æ ‡ã€‚å®ƒæ˜¯ä¸ªElementTypeç±»å‹çš„æšä¸¾ï¼Œå¯ä»¥å–å€¼çš„èŒƒå›´ï¼š
>         - TYPEï¼šä½œç”¨äºç±»
>         - FIELDï¼šä½œç”¨äºå­—æ®µ 
>         - METHODï¼šä½œç”¨äºæ–¹æ³•
>         - PARAMETERï¼šä½œç”¨äºæ–¹æ³•
>         - CONSTRUCTORï¼šä½œç”¨äºæ„é€ å™¨
>         - LOCAL_VARIABLEï¼šä½œç”¨äºå±€éƒ¨å˜é‡
>         - ANNOTATION_TYPEï¼šä½œç”¨äºæ³¨è§£ç±»
>         - PACKAGEï¼šä½œç”¨äºPackage
>         - TYPE_PARAMETERï¼šä½œç”¨äºæ³›å‹çš„ç±»å‹å‚æ•°
>         - TYPE_USEï¼šä½œç”¨äºä»»ä½•ç›®æ ‡ï¼Œå³ä¸Šè¿°æ‰€æœ‰ç›®æ ‡
>     - ä½¿ç”¨`@Inherited`æ ‡æ³¨æ³¨è§£æ˜¯å¦å…è®¸æ´¾ç”Ÿç±»ç»§æ‰¿
>     - ä½¿ç”¨`@Retention`æ¥æ ‡è¯†æ³¨è§£çš„ç”Ÿå­˜å‘¨æœŸã€‚å®ƒæ˜¯ä¸ªRetentionPolicyç±»å‹çš„æšä¸¾ï¼Œæ”¯æŒï¼š
>         - SOURCEï¼šä»…åœ¨æºç ä¸­æœ‰æ•ˆï¼Œç¼–è¯‘æ—¶è¢«ä¸¢å¼ƒï¼ˆè¯·ç±»æ¯”é¢„å¤„ç†æŒ‡ä»¤ï¼‰
>         - CLASSï¼šé»˜è®¤å€¼ã€‚æŒ‡ç¼–è¯‘åå­˜åœ¨äº.classçš„å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ç”¨äºæŸäº›å·¥å…·å¯¹.classæ–‡ä»¶è¿›è¡ŒåŠ¨æ€ä¿®æ”¹ã€‚ä½†ä¸ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶è·å–è¯¥æ³¨è§£ã€‚
>         - RUNTIMEï¼šæœ€å¸¸ç”¨çš„ç”Ÿå­˜å‘¨æœŸèŒƒå›´ã€‚ç¼–è¯‘ååœ¨.classå­—èŠ‚ç ä¸­ï¼Œä¼šè¢«åŠ è½½åˆ°JVMä¸­ï¼Œå¹¶ä¸”å¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡åå°„è·å–ã€‚
>         > å¯¹æ¯”ä¹‹ä¸‹ï¼ŒC#æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚æ‰€æœ‰ç‰¹æ€§éƒ½æ˜¯è¿è¡Œæ—¶å¯è§çš„ï¼Œç›¸å½“äºRUNTIMEã€‚
> - ä½¿ç”¨æ³¨è§£
>     - é€šè¿‡`@æ³¨è§£å`ä½¿ç”¨æ³¨è§£ã€‚
>     - æœªæä¾›defaultå€¼çš„å…ƒç´ ï¼Œå¿…é¡»åœ¨ä½¿ç”¨æ—¶æŒ‡å®šå€¼ã€‚æœ‰defaultå€¼çš„åˆ™å¯ä»¥çœç•¥ã€‚
>     - å¦‚éœ€è¦æŒ‡æ˜å…ƒç´ å€¼ï¼Œå•ä¸ªå…ƒç´ æ—¶å¯ä»¥ä½¿ç”¨`@æ³¨è§£å(å€¼)`ï¼Œå¤šä¸ªå…ƒç´ æ—¶å¯ä»¥ä½¿ç”¨`@æ³¨è§£å(å…ƒç´ 1åç§° = å…ƒç´ 1å€¼, å…ƒç´ 2åç§° = å…ƒç´ 2å€¼, ...)`ã€‚
>     - å¯¹æ•°ç»„ç±»å‹çš„å…ƒç´ æŒ‡å®šå€¼ï¼šè‹¥åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šå•ä¸ªå…ƒç´ çš„å€¼ï¼›è‹¥æœ‰å¤šä¸ªå…ƒç´ ï¼Œå¯ä»¥é€šè¿‡`{é¡¹1, é¡¹2, ...}`æ¥æŒ‡å®šå€¼ã€‚
> - ä¸¾ä¾‹
>     ```java
>     //==Java==
>     @Target({ElementType.METHOD, ElementType.TYPE})  //è¯¥æ³¨è§£å¯ä½œç”¨äºæ–¹æ³•æˆ–ç±»
>     @Retention(RetentionPolicy.RUNTIME)  //è¯¥æ³¨è§£æ˜¯è¿è¡Œæ—¶å¯è§
>     public @interface AutoLog {  //å®šä¹‰è¿˜æœ‰ä¸¤ä¸ªå­—æ®µå…ƒç´ çš„æ³¨è§£@AutoLog
>         String name();  //nameæ²¡æœ‰é»˜è®¤å€¼ï¼Œä½¿ç”¨æ—¶å¿…é¡»æŒ‡å®šå€¼
>         int[] levels() default {0, 1}; //levelsæœ‰é»˜è®¤å€¼ï¼Œä½¿ç”¨æ—¶å¯ä»¥çœç•¥å€¼
>     }
>     //ä½¿ç”¨æ³¨è§£ï¼Œä½œç”¨äºç±»
>     @AutoLog(name = "æµ‹è¯•ç±»", levels = 0) //æŒ‡å®šå…ƒç´ çš„å€¼ï¼Œå…¶ä¸­levelæ˜¯æ•°ç»„ç±»å‹ï¼Œå› è€Œæ—¢å¯ä»¥ç›´æ¥æŒ‡å®šå•ä¸ªå…ƒç´ å€¼ï¼Œä¹Ÿå¯å·²ç”¨{}æŒ‡å®šå¤šä¸ªå…ƒç´ å€¼
>     public class Test {
>     }
>     ```

### æ˜¾å¼æŒ‡å®šç‰¹æ€§çš„ç›®æ ‡

ç‰¹æ€§çš„ä½œç”¨ç›®æ ‡ï¼Œä¹Ÿå¯ä»¥æ˜¾å¼çš„æŒ‡å®šã€‚è¯­æ³•æ˜¯`[ä½œç”¨ç›®æ ‡:ç‰¹æ€§1,ç‰¹æ€§2...]`ã€‚

å¯ä»¥æŒ‡å®šçš„ç›®æ ‡ï¼š

| å…³é”®è¯ | å«ä¹‰ |
| --- | --- |
| assembly | æ•´ä¸ªç¨‹åºé›† |
| module | å½“å‰ç¨‹åºé›†æ¨¡å— |
| field | å­—æ®µ |
| event | äº‹ä»¶ |
| method | æ–¹æ³•ï¼Œ æˆ–å±æ€§çš„è®¿é—®å™¨ |
| param | æ–¹æ³•å‚æ•°ï¼Œæˆ–setterçš„å‚æ•° |
| property | å±æ€§ |
| return | æ–¹æ³•ã€ç´¢å¼•å™¨ã€getterè¿”å›å€¼ |
| type | ç»“æ„ã€ç±»ã€æ¥å£ã€æšä¸¾æˆ–å§”æ‰˜ |

ä¾‹å¦‚ï¼š

```c#
[method: Validated] //æŒ‡å®šä½œç”¨äºæ–¹æ³•
int Method1(){ return 0; } 
int ConvertInt([param:NotNull] string data) { return 0; } //æŒ‡å®šä½œç”¨äºå‚æ•°
[return : NotNull] //æŒ‡æ˜ä½œç”¨äºè¿”å›å€¼
public string CombineNames(string firstName, string lastName) { return string.Empty; }
```

assemblyå’Œmoduleä½œç”¨åŸŸæ¯”è¾ƒç‰¹æ®Šã€‚ç»å¤§éƒ¨åˆ†çš„ç‰¹æ€§ä½œç”¨äºç‰¹å®šçš„è¯­è¨€å…ƒç´ ï¼Œä½†æ˜¯ç›®æ ‡ä¸ºassemblyå’Œmoduleçš„ç‰¹æ€§ä½œç”¨äºåº”ç”¨ç¨‹åºé›†å’Œæ¨¡å—ã€‚ä¾‹å¦‚ï¼šæŒ‡å®šåº”ç”¨ç¨‹åºé›†çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è¿™ä¹ˆæŒ‡å®š

```c#
[assembly: AssemblyVersion("1.0.0.0")]
```

### ç‰¹æ€§ä¸­çš„@ç¬¦å·

ç‰¹æ€§ç±»çš„Attributeåç¼€ä¸æ˜¯å¼ºåˆ¶è¦æ±‚ï¼Œä½†æ˜¯ä»¥Attributeä½œä¸ºåç¼€çš„ç‰¹æ€§åœ¨ä½¿ç”¨æ—¶å¯ä»¥çœç•¥åç¼€ã€‚å› è€Œï¼Œè€ƒè™‘ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼š

```c#
[AttributeUsage(AttributeTargets.Class)]
public class Info : Attribute
{
   private string information;

   public Info(string info)
   {
      information = info;
   }
}

[AttributeUsage(AttributeTargets.Method)]
public class InfoAttribute : Attribute
{
   private string information;

   public InfoAttribute(string info)
   {
      information = info;
   }
}
```

ä¸Šä¾‹å®šä¹‰äº†ä¸¤ä¸ªç‰¹æ€§ã€‚ä¸€ä¸ªæ˜¯Infoï¼Œä½œç”¨äºç±»ï¼›å¦ä¸€ä¸ªæ˜¯InfoAttributeï¼Œä½œç”¨äºæ–¹æ³•ã€‚

è¿™ä¸¤ä¸ªç‰¹æ€§ï¼Œä¸€ä¸ªå¸¦åç¼€ï¼Œä¸€ä¸ªä¸å¸¦ã€‚è¿™æ ·å®šä¹‰ä¸¤ä¸ªä¸åŒçš„Attributeæ˜¯åˆæ³•çš„ï¼ˆç±»åä¸åŒå˜›ï¼‰ã€‚ä½†æ˜¯è¦å¦‚ä½•åˆ†åˆ«ä½¿ç”¨è¿™ä¸¤ä¸ªç‰¹æ€§å‘¢ï¼Ÿ

å¦‚æœä»ç„¶é‡‡ç”¨çœç•¥Attributeçš„åç¼€çš„è¯­æ³•ï¼Œä¼šå‡ºç°äºŒä¹‰æ€§ï¼š

```c#
[Info("some string")] //ä¼šæŠ¥é”™ï¼Œç¼–è¯‘å™¨æ— æ³•ç¡®å®šè°ƒç”¨çš„æ˜¯Infoè¿˜æ˜¯InfoAttribute
```

æ­¤æ—¶ï¼Œè°ƒç”¨Infoæ—¶ï¼Œåœ¨Infoå‰åŠ `@`ç¬¦å³å¯ã€‚è€Œè°ƒç”¨InfoAttributeï¼Œä½¿ç”¨å…¨åã€‚

```c#
[@Info("This is a class.")] //ä½¿ç”¨@Infoè°ƒç”¨Infoç‰¹æ€§
public class Example
{
   [InfoAttribute("This is a method.")]//è°ƒç”¨InfoAttributeæ—¶ä½¿ç”¨å…¨å
   public static void SomeMethod()
   {
   }
}
```

## åå°„ï¼ˆReflectionï¼‰

åŒJavaå’Œç»å¤§å¤šæ•°çš„é«˜çº§è¯­è¨€ä¸€æ ·ï¼ŒC#ä¹Ÿæœ‰åå°„æœºåˆ¶ã€‚åå°„å…¶å®æ˜¯ä¸ªå¾ˆå¤§çš„è¯é¢˜ï¼Œè¿™é‡Œåªåšç®€è¦ä»‹ç»ã€‚

### Typeç±»

C#çš„åå°„ï¼Œæ ¸å¿ƒæ˜¯Typeç±»ã€‚

C#ä¸­çš„ä»»ä½•ç±»å‹ï¼Œéƒ½å¯ä»¥æè¿°ä¸ºTypeç±»çš„å¯¹è±¡ã€‚

å¯¹äºå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡GetTypeæ–¹æ³•ï¼Œè·å–ç”¨äºæè¿°å…¶ç±»å‹çš„Typeå¯¹è±¡ã€‚è¯¥æ–¹æ³•å®šä¹‰äºobjectä¸Šï¼Œä»»ä½•ç±»å‹éƒ½ç»§æ‰¿äº†è¯¥æ–¹æ³•ã€‚è¿™ä¹ŸåŒ…æ‹¬å€¼ç±»å‹ã€‚

è€Œå¦‚æœä¸ä½¿ç”¨å¯¹è±¡ï¼Œæƒ³ç›´æ¥é€šè¿‡ç±»å‹è·å–æè¿°è¯¥ç±»å‹çš„Typeå¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨`typeof`è¿ç®—ç¬¦ã€‚

ä¸åŒçš„æ˜¯ï¼ŒGetTypeæ˜¯è¿è¡Œæ—¶è·å–Typeå¯¹è±¡çš„ï¼Œè€Œ`typeof`è¿ç®—ç¬¦æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µè·å–çš„ã€‚

```c#
Type typeInt = 1.GetType();   //é€šè¿‡å¯¹è±¡çš„GetTypeæ–¹æ³•ï¼Œè·å–Typeå¯¹è±¡
Console.WriteLine(typeInt.Name);  //è¾“å‡ºä¸ºInt32
Type typeInt2 = typeof(int);  //é€šè¿‡typeofè¿ç®—ç¬¦ï¼Œä½œç”¨äºç±»å‹ï¼Œè·å–Typeå¯¹è±¡
Console.WriteLine(typeInt2.Name);  //è¾“å‡ºä¸ºInt32
```

è·å–Typeå¯¹è±¡åï¼Œå¯ä»¥é€šè¿‡è¯¥å¯¹è±¡è·å–è¯¥ç±»å‹çš„å„ç§ä¿¡æ¯ã€‚å¦‚ï¼šå­—æ®µã€å±æ€§ã€æ–¹æ³•ã€ç‰¹æ€§ç­‰ç­‰ã€‚

ä¸‹é¢åˆ—å‡ºTypeå¯¹è±¡ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•ï¼š

- GetPropertiesï¼šè·å–å±æ€§åˆ—è¡¨
- GetFieldsï¼šè·å–å­—æ®µåˆ—è¡¨
- GetMethodsï¼šè·å–æ–¹æ³•åˆ—è¡¨
- GetCustomAttributesï¼šè·å–è‡ªå®šä¹‰ç‰¹æ€§åˆ—è¡¨

> ä¸Typeç±»å¯¹åº”çš„Javaç±»æ˜¯Classç±»ã€‚è™½ç„¶Javaä¹Ÿæœ‰Typeï¼Œä½†æ˜¯Javaçš„Typeæ˜¯æ¥å£ï¼Œè€ŒClasså®ç°äº†è¯¥æ¥å£ã€‚é€šè¿‡å¯¹è±¡æ¥è·å–Classå¯¹è±¡å®ä¾‹æ—¶ï¼Œéœ€è¦ä½¿ç”¨å¯¹è±¡çš„getClassæ–¹æ³•ï¼ˆç±»æ¯”GetTypeï¼‰ï¼›é€šè¿‡ç±»åè·å–æ—¶ï¼Œåˆ™ä½¿ç”¨`ç±»å.class`ï¼ˆä¸typeofè¿ç®—ç¬¦ä½œç”¨ç›¸åŒï¼Œç¼ºç‚¹æ˜¯æ³›å‹ç±»å‹ä¸å¯ä»¥ä½¿ç”¨ï¼‰ã€‚
>
> å…³äºä¸ºä»€ä¹ˆ`æ³›å‹ç±».class`ä¸å¯ç”¨ï¼Œè¿™å°±æ˜¯Javaçš„ç¡¬ä¼¤ â€”â€” æ³›å‹ç±»å‹æ“¦é™¤å¯¼è‡´çš„äº†ã€‚æˆ‘ä»¬ä¼šåœ¨C#2.0ä»‹ç»æ³›å‹æ—¶ï¼Œä½œä¸ºå¯¹æ¯”å¯¹Javaçš„ç±»å‹æ“¦é™¤åšå‡ºä»‹ç»ã€‚

### isè¿ç®—ç¬¦

å¯ä»¥é€šè¿‡`is`è¿ç®—ç¬¦ï¼Œæ¥åˆ¤æ–­æŸä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯æŸä¸ªç±»å‹ã€‚

åœ¨å¦‚ä¸‹æƒ…å†µä¸‹ï¼Œ`is`è¿ç®—ç¬¦è¿”å›true

- å¯¹è±¡çš„å®é™…ç±»å‹æ˜¯ç²¾ç¡®çš„ç›®æ ‡ç±»å‹
- å¯¹è±¡çš„å®é™…ç±»å‹å®ç°äº†ç›®æ ‡æ¥å£
- å¯¹è±¡çš„å®é™…ç±»å‹æ˜¯ç›®æ ‡ç±»å‹çš„æ´¾ç”Ÿç±»å‹
- å¯¹è±¡æ‹†ç®±åç±»å‹ä¸ºç›®æ ‡çš„å€¼ç±»å‹
- å¯¹è±¡çš„å®é™…ç±»å‹éšå¼ç»§æ‰¿ç›®æ ‡ç±»
- isçš„å³ä¾§æ˜¯object

å› ä¸ºä»»ä½•ç±»å‹éƒ½è¢«è®¤ä¸ºæ˜¯objectç±»å‹çš„ï¼Œæ‰€ä»¥ä»»ä½•å¯¹è±¡ï¼Œæ— è®ºå®ƒçš„ç±»å‹æ˜¯æŸä¸ªclassã€æŸä¸ªstructã€æŸä¸ªenumè¿˜æ˜¯æŸä¸ªdelegateï¼Œåˆ¤æ–­å…¶`is object`ï¼Œè¿”å›éƒ½æ˜¯trueã€‚

å¯¹äºå³ä¾§ç±»å‹æ˜¯å·¦ä¾§å¯¹è±¡çš„éšå¼ç»§æ‰¿ç±»çš„æƒ…å†µï¼Œ`is`è¿ç®—ç¬¦éƒ½ä¼šè¿”å›trueã€‚å¦‚ä»»ä½•enumå¯¹è±¡ï¼Œåˆ¤æ–­`is Enum`éƒ½æ˜¯trueã€‚ä»»ä½•å€¼ç±»å‹å¯¹è±¡ï¼Œåˆ¤æ–­`is ValueType`éƒ½æ˜¯trueã€‚

è¿™é‡Œæœ‰ä¸ªéå¸¸ç‰¹æ®Šçš„æƒ…å†µï¼šEnumç±»æœ¬èº«æ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œå®ƒç»§æ‰¿è‡ªValueTypeã€‚ä½†æ˜¯ä¸€ä¸ªEnumç±»å‹çš„å¯¹è±¡ï¼ˆç”±enumç±»å‹è£…ç®±çš„æ¥ï¼‰ï¼Œåˆ¤æ–­`is ValueType`å´æ˜¯falseã€‚

```c#
int a = 1;
bool isInt = a is int; //true
bool isObject = a is object;  //true
bool isValueType = a is ValueType;  //true
bool isStruct = a is Enum;  //false
object obj = a; //è£…ç®±
bool isInt2 = obj is int; //trueï¼Œæ‹†ç®±åä¸ºint
```

```c#
NovelBook novelBook = new NovelBook();  //å‡è®¾NovelBookç±»ç»§æ‰¿è‡ªBookç±»ï¼Œä¸”å®ç°äº†IBookæ¥å£
bool isNovelBook =  novelBook is NovelBook; //true
bool isBook =  novelBook is Book; //true
bool isIBookImplement = novelBook is IBook; //true
Book book = novelBook;
bool isNovelBook2 = book is NovelBook; //trueï¼Œåˆ¤æ–­å®é™…ç±»å‹
```

> Javaå¯¹åº”çš„è¿ç®—ç¬¦æ˜¯`instanceof`ã€‚æ‰€ä¸åŒçš„æ˜¯ï¼š
>
> - `instanceof`åªèƒ½ç”¨äºå¼•ç”¨ç±»å‹ï¼Œæ— æ³•ç”¨äºåŸºæœ¬ç±»å‹ã€‚
> - `instanceof`ä¼šè¿›è¡Œç¼–è¯‘å™¨æ£€æŸ¥ï¼Œæ˜ç¡®æ— æ³•è¿›è¡Œç±»å‹è½¬æ¢çš„ä¼šæŠ¥é”™ï¼Œæ— æ³•ç¼–è¯‘ã€‚C#è™½ç„¶ä¹Ÿä¼šåšç¼–è¯‘å™¨æ£€æŸ¥ï¼Œä½†æ˜¯ä»…ä»…æ˜¯ç»™å‡ºè­¦å‘Šã€‚

### asè¿ç®—ç¬¦

`as`è¿ç®—ç¬¦ç±»ä¼¼ç±»å‹è½¬æ¢ï¼Œç”¨äºå°†å¯¹è±¡è½¬æ¢æˆæŒ‡å®šç±»å‹ã€‚

`someObject as SomeClass` ç­‰ä»·äº `someObject is SomeClass ? (SomeClass)someObject : (SomeClass)null`

å› æ­¤ï¼Œå®ƒè·Ÿå¼ºåˆ¶ç±»å‹è½¬æ¢æœ‰å…³ï¼Œä½†åˆä¸åŒï¼š

- `as`å³ä¾§çš„ç±»å‹ï¼Œåªèƒ½é€‚ç”¨äºå¼•ç”¨ç±»å‹ï¼Œä¸å¯é€‚ç”¨äºå€¼ç±»å‹
- `as`ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœæ— æ³•è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¼šè¿”å›null

`as`ä¸åŒäº`is`ï¼Œåœ¨ç¼–è¯‘å™¨éªŒè¯æ—¶ï¼Œå¦‚æœç¡®è®¤å¯¹è±¡æ— æ³•è¿›è¡Œåˆ°ç›®æ ‡ç±»å‹çš„ç±»å‹è½¬æ¢ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚æ ¹æ®ä¸Šé¢çš„ç­‰ä»·ä»£ç ï¼Œè¿™ç‚¹å¾ˆå¥½ç†è§£ã€‚

## unsafeä¸Šä¸‹æ–‡

è¦ä½¿ç”¨unsafeä¸Šä¸‹æ–‡ï¼Œå¿…é¡»**åœ¨é¡¹ç›®çš„ç¼–è¯‘è®¾ç½®ä¸­å‹¾é€‰å…è®¸ä¸å®‰å…¨ä»£ç é€‰é¡¹**ã€‚å®ƒåœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨è¾ƒå°‘ã€‚

unsafeæ˜¯ä¸€ä¸ªå…³é”®è¯ï¼Œç”¨äºæè¿°ä¸€æ®µä¸å®‰å…¨çš„ä»£ç ã€‚å®ƒå¯ä»¥ä¿®é¥°ç±»ï¼Œä¹Ÿå¯ä»¥ä¿®é¥°æ–¹æ³•ï¼Œè¿˜å¯ä»¥ç›´æ¥åœ¨è¯­å¥ä¸­é€šè¿‡`{}`å¯ç”¨ä¸€æ®µä»£ç å—ã€‚åœ¨unsafeä¸Šä¸‹æ–‡ä¸­ï¼Œå…è®¸ç¼–å†™éæ‰˜ç®¡çš„ä»£ç ï¼Œè¿™å…è®¸ä¸å®‰å…¨çš„å†…å­˜æ“ä½œï¼šç›´æ¥ä½¿ç”¨æŒ‡é’ˆã€‚

```c#
public unsafe class Class1 //åœ¨è¯¥ç±»å†…éƒ¨æ‰€æœ‰æ–¹æ³•å†…å¯ä»¥ä½¿ç”¨æŒ‡é’ˆ
{
}
public class Class2
{
    public unsafe void DoSomething() { ... }  //åœ¨è¯¥æ–¹æ³•å†…å¯ä»¥ä½¿ç”¨æŒ‡é’ˆ
}
public class Class3
{
    public void DoSomething() 
    {
        unsafe   //åœ¨æ¥ä¸‹æ¥çš„unsafeå—å†…å¯ä»¥ä½¿ç”¨æŒ‡é’ˆ
        {
            ...
        }
    }
}
```

å…³äºæŒ‡é’ˆï¼Œç”¨è¿‡C++çš„åŒå­¦ä¸€å®šéå¸¸ç†Ÿæ‚‰ã€‚

æŒ‡é’ˆæ˜¯ä¸€ç§æŒ‡å‘å†…å­˜åŒºåŸŸçš„å˜é‡ï¼Œå®ƒçš„å˜é‡æœ¬èº«å­˜å‚¨çš„æ˜¯æ‰€æŒ‡å‘çš„å†…å­˜åŒºåŸŸçš„åœ°å€ã€‚æŒ‡é’ˆæŒ‡å‘çš„å¯ä»¥æ˜¯å•ä¸ªæ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸²æ•°æ®ç»„æˆçš„æ•°ç»„çš„èµ·å§‹ä½ç½®ã€‚

æŒ‡é’ˆçš„è¯­æ³•åŒC++å®Œå…¨ä¸€è‡´ï¼Œå£°æ˜æŒ‡é’ˆä½¿ç”¨`*`ï¼Œå–æŒ‡é’ˆæ‰€æŒ‡åŒºåŸŸä½œä¸ºå¼•ç”¨ä½¿ç”¨`*`è¿ç®—ç¬¦ï¼Œå–å˜é‡çš„åœ°å€ä½¿ç”¨`&`è¿ç®—ç¬¦ï¼Œå–æŒ‡é’ˆæ‰€æŒ‡çš„structå¯¹è±¡ä¸‹çš„å­—æ®µä½œä¸ºå¼•ç”¨ä½¿ç”¨`->`è¿ç®—ç¬¦ã€‚

å› ä¸ºç›´æ¥ä½¿ç”¨æŒ‡é’ˆæ—¶ï¼Œæ— æ³•ä½¿ç”¨åƒåœ¾å›æ”¶æœºåˆ¶ã€‚å› æ­¤C#è§„å®šunsafeå—ä¸­çš„æŒ‡é’ˆä¸èƒ½æ˜¯å¼•ç”¨ç±»å‹çš„ã€‚æ¢è¨€ä¹‹ï¼Œå¿…é¡»æ˜¯éæ‰˜ç®¡ç±»å‹çš„ï¼Œè€Œä¸”æ˜¯å®Œå…¨éæ‰˜ç®¡çš„ã€‚å…·ä½“æ¥è¯´ï¼ŒæŒ‡é’ˆåªèƒ½æ˜¯ä»¥ä¸‹ç±»å‹ä¹‹ä¸€ï¼š

- éæ‰˜ç®¡ç±»å‹ï¼ˆUnmanaged Typeï¼‰ï¼Œå…·ä½“è¯´æ¥ï¼Œå¯ä»¥æ˜¯ï¼š
    - sbyteã€byteã€shortã€ushortã€intã€uintã€longã€ulongã€charã€floatã€doubleã€decimalã€bool
    - æšä¸¾ç±»å‹
    - struct
        - éœ€è¦æ³¨æ„ï¼Œè¿™è¦æ±‚structå†…å®šä¹‰çš„æ‰€æœ‰å­—æ®µå‡ä¸å«å¼•ç”¨ç±»å‹ã€‚å¦‚æœæœ‰structçš„åµŒå¥—ï¼Œåˆ™æ¯ä¸€å±‚çš„structä¹Ÿä¸èƒ½æœ‰å¼•ç”¨ç±»å‹
- æŒ‡é’ˆç±»å‹ï¼ˆå³å¤šé‡æŒ‡é’ˆï¼Œå¦‚`byte**`ï¼‰
- voidç±»å‹ï¼ˆå³`void*`ï¼‰ï¼Œè¡¨ç¤ºæœªçŸ¥ç±»å‹çš„æŒ‡é’ˆ

ç»™æŒ‡é’ˆèµ‹å€¼ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼š

- ä½¿ç”¨`&`è¿ç®—ç¬¦ï¼Œä½†éœ€è¦æ»¡è¶³ï¼š
    - è¿ç®—ç¬¦çš„æ“ä½œæ•°å¿…é¡»æ˜¯å·¦å€¼ç±»å‹ï¼Œå³å˜é‡
    - æ“ä½œæ•°è¦ä¹ˆæ˜¯æ»¡è¶³ä¸Šé¢è¦æ±‚çš„å€¼ç±»å‹ï¼Œè¦ä¹ˆæ˜¯å€¼ç±»å‹çš„æ•°ç»„å…ƒç´ ã€‚å¦‚æœä½¿ç”¨æ•°ç»„å…ƒç´ ï¼Œåˆ™éœ€è¦å›ºå®šï¼ˆfixedï¼‰
- æŒ‡å‘æ•°ç»„
    - å¯ä»¥ä½¿ç”¨ç›´æ¥åˆ†é…åˆ°æ ˆç©ºé—´ä¸Šï¼ˆä½¿ç”¨`stackalloc`ï¼‰çš„æ•°ç»„
    - ä½¿ç”¨æ‰˜ç®¡æ•°ç»„åèµ‹å€¼ï¼Œä¹Ÿéœ€è¦å›ºå®šï¼ˆä½¿ç”¨`fixed`ï¼‰ã€‚
- æŒ‡é’ˆèµ‹å€¼ç»™æŒ‡é’ˆ

å…·ä½“æ¥è¯´ï¼Œå¦‚æœè¦ä½¿ç”¨`&`ç»™æŒ‡é’ˆèµ‹å€¼ä¸ºæ•°ç»„çš„æŸä¸ªå…ƒç´ åœ°å€ï¼Œåˆ™ä¼šé‡åˆ°é—®é¢˜ï¼šå› ä¸ºæ‰˜ç®¡ä»£ç ä¸­å¼•ç”¨ç±»å‹çš„åœ°å€å¹¶éå›ºå®šçš„ï¼Œå®ƒå¯èƒ½è¢«GCå›æ”¶å¹¶é‡æ–°åˆ†é…ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå°†è¿™ä¸ªæ•°ç»„çš„ä½ç½®å›ºå®šåœ¨å †ç©ºé—´ä¸­ï¼Œä¸å†å˜åŒ–ã€‚è¿™å°±è¦æ±‚å°†èµ‹å€¼è¯­å¥é™åˆ¶åœ¨fixedå—å†…ã€‚æˆ–è€…ï¼Œå¦‚æœä½ è¯•å›¾åˆ›å»ºä¸C++ç›¸ä¼¼çš„æ•°ç»„çš„è¯ï¼Œå¯ä»¥ç›´æ¥å°†æ•°ç»„åˆ†é…åˆ°æ ˆç©ºé—´å†…ã€‚

ä¾‹1ï¼š

```c#
//ä¸‹åˆ—ä»£ç åœ¨unsafeä¸Šä¸‹æ–‡ä¸­
int x = 1;
int* pX = &x;  //å–xçš„åœ°å€
int[] y = new int[100];
fixed (int* pY = &y[0])  //æ­¤å¤„å¿…é¡»ä½¿ç”¨fixedå›ºå®šï¼Œå¦åˆ™ç¼–è¯‘å™¨æŠ¥é”™
{
}
fixed (int* pY2 = y)  //ç›´æ¥èµ‹å€¼ä¸ºæ•°ç»„ï¼Œè¿™è·Ÿèµ‹å€¼ä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€å«ä¹‰ç›¸åŒ
{
}
int* pZ = stackalloc int[100]; //ç›´æ¥å°†å†…å­˜åˆ†é…åœ¨æ ˆä¸Šï¼ˆè¿™æ ·è¯¥æ•°ç»„ä¾¿ä¸C++çš„æ•°ç»„åˆ†é…æ–¹å¼ç›¸åŒäº†ï¼‰
```

ä¾‹2ï¼š

```c#
//ä¸‹åˆ—ä»£ç åœ¨unsafeä¸Šä¸‹æ–‡ä¸­
string str = "12345678";
fixed (char* pStr = str)  //stringä¾ç„¶å¯ä»¥çœ‹ä½œcharæ•°ç»„
{
    char* current = pStr;
    *current++ = 'a';
    *current++ = 'b';
    *current++ = 'c';
    *current++ = 'd';
}
Console.WriteLine(str);  //è¾“å‡ºä¸º abcd5678
```

`fixed`é™¤äº†ç”¨ä½œfixedå—ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç›´æ¥ç»™`unsafe`çš„structå£°æ˜fixedçš„æ•°ç»„ã€‚è¿™è¦æ±‚æ•°ç»„å¿…é¡»æ˜¯sbyteã€byteã€shortã€ushortã€intã€uintã€longã€ulongã€charã€floatã€doubleã€decimalã€boolä¹‹ä¸€ï¼ˆæ³¨æ„ï¼Œè·ŸæŒ‡é’ˆç›¸æ¯”ï¼Œfixedçš„æ•°ç»„ç±»å‹ä¸å¯ä»¥æ˜¯decimalï¼‰ã€‚æ­¤æ—¶å®šä¹‰çš„è¯­æ³•é€€åŒ–ä¸ºC++çš„è¯­æ³•ï¼š`[]`æ”¾åœ¨å­—æ®µååé¢ï¼Œå¹¶ä¸”å¿…é¡»æä¾›å¤§å°ï¼Œä¸”ä¸èƒ½ç”¨`new`åˆå§‹åŒ–ã€‚å®ƒå°†è¢«åˆ†é…åœ¨æ ˆç©ºé—´ä¸Šï¼Œä¸`stackalloc`ç›¸åŒã€‚

```c#
unsafe struct SomeStruct
{
    fixed int data[15];
    public void Test()
    {
        fixed (int* dataPtr = data)
        {
        }
    }
}
```

`fixed`å’Œ`stackalloc`ä¹Ÿéƒ½åªèƒ½åœ¨unsafeä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚(ä»C# 7.2å¼€å§‹ï¼Œ`stackalloc`å¯ä»¥åˆ†é…ç»™Span\<T>ï¼Œå› è€Œå¯ä»¥ç”¨äºéunsafeä¸Šä¸‹æ–‡äº†)

PSï¼šäº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¼šæ›´å¤šä½¿ç”¨`IntPtr`å’Œ`Marsha1`æ¥è¿›è¡ŒæŒ‡é’ˆå’Œéæ‰˜ç®¡çš„å†…å­˜æ“ä½œã€‚ä½¿ç”¨å®ƒä»¬æ— éœ€å¼€å¯ä¸å®‰å…¨ä¸Šä¸‹æ–‡ã€‚

> è™½ç„¶ä¸æ˜¯è¯­æ³•çº§åˆ«çš„æ”¯æŒï¼Œä½†æ˜¯Javaä»å¯ä»¥å‚è€ƒUnsafeç±»ï¼Œå®ƒä¹Ÿèƒ½å®ç°å†…å­˜çš„ç›´æ¥æ“ä½œã€‚åŒæ ·çš„ï¼Œå®ƒä¹Ÿå¾ˆå°‘è¢«ç”¨åˆ°ã€‚

---

æ´‹æ´‹æ´’æ´’ï¼Œå•°å•°å—¦å—¦ï¼Œç»ˆäºæŠŠ1.0è®²å®Œäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¿›å…¥åˆ°C#2.0ã€‚

# C# 2.0 â€”â€” è¿½èµ¶ + åˆ›æ–°

C# 2.0ä»ç„¶èµ°åœ¨è¿½èµ¶Javaè¿™ä½å‰è¾ˆçš„è·¯ä¸Šï¼Œä¸è¿‡ä»ç„¶æ˜¯è¿½èµ¶å’Œåˆ›æ–°å¹¶å­˜ã€‚ä¾‹å¦‚åŒä¸ºæ³›å‹ï¼ŒC#å¯¹æ³›å‹åšäº†ä¼˜åŒ–ï¼Œä½¿å¾—C#çš„æ³›å‹ä¸ºâ€œçœŸâ€æ³›å‹ã€‚

C# 2.0æ”¯æŒä»¥ä¸‹è¯­æ³•ï¼š

## æ³›å‹ï¼ˆGenericï¼‰

C#2.0 æ­£å¼å¼•å…¥äº†æ³›å‹ã€‚è¿™æ˜¯C#å’ŒJavaéƒ½æœ‰çš„é‡è¦çš„æœºåˆ¶ã€‚å®ƒçš„çµæ„Ÿæ˜æ˜¾æ¥æºäºC++çš„æ¨¡æ¿ï¼ˆtemplateï¼‰ï¼Œä½†æ˜¯è¦è¿›åŒ–å¾—å¤šã€‚C#çš„æ³›å‹æ”¯æŒï¼š

- æ³›å‹ç±»
- æ³›å‹æ¥å£
- æ³›å‹æ–¹æ³•

```c#
public interface IGenericClass<T> //å®šä¹‰æ³›å‹æ¥å£
{
}
public class GenericClass<T> : IGenericClass<T>  //å®šä¹‰æ³›å‹ç±»ï¼Œè¯¥ç±»å®ç°äº†æ³›å‹æ¥å£ï¼Œæ­¤å¤„æ¥å£çš„Tæ˜¯classçš„æ³›å‹å‚æ•°Tä¼ å…¥
{
    public void Add(T data) { } //ä½¿ç”¨æ³›å‹ç±»çš„ç±»å‹ä½œä¸ºå‚æ•°çš„æ–¹æ³•
    public void Compare<TOther>(T data1, TOther data2) { }  //å®šä¹‰æ³›å‹æ–¹æ³•
}
public class MultipleGenericClass<T1, T2, T3> //å¤šä¸ªæ³›å‹å‚æ•°
{
}
```

> è¯­æ³•ä¸Šï¼ŒJavaä¸C#ç›¸å·®ä¸å¤§ã€‚ä»…åœ¨æ³›å‹æ–¹æ³•çš„å®šä¹‰ä¸Šæœ‰æ‰€åŒºåˆ«ï¼šJavaå°†æ³›å‹å‚æ•°æ”¾åœ¨è¿”å›ç±»å‹å‰é¢ï¼Œè€ŒC#
æ”¾åœ¨æ–¹æ³•ååé¢ï¼ˆè·Ÿæ³›å‹ç±»å®šä¹‰ä¸€è‡´ï¼‰ï¼š
>
> ```java
> //==Java==
> public <T> void add(T data){}
> ```

éœ€è¦æ³¨æ„ï¼š

- æ³›å‹ä¸éæ³›å‹çš„åŒåç±»ã€åŒç­¾åæ–¹æ³•ï¼Œæ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»ã€æ–¹æ³•ã€‚
- æ³›å‹ç±»å‹ä¸ªæ•°ä¸ä¸€æ ·çš„ç±»ã€æ–¹æ³•ï¼Œä¹Ÿæ˜¯ä¸åŒçš„ç±»å’Œæ–¹æ³•ã€‚

å› æ­¤ï¼Œ`SomeClass`å’Œ`SomeClass`\<T>`æ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»ã€‚`SomeClass\<T>`å’Œ`SomeClass\<T1, T2>`ä¹Ÿæ˜¯ä¸åŒçš„ç±»ã€‚è¿™ä¸Javaä¸åŒã€‚

è¿™é‡Œè¦é‡ç‚¹è®²è®²C#æ³›å‹ä¸Javaæ³›å‹çš„åŒºåˆ«ï¼š

> Javaå…¶å®æ˜¯â€œä¼ªâ€æ³›å‹çš„ï¼Œå®ƒçš„æ³›å‹ç±»å‹åªå­˜åœ¨äºç¼–è¯‘å™¨æ£€æŸ¥é˜¶æ®µï¼Œåœ¨è¿›å…¥JVMæ—¶ä¼šè¿›è¡Œå¯¹æ³›å‹ç±»å‹æ“¦é™¤ï¼šä¸€ç›´æ“¦é™¤åˆ°è§„å®šçš„ç±»å‹ä¸Šç•Œï¼ˆæŒ‡å®šextendsçš„æƒ…å†µä¸‹ä¸ºextendsçš„ç±»å‹ï¼Œå¦åˆ™ä¸ºObjectï¼‰ã€‚ï¼ˆæŒ‡å®šextendsçš„è¯­æ³•å«åšæ³›å‹é€šé…ç¬¦ï¼Œæˆ‘ä»¬åœ¨C#çš„åå˜å’Œé€†å˜ç« èŠ‚ä¸­ï¼Œä¼šä½œä¸ºæ¯”è¾ƒè¿›è¡Œä»‹ç»ã€‚ï¼‰

> ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š
>
> ```java
> //==Java==
> public class SomeClass<T>{
>     T field;
> }
> ```
>
> åœ¨ç¼–è¯‘åï¼ŒTä¼šè¢«æ“¦é™¤è‡³Objectç±»å‹ã€‚å› è€Œå®é™…ç¼–è¯‘çš„åçš„ç±»ä¸ä¸‹é¢çš„åŸå§‹ç±»å‹ç­‰ä»·ï¼š
>
> ```java
> //==Java==
> public class SomeClass{
>     Object field;
> }
> ```

> ä¸ä¿¡ï¼Ÿæˆ‘ä»¬çœ‹ä¸‹é¢çš„ä»£ç ï¼š
>
> ```java
> //==Java==
> SomeClass<String> obj1 = new SomeClass<String>();
> SomeClass<Integer> obj2 = new SomeClass<Integer>();
> System.out.println(obj1.getClass() == obj2.getClass); 
> ```
>
> ä¸Šé¢çš„ä»£ç ä¼šè¾“å‡ºtrueã€‚SomeClass\<String>å’ŒSomeClass\<Object>åœ¨è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰æ˜¯åŒä¸€ä¸ªç±»ã€‚å®ƒä»¬éƒ½ç­‰åŒäºSomeClassè¿™ä¸ªåŸå§‹ç±»ã€‚

> å› æ­¤ï¼Œåœ¨Javaä¸­List\<String>å’ŒListä¹Ÿæ˜¯åŒä¸€ä¸ªç±»ã€‚ä½ å¯ä»¥ç”¨ä»¥ä¸‹çš„ä»»æ„æ–¹å¼èµ‹å€¼ï¼Œå‡åˆæ³•ï¼š
>
> - `List<String> list = new ArrayList<String>();`
> - `List<String> list = new ArrayList<>();` 
> - `List list = new ArrayList<String>();`
> - `List list = new ArrayList();`

> å…¶ä¸­ç¬¬äºŒç§ä¸ºä½¿ç”¨é’»çŸ³è¿ç®—ç¬¦ã€‚ä¸‹é¢è®²åˆ°æ³›å‹ç±»å‹æ¨æ–­çš„ç« èŠ‚æ—¶ä¼šåœ¨å¯¹æ¯”ç¯èŠ‚ä¸­ä»‹ç»ã€‚

> ä½¿ç”¨åä¸¤ç§éƒ½ä¼šé™ä½æ³›å‹çš„å¯ç”¨æ€§ã€‚ç”¨Listæ¥æ”¶ä¼šä½¿å¾—Listç±»ä¸­å«æ³›å‹å‚æ•°çš„æ–¹æ³•æ— æ³•é€šè¿‡listå¯¹è±¡è°ƒç”¨ã€‚æœ€åä¸€ç§æ›´ç”šï¼šæ— æ³•åˆ©ç”¨ç¼–è¯‘é˜¶æ®µçš„ç±»å‹æ£€æŸ¥åŠŸèƒ½æ¥æ’é™¤å¯èƒ½å­˜åœ¨çš„å…ƒç´ ç±»å‹è½¬æ¢é”™è¯¯ï¼Œå› è€Œä¸æ¨èä½¿ç”¨ã€‚

> åœ¨Javaä¸­ï¼Œä½ æ— æ³•åŒæ—¶å®šä¹‰ä¸¤ä¸ªSomeClassï¼šä¸€ä¸ªæ˜¯æ³›å‹çš„ï¼Œä¸€ä¸ªæ˜¯éæ³›å‹ã€‚

> æ³›å‹çš„ç±»å‹æ“¦é™¤è¿˜å¸¦æ¥ä¸€äº›ç¡¬ä¼¤ï¼Œå¯¼è‡´æ³›å‹ç±»ä¸­ï¼Œæƒ³è·å–æ³›å‹çš„ç±»å‹ç›¸å¯¹æ¯”è¾ƒå›°éš¾ï¼š
>
> - ä¸èƒ½ä½¿ç”¨`æ³›å‹ç±»å‹.class`æ¥è·å–
> - åªèƒ½é€šè¿‡å¯¹è±¡ï¼Œç„¶ååˆ©ç”¨åå°„è·å–å…¶çœŸå®ç±»å‹

è€ŒC#çš„æ³›å‹åˆ™ä¸ºâ€œçœŸâ€æ³›å‹ã€‚æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

```c#
Console.WriteLine(typeof(List<string>) == typeof(List<int>));
```

ä¸Šé¢çš„ä»£ç è¾“å‡ºä¸º**False**ã€‚

ä»‹ç»C#çš„æ³›å‹æœºåˆ¶ï¼Œéœ€è¦å¼•å…¥ä¸¤ä¸ªæ–°æ¦‚å¿µï¼š

- **å°é—­ç±»å‹**ï¼ˆClosed Typeï¼‰ï¼šæ˜¯æŒ‡ä¸€ä¸ªåŒ…å«æ³›å‹çš„ç±»å‹ï¼Œå®ƒçš„æ‰€æœ‰æ³›å‹ç±»å‹å‡è¢«å…·ä½“ç±»å‹ç¡®å®šã€‚å®ƒå¯ä»¥è¢«ç”¨æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚
- **å¼€æ”¾ç±»å‹**ï¼ˆOpen Typeï¼‰ï¼šæ˜¯æŒ‡ä¸€ä¸ªåŒ…å«æ³›å‹çš„ç±»å‹ï¼Œå®ƒæœ‰è‡³å°‘ä¸€ä¸ªæ³›å‹å‚æ•°è¿˜æœªè¢«å…·ä½“çš„ç±»å‹ç¡®å®šã€‚å®ƒä¸èƒ½è¢«ç”¨æ¥å®ä¾‹åŒ–å¯¹è±¡ï¼Œä½†ç”¨æ¥ä½œä¸ºæ³›å‹æ–¹æ³•ã€æ³›å‹ç±»çš„å‚æ•°ã€è¿”å›å€¼ç±»å‹å£°æ˜ã€‚

äº‹å®ä¸Šï¼ŒC#ä¸­å®šä¹‰æ³›å‹ç±»æ—¶ï¼Œå®šä¹‰çš„æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç±»å‹ï¼Œè¯¥ç±»ä½¿ç”¨å ä½ç¬¦æ ‡è®°éœ€è¦è¢«æ›¿æ¢çš„æ³›å‹ç±»å‹ã€‚

è€Œåœ¨å®ä¾‹åŒ–å…·ä½“çš„æ³›å‹ç±»çš„å¯¹è±¡æ—¶ï¼Œéœ€è¦ç¡®å®šå…¶ä¸­çš„æ³›å‹ç±»å‹ï¼Œå»ºç«‹ä¸€ä¸ªå°é—­ç±»å‹çš„æ–°çš„æ³›å‹ç±»ã€‚å› æ­¤ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªæ ¹æ®ä½ é€‰æ‹©çš„ç±»å‹å®šåˆ¶çš„â€œç±»å‹å®‰å…¨â€çš„ç±»ã€‚

å›åˆ°ä¸Šä¾‹ä¸­ï¼š

- List\<T>: å¼€æ”¾æ³›å‹ç±»ï¼ŒTä¸ºå ä½ç¬¦
- List\<string>ï¼šæ³›å‹ç±»å‹ä¸ºStringçš„List<>çš„å°é—­æ³›å‹ç±»
- List\<int>ï¼šæ³›å‹ç±»å‹ä¸ºInt32çš„List<>çš„å°é—­æ³›å‹ç±»

é€šè¿‡æŸ¥çœ‹ç±»å‹å…¨åï¼Œæˆ‘ä»¬å‘ç°ä¸‰è€…çš„Typeå‡ä¸ç›¸åŒï¼š

```c#
Console.WriteLine(typeof(List<>).FullName);  //List<>æŒ‡ä»£List<T>çš„å¼€æ”¾æ³›å‹ç±»ï¼Œå¯¹äºå¤šä¸ªæ³›å‹å‚æ•°çš„é›†åˆç±»åˆ™æ˜¯ç±»å<,,>è¿™ç§å½¢å¼
Console.WriteLine(typeof(List<string>).FullName); //List<T>çš„ã€æ³›å‹å‚æ•°Tä¸ºStringçš„å°é—­æ³›å‹ç±»
Console.WriteLine(typeof(List<int>).FullName);  //List<T>çš„ã€æ³›å‹å‚æ•°ä¸ºInt32çš„å°é—­æ³›å‹ç±»
```

ä¸Šä¾‹ä»£ç çš„è¾“å‡ºä¸ºï¼š

```
System.Collections.Generic.List`1
System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]
System.Collections.Generic.List`1[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]
```

ä½¿ç”¨çœŸæ³›å‹çš„å¥½å¤„æ˜¯ï¼Œæ³›å‹ç±»å‹åœ¨è¿è¡Œæ—¶ä¹Ÿæ˜¯ç±»å‹å®‰å…¨çš„ã€‚ä¸è¿‡ï¼Œä¸ºäº†è§£å†³æ´¾ç”Ÿç±»åº”ç”¨äºæ³›å‹çš„é—®é¢˜ï¼Œå¿…é¡»å¼•å…¥æ³›å‹çš„åå˜å’Œé€†å˜æœºåˆ¶ã€‚æˆ‘ä»¬å°†åœ¨C#4.0ç« èŠ‚ä¸­ä»‹ç»[åå˜å’Œé€†å˜](#åå˜ï¼ˆCovariantï¼‰ã€é€†å˜ï¼ˆContravariantï¼‰)ã€‚

### æ³›å‹çº¦æŸ

æœ‰äº†â€œçœŸâ€æ³›å‹ï¼Œä¾¿å¯ä»¥å¯¹æ³›å‹ç±»å‹æˆ–æ³›å‹æ–¹æ³•è¿›è¡Œæ³›å‹çš„çº¦æŸã€‚

æ³›å‹çº¦æŸï¼Œåˆå«æ³›å‹ç±»å‹é™å®šè¯­ã€‚å®ƒä½¿ç”¨`where`å…³é”®è¯ï¼Œå¹¶æ”¾åœ¨ç±»å‹å£°æ˜ã€æ–¹æ³•å£°æ˜ä¹‹åï¼Œ`{}`ä½“ä¹‹å‰ã€‚è¯­æ³•ä¸ºï¼š`where æ³›å‹å ä½ç¬¦ : çº¦æŸç±»å‹, çº¦æŸç±»å‹`ã€‚åŒæ—¶ï¼Œå¦‚æœæœ‰å¤šä¸ªæ³›å‹å ä½ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ª`where`ã€‚

```c#
class MyClass<T, U>
where T: class, new()
where U: struct
{
}
```

å¯ç”¨çš„çº¦æŸåŒ…æ‹¬ï¼š

- classï¼šç”¨äºæŒ‡ç¤ºæ³›å‹ç±»å‹å¿…é¡»æ˜¯ç±»
- structï¼šç”¨äºæŒ‡ç¤ºæ³›å‹ç±»å‹å¿…é¡»æ˜¯ç»“æ„
- å…·ä½“ç±»å‹åï¼šç”¨äºæŒ‡ç¤ºæ³›å‹ç±»å‹å¿…é¡»æ˜¯è¯¥ç±»å‹ï¼Œæˆ–è€…è¯¥ç±»å‹çš„æ´¾ç”Ÿç±»å‹ï¼Œæˆ–è€…è¯¥ç±»å‹çš„éšå¼ç»§æ‰¿ç±»
- å…·ä½“æ¥å£åï¼šç”¨äºæŒ‡ç¤ºæ³›å‹ç±»å‹å¿…é¡»å®ç°äº†è¯¥æ¥å£
- new()ï¼šç”¨äºæŒ‡ç¤ºæ³›å‹ç±»å‹å¿…é¡»åŒ…å«æ— å‚æ„é€ å™¨

å¤šä¸ªæ³›å‹çº¦æŸæ¡ä»¶æ˜¯â€œä¸â€çš„å…³ç³»ï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³ã€‚

ä½¿ç”¨æ³›å‹çº¦æŸçš„å¥½å¤„æ˜¯ï¼Œåœ¨ä»£ç å†…å¯ä»¥ç›´æ¥ä½¿ç”¨çº¦æŸç±»å‹è¿›è¡Œæ“ä½œã€‚å¦‚ï¼šçº¦æŸæ³›å‹ç±»å‹`T`ç¬¦åˆ`new()`ï¼Œåˆ™åœ¨ä»£ç ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨`new T()`ã€‚

### æ³›å‹æ–¹æ³•çš„æ³›å‹ç±»å‹çš„è‡ªåŠ¨æ¨æ–­

å¯¹äºæ³›å‹æ–¹æ³•ï¼Œå¦‚æœæ‰€æœ‰æ³›å‹ç±»å‹éƒ½åŒ…å«åœ¨å‚æ•°ä¸­ï¼Œè°ƒç”¨æ–¹æ³•æ—¶èƒ½æ˜ç¡®æ¨æ–­æ¯ä¸ªæ³›å‹å‚æ•°ç±»å‹çš„è¯ï¼Œå¯ä»¥ä¸å¿…åœ¨è°ƒç”¨æ—¶æŒ‡æ˜æ³›å‹ç±»å‹ã€‚å³ï¼šå¯ä»¥çœç•¥`<>`

ä¾‹å¦‚ï¼Œå¯¹äºä¸‹è¿°å®šä¹‰ï¼š

```c#
public class Client
{
    public void Get<T>(T key) { ... }
    public void GetExtra<T1, T2>(T1 key, T2 extra = null) where T2 : class { ... }
}
```

åˆ™æœ‰ï¼š

```c#
Client client= new Client();
client.Get<int>(1);  //OKï¼Œæ­£å¸¸çš„è°ƒç”¨
client.Get(1);  //OKï¼Œçœç•¥æ³›å‹ç±»å‹
client.GetExtra<string, string>("1");  //OKï¼Œæ­£å¸¸çš„å¤šæ³›å‹å‚æ•°è°ƒç”¨ï¼Œå¹¶çœç•¥äº†é»˜è®¤å‚æ•°
client.GetExtra("1", null);  //Not OKï¼Œç¼–è¯‘å™¨æŠ¥é”™ï¼Œæ— æ³•ä»nullæ¨æ–­å‡ºT2çš„ç±»å‹ã€‚
```

> è™½ç„¶æœ¬è´¨ä¸Šæ²¡å•¥è”ç³»ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æ˜¯æƒ³æä¸€ä¸‹Javaæ³›å‹åœ¨åˆå§‹åŒ–æ—¶çš„ä¸€ä¸ªç”¨æ³•ï¼šã€‚åœ¨newä¸€ä¸ªæ³›å‹ç±»æ—¶ï¼Œå¦‚æœå‰é¢çš„å®šä¹‰æ˜ç¡®äº†æ³›å‹çš„ç±»å‹ï¼Œåé¢newçš„æ—¶å€™å¯ä»¥å°†è¯¥æ³›å‹ç±»å‹çœç•¥ã€‚å½¢å¦‚ï¼š`List<String> list = new LinkedList<>();`ã€‚è¿™ä¸ªè¡¨è¾¾å¼çš„å¥½å¤„æ˜¯ï¼Œæ—¢å¯ä»¥ç®€åŒ–ä¹¦å†™ï¼Œåˆå¯ä»¥å…¼é¡¾ç¼–è¯‘å™¨çš„ç±»å‹åˆ¤æ–­ã€‚å¦‚æœä¹¦å†™`List list = new LinkedList<>();`ä¼šå¼•èµ·æŠ¥é”™ï¼Œå› ä¸ºå·¦ä¾§æ— æ³•ç¡®å®šæ³›å‹çš„ç±»å‹ã€‚ç”±äº<>å¾ˆåƒé’»çŸ³ï¼Œå› æ­¤åˆå«**é’»çŸ³è¿ç®—ç¬¦**ï¼ˆDiamond Operatorï¼‰ã€‚å®ƒçš„æ€æƒ³è·Ÿåˆšåˆšä»‹ç»çš„è‡ªåŠ¨ç±»å‹æ¨æ–­æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚

## åˆ†éƒ¨ç±»å‹ï¼ˆPartial Typeï¼‰

åˆ†éƒ¨ç±»å‹å…è®¸åœ¨å¤šå¤„ã€å¤šæ¬¡å®šä¹‰åŒä¸€ä¸ªç±»å‹ã€‚

classã€interfaceå’Œstructéƒ½å¯partialã€‚

å£°æ˜åˆ†éƒ¨ç±»å‹çš„å…³é”®è¯ä¸º`partial`

```c#
public partial class Eployee
{
    public void Work()
    {
    }
}
//å†æ¬¡å®šä¹‰
public partial class Eployee
{
    public void Relax()
    {
    }
}
```

ä¸Šè¿°ä¾‹å­ä¸­ï¼ŒEployeeè¢«å®šä¹‰åœ¨ä¸¤å¤„ï¼Œç¼–è¯‘å™¨ä¼šå°†å®ƒä»¬åˆå¹¶ã€‚æœ€ç»ˆï¼ŒEployeeå°†åŒæ—¶å…·æœ‰Workå’ŒRelaxä¸¤ç§æ–¹æ³•ã€‚

å®šä¹‰åˆ†éƒ¨ç±»æ—¶ï¼Œå¯å°†å®ƒä»¬æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ã€ä¸åŒçš„å‘½åç©ºé—´ä¸­ã€ç”šè‡³ä¸åŒçš„åº”ç”¨ç¨‹åºç¨‹åºé›†ä¸­ã€‚

ç¼–è¯‘å™¨ï¼Œä¼šå¯¹ä¸‹åˆ—å†…å®¹è¿›è¡Œåˆå¹¶ï¼š

- è¯´æ˜æ³¨é‡Šï¼ˆXMLæ³¨é‡Šï¼‰
- å®ç°çš„æ¥å£
- æ³›å‹ç±»å‹å‚æ•°çš„ç‰¹æ€§
- ç±»å‹çš„ç‰¹æ€§
- æˆå‘˜ï¼ˆå­—æ®µã€å±æ€§ã€æ–¹æ³•ç­‰ï¼‰

```c#
[Cold]
partial class Mercury { }
[Hot]
partial class Mercury { }
//ç‰¹æ€§ä¼šåˆå¹¶ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ°´æ˜Ÿæœ‰äº†å†·å’Œçƒ­ä¸¤ä¸ªç‰¹æ€§ã€‚

partial class Earth : IPlanet, IRotate { }
partial class Earth : IRevolve { }
//æ¥å£ä¼šåˆå¹¶ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„åœ°çƒä¸ä»…æ˜¯è¡Œæ˜Ÿï¼Œè¿˜ä¼šè‡ªä¼ å’Œå…¬è½¬ã€‚
```

åˆ†éƒ¨ç±»å‹ï¼Œæœ‰åˆ©äºæ‹†è§£è¾ƒå¤§çš„ç±»ã€ç»“æ„ç­‰ã€‚

## åŒ¿åæ–¹æ³•ï¼ˆAnonymous Methodï¼‰

åŒ¿åæ–¹æ³•ï¼Œå…è®¸åœ¨ä¸é¢„å…ˆå®šä¹‰æ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œåœ¨ä»£ç ä¸­æ’å…¥ä¸€ä¸ªæ–¹æ³•ã€‚è¿™åœ¨ç»™å§”æ‰˜æ·»åŠ å®ç°æ—¶éå¸¸æœ‰ç”¨ã€‚

åŒ¿åæ–¹æ³•ï¼Œæœ‰ä¸¤ç§å®ç°æ–¹å¼

- `delegate`è¿ç®—ç¬¦
- Lambdaè¡¨è¾¾å¼ï¼ˆC# 3.0å¼•å…¥ï¼‰

äº‹å®ä¸Šï¼ŒLambdaè¡¨è¾¾å¼æ‰æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚å› æ­¤`delegate`è¿ç®—ç¬¦åªåšç®€å•ä»‹ç»ã€‚

```c#
public delegate int Add(int a, int b); //å®šä¹‰å§”æ‰˜

Add add = delegate (int a, int b) { return a + b; };  //å®šä¹‰åŒ¿åæ–¹æ³•
```

åŒ¿åæ–¹æ³•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å½“å‰ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚å³ï¼šå¯ä»¥ä½¿ç”¨å®šä¹‰æ‰€åœ¨ä½ç½®èƒ½å¤Ÿè®¿é—®åˆ°çš„æœ¬åœ°å˜é‡ã€‚å½“ä½ è¿™æ ·ç”¨æ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿ**é—­åŒ…**ï¼ˆClosureï¼‰ã€‚é—­åŒ…çš„æ¦‚å¿µå¾ˆå¤šè¯­è¨€éƒ½æœ‰ï¼Œå¦‚Javaï¼ŒJSï¼ŒPythonç­‰ç­‰ï¼Œç›¸ä¿¡å¤§å®¶éƒ½æœ‰æ‰€äº†è§£ï¼Œè¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ã€‚

### å¼ºç±»å‹å§”æ‰˜ï¼ˆStrongly Typed Delegateï¼‰

è®²åˆ°åŒ¿åæ–¹æ³•ï¼Œè¿™é‡Œæœ‰å¿…è¦æåŠå¼ºç±»å‹å§”æ‰˜ã€‚å¦‚æœä½ æä¾›äº†ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œè¦æŠŠå®ƒèµ‹å€¼ç»™ä¸€ä¸ªå§”æ‰˜ï¼Œä½†æ˜¯ä½ åˆä¸æƒ³äº‹å…ˆå®šä¹‰ä¸€ä¸ªå§”æ‰˜ç±»å‹ï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨å¼ºç±»å‹å§”æ‰˜ã€‚

**å¼ºç±»å‹å§”æ‰˜**ï¼Œåˆå«**é€šç”¨å§”æ‰˜**ï¼Œæ˜¯ä¸¤ç»„é¢„å®šä¹‰çš„å§”æ‰˜ï¼Œåˆ†åˆ«ä¸º`Func`å’Œ`Action`ã€‚`Func`å¯ä»¥ç”¨äºæŒ‡ä»£æœ‰è¿”å›å€¼çš„æ–¹æ³•ï¼Œè€Œ`Action`å¯ä»¥ç”¨äºæŒ‡ä»£æ— è¿”å›å€¼çš„æ–¹æ³•ã€‚æŸ¥çœ‹å…¶å®šä¹‰ï¼š

```c#
//Funcå§”æ‰˜çš„å®˜æ–¹å®šä¹‰
delegate TResult Func<out TResult>();
delegate TResult Func<in T, out TResult>(T arg);   //inå’Œoutæ˜¯åå˜ã€é€†å˜å…³é”®è¯ï¼Œæˆ‘ä»¬åœ¨C# 4.0ä¼šå°†
delegate TResult Func<in T1, in T2, out TResult>(T1 arg1, T2 arg2);
... //ä¸€ç›´åˆ°T16

//Actionå§”æ‰˜çš„å®˜æ–¹å®šä¹‰
delegate void Action();
delegate void Action<in T>(T arg);
delegate void Action<in T1, in T2>(T1 arg1, T2 arg2);
... //ä¸€ç›´åˆ°T16
```

å› è€Œï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†é€šç”¨å§”æ‰˜ä¸åŒ¿åæ–¹æ³•ç»“åˆä½¿ç”¨ã€‚ä¾‹å¦‚ä¸Šä¾‹ï¼Œå¯ä»¥ç®€åŒ–ä¸ºï¼š

```c#
Func<int, int, int> add =  delegate (int a, int b) { return a + b; };  //æ— éœ€é¢„å…ˆå®šä¹‰å§”æ‰˜æ¥æ¥æ”¶æ­¤æ–¹æ³•
```

åŒæ—¶ï¼ŒåŸºäºé€šç”¨å§”æ‰˜ï¼ŒC#æ”¯æŒå¯¹åŒ¿åæ–¹æ³•çš„è‡ªåŠ¨ç±»å‹æ¨æ–­ã€‚ä¸Šè¿°ä»£ç å¯ç®€å†™ä½œï¼š

```c#
var add = delegate (int a, int b) { return a + b; };  //å°†è‡ªåŠ¨æ¨æ–­å‡ºaddç±»å‹ä¸ºFunc<int, int, int>
```

## å¯nullå€¼ç±»å‹ï¼ˆNullable\<T>ï¼‰

`Nullable\<T>`ï¼Œåˆå«å¯nullå€¼ç±»å‹ã€‚

> å®ƒå¯¹åº”Javaçš„åŒ…è£…å™¨ã€‚ä¸åŒç‚¹æ˜¯ï¼Œå®ƒå¯¹ä¸€åˆ‡å€¼ç±»å‹éƒ½æœ‰æ•ˆï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰ç±»å‹ã€‚

å®ƒä»ç„¶æ˜¯è¯­æ³•çº§åˆ«çš„æ”¯æŒï¼Œ`Nullable\<T>`å¯ä»¥ç®€å†™åš`T?`ã€‚

```c#
double? pi = 3.1415926;
int index1 = 0;
int? index2 = index;  //å¼•èµ·è£…ç®±
bool? isCorrect = null;
SomeStruct? someStruct = default(SomeStruct); //SomeStructä¸ºstruct
```

### å¯nullå€¼ç±»å‹çš„ç±»å‹åˆ¤æ–­

è¿™é‡Œè¦ç‰¹åˆ«è®²ä¸€ä¸‹ï¼Œå¯nullå€¼ç±»å‹çš„ç±»å‹åˆ¤æ–­ï¼Œå®ƒæœ‰äº›ç‰¹æ®Šã€‚

```c#
int a = 1;
int? b = 2;
Console.WriteLine(a.GetType().Name);  //è¾“å‡ºä¸º Int32
Console.WriteLine(b.GetType().Name);  //è¾“å‡ºä¹Ÿæ˜¯ Int32
```

æ‰€ä»¥ï¼ŒNullable\<T>åœ¨è·å–ç±»å‹æ—¶ï¼Œè·å–çš„æ˜¯å…¶æ‹†ç®±ç±»å‹ã€‚

åŒæ ·çš„ï¼Œæ¥ä¸Šä¾‹ï¼Œå¯¹äºisè¿ç®—ç¬¦ï¼š

```c#
bool equalA = a is int?;  //int is int?ï¼Œè¿”å›true
bool equalB = b is int;   //int? is intï¼Œè¿”å›ä¹Ÿæ˜¯true
```

å› è€Œï¼Œä¸å¯ä»¥ç›´æ¥ä½¿ç”¨Typeæ¥åˆ¤æ–­æ˜¯å¦Nullable\<T>ç±»å‹ã€‚å¦‚æœéœ€è¦åˆ¤æ–­å½“å‰å˜é‡æ˜¯ä¸æ˜¯å¯nullç±»å‹ï¼Œéœ€è¦è¿™æ ·ï¼š

```c#
bool isNullable = Nullable.GetUnderlyingType(type) != null
```

## è¿­ä»£å™¨ï¼ˆIteratorï¼‰

è¿­ä»£å™¨ï¼Œç‰¹æŒ‡è¿­ä»£å™¨æ–¹æ³•ï¼ˆIterator Methodï¼‰ï¼Œç”¨äºåˆ›å»ºå¯æšä¸¾çš„åºåˆ—ã€‚æ˜¯**éå¸¸éå¸¸éå¸¸é‡è¦**çš„ã€‚æ²¡é”™ï¼Œæˆ‘ç”¨äº†ä¸‰ä¸ªâ€œéå¸¸â€ã€‚

ä¸€ä¸ªæ–¹æ³•è¢«ç¼–è¯‘å™¨è®¤ä½œè¿­ä»£å™¨æ–¹æ³•ï¼Œéœ€è¦æ»¡è¶³ï¼š

- è¿”å›ä¸ºIEnumerableã€IEnumeratorï¼Œæˆ–å®ƒä»¬çš„æ³›å‹ç‰ˆæœ¬æ¥å£
- æ–¹æ³•ä¸­åŒ…å«`yield`è¯­å¥

`yield`è¯­å¥æœ‰ä¸¤ç§ï¼š

- `yield return`ï¼šç”¨äºå®Œæˆä¸€æ¬¡è¿­ä»£ï¼Œå¹¶è¿”å›è¿­ä»£å€¼
- `yield break`ï¼šç”¨äºç»ˆæ­¢è¿­ä»£è¿‡ç¨‹

è¿­ä»£å™¨çš„æ‰§è¡Œé¡ºåºæœ‰äº›è¿åå¸¸è¯†ï¼Œä¸¾ä¾‹è¯´æ˜ï¼š

```c#
public IEnumerable<int> Some() //å®šä¹‰è¿­ä»£å™¨æ–¹æ³•
{
    Console.WriteLine(1);
    for(int i = 2; i < 5; i++)
    {
        yield return i;
    }
}
public void TestForIterator()
{
    IEnumerable<int> list = Some();  //è°ƒç”¨è¿­ä»£å™¨æ–¹æ³•
    Console.WriteLine(0);
    foreach (string item in list)  //è°ƒç”¨æšä¸¾å™¨
    {
        Console.WriteLine(item);
    }
}
```

è¯»è€…å¯ä»¥æš‚åœä¸€ä¸‹ï¼Œå…ˆè‡ªè¡ŒçŒœæµ‹ä¸‹ï¼Œä¸Šé¢çš„ä»£ç è¾“å‡ºæ˜¯ä»€ä¹ˆã€‚

\*

\*

\*

æˆ‘

æ˜¯

åˆ†

éš”

ç¬¦

\*

\*

\*

å®é™…ä¸Šï¼Œä»£ç è¾“å‡ºä¸º

```txt
0
1
2
3
4
```

å•¥ï¼Ÿè¿™ä¹ˆè¿åç›´è§‰çš„å—ï¼Ÿ

äº‹å®ä¸Šï¼Œè¿­ä»£å™¨å…·æœ‰**å»¶è¿Ÿæ‰§è¡Œ**çš„ç‰¹ç‚¹ã€‚æˆ‘ä»¬æ¥ä»”ç»†çœ‹çœ‹ï¼Œä¸Šä¾‹ä¸­ï¼Œè¿­ä»£å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š

ä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œæˆ‘ä»¬æŠŠä¸Šé¢çš„ä»£ç æ ‡ä¸Šè¡Œå·ã€‚

```c#
[1]  public IEnumerable<int> Some() //å®šä¹‰è¿­ä»£å™¨æ–¹æ³•
[2]  {
[3]      Console.WriteLine(1);
[4]      for(int i = 2; i < 5; i++)
[5]      {
[6]          yield return i;
[7]      }
[8]  }
[9]  public void TestForIterator()
[10] {
[11]     IEnumerable<int> list = Some();  //è°ƒç”¨è¿­ä»£å™¨æ–¹æ³•
[12]     Console.WriteLine(0);
[13]     foreach (string item in list)  //è°ƒç”¨æšä¸¾å™¨
[14]     {
[15]         Console.WriteLine(item);
[16]     }
[17] }
```

æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š

1. \[1]å£°æ˜äº†å«æœ‰yieldè¯­å¥çš„Someæ–¹æ³•ï¼Œç¼–è¯‘å™¨å°†è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªè¿­ä»£å™¨æ–¹æ³•
2. TestForIteratorè¢«è°ƒç”¨ï¼Œæ–¹æ³•åœ¨æ‰§è¡Œåˆ°\[11]æ—¶ï¼Œå¹¶ä¸ä¼šçœŸçš„è§¦å‘è¿­ä»£è¿‡ç¨‹ã€‚æ–¹æ³•ä¼šç«‹åˆ»è¿”å›ï¼Œå¹¶å¼€å§‹æ‰§è¡ŒTestForIteratorçš„åç»­è¯­å¥ã€‚
3. ç¨‹åºæ‰§è¡Œåˆ°\[12]ï¼Œæ‰“å°äº†`0`ã€‚
4. æ‰§è¡Œåˆ°\[13]ï¼Œç”±foreachè§¦å‘äº†æšä¸¾å™¨éå†ï¼Œæ­¤æ—¶è¿­ä»£å™¨å¼€å§‹å·¥ä½œã€‚è¿›å…¥Someæ–¹æ³•å¼€å§‹æ‰§è¡Œã€‚
5. æ‰§è¡Œåˆ°\[3]ï¼Œæ‰“å°äº†`1`ã€‚
6. è¿›å…¥\[4]çš„éå†ï¼Œåœ¨æ‰§è¡Œåˆ°ç¬¬ä¸€æ¡\[6]å¤„çš„yield returnæ—¶ï¼ŒSomeæ–¹æ³•çš„æ‰§è¡Œæš‚åœï¼Œå¹¶æŠŠiçš„å€¼2ä½œä¸ºè¿­ä»£å€¼è¿”å›ã€‚
7. TestForIteratorçš„foreachæ‹¿åˆ°äº†ç¬¬ä¸€ä¸ªè¿­ä»£å€¼2ï¼Œä»\[13]ç»§ç»­æ‰§è¡Œï¼Œåˆ°\[15]æ—¶æ‰“å°äº†`2`ã€‚
8. ç»§ç»­æ‰§è¡Œåˆ°foreachå¾ªç¯çš„ä¸‹ä¸€æ¬¡éå†\[13]ï¼Œå†æ¬¡éœ€è¦ä»è¿­ä»£å™¨ä¸­å–å€¼ï¼Œæ­¤æ—¶Someç»§ç»­è¢«å”¤èµ·ï¼Œä»\[6]å¤„ç»§ç»­æ‰§è¡Œã€‚ç„¶åè¿›å…¥içš„ä¸‹ä¸€æ¬¡å¾ªç¯\[4]ã€‚åˆä¸€æ¬¡æ‰§è¡Œåˆ°\[6]çš„yield returnï¼Œå°†3ä½œä¸ºè¿­ä»£å€¼è¿”å›ã€‚
9. TestForIteratorçš„foreachåˆæ‹¿åˆ°äº†è¿­ä»£å€¼3ï¼Œä»è€Œç»§ç»­æ‰§è¡Œï¼Œåœ¨\[15]å¤„æ‰“å°äº†`3`
10. ç»§ç»­é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œåœ¨\[15]å¤„æ‰“å°äº†`4`ã€‚
11. è¿™æ—¶æ‰§è¡Œåˆ°\[13]ï¼Œforeachåˆä¼šå»è¦ä¸‹ä¸€ä¸ªè¿­ä»£å€¼ï¼Œå›åˆ°Someï¼Œæ‰§è¡Œåˆ°\[4]ï¼Œforçš„æ¡ä»¶å·²ç»ä¸æ»¡è¶³ï¼Œäºæ˜¯forç»“æŸäº†ã€‚ä»£ç æ‰§è¡Œåˆ°äº†\[8]ã€‚è¿™æ„å‘³ç€è¿­ä»£å™¨æ–¹æ³•çš„æ‰§è¡Œç»“æŸäº†ã€‚å› è€Œä¸Šå±‚çš„foreachåœ¨æ­¤åˆ»ä¹Ÿç»“æŸäº†ï¼Œç»§ç»­æ‰§è¡Œåˆ°\[17]ï¼ŒTestForIteratoræ–¹æ³•ç»“æŸã€‚

å› è€Œï¼Œä½¿ç”¨è¿­ä»£å™¨åï¼Œç¼–è¯‘å™¨å°†ä»£ç æ‰§è¡Œé¡ºåºè¿›è¡Œäº†é‡æ’ã€‚è°ƒç”¨è¿­ä»£å™¨æ–¹æ³•ä¸æ˜¯ç«‹å³æ‰§è¡Œå¹¶å°†è®¡ç®—ç»“æœå­˜å…¥æŸä¸ªIEnumerableå¯¹è±¡è¿”å›ç»™è°ƒç”¨è€…ï¼Œè€Œæ˜¯åœ¨è¿­ä»£æ—¶æ¯å–å‡ºä¸€æ¡æ•°æ®ä¾¿äº¤ç”±è°ƒç”¨è€…å¤„ç†ä¸€æ¡ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„ç»†èŠ‚ï¼šåŸºäºä¸Šè¿°æœºåˆ¶ï¼Œè¿­ä»£å™¨æ–¹æ³•è¿”å›çš„IEnumerableï¼Œå¹¶**ä¸æ˜¯æŸä¸ªå…·ä½“çš„å®ç°ç±»**ã€‚å®é™…ä¸Š**æ²¡æœ‰ç±»å’Œå¯¹è±¡æ¥æ‰¿è½½**å®ƒçš„è¿”å›ç»“æœï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸€ä¸ªåå‡ºè¿­ä»£å€¼çš„ã€‚æ¢å¥è¯è¯´ï¼Œè¿­ä»£å™¨æ–¹æ³•**æœ¬èº«å°±æ˜¯ä¸ªæ•°æ®æº**ï¼Œå¹¶ä¸”è¿­ä»£å™¨çš„è¿­ä»£ç»“æœä¸ä¼šè¢«é›†ä¸­å­˜å‚¨åœ¨æŸä¸ªåˆ—è¡¨é‡Œã€‚

æˆ‘ä»¬ä¸¾å¦ä¸€ä¸ªæ›´ç®€å•çš„è¿­ä»£å™¨æ–¹æ³•çš„ä¾‹å­ï¼Œè¿™ä¼šæ›´æœ‰åˆ©äºç†è§£ï¼š

```c#
public IEnumerable<int> Some2() //è¯¥æ–¹æ³•åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œä¾æ¬¡è¿”å› 2ã€3ã€4
{
    yield return 2;
    yield return 3;
    yield return 4;
}
```

é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä½ åº”è¯¥èƒ½æ›´å¥½çš„ç†è§£â€œè¿­ä»£å™¨æ–¹æ³•æœ¬èº«å°±æ˜¯ä¸ªæ•°æ®æºâ€è¿™å¥è¯ã€‚è¿­ä»£å™¨æ–¹æ³•åœ¨`yield return`å¤„è¿”å›ä¸€ä¸ªè¿­ä»£å€¼ï¼Œå› è€Œå¯ä»¥æœ‰å¤šä¸ª`yield return`ï¼Œå®ƒä»¬ä¼šè¢«ä¾æ¬¡æ‰§è¡Œã€‚è€Œä¸åƒä¸€èˆ¬çš„æ–¹æ³•åªä¼š`return`ä¸€æ¬¡ã€‚

æˆ‘ä»¬è¶çƒ­æ‰“é“ï¼Œå†ä¸¾ä¸ªç»ˆæä¾‹å­ã€‚å°±ç®—ä¸Šé¢çš„ä»£ç æ²¡æœ‰è®©ä½ ç†è§£ï¼Œä¸‹é¢çš„ä¾‹å­ä¸€å®šèƒ½ä»¤ä½ å½»åº•æ˜ç™½ï¼š

```c#
public static IEnumerable<int> GetInfinite()  //0åˆ°æ— ç©·å¤§çš„åºåˆ—
{
    int i = 0;
    while (true)   //æ²¡é”™ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ­»å¾ªç¯
    {
        yield return i;
        i++;
    }
}
```

è¦æ˜¯ä¸€èˆ¬çš„æ–¹æ³•ï¼Œè¿™é‡Œå·²ç»å¼¹å‡ºç¼–è¯‘å™¨è­¦å‘Šäº†ï¼šâ€œå˜¿ï¼Œå“¥ä»¬ï¼Œå¿«çœ‹ï¼ä½ çš„ä»£ç é‡Œæœ‰ä¸ªæ— æ³•è·³å‡ºçš„æ­»å¾ªç¯ï¼Œä½ æ˜¯ä¸æ˜¯è„‘è¢‹ç§€é€—äº†ï¼Ÿâ€ã€‚ä½†æ˜¯ï¼Œç”±äºå°†è¿­ä»£å™¨èµ‹å€¼ç»™å˜é‡æ—¶ä»–è¿˜æœªæ‰§è¡Œï¼Œè€Œè¿­ä»£æ‰§è¡Œçš„æ—¶å€™è¿­ä»£å™¨åˆæ˜¯ä¸€ä¸ªä¸€ä¸ªåå‡ºæ•°æ®çš„ï¼Œæ‰€ä»¥ä»€ä¹ˆæ—¶å€™åœæ­¢è¿­ä»£å®Œå…¨å¯ä»¥ç”±è°ƒç”¨è€…è¯´äº†ç®—ã€‚ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç”¨ï¼š

```c#
foreach (var integer in infinite)
{
    if (integer > 10)  //å¤§äº10åˆ™ç»“æŸè¿­ä»£
    {
        break;
    }
    Console.WriteLine(integer);
}
```

å®ƒçš„è¿è¡Œç»“æœæ˜¯ï¼š

```txt
0
1
2
3
4
5
6
7
8
9
10
```

ç¨‹åºæ²¡æœ‰å¹¶é™·å…¥æ­»å¾ªç¯ã€‚

å¥½äº†ï¼Œç›¸ä¿¡åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥ä¸å¯èƒ½ä¸ç†è§£è¿­ä»£å™¨çš„å·¥ä½œåŸç†äº†ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬èŠèŠä½¿ç”¨è¿­ä»£å™¨éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š

åŸºäºä¸Šè¿°ç‰¹ç‚¹ï¼Œè¢«è¿­ä»£å™¨èµ‹å€¼çš„å˜é‡**ä¸ä¼šä¿å­˜æ–¹æ³•æ‰§è¡Œç»“æœ**ã€‚å¯¹äºä¸Šä¾‹ä¸­ï¼Œå¦‚æœå†æ¬¡è°ƒç”¨foreachè¿­ä»£ï¼Œè¿­ä»£å™¨æ–¹æ³•ä¼šè¢«**å†æ¬¡æ‰§è¡Œ**ã€‚

- è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šè¿­ä»£å™¨æ–¹æ³•å¯ä»¥æ”¯æŒè¿ç¼€ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ¯æ¬¡è¿ç¼€éƒ½ä¼šçœŸå®çš„æ‰§è¡Œä¸€æ¬¡è¿­ä»£ï¼Œå¯ä»¥åœ¨è¿ç¼€å®Œæˆåä¸€æ¬¡æ€§æ‰§è¡Œè¿­ä»£ã€‚è¿™ä¹Ÿæ˜¯LINQçš„æ€æƒ³åŸºç¡€ã€‚åœ¨LINQä¸­ï¼Œè¿™ä¸ªç‰¹ç‚¹åœ¨é¢„æµ‹ç”¨çš„è¿­ä»£å™¨è¢«å¤šä¸ªæŸ¥è¯¢å¤ç”¨çš„æƒ…å†µä¸‹ä¼šéå¸¸æœ‰ç”¨ã€‚
- è¿™æ ·åšçš„åå¤„æ˜¯ï¼šè¿­ä»£å™¨ä¸­å¦‚æœè¿›è¡Œå¤§é‡è®¡ç®—è¦å½“å¿ƒé‡å¤è°ƒç”¨å¸¦æ¥ä¸å¿…è¦æ€§èƒ½æŸå¤±ã€‚è€Œå¦‚æœè¿­ä»£å™¨ä¸­åŒ…å«å¯¹ç¨‹åºçŠ¶æ€çš„ä¿®æ”¹ï¼Œåˆ™éœ€è¦å½“å¿ƒé‡å¤è°ƒç”¨å¯¼è‡´é‡å¤æ‰§è¡Œæ›´æ”¹çš„é—®é¢˜ã€‚åˆ‡è®°ï¼åˆ‡è®°ï¼

æ‰€ä»¥ï¼Œå¦‚æœä½ å¸Œæœ›é‡å¤ä½¿ç”¨è¿­ä»£å™¨æ–¹æ³•è·å–çš„æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®åˆä¸æ˜¯é›¶æˆæœ¬çš„è¯ï¼ˆæ¯”å¦‚å¿…é¡»ä»æ•°æ®åº“è¯»å–ï¼Œå¿…é¡»é€šè¿‡è®¡ç®—è·å¾—ï¼‰ã€‚æœ€å¥½ä½¿ç”¨å®ç°äº†IEnumerableæ¥å£çš„å¯¹è±¡ï¼Œå°†è¿­ä»£å™¨çš„ç»“æœå›ºåŒ–ä¸‹æ¥ã€‚ä¾¿æ·çš„æ–¹å¼æ˜¯ä½¿ç”¨LINQçš„ToListï¼ŒToArrayç­‰æ–¹æ³•ã€‚

è¿­ä»£å™¨ä¸ºä»€ä¹ˆå¾ˆé‡è¦ï¼Ÿå› ä¸ºå¤§åé¼é¼çš„LINQä¾¿æ˜¯åŸºäºå®ƒçš„ã€‚LINQå› æ­¤ä¹Ÿæœ‰å»¶è¿Ÿæ‰§è¡Œçš„ç‰¹ç‚¹ã€‚

> é‡è¦ï¼šJavaçš„è¿­ä»£å™¨ï¼ˆIteratorï¼‰è·ŸC#ä¸­çš„è¿­ä»£å™¨ï¼ˆIteratorï¼‰ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Javaçš„è¿­ä»£å™¨æŒ‡ç±»å‹ï¼ˆIteratoræ¥å£ï¼‰ï¼›è€ŒC#ç‰¹æŒ‡æ–¹æ³•ï¼ˆè¿­ä»£å™¨æ–¹æ³•ï¼‰ã€‚Javaçš„è¿­ä»£å™¨ï¼ˆIteratorï¼‰å¯¹åº”çš„æ˜¯C#çš„æšä¸¾å™¨æ¥å£ï¼ˆIEnumratorï¼‰ã€‚äº‹å®ä¸Šï¼Œè¿­ä»£å™¨æ–¹æ³•æ˜¯C#ç‰¹æœ‰çš„è¯­æ³•ï¼ŒJavaä¸å­˜åœ¨C#æ„ä¹‰ä¸Šçš„è¿­ä»£å™¨ã€‚Javaçš„è¿”å›è¿­ä»£å™¨çš„æ–¹æ³•ä¸ä¼šå‡ºç°è¿™ç§ç¼–è¯‘å™¨é‡æ’ï¼Œä¹Ÿæ²¡æœ‰å¥‡æ€ªçš„æ‰§è¡Œé¡ºåºï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰å»¶è¿Ÿæ‰§è¡Œçš„ç‰¹ç‚¹ã€‚

## C# 2.0çš„å…¶ä»–æ”¹è¿›

- **getterã€setterçš„å•ç‹¬å¯è®¿é—®æ€§**ï¼šç°åœ¨ï¼Œgetterå’Œsetteræ”¯æŒä½¿ç”¨ä¸åŒçš„è®¿é—®çº§åˆ«ï¼š

    ```c#
    public string Name 
    {
        public get { ... }  //å…¬æœ‰çš„è¯»
        private set { ... }  //ç§æœ‰çš„å†™
    }
    ```

- **staticç±»**ï¼š`static`å¯ä»¥ç”¨æ¥ä¿®é¥°ç±»ã€‚staticçš„ç±»ä¸­åªèƒ½åŒ…å«staticçš„æˆå‘˜ã€‚
- **æ•°ç»„çš„åå˜**ï¼šæ•°ç»„æ”¯æŒäº†åå˜ã€‚ä½†C# 2.0çš„å˜ç§ä¸æ˜¯å®Œæ•´çš„åŠŸèƒ½ã€‚å®Œæ•´çš„åŠŸèƒ½è¦åœ¨C# 4.0æ‰å¼•å…¥ã€‚æˆ‘ä»¬ä¼šåœ¨C#4.0ä¸­ï¼ŒåŒæ³›å‹çš„[åå˜å’Œé€†å˜](#åå˜ï¼ˆCovariantï¼‰ã€é€†å˜ï¼ˆContravariantï¼‰)ä¸€èµ·ä»‹ç»ã€‚

# C# 3.0 â€”â€” åˆ†é“æ‰¬é•³ã€æ”¾é£è‡ªæˆ‘ã€è·¨æ—¶ä»£åˆ›æ–°

æ²¡é”™ï¼Œæˆ‘ç”¨äº†å¥½å‡ ä¸ªå½¢å®¹è¯ã€‚C#3.0æ˜¯ä¸€ä¸ªè·¨æ—¶ä»£çš„ç‰ˆæœ¬ï¼Œå®ƒæå‡ºäº†éå¸¸å¤šåˆ›æ–°ã€è¶…å‰çš„æ¦‚å¿µã€‚è€Œä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹ï¼ŒC#ä¹Ÿå½»åº•è„±ç¦»äº†å¯¹Javaçš„è¿½èµ¶ï¼Œä¸æ›¾ç»çš„è€å¸ˆåˆ†é“æ‰¬é•³ï¼Œèµ°å‘äº†ç‹¬ç«‹å‘å±•ã€‚

è¿™ä¸€ç« ï¼Œåˆä¼šæ¯”è¾ƒé•¿ã€‚

C# 3.0ï¼Œæ”¯æŒä»¥ä¸‹è¯­æ³•ï¼š

## è‡ªåŠ¨å±æ€§ï¼ˆAuto-Implemented Propertyï¼‰

è‡ªåŠ¨å®ç°çš„å±æ€§ï¼Œç®€ç§°è‡ªåŠ¨å±æ€§ã€‚æ˜¯æˆ‘ä»¬ç°åœ¨å®šä¹‰å±æ€§æ—¶æœ€å¸¸ç”¨çš„è¯­æ³•ï¼š

```c#
public string Name { get; set; }
```

è¿™æ ·ä¹¦å†™çš„å±æ€§ï¼Œå°†è‡ªåŠ¨å®ç°`get`å’Œ`set`è®¿é—®å™¨ï¼Œä¹Ÿä¸å¿…å†æä¾›æ”¯æ’‘å­—æ®µã€‚

> ä¸ä¹‹éå¸¸ç±»ä¼¼çš„æ˜¯ï¼ŒJavaä¸­å¯ä»¥ä½¿ç”¨Lombokæ¥å®ç°ç±»ä¼¼åŠŸèƒ½ã€‚ä½¿ç”¨Lombokä¸­çš„`@Data`ã€`@Setter`ã€`@Getter`æ³¨è§£ï¼Œæ ‡æ³¨äºç±»æˆ–è€…å­—æ®µä¸Šï¼Œå¯ä»¥è‡ªåŠ¨å®ç°å­—æ®µçš„getå’Œsetæ–¹æ³•ã€‚éœ€è¦æ³¨æ„ï¼Œè¦ä½¿å¾—ä½¿ç”¨äº†Lombokçš„ä»£ç åœ¨IDEä¸­è·å¾—è¯­æ³•æç¤ºï¼Œéœ€è¦å®‰è£…é¢å¤–çš„æ’ä»¶ã€‚

## éšå¼ç±»å‹ï¼ˆImplicitly Typedï¼‰

`var`å…³é”®è¯ç”¨äºè‡ªåŠ¨æ¨æ–­å˜é‡çš„ç±»å‹ï¼Œå¯ä»¥ç”¨ç®€åŒ–æœ¬åœ°å˜é‡çš„å£°æ˜ï¼š

```c#
int x = 1; //æ˜¾å¼ç±»å‹
var y = 1; //éšå¼ç±»å‹

var a = 1; //aä¸ºintå‹
var b = 'c'; //bä¸ºcharå‹
var c = "Hello"; //cä¸ºstringå‹
```

éœ€è¦æ³¨æ„ï¼š

- ä½¿ç”¨`var`å£°æ˜çš„å˜é‡ï¼Œä¾æ—§æ˜¯å¼ºç±»å‹çš„ã€‚ä¸€æ—¦å¯¹è±¡çš„ç±»å‹æ¨æ–­å®Œæˆï¼Œè¯¥å˜é‡ä¾¿å§‹ç»ˆå…·æœ‰è¯¥ç±»å‹ï¼Œä¸å¯æ”¹å˜ã€‚
- `var`åªèƒ½ç”¨äºæœ¬åœ°å˜é‡ï¼Œä¸å¯ç”¨äºç±»çš„æˆå‘˜ã€‚

> Javaåœ¨10ç‰ˆæœ¬ä¹Ÿå¼•å…¥äº†varå…³é”®è¯ï¼Œç”¨æ³•ä¸€è‡´ã€‚

## åˆå§‹åŒ–å™¨ï¼ˆInitailizerï¼‰

åˆå§‹åŒ–å™¨å¯ä»¥åœ¨ç»™å˜é‡ã€æˆå‘˜åˆå§‹åŒ–æ—¶ï¼Œå¿«é€Ÿè®¾ç½®ã€å¡«å……å†…å®¹ã€‚

åŒ…å«å±æ€§çš„ç±»ï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–åŒæ—¶è®¾ç½®å±æ€§çš„å€¼ã€‚

è€ƒè™‘å¦‚ä¸‹ç±»å®šä¹‰ï¼š

```c#
public class Dog
{
    public int Age { get; set; } //å¹´é¾„
    public string Name { get; set; } //æ˜µç§°
    public Dog() { }  //æ— å‚æ„é€ å™¨
    public Dog(string name)  //å«å‚æ•°æ„é€ å™¨
    {
        Name = name;
    }
}
```

åœ¨åˆ›å»ºDogå¯¹è±¡æ—¶ï¼Œå¯ä»¥ï¼š

```c#
//ä½¿ç”¨æ— å‚æ„é€ å™¨æ—¶ï¼Œ()å¯ä»¥çœç•¥
Dog dog1 = new Dog  //è¿™å°†è°ƒç”¨æ— å‚æ„é€ å™¨ 
{
    Age = 10,
    Name = "æ—ºè´¢"
};  //ä½œä¸ºä¸€è¡Œè¯­å¥ï¼Œæ­¤å¤„éœ€è¦åˆ†å·
Dog dog2 = new Dog("å¤§é»„")
{
    Age = 5
};
```

å¦å¤–ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ»¡è¶³ä¸‹é¢æ¡ä»¶ä¹‹ä¸€ï¼š

- å¯¹è±¡æ˜¯ä¸ªæ•°ç»„
- å¯¹è±¡å®ç°äº†`IEnumerable`æˆ–è€…`IEnumerable\<T>`ï¼Œå¹¶ä¸”å¯¹è±¡æœ‰ä¸€ä¸ªå…¬å¼€çš„ï¼ˆ`public`æˆ–`internal`ï¼‰çš„`Add`æ–¹æ³•

åˆ™å¯ä»¥ä½¿ç”¨èŠ±æ‹¬å·çš„åˆå§‹åŒ–å™¨æ ¼å¼ï¼Œå½¢å¦‚ï¼š

```c#
int [] array = new int[5] { 1, 2, 3, 4, 5 }; //æ•°ç»„çš„åˆå§‹åŒ–å™¨
int [] array2 = new int[] { 1, 2, 3, 4, 5 }; //ç‰¹åˆ«çš„ï¼Œç”±äºæ•°ç»„çš„å¤§å°ä¸å¯å˜ï¼Œå› æ­¤ä½¿ç”¨åˆå§‹åŒ–å™¨å¯ä»¥çœç•¥é•¿åº¦
int [] array3 = { 1, 2, 3, 4, 5 }; //æ›´ç‰¹åˆ«çš„ï¼Œå¯¹äºæ•°ç»„ï¼Œå¯ä»¥æ”¯æŒè¿™ç§ç®€å†™å½¢å¼ã€‚

List<int> digits = new List<int> { 1, 2, 3 }; //è¿™ä¼šè°ƒç”¨List<int>çš„Add(int)æ–¹æ³•
SomeClass someObjects = new SomeClass { {1, "ä½ å¥½"}, {2, "ä½ ä¸å¥½"} }; //è¿™å°†è°ƒç”¨SomeClassçš„Add(int, string)æ–¹æ³•ã€‚
```

ä½¿ç”¨åˆå§‹åŒ–å™¨ï¼Œå¯ä»¥ä½¿å¯¹è±¡çš„åˆå§‹åŒ–å˜å¾—æ›´åŠ ç®€æ´ç¾è§‚ã€‚

è®©æˆ‘ä»¬è€ƒè™‘æ›´å¤æ‚çš„æƒ…å½¢ï¼Œæ¥çœ‹çœ‹åˆå§‹åŒ–å™¨å¸¦æ¥çš„ä¼˜åŠ¿ï¼š

```c#
Student student = new Student
{
    Age = 13,
    Name = "å°æ˜",
    Scores = { 100, 95, 95 }, //Scoresæ˜¯ä¸€ä¸ªintå‹æ•°ç»„
    HaveCats = new List<Cat>  //ä»–å…»äº†è®¸å¤šçŒ« 
    {
        new Cat { Name = "å’ªå’ª" },
        new Cat 
        { 
            Name = "å¡å¡", //å¡å¡æ˜¯æˆ‘å…»è¿‡çš„ä¸€åªçŒ«ï¼Œåæ¥èµ°ä¸¢äº†
            Hobby = new List<string>
            {
                "çˆ¬é«˜",
                "ä¸Šä½", //æ­¤å¤„é€—å·å¯ä»¥ä¿ç•™ï¼Œä¸ä¼šæŠ¥é”™
            } 
        } //åŒæ ·çš„ï¼Œè¿™é‡Œå¯ä»¥æ·»åŠ é€—å·
    }, //åŒç†ï¼Œæ­¤å¤„é€—å·å¯å†™å¯ä¸å†™
};
```

> Javaæ²¡æœ‰åˆå§‹åŒ–å™¨çš„å¯¹ç…§ç‰©ã€‚ä¸è¿‡ä»åŠŸèƒ½çš„å®ç°æ¥è®²ï¼Œå€’æ˜¯å¯ä»¥è®²è®²ä¸¤ä¸ªä¸œè¥¿ï¼šåŒèŠ±æ‹¬å·åˆå§‹åŒ–ã€Java 9å¼•å…¥çš„ofé™æ€æ–¹æ³•ã€‚

> åŒèŠ±æ‹¬å·åˆå§‹åŒ–ï¼Œè¯­æ³•ä¸ºnewä¸€ä¸ªå¯¹è±¡çš„åŒæ—¶åœ¨åé¢æ·»åŠ åŒèŠ±æ‹¬å·ã€‚åœ¨å…¶ä¸­è°ƒç”¨setã€addç­‰æ–¹æ³•ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ç”¨æ³•ï¼Œç„¶åå†è¯´è¯´ä¸ºä»€ä¹ˆå®ƒåªæ˜¯çœ‹ä¼¼å®ç°äº†ç±»ä¼¼åŠŸèƒ½ï¼Œæœ¬è´¨ä¸Šä¸C#çš„åˆå§‹åŒ–å™¨å®Œå…¨ä¸åŒã€‚
>
> ```java
> //==Java==
> Person person = new Person() {{
>     setName("å¼ ä¸‰");
> }};
> ```
>
> å¦‚æœè¦å®ç°ä¸Šé¢çš„Studentåˆå§‹åŒ–ä¸€æ ·çš„åŠŸèƒ½ï¼ŒJavaéœ€è¦è¿™ä¹ˆå†™
>
> ```java
> //==Java==
> Student student = new Student() {{
>     setAge(13);
>     setName("å°æ˜");
>     setScores(new int[]{100, 95, 95});
>     setHaveCats(new LinkedList<Cat>(){{
>         add(new Cat() {{
>             setName("å’ªå’ª");
>         }});
>         add(new Cat() {{
>             setName("å’ªå’ª");
>             setHobby(new LinkedList<String>() {{
>                 add("çˆ¬é«˜");
>                 add("ä¸Šä½");
>             }});
>         }});
>     }});
> }};
> ```
>
> æ˜¾è€Œæ˜“è§ï¼Œè¿™æ—¶ä»£ç çš„å¯è¯»æ€§å·²ç»å¾ˆå·®äº†ï¼Œä¹¦å†™çš„å¤æ‚åº¦ä¹Ÿä¸Šå‡äº†ä¸å°‘ã€‚ä½†è¿™è¿˜ä¸æ˜¯æœ€è¦å‘½çš„ã€‚
>
> æ›´è¦å‘½çš„æ˜¯ï¼šè¿™æ ·åšçš„å«ä¹‰ï¼Œå…¶å®æ˜¯åˆ›å»ºäº†åŒ¿åå†…éƒ¨ç±»ï¼ˆå¤–å±‚æ‹¬å·ï¼‰ï¼Œç„¶åå†åœ¨åŒ¿åç±»ä¸­æ‰§è¡Œäº†å®ä¾‹åˆå§‹åŒ–ä»£ç å—ï¼ˆå†…å±‚æ‹¬å·ï¼‰ã€‚å› è€Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéé™æ€çš„å†…éƒ¨åŒ¿åç±»ä¼šæŒæœ‰å¤–éƒ¨å¯¹è±¡çš„å¼•ç”¨ã€‚è€Œå¤–éƒ¨å¯¹è±¡å¦‚æœè¢«æ›´å¹¿æ³›çš„å¼•ç”¨åˆ°æ›´å¤§çš„ç”Ÿå‘½å‘¨æœŸå†…â€”â€”æ¯”å¦‚ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ï¼Œå¹¶èµ‹å€¼ç»™ç”Ÿå‘½å‘¨æœŸæ›´é•¿çš„å¯¹è±¡ä½œä¸ºå­—æ®µå€¼â€”â€”æœ‰å¯èƒ½å¯¼è‡´GCæ— æ³•åŠæ—¶å›æ”¶å†…éƒ¨ç±»çš„èµ„æºã€‚è¿™æœ‰å¯èƒ½å¼•èµ·å†…å­˜æ³„æ¼ï¼Œç”šè‡³æç«¯æƒ…å†µä¸‹å¼•å‘OOMï¼ˆOut Of Memoryï¼Œå³å†…å­˜æº¢å‡ºï¼‰ã€‚
> > å…³äºJavaçš„åŒ¿åå†…éƒ¨ç±»ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€ä¸ªå°ç»“çš„å¯¹æ¯”ä¸­ä»‹ç»ã€‚
> è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å‘ç°ï¼Œå®ƒä¸C#çš„åˆå§‹åŒ–å™¨è™½ç„¶å¯ä»¥å®ç°ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†æ˜¯å®Œå…¨ä¸æ˜¯ä¸€å›äº‹å„¿ã€‚è¿˜æ˜¯ä¸ç”¨ä¸ºå¦™ã€‚
>
> äº‹å®ä¸Šï¼Œå¾ˆå¤šå…¬å¸æ˜ç¡®è¦æ±‚ç¦æ­¢åŒæ‹¬å·åˆå§‹åŒ–è¯­æ³•å‡ºç°åœ¨é¡¹ç›®ä¸­ã€‚

> åªé’ˆå¯¹åºåˆ—ï¼Œåœ¨Java 9ä¹‹åï¼ŒListã€Setã€Mapç­‰æ¥å£å¢åŠ äº†ç”¨äºåˆå§‹åŒ–å¹¶æ·»åŠ å…ƒç´ çš„æ–°æ–¹æ³•ï¼šé™æ€çš„ofæ–¹æ³•ï¼Œofæ–¹æ³•çš„å‚æ•°æ˜¯å¯å˜å‚æ•°ï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–æ—¶ä¸€æ¬¡æ€§æ·»åŠ å¤šä¸ªå…ƒç´ åˆ°åºåˆ—ä¸­ï¼š
>
> ```java
> //==Java==
> List<String> list = List.of("a", "b", "c", "d", "e");
> ```
>
> è¿™ä¸ªä¸C#é’ˆå¯¹å¯æšä¸¾å¯¹è±¡çš„åˆå§‹åŒ–å™¨æœ‰äº›è®¸ç›¸ä¼¼ï¼Œä½†æ˜¯ï¼š
>
> - å®ƒä»¬åªèƒ½ç”¨äºåˆå§‹åŒ–è¿™å‡ ç§ç‰¹å®šæ¥å£çš„åºåˆ—ã€‚
> - ç”¨å®ƒä»¬åˆå§‹åŒ–çš„åºåˆ—æ˜¯åªè¯»çš„ï¼Œä¸å¯ä»¥å†addå’Œremoveã€‚
>
> äº‹å®ä¸Šï¼Œofæ–¹æ³•ä¹Ÿæ˜¯ä¸ºäº†æ»¡è¶³å‡½æ•°å¼ç¼–ç¨‹è€Œå‡ºç°çš„ã€‚
>
> æ‰€ä»¥ï¼Œè¿˜æ˜¯æ— æ³•ä¸C#çš„åˆå§‹åŒ–å™¨ç›¸æå¹¶è®ºã€‚

## åŒ¿åç±»å‹ï¼ˆAnonymous Typeï¼‰

æœ‰äº†éšå¼ç±»å‹å’Œåˆå§‹åŒ–å™¨ä½œä¸ºåŸºç¡€ï¼Œä¾¿å¯ä»¥æè¿°åŒ¿åç±»å‹äº†ã€‚

åŒ¿åç±»å‹æ˜¯æŒ‡ä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸å¿…æ˜¯äº‹å…ˆå·²å®šä¹‰çš„ç±»å‹ã€‚è¿™æ ·åšå¯ä»¥åœ¨éœ€è¦ä½¿ç”¨ä¸€ä¸ªç”±ç®€å•ç»“æ„ç»„æˆçš„å¯¹è±¡çš„åœºåˆï¼Œä¸å¿…ä¸­æ–­æ€è·¯å…ˆå»å®šä¹‰ä¸€ä¸ªç±»æ¥æ‰¿è½½è¿™ä¸ªå¯¹è±¡ã€‚

åŒ¿åç±»å‹çš„å£°æ˜å¦‚ä¸‹ï¼š

```c#
var anonymousObject = new 
{
    Name = "åŒ¿åç±»å‹",
    Description = "è¿™æ˜¯ä¸€ä¸ªåŒ¿åç±»å‹",
    Levels = new int[] { 1, 2, 3 }
};
```

å¯è§ï¼ŒåŒ¿åç±»å‹çš„è¯­æ³•ï¼Œæ˜¯åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œåªç”¨newï¼Œä¸æŒ‡å®šç±»å‹ã€‚åœ¨åé¢ä¹¦å†™åˆå§‹åŒ–å™¨ï¼Œç›´æ¥åˆå§‹åŒ–è¯¥å¯¹è±¡ã€‚åˆå§‹åŒ–å™¨ä¸­å£°æ˜çš„å‡æ˜¯è¯¥åŒ¿åç±»å‹çš„å±æ€§ã€‚ä¹Ÿç”±äºæ˜¯åŒ¿åçš„ï¼Œå®ƒä¹Ÿåªèƒ½ç”±varéšå¼ç±»å‹æ¥æ”¶ï¼ˆç”±Objectæ¥å—çš„è¯ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨åŒ¿åç±»å‹çš„å±æ€§ï¼‰ã€‚

ä½¿ç”¨åŒ¿åç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŒ¿åçš„å¼ºç±»å‹ç±»ã€‚æ‰€æœ‰åå°„çš„æ“ä½œéƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚

åŒæ—¶ï¼Œç¼–è¯‘å™¨è¿˜å¯¹åŒ¿åç±»å‹åšäº†ä¼˜åŒ–ï¼šå…·æœ‰å®Œå…¨ç›¸åŒå±æ€§çš„åŒ¿åç±»å‹ï¼Œä¼šè¢«åˆå¹¶æˆä¸€ä¸ªç›¸åŒçš„åŒ¿åç±»å‹ã€‚

```c#
var a = new { x = 1 };
var b = new { x = 2 };
var c = new { x = 3, y = 3 };
Console.WriteLine(a.GetType().FullName);
Console.WriteLine(b.GetType().FullName);
Console.WriteLine(c.GetType().FullName);
```

ç»“æœä¸ºï¼š

```txt
<>f__AnonymousType0`1[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]
<>f__AnonymousType0`1[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]
<>f__AnonymousType1`2[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]
```

aå’Œbçš„ç±»å‹å®Œå…¨ç›¸åŒã€‚æ­¤æ—¶æˆ‘ä»¬å°†bèµ‹å€¼ç»™aæ˜¯å®Œå…¨å¯ä»¥çš„ã€‚

```c#
a = b; //OK
```

æ­£å› ä¸ºå¦‚æ­¤ï¼Œå¯ä»¥ç›´æ¥åˆ›å»ºåŒ¿åç±»å‹çš„æ•°ç»„ï¼š

```c#
var array = new [] 
{
    new { x = 1, y = 2 },
    new { x = 2, y = 3 },
    new { x = 4, y = 5 },
};  //OKï¼Œåˆæ³•
```

> è¿™é‡Œå¯ä»¥å¯¹æ¯”ä¸€ä¸‹Javaçš„åŒ¿åå†…éƒ¨ç±»ï¼ˆAnonymous Inner Classï¼‰ã€‚äº‹å®ä¸Šï¼Œè¿™æ˜¯Javaä¸ºæ•°ä¸å¤šçš„åœ¨è¯­æ³•å±‚é¢è¶…è¶ŠC#çš„æœºåˆ¶ã€‚
>
> C#çš„åŒ¿åç±»å‹ï¼Œåªèƒ½æä¾›å±æ€§åŠå…¶å€¼ï¼Œå› è€ŒåŒ¿åç±»å‹éƒ½æ˜¯**POCO**ï¼ˆPlain Old CLR Objectï¼Œå¯¹åº”Javaçš„**POJO**ï¼Œå³Plain Old Java Objectï¼‰ã€‚è€ŒJavaçš„å†…éƒ¨åŒ¿åç±»ï¼Œä¸ä»…èƒ½æä¾›å­—æ®µã€å­—æ®µçš„getå’Œsetæ–¹æ³•ï¼Œè¿˜å¯ä»¥æä¾›å®ä¾‹åˆå§‹åŒ–ä»£ç ï¼ˆInstance Initializer Blockï¼‰ï¼Œç”šè‡³å¯ä»¥å®šä¹‰æ–¹æ³•å’Œé‡å†™æ–¹æ³•ã€‚å”¯ä¸€çš„é™åˆ¶æ˜¯ï¼šåŒ¿åå†…éƒ¨ç±»å¿…é¡»ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œæˆ–è€…å®ç°ä¸€ä¸ªæ¥å£ï¼Œè€Œä¸èƒ½æ— ä¸­ç”Ÿæœ‰ã€‚
>
> ä¸Šè¿°åŒºåˆ«ä½¿å¾—äºŒè€…ä½¿ç”¨çš„åœºæ™¯å¹¶ä¸ç›¸åŒï¼šC#åŒ¿åç±»å¤šç”¨äº**ä¸´æ—¶èšåˆæ•°æ®**ï¼ˆC# 7.0åæœ‰äº†æ›´å¥½çš„æ–¹å¼â€”â€”å…ƒç»„ï¼‰ï¼Œè€ŒJavaçš„åŒ¿åå†…éƒ¨ç±»åˆ™æ˜¯ç”¨æ¥**ä¸´æ—¶æ·»åŠ åŠŸèƒ½**ã€‚

> ä¸¾ä¾‹è¯´æ˜ï¼š
>
> ```java
> //==Java==
> Person person = new Person() {  //è¿™é‡ŒèŠ±æ‹¬å·æ˜¯æŒ‡å®ç°ä¸€ä¸ªå†…éƒ¨åŒ¿åç±»ï¼Œå®ƒç»§æ‰¿äº†Personç±»ï¼Œä¸C#çš„åˆå§‹åŒ–å™¨ä¸æ˜¯ä¸€å›äº‹
>     {    //è¿™é‡Œæ˜¯å®ä¾‹åŒ–åˆå§‹åŒ–å—ï¼Œæ˜¯æŒ‡è¯¥å†…éƒ¨åŒ¿åç±»çš„å¯¹è±¡è¢«åˆ›å»ºæ—¶åº”è¯¥æ‰§è¡Œçš„è¯­å¥ï¼Œç›¸å½“äºæ„é€ å™¨ã€‚åŒæ‹¬å·åˆå§‹åŒ–æœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨çš„è¿™ä¸ª
>         setName("å¼ ä¸‰");  //Personç±»ä¸­å·²ç»æœ‰nameå­—æ®µå’ŒsetNameæ–¹æ³•
>     }
>     @Getter
>     @Setter
>     private int age;  //å®šä¹‰äº†å­—æ®µï¼Œå¹¶é€šè¿‡Lombokæ·»åŠ äº†getå’Œsetæ–¹æ³•ï¼Œä½†æ˜¯æ— æ³•è¢«è®¿é—®åˆ°
>     public int computeImaginaryAge() { //å®šä¹‰äº†æ–¹æ³•ï¼šè®¡ç®—è™šå²ï¼Œä½†æ˜¯æ— æ³•è¢«è®¿é—®
>         return age + 1;  //è¯·ä¸è¦çº ç»“è™šå²ä¸æ˜¯è¿™ä¹ˆç®—çš„
>     }  
>     @Override
>     public String toString() {  //é‡å†™toStringæ–¹æ³•
>         return name;
>     }
> };
> ```
>
> ä¸Šè¿°ä»£ç å®é™…ä¸Šå£°æ˜äº†ä¸€ä¸ªPersonçš„åŒ¿åå†…éƒ¨ç±»ï¼Œå¹¶å¯¹å…¶å®ä¾‹åŒ–ï¼Œç„¶åå°†å…¶èµ‹å€¼ç»™äº†Personç±»å‹çš„å˜é‡personã€‚personçš„å®é™…ç±»å‹ä¸ºè¯¥åŒ¿åç±»å‹ï¼ŒPersonæ˜¯å®ƒçš„çˆ¶ç±»ã€‚æ³¨é‡Šä¸­å·²ç»åˆ—å‡ºäº†ä¸Šè¿°ä»£ç å­˜åœ¨çš„é—®é¢˜ï¼šç”±äºå†…éƒ¨åŒ¿åç±»ä½¿ç”¨çˆ¶ç±»è¿›è¡Œæ“ä½œï¼Œåœ¨å†…éƒ¨ç±»ä¸­å®šä¹‰çš„publicæ–¹æ³•æ— æ³•è¢«ç›´æ¥è®¿é—®åˆ°ã€‚è™½ç„¶ä»ç„¶å¯ä»¥é€šè¿‡åå°„è®¿é—®åˆ°ï¼Œä½†æ˜¯è°ä¼šè¿™ä¹ˆåšå‘¢ï¼Ÿå®é™…åœºæ™¯ä¸­åŒ¿åå†…éƒ¨ç±»æ–°å¢çš„æ–¹æ³•ä¼šç”¨privateä¿®é¥°ã€‚publicçš„æ–¹æ³•è¦ä¹ˆæ˜¯å¯¹çˆ¶ç±»æ–¹æ³•çš„é‡å†™ï¼Œè¦ä¹ˆæ˜¯å¯¹æ¥å£çš„å®ç°ã€‚

> åŒ¿åå†…éƒ¨ç±»çš„å¯¹è±¡å®é™…ä¸Šéšå¼çš„åŒ…å«äº†ä¸€ä¸ªå­—æ®µï¼Œç”¨äºå­˜å‚¨å¯¹çˆ¶ç±»çš„å¼•ç”¨ï¼Œè¯¥å­—æ®µä¸º`this$0`ï¼Œå¯ä»¥é€šè¿‡åå°„è¯»å–åˆ°ã€‚

> åŒ¿åå†…éƒ¨ç±»æœ€ä¸ºå¥½ç”¨çš„åœºæ™¯ï¼Œåœ¨äºå®ƒå¯ä»¥ç›´æ¥æä¾›ä¸€ä¸ªæ¥å£çš„åŒ¿åå®ç°ï¼Œè€Œä¸å¿…ä¸ºæ­¤ç‰¹æ„æå‰å®šä¹‰ä¸€ä¸ªç±»ã€‚å› è€Œï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¸ºä¸€ä¸ªä»æœªè¢«å®ç°è¿‡çš„æ¥å£æä¾›ä¸´æ—¶çš„å®ç°ã€‚è¿™ç‚¹æ¯”C#è¦èˆ’å¦ï¼ŒC#ä¸­æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚

> ç‰¹åˆ«çš„ï¼Œåœ¨ä½¿ç”¨é’»çŸ³è¿ç®—ç¬¦æ—¶ï¼ŒJava 8ä¹‹å‰çš„ç‰ˆæœ¬ä¸å¯ä»¥å®šä¹‰å†…éƒ¨åŒ¿åç±»ï¼Œä½†æ˜¯Java 9ä»¥åçš„ç‰ˆæœ¬æ”¯æŒå®šä¹‰å†…éƒ¨åŒ¿åç±»ã€‚

### åŒ¿åç±»å‹çš„å±æ€§åç§°æ¨æ–­

å½“åˆ›å»ºä¸€ä¸ªåŒ¿åç±»å‹å¯¹è±¡æ—¶ï¼Œå…·æœ‰æ˜ç¡®åç§°çš„å¯¹è±¡ã€å¯¹è±¡çš„å­—æ®µæˆ–å±æ€§ç­‰å¯ä»¥ç›´æ¥ç”¨äºæè¿°åŒ¿åç±»å‹çš„å±æ€§ï¼Œè€Œä¸éœ€è¦æ˜¾å¼çš„æä¾›`å±æ€§=å€¼`çš„æ ¼å¼ã€‚

```c#
int n = 100;
Cat cat new Cat { Name = "å–µå‘œ" };
var anonymousObject = new  //è¯¥åŒ¿åç±»å¯¹è±¡å…·æœ‰ä¸¤ä¸ªå±æ€§ï¼šNameå’Œn
{
    cat.Name,  //è‡ªåŠ¨æ¨æ–­å±æ€§åä¸ºNameï¼Œèµ‹å€¼ä¸ºcat.Nameçš„å€¼ 
    n //è‡ªåŠ¨æ¨æ–­å±æ€§åä¸ºnï¼Œèµ‹å€¼ä¸ºnçš„å€¼
}
```

## Lambdaè¡¨è¾¾å¼

Lambdaè¡¨è¾¾å¼ï¼Œç®€ç§°Lambdaï¼Œç”¨äºæè¿°æ–¹æ³•çš„å®ç°ã€‚ç¬¦å·ä¸º`=>`ã€‚

Lambdaæœ‰ä¸¤ç§å½¢å¼ï¼š

- è¡¨è¾¾å¼Lambdaï¼šä¸»ä½“ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼ŒLambdaåœ¨æ‰§è¡Œæ—¶è®¡ç®—è¯¥è¡¨è¾¾å¼çš„ç»“æœå¹¶è¿”å›ï¼ˆå¯ä»¥ä¸ºvoidï¼‰ã€‚æ­¤æ—¶ï¼Œæ— éœ€`{}`ã€‚æ ¼å¼ä¸ºï¼š

    ```c#
    (å‚æ•°åˆ—è¡¨) => è¡¨è¾¾å¼
    ```

- è¯­å¥Lambdaï¼šä¸»ä½“ä¸ºè¯­å¥å—ï¼ŒLambdaæ ¹æ®è¯­å¥å—ä¸­returnç±»å‹ç¡®å®šLambdaçš„è¿”å›ç±»å‹ï¼ˆå¯ä»¥ä¸returnï¼Œå³voidï¼‰ã€‚æ­¤æ—¶ï¼Œä½¿ç”¨`{}`åŒ…è£¹ï¼Œæ ¼å¼ä¸ºï¼š

    ```c#
    (å‚æ•°åˆ—è¡¨) => 
    {
        è¯­å¥;
        è¯­å¥;
        ...
    }
    ```

è¡¨è¾¾å¼Lambdaå¯ä»¥ç†è§£ä¸ºä»…åŒ…å«ä¸€æ¡returnè¯­å¥çš„è¯­å¥Lambdaã€‚ï¼ˆåªæ˜¯å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œåœ¨ç‰¹å®šåœºåˆä¸‹ï¼Œå®ƒä»¬åœ¨è¯­æ³•ä¸Šå¹¶ä¸ç­‰åŒï¼‰

Lambdaæ‰æ˜¯æä¾›åŒ¿åæ–¹æ³•å®ç°çš„æœ€å¸¸ç”¨æ–¹æ³•ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š

```c#
Action writeLine = () => Console.WriteLine();  //0å‚æ•°
Func<double, double> square = x => x * x;  //1ä¸ªå‚æ•°ï¼Œæ­¤æ—¶()å¯ä»¥çœç•¥
Func<int, int, int> add = (a, b) => a + b; //ä¸¤ä¸ªå‚æ•°
```

æ³¨æ„ï¼ŒLambdaä¸èƒ½æŒ‡å®šå‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹ï¼ˆC#10.0ä¹‹å‰ï¼‰ï¼Œåœ¨ä½¿ç”¨æ—¶ï¼Œä¼šæ ¹æ®æ¥æ”¶çš„å§”æ‰˜ç±»å‹è‡ªåŠ¨æ¨æ–­å‚æ•°å’Œè¿”å›ç±»å‹ã€‚

Lambdaä¹Ÿå¯ä»¥ä½¿ç”¨å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„æœ¬åœ°å˜é‡ã€‚å› æ­¤ä¹ŸåŒæ ·å¯èƒ½äº§ç”Ÿé—­åŒ…ã€‚

æ‰€æœ‰å§”æ‰˜ç±»å‹å‡å¯ä»¥ä½¿ç”¨Lambdaæè¿°ã€‚å¦å¤–ï¼ŒLambdaè¿˜å¯ä»¥ç”¨äº**è‡ªåŠ¨ç”Ÿæˆè¡¨è¾¾å¼æ ‘**ã€‚åœ¨ä½¿ç”¨LINQçš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•æ—¶Lambdaè¢«å¤§é‡ä½¿ç”¨ã€‚å®ƒ**å¾ˆé‡è¦**ã€‚

> Javaä¹Ÿæœ‰Lambdaï¼Œè¯­æ³•ä»…ä»…æ˜¯å°†`=>`æ”¹æˆ`->`ã€‚Javaçš„Lambdaè·ŸéšJava8ä¸€èµ·æ¨å‡ºï¼Œæ—¶é—´æ˜¯åœ¨2014å¹´ã€‚è¿™æ¯”C# 3.0çš„2007å¹´æ™šäº†7å¹´æ—¶é—´ã€‚
>
> æˆ‘ä»¬çŸ¥é“Javaæ˜¯æ²¡æœ‰å§”æ‰˜ç±»å‹çš„ã€‚é‚£ä¹ˆJavaæ˜¯ç”¨ä»€ä¹ˆç±»å‹æ¥æ¥æ”¶Lambdaçš„å‘¢ï¼Ÿ
>
> è¿™åˆæ˜¯ä¸€åœºç¼–è¯‘å™¨çš„é­”æœ¯äº†ã€‚
>
> Javaè§„å®šäº†ä¸€ç§æ¥å£ç±»å‹ï¼Œè¢«ç§°ä½œå‡½æ•°å¼æ¥å£ã€‚**å‡½æ•°å¼æ¥å£**æ˜¯æŒ‡åªæœ‰ä¸€ä¸ªéœ€è¦å®ç°çš„æ–¹æ³•çš„æ¥å£ã€‚å‡½æ•°å¼æ¥å£ä¸­å…è®¸æœ‰å…¶å®ƒå·²ç»æä¾›äº†é»˜è®¤å®ç°çš„æ–¹æ³•ï¼Œä½†æœªå®ç°çš„åªèƒ½æœ‰ä¸€ä¸ªã€‚å½“æŒ‡å®šä½¿ç”¨å‡½æ•°å¼æ¥å£ä½œä¸ºå‚æ•°ã€å˜é‡ç±»å‹æ—¶ï¼Œå¯ä»¥ç”¨ä¸¤ç§æ–¹å¼ä¼ é€’å‚æ•°å’Œèµ‹å€¼ï¼š
>
> - ä½¿ç”¨`ç±»å::æ–¹æ³•å`çš„è¯­æ³•ï¼Œç›´æ¥å°†æŸä¸ªç±»çš„æŸä¸ªæ–¹æ³•ä½œä¸ºè¯¥æ¥å£ä¸­å¾…å®ç°æ–¹æ³•çš„å®ç°ã€‚è¯¥æ–¹æ³•å¿…é¡»ä¸æ¥å£æ–¹æ³•çš„å£°æ˜ä¸€è‡´ã€‚
> - ä½¿ç”¨Lambdaè¡¨è¾¾å¼ã€‚æ­¤æ—¶ç¼–è¯‘å™¨å°†Lambdaçš„æè¿°è§†ä½œè¯¥æ¥å£ä¸­å¾…å®ç°çš„æ–¹æ³•çš„å®ç°ã€‚æä¾›çš„Lambdaéœ€è¦æœ‰ä¸æ­¤æ–¹æ³•ä¸€è‡´çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ã€‚
>
> åŸºäºç¼–è¯‘å™¨çš„ä¸Šè¿°é­”æœ¯ï¼Œå¯¹Lambdaçš„è°ƒç”¨è¢«è½¬åŒ–æˆäº†è°ƒç”¨æ¥å£å¯¹è±¡çš„æ–¹æ³•ï¼Œä»è€Œé¿å…äº†å¼•å…¥å‡½æ•°æŒ‡é’ˆçš„æ¦‚å¿µã€‚
>
> å‡½æ•°å¼æ¥å£ä¸€èˆ¬éƒ½ä¼šæ·»åŠ @FunctionalInterfaceæ³¨è§£ã€‚è¯¥æ³¨è§£æ ‡æ˜æ­¤æ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚ç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¯¥æ¥å£æ˜¯ä¸æ˜¯åªæœ‰ä¸€ä¸ªæœªå®ç°çš„æ–¹æ³•ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚
>
> ```java
> //==Java==
> @FunctionalInterface
> public interface MyFunctionalInterface {  //å®šä¹‰å‡½æ•°å¼æ¥å£
>     void method();
> }
>
> public class MyClass {
>     public void forLambda(MyFunctionalInterface impl) {  //å‡½æ•°å¼æ¥å£ä½œä¸ºå‚æ•°
>         impl.method();  //è°ƒç”¨æ¥å£çš„æ–¹æ³•ã€‚
>     }
>     public void test() {
>         forLambda(()->System.out.println("Lambdaæµ‹è¯•"));  //è°ƒç”¨forLambdaæ–¹æ³•ï¼Œå¹¶ä½¿ç”¨Lambdaæè¿°å‚æ•°implï¼Œæ­¤æ—¶Lambdaä¼šæˆä¸ºè¯¥æ¥å£çš„methodæ–¹æ³•çš„å®ç°ã€‚
>     }
> }
> ```
>
> Javaç³»ç»Ÿæä¾›äº†ä¸€å †é¢„å®šä¹‰çš„å‡½æ•°å¼æ¥å£ï¼Œå®ƒä»¬è¢«å®šä¹‰åœ¨java.util.functionåŒ…ä¸‹ã€‚è¿™äº›æ¥å£åŸºæœ¬æ»¡è¶³äº†streamç¼–ç¨‹çš„éœ€æ±‚ï¼ˆJavaçš„streamç¼–ç¨‹è¯­æ³•ç±»ä¼¼LINQçš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼Œæœ¬æ–‡ä¼šåœ¨ä»‹ç»åˆ°LINQçš„æ—¶å€™åšå‡ºä»‹ç»ï¼‰ã€‚
>
> PSï¼šäº‹å®ä¸Šï¼Œå‡½æ•°å¼æ¥å£åŒæ ·æ˜¯å‘å‡½æ•°å¼ç¼–ç¨‹é æ‹¢çš„ä¸€æ¬¡å°è¯•ã€‚å°±æœ¬è´¨ä¸Šè®²ï¼ŒLINQå’ŒStreaméƒ½å¾ˆå‡½æ•°å¼ï¼Œç„¶è€Œæ— è®ºJavaè¿˜æ˜¯C#éƒ½å¹¶ä¸æ˜¯å‡½æ•°å¼çš„è¯­è¨€ã€‚åé¢æˆ‘ä»¬è¿˜ä¼šçœ‹åˆ°ä¸¤è€…æ›´å¤šå‘å‡½æ•°å¼çœ‹é½çš„æ›´æ–°ã€‚

## åˆ†éƒ¨æ–¹æ³•ï¼ˆPartial Methodï¼‰

åˆ†éƒ¨æ–¹æ³•æ˜¯åˆ†éƒ¨ç±»çš„æ‰©å±•ã€‚åˆ†éƒ¨æ–¹æ³•å¿…é¡»æ”¾åœ¨åˆ†éƒ¨ç±»ä¸­ï¼Œå®ƒå…è®¸å…ˆå£°æ˜åˆ†éƒ¨æ–¹æ³•çš„ç­¾åï¼Œä½†æ˜¯ä¸åœ¨æ­¤æä¾›å®ç°ã€‚è¯¥æ–¹æ³•å¯ç”±åˆ†éƒ¨ç±»çš„å…¶ä»–éƒ¨åˆ†æ¥å®ç°ã€‚

åˆ†éƒ¨æ–¹æ³•åœ¨å£°æ˜æ—¶æœ‰ä¸€äº›é™åˆ¶ï¼šï¼ˆåˆ°äº†C#9.0è¿™äº›é™åˆ¶è¢«å–æ¶ˆï¼‰

- ä¸èƒ½æŒ‡å®šä¿®é¥°ç¬¦
- ä¸èƒ½è¿”å›void
- ä¸èƒ½å¸¦outå‚æ•°

åˆ†éƒ¨æ–¹æ³•æœªæä¾›å®ç°ï¼Œåˆ™ä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥ã€‚ï¼ˆåˆ°äº†C#9.0ï¼Œè¦æ±‚å¿…é¡»æä¾›å®ç°ï¼‰

```c#
partial class A
{
    partial string FetchIt(); //æ­¤å¤„ä¸æä¾›å®ç°
}
partial class A
{
    partial string FetchIt()  //æ­¤å¤„æä¾›å®ç°
    {
        return "æ‹¿å›æ¥äº†ï¼Œç»™ä½ ";
    }
}
```

## æ‰©å±•æ–¹æ³•ï¼ˆExtension Methodï¼‰

æ‰©å±•æ–¹æ³•çš„ä½¿ç”¨ååˆ†å¹¿æ³›ï¼ŒåŒ…æ‹¬LINQçš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•ä¹Ÿæ˜¯åŸºäºæ‰©å±•æ–¹æ³•ã€‚

æ‰©å±•æ–¹æ³•æä¾›äº†åœ¨ç±»å‹å®šä¹‰ä¹‹å¤–ä»»æ„ä½ç½®æ‰©å±•ç±»å‹çš„åŠŸèƒ½èƒ½åŠ›ã€‚

æ‰©å±•æ–¹æ³•å¯ç”¨äºç±»ã€ç»“æ„ã€æšä¸¾ç­‰ç­‰ç­‰ç­‰ã€‚

å®šä¹‰æ‰©å±•æ–¹æ³•ï¼Œéœ€è¦æ»¡è¶³ï¼š

- æ‰©å±•æ–¹æ³•çš„åªèƒ½å®šä¹‰åœ¨staticç±»ä¸­ï¼Œä¸”è‡ªèº«å¿…é¡»æ˜¯staticæ–¹æ³•
- ä½¿ç”¨`this`å…³é”®è¯ä¿®é¥°å‚æ•°ï¼Œå¹¶ä¸”thiså‚æ•°åªèƒ½æ”¾åœ¨ç¬¬ä¸€ä¸ªï¼Œå®ƒæ ‡è¯†å‡ºæ˜¯è¯¥æ–¹æ³•æ˜¯å“ªä¸ªç±»å‹çš„æ‰©å±•æ–¹æ³•

æ‰©å±•æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š

```c#
public static ArticleExtensions
{
    public static int WordCount(this Article article)  //å®šä¹‰Articleç±»çš„æ‰©å±•æ–¹æ³•WordCountï¼Œç”¨äºæ•°å‡ºå•è¯æ•°é‡
    {
        return article.Content.Split(new char[] { ' ', '.', '?', '!' },
            StringSplitOptions.RemoveEmptyEntries).Length;
    }
}
```

æ­¤å®šä¹‰ä¸åœ¨Articleå†…ï¼Œè€Œæ˜¯åœ¨ç‹¬ç«‹çš„é™æ€ç±»ArticleExtensionsä¸­ã€‚è¿™æ ·å®šä¹‰åï¼ŒArticleç±»çš„å¯¹è±¡ä¾¿æ‹¥æœ‰äº†WordCountè¿™ä¸ªæ‰©å±•æ–¹æ³•å¯ç”¨ã€‚

äº‹å®ä¸Šï¼Œå•ä¸ªé™æ€ç±»ä¸­ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªä¸åŒç±»å‹çš„æ‰©å±•æ–¹æ³•ã€‚

ä½¿ç”¨æ‰©å±•æ–¹æ³•ï¼Œå¯ä»¥åƒä½¿ç”¨ç±»å‹çš„æ–¹æ³•ä¸€æ ·ï¼š`å¯¹è±¡.æ‰©å±•æ–¹æ³•(å‚æ•°åˆ—è¡¨)`

ä¸Šä¾‹ä¸­ï¼Œå¯ä»¥è¿™æ ·ç”¨ï¼š

```c#
Article article = new Article("A Story.txt");
var wordCount = article.WordCount();  //è°ƒç”¨æ‰©å±•æ–¹æ³•ï¼Œè°ƒç”¨è€…æœ¬èº«ä½œä¸ºå‚æ•°åˆ—è¡¨é‡Œçš„è¢«æ‰©å±•çš„å¯¹è±¡ï¼ˆå³ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ä¼ å…¥æ–¹æ³•ï¼Œå› æ­¤è°ƒç”¨æ—¶æ‹¬å·å†…ä¼šå°‘äº†ç¬¬ä¸€ä¸ªå‚æ•°ã€‚
```

éœ€è¦æ³¨æ„ï¼Œéœ€è¦å¼•ç”¨æ‰©å±•æ–¹æ³•æ‰€åœ¨çš„å‘½åç©ºé—´åï¼Œæ‰å¯ä»¥ä½¿ç”¨è¯¥æ‰©å±•æ–¹æ³•ã€‚

æ‰©å±•æ–¹æ³•ä¹Ÿèƒ½å½“ä½œä¸€èˆ¬çš„é™æ€æ–¹æ³•ä½¿ç”¨ï¼š

```c#
Article article = new Article("A Story.txt");
var wordCount = ArticleExtensions.WordCount(article);  //å½“ä½œä¸€èˆ¬é™æ€æ–¹æ³•ä½¿ç”¨
```

æ‰©å±•æ–¹æ³•ä¹Ÿæ”¯æŒæ³›å‹ã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªæ³›å‹æ‰©å±•æ–¹æ³•ToJson\<T>ï¼ŒTç±»å‹ä½œä¸ºè¢«æ‰©å±•çš„ç±»å‹ã€‚ä¹‹åä¾¿å¯ä»¥ä½¿ç”¨`ä»»æ„å¯¹è±¡.ToJson()`å°†å¯¹è±¡è½¬æ¢æˆJsonå­—ä¸²ï¼ˆè¿™ä¸ªä¾‹å­ä¸­æœ‰ä¸ªç»†èŠ‚ï¼šToJsonçš„æ³›å‹å‚æ•°ä¹Ÿè¢«çœç•¥äº†ï¼Œå› ä¸ºè°ƒç”¨è€…å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥æ¨æ–­å‡ºæ³›å‹ç±»å‹ï¼‰ã€‚

å¦å¤–ï¼Œæ‰©å±•æ–¹æ³•å¦‚æœè·Ÿæ—¢æœ‰æ–¹æ³•åŒåï¼Œç”±äºé™æ€æ–¹æ³•åªèƒ½æ˜¯éšè—ï¼Œæ— æ³•ä½œä¸ºé‡å†™ï¼Œæ‰€ä»¥ï¼š

- æ‰©å±•æ–¹æ³•ä¸ç±»å‹è‡ªèº«æ–¹æ³•å†²çªæ—¶ï¼šå°†ä¼šä¼˜å…ˆä½¿ç”¨è‡ªèº«æ–¹æ³•
- ç¥–å…ˆç±»å‹æ‹¥æœ‰ç›¸åŒç­¾åçš„æ‰©å±•æ–¹æ³•ï¼šç”±äºä¼šè¿›è¡Œæ–¹æ³•éšè—ï¼Œå°†ä½¿ç”¨å¯¹è±¡æ‰€æ˜¾å¼å£°æ˜ç±»å‹çš„æ‰©å±•æ–¹æ³•ï¼Œè€Œä¸æ˜¯å®é™…ç±»å‹çš„æ–¹æ³•ã€‚è¿™é€‚ç”¨äºå„ç§æƒ…å†µï¼šå®é™…ç±»å‹æ‹¥æœ‰è‡ªèº«å®šä¹‰çš„é™æ€çš„æˆ–éé™æ€çš„åŒç­¾åæ–¹æ³•ï¼›å®é™…ç±»å‹æ‹¥æœ‰åŒç­¾åçš„æ‰©å±•æ–¹æ³•ã€‚è¿™äº›æƒ…å†µä¸‹éƒ½ä¸ä¼šä½¿ç”¨å®é™…ç±»å‹çš„æ–¹æ³•ã€‚
- å¤šå¤„å®šä¹‰å¤šä¸ªåŒç­¾åçš„æ‰©å±•æ–¹æ³•ï¼ˆåªè¦ä¸åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰ï¼Œç¼–è¯‘å™¨ä¾¿ä¸ä¼šæŠ¥é”™ï¼‰ï¼šå¦‚æœå®ƒä»¬åœ¨ä¸åŒçš„å‘½åç©ºé—´ä¸­ï¼Œä½¿ç”¨æ—¶å¯ä»¥åªusingéœ€è¦ä½¿ç”¨çš„æ‰©å±•æ–¹æ³•æ‰€åœ¨çš„å‘½åç©ºé—´ï¼Œå¯ä»¥æ­£å¸¸è°ƒç”¨ã€‚å¦‚æœå®ƒä»¬åœ¨åŒä¸€ä¸ªå‘½åç©ºé—´ä¸‹ï¼Œæˆ–è€…ä½¿ç”¨æ—¶åŒæ—¶usingäº†è¿™ä¸¤ä¸ªå‘½åç©ºé—´ï¼Œåˆ™åœ¨è°ƒç”¨æ—¶ä¼šå¼•èµ·äºŒä¹‰æ€§é”™è¯¯ã€‚æ­¤æ—¶è¯·ç›´æ¥ç”¨æ™®é€šé™æ€æ–¹æ³•çš„è¯­æ³•æ¥è°ƒç”¨å®ƒä»¬ã€‚

> Javaæ²¡æœ‰æ‰©å±•æ–¹æ³•

## è¡¨è¾¾å¼æ ‘ï¼ˆExpression Treeï¼‰

è¡¨è¾¾å¼æ ‘ï¼Œä¸»è¦æä¾›ä¸¤ç§èƒ½åŠ›ï¼š

- å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€**ç”Ÿæˆ**å¯ç¼–è¯‘å’Œæ‰§è¡Œçš„è¡¨è¾¾å¼
- å¯ä»¥åœ¨è¿è¡Œæ—¶**åˆ†æå¤„ç†**ä»£ç ä¸­ç¼–å†™çš„è¡¨è¾¾å¼

### ç”Ÿæˆã€ç¼–è¯‘å’Œæ‰§è¡Œè¡¨è¾¾å¼æ ‘

å¯¹äºä¸‹åˆ—ç®€å•çš„è¡¨è¾¾å¼

```c#
int sum = 1 + 2
```

å®ƒå…·ä½“ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š

- å·¦å€¼éƒ¨åˆ†
    - å˜é‡ç±»å‹å£°æ˜ `int`
    - å˜é‡å `sum`
- èµ‹å€¼ç¬¦å· `=`
- å³å€¼éƒ¨åˆ†
    - å·¦æ“ä½œæ•° `1`
    - åŠ æ³•ç¬¦å· `+`
    - å³æ“ä½œæ•° `2`

å­¦è¿‡ç®—æ³•çš„åŒå­¦åº”è¯¥éƒ½çŸ¥é“ï¼Œæˆ‘ä»¬ä¹¦å†™çš„ç¬¦åˆè‡ªç„¶è¯­ä¹‰çš„è¡¨è¾¾å¼ä¸ºä¸­ç¼€è¡¨è¾¾å¼ï¼Œå®ƒæ— æ³•ç›´æ¥è¢«è®¡ç®—æœºå¤„ç†ã€‚ä¸€èˆ¬åœ¨è®¡ç®—è¡¨è¾¾å¼æ—¶ï¼Œéœ€è¦å°†ä¸­ç¼€è¡¨è¾¾å¼è½¬æˆåç¼€è¡¨è¾¾å¼ï¼Œè¿™å°±ä¼šç”¨åˆ°äºŒå‰æ ‘ã€‚è¡¨è¾¾å¼å¯ä»¥è¡¨ç¤ºæˆä¸€æ£µäºŒå‰æ ‘ï¼Œæ ‘çš„éå¶å­èŠ‚ç‚¹ä¸ºè¡¨è¾¾å¼çš„è¿ç®—ç¬¦ï¼Œå¶å­èŠ‚ç‚¹ä¸ºæ“ä½œæ•°ï¼›èŠ‚ç‚¹çš„å·¦ä¾§å­èŠ‚ç‚¹ä¸ºå·¦æ“ä½œæ•°ï¼Œå³ä¾§å­èŠ‚ç‚¹ä¸ºå³æ“ä½œæ•°ã€‚

ä¸Šè¿°è¡¨è¾¾å¼ï¼Œå¦‚æœç”¨C#çš„è¡¨è¾¾å¼æ ‘æ¥æè¿°ï¼š

```c#
var varibleSum = Expression.Variable(typeof(int), "sum"); //å£°æ˜intç±»å‹çš„å˜é‡sum
var one = Expression.Constant(1);  //å£°æ˜å·¦æ“ä½œæ•°å¸¸é‡è¡¨è¾¾å¼ 1
var two = Expression.Constant(2);  //å£°æ˜å³æ“ä½œæ•°å¸¸é‡è¡¨è¾¾å¼ 2
var add = Expression.Add(one, two); //å£°æ˜å°†ä¸¤ä¸ªå¸¸é‡è¡¨è¾¾å¼åŠ èµ·æ¥çš„è¡¨è¾¾å¼ 1+2
var assignment = Expression.Assign(varibleSum, add); //å£°æ˜èµ‹å€¼è¡¨è¾¾å¼
```

å¯è§ï¼Œè¡¨è¾¾å¼æ ‘ä¸ä¸Šè¿°äºŒå‰æ ‘çš„ç»“æ„ä¸€è‡´ã€‚å› æ­¤æ„å»ºçš„æ–¹å¼æ˜¯å…ˆæ„å»ºå¶å­èŠ‚ç‚¹ï¼Œç„¶åå†é€šè¿‡è¿ç®—ç¬¦è¿æ¥å¶å­èŠ‚ç‚¹æ„æˆä¸€ä¸ªä¸ªæ£®æ—ï¼Œä¾æ¬¡è¿›è¡Œä¸‹å»ç›´åˆ°åˆå¹¶æˆä¸€æ£µæ ‘ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¡¨è¾¾å¼æ ‘æ˜¯ä¸å¯å˜çš„ã€‚ä¸€æ—¦ç”Ÿæˆåï¼Œä½ å°±æ— æ³•ä¿®æ”¹å®ƒäº†ã€‚å¦‚æœéœ€è¦ä¿®æ”¹ï¼Œè¯·è€ƒè™‘å¤åˆ¶ä¸€æ£µè¡¨è¾¾å¼æ ‘ï¼Œå¹¶åœ¨å¤åˆ¶çš„è¿‡ç¨‹ä¸­æ›¿æ¢ä½ è¦ä¿®æ”¹çš„éƒ¨åˆ†ã€‚

è¡¨è¾¾å¼æ ‘æ˜¯å¯ä»¥è¢«æ‰§è¡Œçš„ã€‚åªéœ€è¦

1. ç”¨Expressionçš„Lamdbaæ–¹æ³•æ¥ç”Ÿæˆä¸€ä¸ªLambdaè¡¨è¾¾å¼çš„è¡¨è¾¾å¼æ ‘ï¼Œä»¥ä¾¿å°è£…æˆä¸€ä¸ªå¯è°ƒç”¨çš„æ–¹æ³•ã€‚
2. ç¼–è¯‘å®ƒ
3. æ‰§è¡Œ

Expressionçš„Lamdbaæ–¹æ³•è¿”å›ä¸€ä¸ª`Expression\<TDelegate>`ç±»å‹çš„è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥è¢«ç¼–è¯‘ä¸ºä¸€ä¸ªæ–¹æ³•ã€‚å› æ­¤ä½ ä¹Ÿå¯ä»¥å°†å®ƒåˆ†é…ç»™ä¸€ä¸ªå§”æ‰˜å˜é‡ã€‚

```c#
var expFunc = Expression.Lambda<Func<int>>(assignment); //ç”ŸæˆLambdaï¼ŒexpFuncçš„ç±»å‹æ˜¯Expression<Func<int>>
var func = expFunc.Compile(); //ç¼–è¯‘ï¼Œå¹¶èµ‹å€¼ç»™å§”æ‰˜ã€‚funcçš„ç±»å‹æ˜¯Func<int>
var assignResult = func();  //æ‰§è¡Œå§”æ‰˜ï¼ŒassignResultä¸ºint sum = 1 + 2èµ‹å€¼è¡¨è¾¾å¼çš„ç»“æœï¼Œä¸º3
```

### Expression\<TDelegate>å’Œä»£ç åˆ†æ

è¿™é‡Œæœ‰å¿…è¦ç‰¹åˆ«çµ®å¨ä¸€ä¸‹`Expression\<TDelegate>`ã€‚å®ƒæ´¾ç”Ÿè‡ªLambdaExpressionï¼Œç”¨äºæè¿°ä¸€ä¸ªLambdaçš„è¡¨è¾¾å¼ã€‚å…¶ä¸­TDelegateè™½ç„¶æœªæŒ‡å®šæ³›å‹çº¦æŸæ¡ä»¶ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ºå¼ºç±»å‹å§”æ‰˜ç±»å‹ï¼ˆFuncæˆ–è€…Actionï¼‰ã€‚

è¯¥ç±»å‹çš„å¯¹è±¡å¯ä»¥ç”±ä¸‹åˆ—æ–¹å¼åˆ›å»ºï¼š

- ä½¿ç”¨`Expression.Lambda`é™æ€æ–¹æ³•æ„å»º
- ç›´æ¥ä½¿ç”¨è¡¨è¾¾å¼Lambdaè¿›è¡Œèµ‹å€¼ï¼Œä½†æ˜¯æœ‰é™åˆ¶ï¼š
    - åªèƒ½æ˜¯â€œè¡¨è¾¾å¼Lambdaâ€ï¼Œä¸èƒ½æ˜¯â€œè¯­å¥Lambdaâ€
    - è¿™ç§èµ‹å€¼è¦æ±‚è¡¨è¾¾å¼ä¸èƒ½åŒ…å«èµ‹å€¼è¿ç®—ç¬¦`=`

å½“**ç›´æ¥èµ‹å€¼ä¸ºè¡¨è¾¾å¼Lambda**æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†ä½ çš„Lambdaè¡¨è¾¾å¼å†…å®¹è½¬æ¢æˆè¡¨è¾¾å¼æ ‘ã€‚å¼€å‘è€…å› æ­¤å¯ä»¥è¯»å–è¡¨è¾¾å¼æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œè¿›è¡Œä»£ç åˆ†æã€‚ä¹ŸåŸºäºæ­¤ï¼Œè¡¨è¾¾å¼æ ‘å¹¶ä¸ä»…ä»…æ˜¯ç±»åº“å±‚é¢çš„æ›´æ–°ï¼ŒåŒæ ·ä¹Ÿæ˜¯è¯­æ³•çº§åˆ«çš„å‡çº§ã€‚

è¡¨è¾¾å¼`1 + 2`ï¼Œå¦‚æœç›´æ¥ç”¨è¡¨è¾¾å¼Lambdaèµ‹å€¼ä¸ºExpression\<TDelegate>ï¼Œåˆ™å¯ä»¥å†™ä½œï¼š

```c#
Expression<Func<int>> funcExp = () => 1 + 2;
var rsl = funcExp.Compile()();  //rslä¸º 3
```

ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆäº†`() => 1 + 2`çš„è¡¨è¾¾å¼æ ‘ï¼Œä¸Šé¢çš„ä»£ç ç­‰åŒäº:

```c#
Expression<Func<int>> funcExp = Expression.Lambda<Func<int>> (
    Expression.Add(
        Expression.Constant(1, typeof(int)),
        Expression.Constant(2, typeof(int))
    )
);
var rsl = funcExp.Compile()(); //rslä¸º 3
```

å¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥åˆ†æfuncExpå†…è¡¨è¾¾å¼æ ‘ï¼Œå®ç°ä»£ç åˆ†æã€‚ç”šè‡³ï¼Œä½ å¯ä»¥æ ¹æ®åˆ†æç»“æœï¼ŒæŒ‰ç…§è‡ªå·±çš„è§„åˆ™æ‰§è¡Œæ–°çš„é€»è¾‘ï¼Œä»è€Œå®ç°å¯¹è¡¨è¾¾å¼çš„è½¬æ¢ã€‚

è¿™ååˆ†ååˆ†å¼ºå¤§ï¼æˆ‘ä»¬ä¸‹ä¸€èŠ‚è®²åˆ°[LINQ](#LINQ)æ—¶ï¼Œä¼šçœ‹åˆ°å®ƒåœ¨å®ä½“æ¡†æ¶ï¼ˆEntity Frameworkï¼‰ä¸­çš„åº”ç”¨ã€‚

### ç”Ÿæˆè¡¨è¾¾å¼æ ‘çš„ä¸€ä¸ªæƒ…æ™¯åŒ–çš„ä¾‹å­

è¡¨è¾¾å¼æ ‘ç”¨äºä»£ç åˆ†æçš„ä¾‹å­æˆ‘ä»¬ä¼šåœ¨LINQç« èŠ‚ä¸­çœ‹åˆ°ï¼›è¿™é‡Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªåŠ¨æ€ç”Ÿæˆè¡¨è¾¾å¼æ ‘å¹¶æ‰§è¡Œçš„ä¾‹å­ï¼ˆæƒ…èŠ‚è¿‡äºç‹—è¡€ï¼Œè¯·è‡ªå¤‡çº¸å·¾ï¼‰ï¼š

å‡è®¾ï¼Œå› ä¸ºæŸäº›å†å²åŸå› ï¼Œä½ ä»¬å…¬å¸æœ‰Aã€Bä¸¤å¥—åŠŸèƒ½é‡å çš„ç³»ç»Ÿã€‚ä¸¤å¥—ç³»ç»Ÿä¹‹å‰æ˜¯ç‹¬ç«‹å¼€å‘çš„ï¼Œæ²¡æœ‰ç›´æ¥è”ç³»ã€‚ä¸¤å¥—ç³»ç»Ÿéƒ½æœ‰è‡ªå·±çš„ç”¨æˆ·ç³»ç»Ÿã€‚æŸä¸€å¤©ï¼Œä½ ä»¬çš„è€æ€»å¿½ç„¶è§‰å¾—ï¼Œç»´æŠ¤ä¸¤å¥—ç³»ç»Ÿéœ€è¦çš„æˆæœ¬å¤ªé«˜ï¼Œæ—¢ç„¶åŠŸèƒ½æ˜¯é‡å çš„ï¼Œä¸ºä»€ä¹ˆä¸åˆæˆä¸€å¥—ç³»ç»Ÿå‘¢ï¼Ÿäºæ˜¯ï¼Œè€æ€»ç»™ä½ å¸ƒç½®äº†ä»»åŠ¡ï¼šä»¥Aç³»ç»Ÿä¸ºä¸»ä½“ï¼Œå°†Bç³»ç»ŸåŠŸèƒ½å®Œå…¨å®ç°ï¼Œç„¶åå°†Bç³»ç»Ÿè¿ç§»è‡³Aç³»ç»Ÿã€‚é¡¹ç›®è¿›å±•å¾ˆé¡ºåˆ©ï¼Œä½ ä»¬å¾ˆå¿«è¿›å…¥äº†æ•°æ®è¿ç§»çš„ç¯èŠ‚ã€‚è¿™æ—¶ä½ å‘ç°ï¼Œå…¶ä»–çš„æ•°æ®éƒ½å¾ˆå¥½è¿ç§»ï¼Œå”¯ç‹¬ç”¨æˆ·çš„è¿ç§»å­˜åœ¨é—®é¢˜ï¼šä¸¤å¥—ç³»ç»Ÿç”¨äº†å®Œå…¨ä¸åŒçš„å¯†ç æ ¡éªŒè§„åˆ™ã€‚ç”±äºç”¨æˆ·å¯†ç åœ¨åº“ä¸­å­˜å‚¨çš„å‡ä¸ºå“ˆå¸Œæ ¡éªŒå€¼ï¼Œæ— æ³•åè§£å‡ºç”¨æˆ·çš„åŸå§‹å¯†ç ï¼Œå› æ­¤ä¸å¯èƒ½å°†å¯†ç æŒ‰ç…§Aç³»ç»Ÿçš„å¯†ç è§„åˆ™é‡æ–°ç”Ÿæˆä¸€éã€‚è€Œå› ä¸ºBç³»ç»Ÿåœ¨å®Œæˆè¿ç§»åä¼šè¢«å½»åº•å…³åœï¼Œä½ ä¹Ÿä¸å¸Œæœ›ä¿ç•™Bç³»ç»Ÿçš„ç”¨æˆ·ç³»ç»ŸæœåŠ¡åšOAuthæˆæƒã€‚

æœ€ç®€å•çš„åŠæ³•ï¼šå°†Bç³»ç»Ÿçš„å¯†ç æ ¡éªŒè§„åˆ™ä¹Ÿåœ¨Aç³»ç»Ÿå†…å®ç°ä¸€éï¼Œç„¶åæ ¹æ®ç”¨æˆ·å½’å±ç³»ç»Ÿçš„æ ‡è¯†é‡‡ç”¨ä¸åŒçš„è§„åˆ™è¿›è¡Œæ ¡éªŒã€‚ä½ ä¹Ÿè¿™ä¹ˆåšäº†ã€‚é¡¹ç›®é¡ºåˆ©ä¸Šçº¿ï¼Œä½ æ‹¿åˆ°äº†ä¸°åšçš„å¥–é‡‘ï¼Œç¾æ»‹æ»‹ã€‚

åˆå¹¶åçš„Aç³»ç»Ÿç”±äºåšäº†å¤§é‡ä¼˜åŒ–å‡çº§ï¼ŒåŠŸèƒ½å·²ç»ååˆ†å®Œå–„ï¼Œæ€§èƒ½ä¹Ÿæ˜¯æ æ çš„ã€‚è™½ç„¶Aç³»ç»Ÿä»…ä»…æ˜¯ä½ ä»¬å…¬å¸å†…éƒ¨ä½¿ç”¨çš„ç³»ç»Ÿï¼Œä½†æ˜¯åœ¨æ¥çº³å…¶ä»–å…¬å¸çš„å‚è§‚å­¦ä¹ æ—¶ï¼Œå—åˆ°äº†ç‰¹åˆ«å…³æ³¨ã€‚å¾ˆå¿«ä½ ä»¬çš„ç³»ç»Ÿåå£°é¹Šèµ·ï¼Œå‰æ¥å‚è§‚å–ç»çš„å…¬å¸ç»œç»ä¸ç»ã€‚æ­¤æ—¶ï¼Œä½ çš„Bossä¸€æ‹è„‘è¢‹ï¼Œä½•ä¸å°†ç³»ç»Ÿæ‰“åŒ…æˆäº§å“å–ç»™å…¶ä»–å…¬å¸ï¼Œä»¥æ›¿ä»£å®ƒä»¬é‚£äº›ä¸å¤ªå¥½ç”¨çš„æ—¢æœ‰ç³»ç»Ÿã€‚äºæ˜¯ï¼Œä½ çš„å…¬å¸å¿½ç„¶æ‰¾åˆ°äº†å¦ä¸€æ¡å‘å®¶è‡´å¯Œçš„é“è·¯ã€‚

è¿™æ—¶ï¼Œä½ å‘ç°æƒ…å½¢å˜äº†ã€‚æ¯ä¸ªå®¢æˆ·éƒ½æœ‰è‡ªå·±çš„æ—¢æœ‰ç³»ç»Ÿï¼Œåˆéƒ½æƒ³ä¿ç•™è‡ªå·±çš„ç”¨æˆ·ä¿¡æ¯ã€‚ä½†æ˜¯æ¯ä¸ªç³»ç»Ÿå¯èƒ½ç”¨çš„éƒ½æ˜¯ä¸åŒçš„å¯†ç æ ¡éªŒè§„åˆ™ï¼Œä½ ä¸å¯èƒ½é’ˆå¯¹æ¯ä¸€å®¶ç”¨æˆ·çš„æ ¡éªŒè§„åˆ™éƒ½å»å†™ä¸€æ®µä»£ç å®ç°ã€‚äºæ˜¯ä½ è€ƒè™‘ï¼Œå¯ä»¥é€šè¿‡ä¸€æ®µå­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼Œæ¥æè¿°å¯†ç æ ¡éªŒè§„åˆ™â€”â€”ä½ ç§°ä¹‹ä¸ºå¯†ç è¡¨è¾¾å¼ã€‚ç„¶åé€šè¿‡è§£æè¯¥è¡¨è¾¾å¼ï¼Œç”¨è¡¨è¾¾å¼æè¿°çš„è¿‡ç¨‹æ¥éªŒè¯å¯†ç ã€‚

è¿™æ—¶å€™ï¼Œä½ ç¥­å‡ºäº†è¡¨è¾¾å¼æ ‘ã€‚ä½ å®ç°äº†å¯¹å¯†ç è¡¨è¾¾å¼å­—ä¸²çš„è§£æï¼Œå¹¶å°†å…¶è½¬æˆè¡¨è¾¾å¼æ ‘ã€‚ç„¶åï¼Œå°†è¡¨è¾¾å¼æ ‘ç¼–è¯‘å¹¶ç¼“å­˜ã€‚å¯†ç æ ¡éªŒæ—¶ï¼Œåªéœ€è¦è°ƒç”¨å·²ç¼“å­˜çš„ç¼–è¯‘å¥½çš„å§”æ‰˜ï¼Œè€Œä¸å¿…å†æ¬¡è§£æè¯¥å­—ä¸²ã€‚

ä½ åˆè¿™ä¹ˆåšäº†ï¼Œä½¿å¾—Aç³»ç»ŸæˆåŠŸäº§å“åŒ–ã€‚ä¹‹åï¼Œå…¬å¸é€šè¿‡ç§¯æçš„å¸‚åœºåŒ–è¿ä½œï¼Œåˆ©ç”¨Aç³»ç»Ÿå¾—å¤§å–ç‰¹å–ï¼Œèµšçš„ç›†æ»¡é’µæ»¡ã€‚ä½œä¸ºä¸»ç¨‹åºå‘˜ä¹‹ä¸€ï¼Œä½ ä¹Ÿæ‹¿åˆ°äº†å·¨é¢çš„å¥–é‡‘ã€‚å› æ­¤ä½ å¾—ä»¥åœ¨ä¸€çº¿åŸå¸‚æ ¸å¿ƒåœ°æ®µä¹°äº†æˆ¿ï¼Œä»æ­¤èµ°å‘äººç”Ÿå·…å³°ã€‚

ä¸Šé¢çš„æ•…äº‹æ˜¾ç„¶æ˜¯è™šæ„çš„ï¼Œæƒ³åæ§½çš„è¯è¯·å¿ç€ã€‚

ä¸è¿‡ï¼Œå¯†ç éªŒè¯è¡¨è¾¾å¼çš„åŠŸèƒ½ç¡®å®æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­å®ç°äº†çš„ã€‚ä¸‹é¢æ˜¯æˆ‘çš„éƒ¨åˆ†å•å…ƒæµ‹è¯•ä»£ç ï¼Œè¯»è€…ä»ä¸­åº”è¯¥èƒ½ä½“ä¼šå‡ºè¡¨è¾¾å¼æ ‘çš„ä½œç”¨ï¼š

```c#
[Fact]
public void PasswordExpressionCombinedTest2()
{
    var passExp = "sha1(lower(md5($password+$salt))+'_usr'); //å¯†ç è¡¨è¾¾å¼å­—ä¸²ï¼Œå…¶ä¸­sha1ã€lowerã€md5ç­‰ä¸ºé¢„å®šä¹‰çš„æ–¹æ³•ï¼Œ$å¼€å¤´è¡¨ç¤ºå˜é‡
    var func = PasswordExpression.Build(exp);  //Buildæ–¹æ³•æ ¹æ®expçš„æè¿°ç”Ÿæˆè¡¨è¾¾å¼æ ‘å¹¶ç¼–è¯‘å¹¶ä¸”ç¼“å­˜ï¼Œç„¶åè¿”å›Func<string, object>çš„å§”æ‰˜å¯¹è±¡ã€‚å·²ç¼“å­˜çš„expè¯¥æ–¹æ³•ä¼šç›´æ¥è¿”å›å§”æ‰˜ï¼Œä¸å†è§£æexpã€‚
    var actual = func(new { password = "pwd", salt = "abc" }); //è¿™é‡Œçš„è°ƒç”¨ä½¿ç”¨äº†åŒ¿åç±»å’Œåå°„ã€‚è¿™æ ·è®¾è®¡çš„å¥½å¤„æ˜¯ï¼š1. ä»£ç å«ä¹‰æ›´æ˜ç¡®ï¼› 2. æ–¹ä¾¿äºå°†æ•°æ®åº“çš„Modelç›´æ¥ä¼ å…¥ä½œä¸ºå‚æ•°ã€‚åå¤„æ˜¯ï¼šä½¿ç”¨åå°„ï¼Œå¤šå°‘ä¼šæŸå¤±ç‚¹æ€§èƒ½ã€‚
    var expect = HashHelper.Sha1((HashHelper.Md5("pwd" + "abc")).ToLower() + "_usr"); //æŒ‰ç…§ä¸Šè¿°å¯†ç è¡¨è¾¾å¼å­—ä¸²+æä¾›çš„å‚æ•°çš„å®é™…è¯­ä¹‰ï¼Œæ¨¡æ‹Ÿæ‰§è¡Œä¸€é
    Assert.Equal(expect, actual);  //è¿™å¥æ˜¯å•å…ƒæµ‹è¯•ä¸­çš„æ–­è¨€ï¼Œè¿™é‡Œæ˜¯æ¯”è¾ƒæ¨¡æ‹Ÿæ‰§è¡Œçš„æœŸæœ›ç»“æœå’Œå¯†ç è¡¨è¾¾å¼å§”æ‰˜çš„å®é™…æ‰§è¡Œç»“æœï¼Œä¸¤ä¸ªç»“æœå­—ä¸²åº”è¯¥ç›¸ç­‰ã€‚
```

> Javaä¹Ÿæ²¡æœ‰è¡¨è¾¾å¼æ ‘ã€‚

## LINQ

æœ‰äº†è¿­ä»£å™¨ã€æ‰©å±•æ–¹æ³•ã€Lamabdaè¡¨è¾¾å¼å’Œè¡¨è¾¾å¼æ ‘è¿™4ç§è¯­æ³•ï¼ŒLINQç»ˆäºå¯ä»¥é—ªäº®ç™»åœºäº†ã€‚

LINQ â€”â€” Language Integrated Queryï¼Œè¯»ä½œ\[link] ã€‚ç¿»è¯‘æˆä¸­æ–‡å«é›†æˆè¯­è¨€æŸ¥è¯¢ã€‚

è¿™æ˜¯C# 3.0çš„ä¸€é¢—é‡ç£…ç‚¸å¼¹ã€‚

LINQè¯•å›¾æä¾›ä¸€ç§æŠ½è±¡ï¼Œå¯¹äºå¯æšä¸¾ï¼ˆIEnumerableï¼‰ã€å¯æŸ¥è¯¢ï¼ˆIQueryableï¼‰æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç»Ÿä¸€çš„æ–¹æ³•æ¥æŸ¥è¯¢å…¶ä¸­çš„å…ƒç´ ã€‚è¿™ç§æŸ¥è¯¢æ˜¯æ— å·®åˆ«çš„ï¼Œä½¿ç”¨è€…å¯ä»¥ä¸ç”¨å…³å¿ƒåº•å±‚æ•°æ®çš„å­˜å‚¨ã€è·å–æ–¹å¼ã€‚è¢«æŸ¥è¯¢çš„æ•°æ®å¯ä»¥æ¥è‡ªä¸€ä¸ªå†…å­˜å¯¹è±¡ï¼Œæ¥è‡ªè¿­ä»£å™¨ç”Ÿäº§çš„æ•°æ®ï¼Œæˆ–è€…æ¥è‡ªæ•°æ®åº“ã€ç¡¬ç›˜è¿œç¨‹å–å‡ºçš„æ•°æ®ç­‰ç­‰ã€‚

LINQä¸¤ç§è¯­æ³•å½¢å¼ï¼š

- **æŸ¥è¯¢è¯­æ³•**ï¼ˆQuery Syntaxï¼‰â€”â€”ä½¿ç”¨[æŸ¥è¯¢è¡¨è¾¾å¼](#æŸ¥è¯¢è¡¨è¾¾å¼ï¼ˆQuery%20Expressionï¼‰)
- **æ–¹æ³•è¯­æ³•**ï¼ˆMethod Syntaxï¼‰â€”â€”ä½¿ç”¨[æŸ¥è¯¢æ‰©å±•æ–¹æ³•](#æŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼ˆQuery%20Extension%20Methodï¼‰)

è¿™ä¸¤ç§å½¢å¼å¯ä»¥ç»„åˆä½¿ç”¨ã€‚

æŸ¥è¯¢è¡¨è¾¾å¼ï¼Œåœ¨åº•å±‚ä¸Šä¾èµ–æŸ¥è¯¢æ‰©å±•æ–¹æ³•ã€‚ç¼–è¯‘å™¨ä¼šå°†æŸ¥è¯¢è¡¨è¾¾å¼è¯­æ³•è½¬æ¢æˆå¯¹æŸ¥è¯¢æ‰©å±•æ–¹æ³•çš„è°ƒç”¨ã€‚å› æ­¤ï¼Œä¸¤è€…åœ¨æ€§èƒ½ä¸Šæ²¡æœ‰å·®å¼‚ã€‚è€Œä¸”ï¼Œä½¿ç”¨æ‰©å±•æ–¹æ³•å¯ä»¥å®Œæˆæ‰€æœ‰æŸ¥è¯¢è¡¨è¾¾å¼æ‰€èƒ½å®Œæˆçš„å·¥ä½œã€‚ä¸è¿‡ï¼Œä¸€äº›åŠŸèƒ½å´åªèƒ½ä½¿ç”¨æ‰©å±•æ–¹æ³•æ¥å®ç°ã€‚ä¾‹å¦‚ï¼šè®¡ç®—å…ƒç´ æ•°é‡ï¼Œå–å…ƒç´ æœ€å¤§å€¼ç­‰ç­‰ã€‚

LINQçš„ç”¨é€”ååˆ†å¹¿æ³›ï¼Œå¦‚ï¼š

- å†…å­˜æ•°ç»„ã€åˆ—è¡¨ã€å­—ç¬¦ä¸²ç­‰æŸ¥è¯¢â€”â€”LINQ to Objects
- æ–‡ä»¶æŸ¥è¯¢â€”â€”LINQ to IO
- XMLæ–‡æ¡£æŸ¥è¯¢â€”â€”LINQ to XML
- å®ä½“æ¡†æ¶æŸ¥è¯¢â€”â€”LINQ to Entity
- Elastic SearchæŸ¥è¯¢
- ExcelæŸ¥è¯¢
- ...

å› ä¸ºååˆ†é‡è¦ï¼Œåœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘è¦å†æ¥å¼ºè°ƒä¸€æ¬¡ï¼š

**LINQåŸºäºè¿­ä»£å™¨ï¼Œå› è€Œä¹Ÿæœ‰å»¶è¿Ÿæ‰§è¡Œçš„ç‰¹ç‚¹ï¼**

ä¸‹é¢æˆ‘ä»¬å°†åˆ†åˆ«ä»‹ç»ä¸¤ç§è¯­æ³•ï¼š

### æŸ¥è¯¢è¡¨è¾¾å¼ï¼ˆQuery Expressionï¼‰

æŸ¥è¯¢è¯­æ³•ä½¿ç”¨æŸ¥è¯¢è¡¨è¾¾å¼ï¼Œå®ƒæ˜¯è¯­æ³•çº§åˆ«çš„æ”¯æŒã€‚å…¶å½¢å¼éå¸¸ç±»ä¼¼sqlè¯­å¥ã€‚ä½†æ˜¯ï¼Œåˆä¸sqlæœ‰æ‰€åŒºåˆ«ï¼š

```c#
IEnumerable<string> oldCatNames = 
    from cat in cats
    where cat.Age > 10
    orderby cat.Age descending
    select cat.Name; 
```

å…¶ä¸­ï¼Œcatsæ˜¯List\<Cat>ç±»å‹çš„ã€‚catæ˜¯æŒ‡éå†æ—¶å–å‡ºçš„æ¯ä¸€ä¸ªCatå¯¹è±¡ï¼Œå…¶ä»–çš„éƒ¨åˆ†åº”è¯¥å¾ˆå¥½ç†è§£ã€‚ä¸Šè¿°è¯­å¥ï¼Œç­›é€‰äº†æ‰€æœ‰å¹´é¾„å¤§äº10çš„çŒ«ï¼Œå¹¶æŒ‰ç…§å¹´é¾„å€’åºæ’åºï¼Œç„¶åå°†è¿™äº›çŒ«çš„åå­—å–å‡ºæ¥ã€‚

æ³¨æ„ï¼šç”±äºå»¶è¿Ÿæ‰§è¡Œç‰¹ç‚¹ï¼Œè¿™é‡Œåœ¨èµ‹å€¼oldCatNamesæ—¶æŸ¥è¯¢è¿‡ç¨‹å¹¶æœªçœŸæ­£æ‰§è¡Œã€‚çœŸæ­£çš„æ‰§è¡Œè¦ç­‰åˆ°æšä¸¾å™¨è¢«è°ƒç”¨ã€‚

æŸ¥è¯¢è¡¨è¾¾å¼å®é™…ä¼šç”±ç¼–è¯‘å™¨è½¬æ¢æˆå¯¹æŸ¥è¯¢æ‰©å±•æ–¹æ³•çš„è°ƒç”¨ã€‚

æŸ¥è¯¢è¡¨è¾¾å¼æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. æŸ¥è¯¢çš„å¯¹è±¡ä¸ºä¸€ä¸ªå¯æšä¸¾æˆ–å¯æŸ¥è¯¢å¯¹è±¡
2. è¡¨è¾¾å¼çš„è¿”å›æ˜¯ä¸€ä¸ªè¿­ä»£å™¨
3. ä»¥`from`å¼€å¤´ï¼Œä»¥`select`æˆ–è€…`group`ç»“å°¾
4. `from`å’Œ`select`ã€`group`ä¹‹é—´ä¸­é—´å¯ä»¥åŒ…å«`where`ã€`orderby`ã€`join`ã€`let`ç­‰å­å¥
5. `from`å¯ä»¥åµŒå¥—
6. å¯ä»¥ä½¿ç”¨`into`å°†`select`æˆ–`group`çš„ç»“æœå­˜å…¥ä¸´æ—¶æ ‡è¯†
7. è¿‡ç¨‹ä¸­æ¯ä¸€æ­¥éƒ½æ˜¯å¼ºç±»å‹çš„ï¼Œå®ƒæ˜¯â€œæµå¼â€çš„

æŸ¥è¯¢è¡¨è¾¾å¼çš„å¯ç”¨å…³é”®è¯å¦‚ä¸‹ï¼š

| å­å¥ | è¯´æ˜ |
| --- | --- |
| from | æŒ‡å®šæ•°æ®æºå’ŒèŒƒå›´å˜é‡ï¼ˆç±»ä¼¼äºè¿­ä»£å˜é‡ï¼Œé…åˆinå…³é”®è¯ï¼‰ |
| where | æä¾›ç”±é€»è¾‘å…³ç³»è¿ç®—ç¬¦ï¼ˆ&& æˆ– \|\|ï¼‰åˆ†éš”çš„ä¸€ä¸ªæˆ–å¤šä¸ªå¸ƒå°”è¡¨è¾¾å¼ä½œä¸ºç­›é€‰æ¡ä»¶ |
| select | æŒ‡å®šæ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œè¿”å›åºåˆ—çš„å…ƒç´ ç±»å‹ |
| group | æ ¹æ®æŒ‡å®šçš„Keyå¯¹æŸ¥è¯¢ç»“æœåˆ†ç»„ |
| into | å°†joinã€groupã€selectå­å¥çš„ç»“æœå­˜å…¥ä¸´æ—¶æ ‡è¯† |
| orderby | æ ¹æ®å…ƒç´ ç±»å‹çš„é»˜è®¤æ¯”è¾ƒå™¨ï¼Œå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œå‡åºæˆ–é™åºæ’åº |
| join | æ ¹æ®æŒ‡å®šåŒ¹é…æ¡ä»¶ï¼Œè”æ¥ä¸¤ä¸ªæ•°æ®æº |
| let | å¼•å…¥èŒƒå›´å˜é‡ï¼Œåœ¨æŸ¥è¯¢è¡¨è¾¾å¼ä¸­å­˜å‚¨å­è¡¨è¾¾å¼ç»“æœ |
| in | fromå’Œjoinå­å¥ä¸­çš„ä¸Šä¸‹æ–‡å…³é”®å­—ï¼Œinå‰ä¸ºè¿­ä»£å˜é‡ï¼Œinåä¸ºå…ƒç´ åºåˆ— |
| on | joinå­å¥ä¸­çš„ä¸Šä¸‹æ–‡å…³é”®å­—ï¼Œç”¨äºæä¾›joinæ¡ä»¶ |
| equals | joinå­å¥ä¸­çš„ä¸Šä¸‹æ–‡å…³é”®å­—ï¼Œç”¨åœ¨onä¸­ï¼Œæ¯”è¾ƒä¸¤ä¸ªåºåˆ—ä¸­å¯¹åº”å…ƒç´  |
| by | groupå­å¥ä¸­çš„ä¸Šä¸‹æ–‡å…³é”®å­—ï¼Œç”¨äºæä¾›groupçš„èšåˆé”® |
| ascending | orderbyå­å¥ä¸­çš„ä¸Šä¸‹æ–‡å…³é”®å­—ï¼ŒæŒ‡ç¤ºå‡åºæ’åˆ— |
| descending | orderbyå­å¥ä¸­çš„ä¸Šä¸‹æ–‡å…³é”®å­—ï¼ŒæŒ‡ç¤ºé™åºæ’åˆ— |

åœ¨å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œå»ºè®®ä½¿ç”¨LINQæ—¶ä¼˜å…ˆé€‰ç”¨æŸ¥è¯¢è¯­æ³•ï¼Œè€Œä¸æ˜¯æ–¹æ³•è¯­æ³•ã€‚ä½†æ˜¯ï¼Œä»å®é™…é¡¹ç›®ç»éªŒçœ‹ï¼ŒæŸ¥è¯¢è¡¨è¾¾å¼çš„ä½¿ç”¨ç‡è¿œä¸å¦‚é©¬ä¸Šè¦ä»‹ç»çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•ã€‚åŸå› æ˜¯æˆ‘ä»¬è®¤ä¸ºæ–¹æ³•è¯­æ³•çš„è¯­ä¹‰ä¹Ÿè¶³å¤Ÿæ˜ç¡®ï¼Œå¯è¯»æ€§ä¸æŸ¥è¯¢è¯­æ³•ä¸åˆ†ä¼¯ä»²ï¼›å¹¶ä¸”å› ä¸ºæœ‰äº›åŠŸèƒ½å¿…é¡»ä½¿ç”¨æ–¹æ³•è¯­æ³•å®Œæˆï¼Œå…¨ç¨‹ä½¿ç”¨æ–¹æ³•è¯­æ³•åè€Œä¼šå¢åŠ ä»£ç çš„ä¸€è‡´æ€§å’Œè¿è´¯æ€§ã€‚å› æ­¤ï¼Œå…³äºæŸ¥è¯¢è¡¨è¾¾å¼è¿™é‡Œå°±ä¸å†ç»§ç»­å±•å¼€æ¥è®²äº†ï¼Œæ„Ÿå…´è¶£çš„è¯·è‡ªè¡ŒæŸ¥è¯¢å®˜æ–¹æ–‡æ¡£ã€‚

> Javaæ²¡æœ‰è¿™ç§è¯­æ³•ã€‚ä¸è¿‡å®ƒæ”¯æŒæµå¼ç¼–ç¨‹ï¼Œè¯­æ³•ç±»ä¼¼ä¸‹é¢è¦è®²åˆ°çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•ã€‚

### æŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼ˆQuery Extension Methodï¼‰

æ–¹æ³•è¯­æ³•ä½¿ç”¨æŸ¥è¯¢æ‰©å±•æ–¹æ³•ã€‚å®ƒä»¬æ˜¯é’ˆå¯¹IEnumerable\<T>å’ŒIQuerayable\<T>æ¥å£çš„ä¸€ç³»åˆ—æ‰©å±•æ–¹æ³•ã€‚å®ƒä»¬è¢«å®šä¹‰åœ¨System.Linqå‘½åç©ºé—´ä¸‹ã€‚

å¤§éƒ¨åˆ†æ‰©å±•æ–¹æ³•ä»æ—§è¿”å›IEnumerable\<T>å’ŒIQuerayable\<T>æ¥å£ï¼Œå› æ­¤å¤§éƒ¨åˆ†æ–¹æ³•æ”¯æŒè¿ç¼€ï¼Œæ˜¯â€œæµå¼â€çš„ã€‚

#### é’ˆå¯¹IEnumerable\<T>çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•

LINQçš„åŸºç¡€ç±»åº“ä¸­å®ç°äº†é’ˆå¯¹IEnumerable\<T>çš„å¤§é‡æ‰©å±•æ–¹æ³•ï¼Œä»¥ç”¨äºæŸ¥è¯¢ã€‚æˆ‘ä»¬æ¥çœ‹å…¶ä¸­ä¸€äº›å®šä¹‰ï¼š

```c#
public static IEnumerable<TSource> Where<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate){} //ç›¸å½“äºwhereå­å¥

public static IOrderedEnumerable<TSource> OrderBy<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector){}  //ç›¸å½“äº orderbyå­å¥+ascending

public static IOrderedEnumerable<TSource> OrderByDescending<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector){}  //ç›¸å½“äº oderbyå­å¥+descending

public static IEnumerable<TResult> Select<TSource, TResult>(this IEnumerable<TSource> source, Func<TSource, TResult> selector){}  //ç›¸å½“äºselectå­å¥

public static IEnumerable<IGrouping<TKey, TSource>> GroupBy<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector){}  //ç›¸å½“äºgroupå­å¥+by

public static IEnumerable<TResult> Join<TOuter, TInner, TKey, TResult>(this IEnumerable<TOuter> outer, IEnumerable<TInner> inner, Func<TOuter, TKey> outerKeySelector, Func<TInner, TKey> innerKeySelector, Func<TOuter, TInner, TResult> resultSelector){} //ç›¸å½“äºjoinå­å¥+on+equal


public static IEnumerable<int> Range(int start, int count){}  //å–èŒƒå›´å†…å…ƒç´ 

public static IEnumerable<TSource> Concat<TSource>(this IEnumerable<TSource> first, IEnumerable<TSource> second){} //æ‹¼æ¥ä¸¤ä¸ªåºåˆ—

public static IEnumerable<TSource> Skip<TSource>(this IEnumerable<TSource> source, int count){} //è·³è¿‡countä¸ªå…ƒç´ 

public static IEnumerable<TSource> Take<TSource>(this IEnumerable<TSource> source, int count){}  //å–æœ€å¤šcountä¸ªå…ƒç´ 

public static TResult Aggregate<TSource, TAccumulate, TResult>(this IEnumerable<TSource> source, TAccumulate seed, Func<TAccumulate, TSource, TAccumulate> func, Func<TAccumulate, TResult> resultSelector){} //ç´¯åŠ å™¨

public static TSource FirstOrDefault<TSource>(this IEnumerable<TSource> source){} //å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸å­˜åœ¨æ—¶è¿”å›default<TSorce>çš„å€¼ã€‚è¿™å°†å¼•èµ·ç«‹åˆ»æ‰§è¡Œã€‚

public static TSource Max<TSource>(this IEnumerable<TSource> source){} //å–æœ€å¤§å€¼ã€‚è¿™å°†å¼•èµ·ç«‹åˆ»æ‰§è¡Œã€‚

public static int Count<TSource>(this IEnumerable<TSource> source){} //æ•°å…ƒç´ æ•°é‡ã€‚è¿™å°†å¼•èµ·ç«‹åˆ»æ‰§è¡Œã€‚


public static List<TSource> ToList<TSource>(this IEnumerable<TSource> source){} //å°†ç»“æœè½¬ä¸ºList\<TSource>ã€‚è¿™å°†å¼•èµ·ç«‹åˆ»æ‰§è¡Œã€‚

public static TSource[] ToArray<TSource>(this IEnumerable<TSource> source){} //å°†ç»“æœè½¬ä¸ºæ•°ç»„ã€‚è¿™å°†å¼•èµ·ç«‹åˆ»æ‰§è¡Œã€‚

public static Dictionary<TKey, TSource> ToDictionary<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector){} //å°†ç»“æœè½¬ä¸ºå­—å…¸ã€‚è¿™å°†å¼•èµ·ç«‹åˆ»æ‰§è¡Œã€‚

...
```

è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šã€‚LINQæä¾›äº†ä¸°å¯Œçš„æ‰©å±•æ–¹æ³•ã€‚å®ƒä»¬æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š

- è®¸å¤šæ‰©å±•æ–¹æ³•è¿”å›çš„ä»æ—§æ˜¯IEnumerable\<T>å› è€Œå¯ä»¥æ”¯æŒ**è¿ç¼€**ã€‚

- å¤§éƒ¨åˆ†æ–¹æ³•å¹¶ä¸ä¼šå¼•èµ·ç«‹åˆ»æ‰§è¡Œï¼Œä»ç„¶å…·æœ‰å»¶è¿Ÿæ‰§è¡Œçš„ç‰¹ç‚¹ã€‚ä¸Šè¿°ä»£ç ä¸­æœªåœ¨æ³¨é‡Šä¸­æ³¨æ˜ä¼šå¼•èµ·ç«‹åˆ»æ‰§è¡Œçš„æ–¹æ³•ï¼Œå‡ä¼šå»¶è¿Ÿæ‰§è¡Œã€‚

- å¼•èµ·ç«‹åˆ»æ‰§è¡Œçš„æ–¹æ³•ï¼Œè¿”å›çš„å‡æ˜¯å…·ä½“çš„ç±»å‹ï¼Œä¸å†æ˜¯IEnumerable\<T>æ¥å£ã€‚ä¾‹å¦‚å¯¹äºToListæ–¹æ³•ï¼Œä¼šå¼•èµ·æŸ¥è¯¢æ‰§è¡Œï¼Œå¹¶å°†æŸ¥è¯¢ç»“æœå­˜å…¥List\<T>çš„å¯¹è±¡ä¸­ï¼Œä»è€Œä½¿è¿­ä»£å™¨çš„ç»“æœå›ºåŒ–åˆ°å†…å­˜ä¸­ï¼Œè€Œä¸å†éœ€è¦æ‹…å¿ƒ`foreach`è¯¥å¯¹è±¡ä¼šå¼•èµ·è¿­ä»£å™¨çš„é‡å¤æ‰§è¡Œã€‚

- ä¸å°‘æ‰©å±•æ–¹æ³•ä¸­ä½¿ç”¨äº†å§”æ‰˜ä½œä¸ºå‚æ•°ï¼šä¾‹å¦‚Whereæ–¹æ³•ï¼Œä¼ é€’ä¸€ä¸ªå‚æ•°ä¸ºå…ƒç´ é¡¹ï¼Œè¿”å›ä¸ºboolç±»å‹çš„å§”æ‰˜ï¼Œæ¥æŒ‡å®šç­›é€‰çš„æ¡ä»¶ã€‚ä½¿ç”¨å®ƒä»¬æ—¶ï¼Œå°±æ˜¯Lambdaå¤§æ”¾å¼‚å½©çš„æ—¶å€™ã€‚

å›é¡¾ä¹‹å‰åœ¨æŸ¥è¯¢è¡¨è¾¾å¼ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„ç­›çŒ«ä¾‹å­ã€‚ç”¨æŸ¥è¯¢æ‰©å±•æ–¹æ³•å°±å¯ä»¥å†™æˆï¼š

```c#
IEnumerable<string> oldCatNames = 
    cats.Where(cat => cat.Age > 10)
        .OrderByDescending(cat => cat.Age)
        .Select(cat => cat.Name); 
```

è€Œä½¿ç”¨æ›´å¤šæŸ¥è¯¢è¡¨è¾¾å¼ä¸æ”¯æŒçš„æ–¹æ³•ï¼Œå¯ä»¥å®ç°æ›´å¤šæŸ¥è¯¢åŠŸèƒ½ï¼š

```c#
var names = persons
    .Where(i => i.Name != null && i.Name.StartsWith("æ"))
    .OrderBy(i => i.Name)
    .Select(i => i.Name)
    .Skip(2)
    .Take(3)
    .ToList();  //è§¦å‘ç«‹åˆ»æ‰§è¡Œï¼Œå¹¶å°†ç»“æœç±»å‹è½¬æ¢ä¸ºList<string>ã€‚
```

> Javaä¸­ä¸C#çš„IEnumerable\<T>çš„LINQè¯­æ³•ç±»ä¼¼çš„æ˜¯æµå¼ï¼ˆStreamï¼‰ç¼–ç¨‹ã€‚æ–¹æ³•æ˜¯å°†ä»»æ„Collectioné¦–å…ˆè½¬æ¢ä¸ºjava.util.stream.Streamã€‚ç„¶åé’ˆå¯¹Streamæ¥å£æ‰§è¡Œä¸€ç³»åˆ—å¯è¿ç¼€çš„æµå¼å¤„ç†æ–¹æ³•ã€‚

> ä¸Šä¾‹çš„åŠŸèƒ½ç”¨Streamå¤„ç†å†™æ³•å¦‚ä¸‹ï¼š
>
> ```java
> //==Java==
> List<String> names = persons.stream()
>     .filter(i->i.getName() != null && i.getName().StartsWith("æ"))
>     .sorted(Compartor.comparing(Person::getName))
>     .map(i->i.getName())
>     .skip(2L)
>     .limit(3L)
>     .collect(Collectors.toList());
> ```
>
> å…¶ä¸­ï¼š
>
> - ä»»æ„Collectionè°ƒç”¨streamæ–¹æ³•ï¼Œè¿›å…¥Stream Apiã€‚
> - Stream Apiæ•ˆä»¿äº†LINQçš„**å»¶è¿Ÿæ‰§è¡Œ**ï¼Œåœ¨ä½¿ç”¨Collectorä¹‹å‰ï¼Œè¿ç¼€å¹¶ä¸ä¼šå¼•èµ·éå†çš„æ‰§è¡Œã€‚åŒæ—¶ï¼ŒStreamä¹Ÿå¯¹è¿ç¼€çš„æ‰§è¡Œé¡ºåºè¿›è¡Œè°ƒé…ï¼šä¾‹å¦‚å°†ä¸¤ä¸ªfilteråˆå¹¶åˆ°ä¸€æ¬¡è¿­ä»£ä¸­ã€‚
> - collectæ–¹æ³•ä¼ é€’ä¸€ä¸ªCollectoræ¥å£å¯¹è±¡ï¼Œç”¨äºè¿›è¡Œæ•°æ®æ”¶é›†ã€æ‹¼æ¥ã€è½¬æ¢ï¼Œå¹¶å¼•å‘å®é™…éå†ã€‚
> - Collectorsæ˜¯ä¸€ä¸ªç³»ç»Ÿé¢„ç½®ç±»ï¼Œå®ƒæä¾›äº†å¤šç§é¢„ç½®Collectorã€‚
> - åœ¨collectæ–¹æ³•ä¹‹åï¼Œå°†é€€å‡ºStreamæ¨¡å¼ï¼Œç»“æœé€€åŒ–ä¸ºæ™®é€šåˆ—è¡¨ã€Mapã€Setç­‰ã€‚
>
> ç›¸è¾ƒè€Œè¨€ï¼š
>
> - ç”±äºJavaæ²¡æœ‰C#æ„ä¹‰ä¸Šçš„è¿­ä»£å™¨ï¼Œå› æ­¤Streamè™½ç„¶æ•ˆä»¿äº†å»¶è¿Ÿæ‰§è¡Œï¼Œä½†Javaçš„æµå¼ç¼–ç¨‹æ— æ³•ç›´æ¥é’ˆå¯¹æ™®é€šIteratoræ¥å£å®ç°ï¼Œå¿…é¡»é€šè¿‡ä¸€å¥—æ–°çš„Streamæ¥å£å®ç°ã€‚è€ŒC#åˆ©ç”¨è¿­ä»£å™¨çš„å»¶è¿Ÿæ‰§è¡Œï¼Œç›´æ¥é’ˆå¯¹IEnumerableè®¾è®¡ï¼Œé€šç”¨æ€§æ›´å¥½ã€‚
> - Javaçš„æµå¼ç¼–ç¨‹åœ¨collectä¹‹åï¼Œå°†é€€å‡ºæµå¼å¤„ç†â€”â€”å®ƒçš„è¿”å›ä¸å†æ˜¯Streamã€‚å› è€Œä¼šå¯¼è‡´æµå¼å¤„ç†ä¸­æ–­ã€‚å¦‚æœéœ€è¦å¯¹ç»“æœç»§ç»­å¤„ç†ï¼Œåˆ™éœ€è¦å†æ¬¡è°ƒç”¨streamæ–¹æ³•ï¼Œè½¬æ¢æˆæ–°çš„Streamã€‚è€ŒC#å³ä½¿è°ƒç”¨äº†ToListç­‰æ–¹æ³•ï¼Œä»ç„¶å¯ä»¥ç»§ç»­è¿ç¼€ã€‚
> - LINQçš„è¯­ä¹‰æ›´åŠ ç›´è§‚ã€æ›´å¥½ç†è§£ã€‚Streamæœ‰äº›æ“ä½œå¤šå°‘æœ‰äº›æ‹—å£ï¼Œè¿™åœ¨è¿›è¡Œå¤æ‚æŸ¥è¯¢çš„æ—¶å€™ä¼šæ›´ä¸ºæ˜æ˜¾ã€‚
> - Javaæ²¡æœ‰è¡¨è¾¾å¼æ ‘ï¼Œå› æ­¤Streamä¹Ÿæ— æ³•æ”¯æŒä¸‹ä¸€èŠ‚è¦è®²åˆ°çš„LINQçš„æ›´å¼ºå¤§çš„ç‰¹æ€§ï¼šé€šè¿‡è½¬æ¢è¡¨è¾¾å¼æ ‘å®ç°æ›´å¤šåŠŸèƒ½ã€‚
>
> äº‹å®ä¸Šï¼ŒStreamç¼–ç¨‹åœ¨Javaerä¸­é—´ï¼Œæµè¡Œåº¦ä¹Ÿä¸æ˜¯ç‰¹åˆ«çš„é«˜ã€‚
>
> å…³äºLINQå’ŒStreamçš„ç›¸ä¼¼åŠŸèƒ½çš„å®ç°å¯¹æ¯”ï¼Œå¯ä»¥å‚è€ƒ[è¿™ç¯‡æ–‡ç« ](https://www.zeusro.tech/2018/03/08/linq-vs-stream/)ã€‚

å› ä¸ºLINQå®åœ¨å¾ˆæœ‰è¶£ï¼Œæ‰€ä»¥è¿™é‡Œç•™ç»™è¯»è€…ä¸€é“**æ€è€ƒé¢˜**ï¼š

æˆ‘ä»¬çŸ¥é“IPv4åœ°å€çš„é•¿åº¦ä¸º4ä¸ªå­—èŠ‚ï¼Œå› æ­¤IPv4å¯ä»¥ä½¿ç”¨ä¸€ä¸ªuintå­˜å‚¨ã€‚uintçš„æ¯”è¾ƒæ•ˆç‡è‡ªç„¶é«˜äºstringã€‚

è¯·è¯»è€…æ€è€ƒï¼Œåˆ©ç”¨LINQä¸­çš„ç´¯åŠ å™¨æ–¹æ³•ï¼ˆAggregateï¼‰ï¼Œä»…ç”¨ä¸€è¡Œä»£ç ï¼Œå®ç°å°†ä¸€èˆ¬çš„`xxx.xxx.xxx.xxx`æ ¼å¼çš„stringç±»å‹çš„ipåœ°å€è½¬æ¢æˆuintå€¼ã€‚

#### é’ˆå¯¹IQuerayable\<T>çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•

é’ˆå¯¹IQuerayable\<T>çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•ï¼Œå‡ ä¹ä¸IEnumerable\<T>çš„ä¸€ä¸€å¯¹åº”ã€‚å”¯ä¸€ä¸åŒç‚¹æ˜¯ï¼ŒIEnumerable\<T>çš„æ‰©å±•æ–¹æ³•ä¸­ä¼ é€’å§”æ‰˜çš„åœ°æ–¹ï¼ŒIQuerayable\<T>ä¼ é€’çš„æ˜¯åŒç±»å‹çš„å§”æ‰˜ä½œä¸ºæ³›å‹å‚æ•°çš„è¡¨è¾¾å¼æ ‘Expression\<TDelegate>ã€‚

ä¾‹å¦‚Whereæ‰©å±•æ–¹æ³•ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š

```c#
public static IQueryable<TSource> Where<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate){}  //ç­›é€‰æ¡ä»¶
```

è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ

**è¿™ç”¨å¤„å¤§äº†**ï¼

è¿˜è®°å¾—ä¹‹å‰æˆ‘ä»¬ä»‹ç»çš„Expression\<TDelegate>å—ï¼Ÿä¼ é€’Lambdaæ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆè¯¥Lambdaå¯¹åº”çš„è¡¨è¾¾å¼æ ‘ã€‚

ä¾‹å¦‚ï¼š

```c#
var predict = Persons.Where(person => person.Name == "å¼ ä¸‰" && person.Age == 18);
```

è¿™é‡Œï¼ŒWhereå†…çš„Lambdaä¼šè¢«è½¬æ¢æˆç­‰æ•ˆäºä¸‹é¢è¯­å¥ç”Ÿæˆçš„è¡¨è¾¾å¼æ ‘ï¼š

```c#
ParameterExpression personParam = Expression.Parameter(typeof(Person), "person");
Expression<Func<Person, bool>> whereCondition = Expression.Lambda<Func<Person, bool>>(
    Expression.And(
        Expression.Equal(
            Expression.Property(
                personParam,
                "Name"
            ),
            Expression.Constant("å¼ ä¸‰", typeof(string))
        ),
        Expression.Equal(
            Expression.Property(
                personParam,
                "Age"
            ),
            Expression.Constant(18, typeof(int))
        )
    ),
    personParam
);
```

çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œå´å¾ˆå¥½ç†è§£ã€‚

ä½†æ˜¯ï¼Œè¿™åˆæœ‰ä»€ä¹ˆç”¨ï¼Ÿ

å¾ˆç®€å•ï¼æˆ‘å¯ä»¥ä¸æŒ‰ç…§Lambdaçš„æè¿°æ¥æ‰§è¡Œï¼Œè€Œæ˜¯æŒ‰ç…§æˆ‘ä»¬è‡ªå·±çš„å¥—è·¯ä¿®æ”¹æ‰§è¡Œé€»è¾‘ï¼

é€šè¿‡éå†è¡¨è¾¾å¼æ ‘ï¼Œæˆ‘ä»¬å‘ç°`person.Name == "å¼ ä¸‰"`å’Œ`person.Age == 18`æ˜¯ä¸çš„å…³ç³»ï¼ˆ&&ï¼‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æ‰“ç®—å·å¤©æ¢æ—¥ï¼Œæ¨¡æ‹Ÿè¿™ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼Œä½†æ˜¯æŠŠä¸æ¢æˆæˆ–ï¼ˆ||ï¼‰ã€‚è¿™æ ·ï¼Œè°ƒç”¨æˆ‘ä»¬Whereæ–¹æ³•çš„äººçš„ä»£ç å°±è¢«æˆ‘â€œç¯¡æ”¹â€äº†ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹ç§°ä½œ**è¡¨è¾¾å¼è½¬æ¢**ï¼ˆè¿™ä¸ªä¾‹å­ä¸­ï¼Œå«è¡¨è¾¾å¼ç¯¡æ”¹æ›´åˆç†ğŸ™‚ï¼‰ã€‚

æ˜¾ç„¶ï¼Œè¡¨è¾¾å¼æ ‘ä¸ä¼šç”¨æ¥å¹²è¿™ä¸ªï¼Œæˆ‘ä»¬ä¸ä¼šè¿™ä¹ˆæ— èŠã€‚è¦ä¸¾ä¾‹è¯´æ˜å®ƒçš„å®é™…ç”¨å¤„ï¼Œæ²¡æœ‰æ¯”å®ä½“æ¡†æ¶æ›´åˆé€‚çš„äº†ã€‚

**å®ä½“æ¡†æ¶**ï¼ˆEntity Frameworkï¼Œç®€ç§°EFï¼‰ï¼Œæ˜¯ä¸€å¥—ç”¨äºè®¿é—®æ•°æ®åº“çš„æ¡†æ¶ï¼Œé€šè¿‡LINQ to Entityï¼Œå¯ä»¥è½»æ¾ä½¿ç”¨LINQè¯­å¥æ¥æŸ¥è¯¢æ•°æ®åº“å†…å®¹ã€‚

åœ¨LINQ to Entityä¸­ï¼Œæ‰©å±•æ–¹æ³•Whereä¼šå°†ä¼ å…¥çš„Lambdaä½œä¸ºè¡¨è¾¾å¼æ ‘è¿›è¡Œè¯­ä¹‰åˆ†æï¼Œæ ¹æ®è¡¨è¾¾å¼æ ‘å°†å®ƒè½¬æ¢ä¸ºè¯¥è¯­ä¹‰å¯¹åº”çš„SQLçš„whereè¯­å¥ã€‚

ä¾‹å¦‚ï¼Œä¸Šè¿°ä¾‹å­ä¸­ï¼Œ`person.Name == "å¼ ä¸‰" && person.Age == 18`è¿™ä¸ªC#çš„è¡¨è¾¾å¼ï¼Œä¼šè¢«è½¬æ¢æˆSQLçš„è¯­å¥ï¼š`Name = 'å¼ ä¸‰' and Age = 18`ã€‚

LINQ to EntityæŠŠLINQçš„å¤§éƒ¨åˆ†æ‰©å±•æ–¹æ³•é‡å†™äº†ä¸€éï¼Œä»¥ç”¨äºæŸ¥è¯¢æ•°æ®åº“ã€‚åœ¨Whereç­‰æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä»…ä»…æ˜¯æ„å»ºæ•°æ®åº“æŸ¥è¯¢çš„è¯­å¥ï¼Œå½“æšä¸¾å™¨è§¦å‘æ—¶ï¼Œæ‰ä¼šçœŸçš„è¿›è¡ŒæŸ¥åº“æ“ä½œã€‚å› è€Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ‰§è¡Œæ•°æ®åº“çš„æŸ¥è¯¢ï¼š

```c#
var rsl = dbContext.Table1
    .Where(i => i.Flag || i.Parent == null)
    .Where(i => i.Url.StartsWith("http"))
    .Skip(10)
    .Take(10)
    .Select(i => new { i.Name, i.Title })
    .ToList();  //ToListæ–¹æ³•å°†å¼•å‘æŸ¥åº“æ“ä½œ
```

ä¸Šé¢çš„ä»£ç ä¼šè¢«ç¿»è¯‘æˆä¸‹åˆ—SQLè¯­å¥å¹¶æ‰§è¡Œï¼ˆå‡è®¾æ•°æ®åº“ä¸ºmysqlï¼Œä¸”è¿™é‡Œä»…ç”¨ä½œç¤ºä¾‹ï¼Œå®é™…ä¸ŠEFç”Ÿæˆçš„è¯­å¥ä¼šæ›´è§„èŒƒä¸€äº›ï¼‰

```sql
select `Name`, Title 
from Table1
where (Flag = 1 or Parent is null)
    and `url` like 'http%'
limit 10,10
```

Linq to Entityçš„èƒ½åŠ›è¿œè¿œä¸æ­¢å¦‚æ­¤ã€‚å®ƒæ”¯æŒå¤–é”®å¼•ç”¨ï¼Œæ”¯æŒå…³è”æŸ¥è¯¢ï¼Œæ”¯æŒå„ç§group byã€joinæ“ä½œã€‚å°±å®é™…é¡¹ç›®è€Œè¨€ï¼Œç›®å‰è¿˜æ²¡æœ‰å‘ç°æ‰€éœ€çš„æŸ¥è¯¢æ“ä½œç”¨LINQæ— æ³•å®Œæˆä¹¦å†™çš„ã€‚å› æ­¤ï¼Œä½œä¸ºCShaperï¼Œå½»åº•å‘Šåˆ«Sqlè¯­å¥ä¹Ÿæ˜¯å¸¸æœ‰çš„äº‹ã€‚

å¤šè¯´ä¸¤å¥ï¼ŒEFé™¤äº†æ”¯æŒé€šè¿‡LINQæ¥æŸ¥è¯¢æ•°æ®ï¼Œä¹Ÿæ”¯æŒæ•°æ®çš„æ’å…¥å’Œæ›´æ–°ã€‚å®ƒè¿˜æ”¯æŒä»ä»£ç ç”Ÿæˆæ•°æ®åº“ï¼ˆCode Firstï¼‰å’Œä»æ•°æ®åº“ç”Ÿæˆä»£ç ï¼ˆDB Firstï¼‰ï¼Œä½¿å¾—æ•°æ®åº“çš„è®¾è®¡ã€ä½¿ç”¨å¯¹å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œä»è€Œä½¿å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºä»£ç çš„ä¹¦å†™ã€‚

ç°åœ¨ä½ åº”è¯¥å·²ç»ç†è§£äº†ï¼ŒIQuerayable\<T>çš„æŸ¥è¯¢æ‰©å±•æ–¹æ³•èƒ½åšäº›ä»€ä¹ˆäº†ã€‚æ˜¯ä¸æ˜¯å¾ˆæ£’ï¼Ÿ

PSï¼šç”±äºæŸ¥è¯¢è¯­æ³•å’Œæ–¹æ³•è¯­æ³•çš„ç­‰æ•ˆæ€§ï¼ŒLINQ to SQLä¹ŸåŒæ ·å¯ä»¥ç”¨æŸ¥è¯¢è¯­æ³•ã€‚æ­¤æ—¶ï¼Œä½ æ„Ÿè§‰å°±åƒæ˜¯åœ¨ä»£ç ä¸­å†™SQLã€‚æˆ‘å¹¶ä¸å–œæ¬¢è¿™ç§æ„Ÿè§‰ï¼Œå¥½å®¹æ˜“é€šè¿‡ORMæ¡†æ¶ç»•å¼€äº†SQLï¼ŒåˆæŠŠä»–å†™è¿›äº†ä»£ç é‡Œã€‚è¿™ä¹Ÿæ˜¯æˆ‘å¾ˆå°‘ä½¿ç”¨æŸ¥è¯¢è¯­æ³•çš„å¦ä¸€ä¸ªåŸå› ã€‚

> Javaç”±äºæ²¡æœ‰è¡¨è¾¾å¼æ ‘ï¼Œå› è€Œå®ƒçš„Streamç¼–ç¨‹ä¹Ÿæ²¡æœ‰ç±»ä¼¼çš„è¡¨è¾¾å¼è½¬æ¢æœºåˆ¶ã€‚

---

ç”±äºC# 3.0å¤ªé‡è¦äº†ï¼Œæˆ‘ä»ç„¶ç”¨äº†è¾ƒé•¿ç¯‡å¹…å»ä»‹ç»ã€‚å°¤å…¶é’ˆå¯¹LINQï¼Œæˆ‘åå¤å¼ºè°ƒäº†å®ƒä¸è¿­ä»£å™¨çš„å…³ç³»ï¼Œç›®çš„æ˜¯åŠ æ·±å¤§å®¶çš„ç†è§£ã€‚äº‹å®ä¸Šï¼Œçºµè§‚C#çš„å‘å±•å†å²ï¼Œå¦‚æ­¤å…·æœ‰åˆ›æ–°æ€§å’Œé¢ è¦†æ€§çš„ç‰ˆæœ¬ä¹Ÿæ˜¯ç»æ— ä»…æœ‰çš„ã€‚ä¸‹ä¸€ä¸ªå…·æœ‰åˆ’æ—¶ä»£æ„ä¹‰çš„C#ç‰ˆæœ¬ä¼šæ˜¯5.0ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç»§ç»­C#çš„æ—…ç¨‹ï¼Œæ¥çœ‹çœ‹C# 4.0çš„æ›´æ–°å†…å®¹ã€‚

# C# 4.0 â€”â€” ç‹¬ç«‹å‘å±•

è™½ç„¶æ²¡æœ‰C# 3.0é‚£ä¹ˆçš„æ¿€åŠ¨äººå¿ƒï¼Œ4.0ç‰ˆæœ¬æœ‰ç€è¾ƒä¸ºå®ç”¨çš„æ”¹åŠ¨ã€‚C#å·²ç»åœ¨è‡ªå·±çš„é“è·¯ä¸Šç‹¬ç«‹å‘å±•äº†èµ·æ¥ã€‚åç»­çš„ç‰ˆæœ¬ä¸­ï¼Œå¤§éƒ¨åˆ†è¯­æ³•ç‰¹ç‚¹å·²ç»æ— æ³•åœ¨Javaæ‰¾åˆ°å¯¹ç…§ç‰©äº†ï¼Œå› æ­¤åé¢ç¯‡å¹…ä¸­çš„å¯¹æ¯”éƒ¨åˆ†å°†ä¼šæ˜æ˜¾å‡å°‘ã€‚

C# 4.0çš„è¯­æ³•æ”¯æŒï¼š

## åŠ¨æ€ç±»å‹ï¼ˆDynamic Typeï¼‰

åŠ¨æ€ç±»å‹ï¼Œå¯ä»¥ç®—å¾—ä¸Šæ˜¯C#è¿™ä¸ªå¼ºç±»å‹è¯­è¨€é’ˆå¯¹å¼±ç±»å‹çš„ä¼˜åŒ–ã€‚ä¹‹å‰æˆ‘ä»¬ä»‹ç»varæ—¶è¯´è¿‡ï¼Œvaråªæ˜¯è‡ªåŠ¨è¿›è¡Œç±»å‹æ¨æ–­ï¼Œæœ¬è´¨è¿˜æ˜¯å¼ºç±»å‹çš„ã€‚è€Œdynamicåˆ™çœŸçœŸåˆ‡åˆ‡åœ°å®ç°äº†ä¸€æŠŠå‡†å¼±ç±»å‹ã€‚

å®šä¹‰åŠ¨æ€ç±»å‹å˜é‡ï¼š

```c#
dynamic dyn = 1;
```

ä½¿ç”¨GetTypeè·å–åŠ¨æ€ç±»å‹çš„ç±»å‹ï¼Œå°†ä¼šå¾—åˆ°å®ƒå­˜å‚¨çš„å®é™…æ•°æ®çš„ç±»å‹ï¼š

```c#
//æ¥ä¸Šä¾‹
Console.WriteLine(dyn.GetType().Name);  //è¾“å‡º Int32
```

dynamicç±»å‹å¯ä»¥é‡æ–°è¢«èµ‹å€¼ä¸ºå…¶ä»–ç±»å‹è€Œä¸ä¼šå‡ºé”™ã€‚é‡æ–°èµ‹å€¼åï¼ŒåŠ¨æ€å¯¹è±¡çš„ç±»å‹ä¹Ÿä¼šæ”¹æˆå®é™…çš„ç±»å‹ã€‚

```c#
//æ¥ä¸Šä¾‹ï¼Œé‡æ–°ç»™dynèµ‹å€¼ä¸ºstring
dyn = "1";
```

dynamicä½œä¸ºä¸€ä¸ªç±»å‹ï¼Œå¯ä»¥ç”¨åœ¨ä»»ä½•ä¿®é¥°æ•°æ®ç±»å‹çš„åœ°æ–¹ï¼š

```c#
public class DynamicSampleClass
{
    static dynamic field;  //é™æ€å­—æ®µ
    public dynamic Prop {get; set;} //å±æ€§
    public dynamic ExampleMethod(dynamic param) { ... } //ä½œä¸ºæ–¹æ³•è¿”å›ç±»å‹ã€å‚æ•°ç±»å‹
}
```

åŠ¨æ€ç±»å‹å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- åŠ¨æ€ç±»å‹å¯¹è±¡å¯ä»¥èµ‹å€¼ä¸ºä»»ä½•ç±»å‹ï¼Œä¹Ÿå¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ï¼ˆå¯èƒ½å‡ºé”™ï¼‰ã€‚
- åŠ¨æ€ç±»å‹è¢«é‡æ–°èµ‹å€¼æ—¶ï¼Œå¯ä»¥æ”¹å˜ç±»å‹ã€‚
- åŠ¨æ€ç±»å‹è¿›è¡Œè¿ç®—ã€è·å–æˆå‘˜éƒ½ä¸ä¼šè¿›è¡Œç¼–è¯‘å™¨æ£€æŸ¥ã€‚ä½†æ˜¯å¯èƒ½ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡ºå¼‚å¸¸ã€‚
    - ä¾‹å¦‚ï¼šèµ‹å€¼ä¸€ä¸ªåŠ¨æ€å¯¹è±¡dynä¸ºstringç±»å‹ï¼Œå†™ä¸‹`dyn*3`è¿™æ ·çš„è¡¨è¾¾å¼ç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ï¼Œä½†åœ¨è¿è¡Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

è¿™é‡Œæœ‰å¿…è¦å°†ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ï¼š**ExpandoObject**

ExpandoObjectç±»çš„å¯¹è±¡æ”¯æŒåŠ¨æ€æ·»åŠ æˆå‘˜ã€‚å› æ­¤ä¸å¿…é¢„å…ˆå®šä¹‰ï¼Œä¾¿å¯ä»¥ä½¿ç”¨`.`è¿ç®—ç¬¦æ¥èµ‹å€¼ã€è·å–å…¶å±æ€§ã€‚

```c#
dynamic dyn = new ExpandoObject();
dyn.Number = 10;  //åŠ¨æ€æ·»åŠ Numberå±æ€§ï¼Œå¹¶èµ‹å€¼ä¸º10
dyn.Increment = (Action)(()=> dyn.Number++; );  //åŠ¨æ€æ·»åŠ Incrementï¼Œä½œä¸ºä¸€ä¸ªæ–¹æ³•ï¼ˆå§”æ‰˜ï¼‰
Console.WriteLine(dyn.Number);  //è¾“å‡ºä¸º 10
dyn.Increment();  
Console.WriteLine(dyn.Number);  //è¾“å‡ºä¸º 11
Console.WriteLine(dyn.Nothing);  //è·å–Nothingå±æ€§ï¼Œè¿™é‡Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯è¿”å›null
```

åŠ¨æ€ç±»å‹å¯ä»¥ç”¨äºï¼š

- è°ƒç”¨åŠ¨æ€è¯­è¨€ç±»å‹çš„åº“ï¼Œå¦‚pythonç¼–å†™çš„åº“
- æ¥æ”¶å¯å˜çš„æ•°æ®ï¼Œå¦‚jsonååºåˆ—åŒ–çš„æ•°æ®
- ä¸å¿…äº‹å…ˆç¼–å†™ç±»å®šä¹‰ï¼Œæ–¹ä¾¿è‡ªä¸Šè€Œä¸‹çš„ä»£ç ç¼–å†™ï¼Œä½¿å¼€å‘è€…ä¸“æ³¨äºé€»è¾‘ã€‚
- å·æ‡’çœäº‹å„¿

## å‘½åå‚æ•°ï¼ˆNamed Argumentï¼‰

æˆ‘ä»¬åœ¨è¿›è¡Œæ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼ é€’ç»™æ–¹æ³•æ¯ä¸ªå‚æ•°ä¼šæŒ‰ç…§å£°æ˜çš„é¡ºåºæ’åˆ—ã€‚æˆ‘ä»¬æŠŠè¿™ç§æŒ‰é¡ºåºä¼ é€’çš„å‚æ•°ç§°ä½œ**ä½ç½®å‚æ•°**ã€‚

ä»C# 4.0å¼€å§‹ï¼Œæ”¯æŒå¦ä¸€ç§ä¼ é€’å‚æ•°çš„æ–¹å¼ï¼šæ˜¾ç¤ºçš„æŒ‡æ˜è¦ä¼ é€’çš„å‚æ•°åç§°ï¼Œè€Œä¸å¿…å†éµå®ˆå‚æ•°çš„ä½ç½®é¡ºåºã€‚æˆ‘ä»¬æŠŠè¿™ç§ä¼ é€’æ–¹å¼ç§°ä¸º**å‘½åå‚æ•°**ã€‚

å‘½åå‚æ•°çš„è¯­æ³•ä¸ºï¼š`å‚æ•°å:å€¼`

```c#
public class Shop
{
    public void Sell(string userName, string goodsName, int amount) {...} //å®šä¹‰å«æœ‰ä¸‰ä¸ªå‚æ•°çš„æ–¹æ³•
}

Shop shop = new shop();
shop.Sell("å¼ ä¸‰", "æ¯›å·¾", 10);  //å¸¸è§„è°ƒç”¨

shop.Sell(userName: "å¼ ä¸‰", goodsName: "æ¯›å·¾", amount: 10);  //ç”¨å‘½åå‚æ•°è¯­æ³•è°ƒç”¨
shop.Sell(amount: 10, userName: "å¼ ä¸‰", goodsName: "æ¯›å·¾");  //è°ƒæ¢å‘½åå‚æ•°çš„é¡ºåº
```

å®é™…ä¸Šï¼Œå…è®¸ä½ç½®å‚æ•°ä¸å‘½åå‚æ•°çš„æ··ç”¨ã€‚ä½†æ˜¯åªå…è®¸å°†ä½ç½®å‚æ•°æ”¾åœ¨å‰é¢ï¼ˆC#7.2åï¼Œè¿™æ¡é™åˆ¶è¢«å–æ¶ˆï¼‰

```c#
shop.Sell("å¼ ä¸‰", amount: 10ï¼Œ goodsName: "æ¯›å·¾");
```

### å¯é€‰å‚æ•°ï¼ˆOptional Argumentï¼‰

å¯é€‰å‚æ•°çš„è¯­æ³•åŸºäºå‘½åå‚æ•°ã€‚å®ƒæ˜¯é’ˆå¯¹æœ‰é»˜è®¤å€¼çš„å‚æ•°çš„ã€‚

åœ¨è°ƒç”¨åŒ…å«å…·æœ‰é»˜è®¤å€¼å‚æ•°çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å‘½åå‚æ•°çš„è¯­æ³•æŒ‡å®šå«é»˜è®¤å€¼å‚æ•°çš„å€¼ã€‚æŒ‡å®šäº†å€¼çš„ï¼Œä½¿ç”¨è¯¥æŒ‡å®šå€¼ï¼›æœªæŒ‡å®šå€¼çš„ï¼Œä½¿ç”¨é»˜è®¤å€¼ã€‚

```c#
public class Student
{
    public void Study(string subject, int hours = 2, bool workHard = true) {...} //å«æœ‰ä¸¤ä¸ªæœ‰é»˜è®¤å€¼çš„å‚æ•°
}

Student student = new Student();
student.Study("è¯­æ–‡");  //å¸¸è§„è°ƒç”¨ï¼Œçœç•¥æ‰€æœ‰é»˜è®¤å‚æ•°
student.Study("è¯­æ–‡", 10);  //å¸¸è§„è°ƒç”¨ï¼Œçœç•¥æœ€åä¸€ä¸ªé»˜è®¤å‚æ•°
student.Study("è¯­æ–‡", 2, false);  //å¸¸è§„è°ƒç”¨ï¼Œæä¾›å…¨éƒ¨å‚æ•°

student.Study("è¯­æ–‡", workHard: false); //é‡‡ç”¨å¯é€‰å‚æ•°è¯­æ³•ï¼Œå¹¶ä¸”åªæä¾›workHardå‚æ•°çš„å€¼ï¼Œhourså‚æ•°é‡‡ç”¨é»˜è®¤å€¼
```

## åå˜ï¼ˆCovariantï¼‰ã€é€†å˜ï¼ˆContravariantï¼‰

åå˜å’Œé€†å˜åˆç§°**å˜ç§**ï¼ˆVariantï¼‰ã€‚æ˜¯æŒ‡å…è®¸æ•°ç»„ã€æ³›å‹å§”æ‰˜å’Œæ³›å‹æ¥å£è¿›è¡Œéšå¼ç±»å‹è½¬æ¢çš„æœºåˆ¶ã€‚

åå˜æ˜¯æŒ‡å°†å…ƒç´ ç±»å‹å˜æ›´ä¸ºæ¯”åŸç±»å‹èŒƒå›´æ›´å¤§çš„ç±»å‹ï¼ˆå¦‚çˆ¶ç±»å‹ã€æ¥å£ç­‰ï¼‰ã€‚å®ƒç”¨äºè·å–æ•°æ®ï¼Œå¹¶æŒ‰ç…§æ›´å¤§èŒƒå›´çš„ç±»å‹ä½¿ç”¨ã€‚

é€†å˜æ˜¯æŒ‡å°†å…ƒç´ ç±»å‹å˜æ›´ä¸ºæ¯”åŸç±»å‹æ›´ç²¾ç¡®çš„ç±»å‹ï¼ˆå¦‚å­ç±»å‹ï¼Œå®ç°æ­¤æ¥å£çš„ç±»å‹ç­‰ï¼‰ã€‚å®ƒç”¨äºåœ¨ç²¾ç¡®ç±»å‹ä¸­è°ƒç”¨ä½œç”¨äºæ›´å¤§èŒƒå›´ç±»å‹çš„æ–¹æ³•ã€‚

å¬ä¸æ‡‚ï¼Ÿæ²¡å…³ç³»ï¼ç®€ç­”ç›´è§‚è¯´æ¥ï¼š

- åå˜ï¼šå­ç±»å‹ -> åŸºç±»å‹ï¼Œç”¨äºè·å–
- é€†å˜ï¼šåŸºç±»å‹ -> å­ç±»å‹ï¼Œç”¨äºæ“ä½œ

å˜ç§çš„æ”¯æŒæƒ…å†µï¼š

- æ•°ç»„çš„å˜ç§ï¼ˆC#2.0ï¼‰
- å§”æ‰˜çš„å˜ç§ï¼ˆC#4.0ï¼‰
- æ³›å‹æ¥å£çš„å˜ç§ï¼ˆC#4.0ï¼‰

```c#
//æ•°ç»„çš„åå˜
Cat[] cats = { new Cat("é˜¿å–µ"), new Cat("é˜¿å’ª") };
Animal [] animals = cats;   //è¢«èµ‹å€¼çš„æ•°ç»„å…ƒç´ å³ä¾§æ•°ç»„å…ƒç´ èŒƒå›´æ›´å¤§çš„ç±»å‹ï¼ˆåŸºç±»ï¼‰

//æ¥å£çš„åå˜
IEnumerable<string> strings = new List<string>();   
IEnumerable<object> objects = strings;  //objectæ¯”stringçš„èŒƒå›´æ›´å¤§

//å§”æ‰˜çš„é€†å˜
Action<object> actObject = someMethod;
Action<string> actString = actObject;  //stringæ¯”objectçš„èŒƒå›´æ›´å°
```

å…·ä½“åˆ†æï¼Œå¾ˆå¥½ç†è§£ï¼š

- å¯¹äºåå˜ï¼š
    - å› ä¸ºå­ç±»å‹ç»§æ‰¿äº†çˆ¶ç±»å‹ï¼Œå› æ­¤å­ç±»å‹ä¸€å®šå…·æœ‰çˆ¶ç±»å‹å±æ€§ã€æ–¹æ³•ç­‰æˆå‘˜ã€‚å°†æ•°ç»„ã€æ¥å£çš„å­ç±»å‹è§†ä½œçˆ¶ç±»å‹ï¼Œå¹¶**ä½¿ç”¨çˆ¶ç±»å‹æ‹¥æœ‰çš„æˆå‘˜è¿›è¡Œæ“ä½œä¸€å®šä¸ä¼šå‡ºé—®é¢˜**ã€‚åä¹‹åˆ™ä¸ç„¶ã€‚
    - å¦‚æœä¸€ä¸ªæ¥å£çš„æ³›å‹ç±»å‹æ”¯æŒåå˜ï¼Œå¿…ç„¶è¦æ±‚åœ¨æ¥å£çš„æ–¹æ³•å†…**ä¸å¯ä»¥æŒ‰ç…§è¯¥ç±»å‹æ¥æ“ä½œå…ƒç´ **ã€‚å¦åˆ™è°ƒç”¨äº†æ­¤æ–¹æ³•çš„ä½¿ç”¨è€…ï¼Œä¼ é€’åå˜ç±»å‹ç»™æ–¹æ³•ï¼Œæ–¹æ³•ä¸­å¯èƒ½ä¼šè°ƒç”¨ä¸å­˜åœ¨äºè¯¥åå˜ç±»å‹çš„æˆå‘˜ï¼Œä»è€Œå¼•å‘é”™è¯¯ã€‚
- å¯¹äºé€†å˜ï¼š
    - åŒæ ·å› ä¸ºå­ç±»å‹ç»§æ‰¿äº†çˆ¶ç±»å‹ï¼Œå› æ­¤å­ç±»å‹çš„å¯æ“ä½œæˆå‘˜å¤šäºçˆ¶ç±»å‹ã€‚å¦‚æœä¸€ä¸ªå§”æ‰˜åŸæ¥æ˜¯ç”¨æ¥æ“ä½œçˆ¶ç±»å‹çš„ï¼Œé‚£ä¹ˆ**å®ƒçš„æ‰€æœ‰æ“ä½œä½œç”¨äºå­ç±»å‹ä¸€å®šä¸ä¼šæœ‰é—®é¢˜**ã€‚åä¹‹åˆ™ä¸ç„¶ã€‚
    - å¦‚æœä¸€ä¸ªæ¥å£çš„æ³›å‹ç±»å‹æ”¯æŒé€†å˜ï¼Œå¿…ç„¶è¦æ±‚åœ¨æ¥å£çš„æ–¹æ³•ä¸­**ä¸èƒ½ä»¥è¯¥ç±»å‹ä½œä¸ºè¿”å›**ã€‚å¦åˆ™è°ƒç”¨äº†æ­¤æ–¹æ³•çš„ä½¿ç”¨è€…ï¼Œä»¥é€†å˜ç±»å‹æ‹¿åˆ°è¿”å›çš„å¯¹è±¡åï¼Œè°ƒç”¨è€…ä»¥é€†å˜ç±»å‹æ“ä½œå¯¹è±¡ï¼Œå¯èƒ½ä¼šè°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æˆå‘˜ï¼Œä»è€Œå¼•å‘é”™è¯¯ã€‚

å®šä¹‰æ³›å‹æ¥å£çš„åå˜ç±»å‹ï¼Œå…³é”®è¯ä¸º`out`ã€‚æ ‡è®°ä¸ºoutçš„ç±»å‹ä»…èƒ½ç”¨äºæ–¹æ³•çš„è¿”å›ï¼Œä¸å¯ä½œä¸ºæ–¹æ³•å‚æ•°ã€‚ä½†å¯ä»¥ä½œä¸ºæ–¹æ³•çš„æ³›å‹å‚æ•°çš„æ³›å‹ç±»å‹å‚æ•°ã€‚

```c#
interface ICovariant<out R>
{
    R GetOne() { ... }  //OK
    void DoSomething(R r) { ... } //Not OKï¼ŒRç±»å‹ä¸èƒ½ä½œä¸ºå‚æ•°ç±»å‹ï¼Œç¼–è¯‘å™¨æŠ¥é”™
    void DoSomething(Action<R> callback) { ... }  //OK Rä½œä¸ºæ³›å‹çš„ç±»å‹å‚æ•°
}
```

å®šä¹‰æ³›å‹æ¥å£çš„é€†å˜ç±»å‹ï¼Œå…³é”®è¯ä¸º`in`ã€‚æ ‡è®°ä¸ºinçš„ç±»å‹ä»…èƒ½ç”¨ä½œæ–¹æ³•çš„å‚æ•°ï¼ˆä¸€èˆ¬å‚æ•°å’Œæ³›å‹ç±»å‹å‚æ•°ï¼‰ï¼Œä¸å¯ç”¨äºæ–¹æ³•çš„è¿”å›ã€‚

```c#
interface IContravariant<int A>
{
    void SetOne(A a) { ... } //OK
    void DoSomething<T>() where T : A { ... }  //OKï¼Œ ä½œä¸ºæ³›å‹æ–¹æ³•çš„ç±»å‹å‚æ•°
    R GetOne() { ... } //Not OKï¼ŒAç±»å‹ä¸èƒ½ä½œä¸ºæ–¹æ³•è¿”å›ç±»å‹ï¼Œç¼–è¯‘å™¨æŠ¥é”™
}
```

åœ¨åŒä¸€ä¸ªæ¥å£ä¸­ï¼Œå¯ä»¥åŒæ—¶æŒ‡å®šé€†å˜å’Œåå˜ç±»å‹ï¼š

```c#
interface IVariant<out R, in A>
{
    R GetOne();  //OK
    void DoSomething(A a);  //OK
    R GetSomething(A a);  //OK
}
```

> Javaæ²¡æœ‰ä¸å˜ç§çš„ç²¾ç¡®å¯¹ç…§ç‰©ã€‚ä¸ä¹‹æœ‰äº›ç›¸ä¼¼çš„ï¼Œæ˜¯**æ³›å‹é€šé…ç¬¦**ã€‚
> Javaå…è®¸ç»™æ³›å‹æ·»åŠ é€šé…ç¬¦ï¼Œä»¥ä¾¿æ‰§è¡Œç¼–è¯‘æ—¶æ£€æŸ¥ã€‚
>
> ```java
> //==Java==
> List<?> listUnknown = new ArrayList<A>();  //æ— è¾¹ç•Œé€šé…ç¬¦ï¼Œè¡¨ç¤ºListå…ƒç´ å¯ä»¥æ˜¯ä»»æ„ç±»å‹
> List<? extends A> listExtendsA = new ArrayList<A>(); //ä¸Šç•Œé€šé…ç¬¦ï¼Œè¡¨ç¤ºListå…ƒç´ ç±»å‹å¿…é¡»æ˜¯Aæˆ–è€…Açš„å­ç±»
> List<? super A> listSuperA = new ArrayList<A>(); //ä¸‹ç•Œé€šé…ç¬¦ï¼Œè¡¨ç¤ºListå…ƒç´ ç±»å‹å¿…é¡»æ˜¯Aæˆ–è€…Açš„çˆ¶ç±»
> ```
>
> ä½¿ç”¨æ³›å‹é€šé…ç¬¦ä¹Ÿæœ‰PECSåŸåˆ™ï¼Œè¿™ä¸å˜ç§æœ‰äº›ç±»ä¼¼
>
> - å¦‚æœè¦ä»é›†åˆä¸­è¯»å–ç±»å‹ï¼Œå¹¶ä¸”ä¸èƒ½å†™å…¥ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šç•Œé€šé…ç¬¦ï¼›å³ç”Ÿäº§è€…ä½¿ç”¨`extends`ï¼ˆProducer Extendsï¼Œå³PEï¼‰ã€‚ 
> - å¦‚æœè¦ä»é›†åˆä¸­å†™å…¥æ•°æ®ï¼Œå¹¶ä¸”ä¸éœ€è¦è¯»å–ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹ç•Œé€šé…ç¬¦ï¼›å³æ¶ˆè´¹è€…ä½¿ç”¨`super`ï¼ˆConsumer Superï¼Œå³CSï¼‰ã€‚
> - å¦‚æœæ—¢è¦å­˜åˆè¦å–ï¼Œé‚£ä¹ˆå°±ä¸è¦ä½¿ç”¨ä»»ä½•é€šé…ç¬¦

> æ³›å‹é€šé…ç¬¦è™½ç„¶ä¸å˜ç§æœ‰äº›ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬æ˜¯ä¸åŒçš„ä¸œè¥¿ï¼š
>
> - å˜ç§é’ˆå¯¹æ•°ç»„ã€å§”æ‰˜æ˜¯ä¸€å¾‹æ”¯æŒçš„ï¼›é’ˆå¯¹æ¥å£æ˜¯ç»™æ¥å£çš„æ³›å‹ç±»å‹æ–½åŠ çš„é™åˆ¶æ¡ä»¶ï¼›æ³›å‹é€šé…ç¬¦æ˜¯ç»™å®ä¾‹åŒ–çš„å¯¹è±¡æ–½åŠ çš„é™åˆ¶æ¡ä»¶ã€‚
> - å˜ç§å¯¹äºå£°æ˜çš„æ¥å£å…·æœ‰æ°¸ä¹…çº¦æŸï¼›æ³›å‹é€šé…ç¬¦ä»…ä»…å¯¹å£°æ˜çš„å˜é‡æ—¶æœ‰æ•ˆï¼Œå£°æ˜å¦ä¸€ä¸ªå˜é‡å¯ä»¥æ›´æ¢çº¦æŸã€‚
> - æ³›å‹çš„å˜ç§æ˜¯ç”±äºC#â€œçœŸâ€æ³›å‹å¸¦æ¥çš„è¦æ±‚ï¼Œå˜ç§è¿‡ç¨‹ä¸­è¿è¡Œæ—¶ç±»å‹å‘ç”Ÿäº†æ”¹å˜ï¼ˆå› ä¸ºå°é—­åçš„æ³›å‹ç±»çš„ç±»å‹ä¸åŒï¼‰ï¼›è€Œæ³›å‹é€šé…ç¬¦æ›´åƒæ˜¯è¯­æ³•ç³–ï¼Œå®ƒä»…åœ¨ç¼–è¯‘é˜¶æ®µèµ·ä½œç”¨ï¼Œåœ¨è¿›å…¥è¿è¡Œæ—¶åç”±äºç±»å‹æ“¦é™¤ä¾¿ä¸å†éœ€è¦ç±»å‹è½¬å˜ã€‚
>     - è¿™ä¹ˆè¯´ä¸»è¦ä¸ºäº†ä¾¿äºç†è§£ã€‚ä¸¥æ ¼æ¥è¯´æ³›å‹é€šé…ç¬¦ä¹Ÿä¸å®Œå…¨åªæ˜¯è¯­æ³•ç³–ï¼Œå¯¹äºç”¨extendsé™å®šä¸Šç•Œçš„é€šé…ç¬¦ï¼Œç¼–è¯‘å™¨åœ¨åšç±»å‹æ“¦é™¤æ—¶ä¼šæ“¦é™¤åˆ°ä¸Šç•Œç±»å‹ï¼Œè€Œéåˆ°Objectã€‚

# C# 5.0 â€”â€” å­—æ•°è¶Šå°‘ï¼Œäº‹å„¿å°±è¶Šå¤§

C#5.0çš„è¯­æ³•æ›´æ–°ï¼Œåªæœ‰2ä¸ªã€‚ä½†è¿™ä¸æ¯«ä¸å½±å“å®ƒæ˜¯ä¸€ä¸ªè·¨æ—¶ä»£è¯­æ³•åˆ›æ–°ã€‚å¦‚æœç»™C#è¯­æ³•çš„åˆ›æ–°ç­‰çº§æ’ä¸ªåºçš„è¯ï¼ŒC#3.0æ’ç¬¬ä¸€ï¼ŒC#5.0åˆ™æ’ç¬¬äºŒã€‚

## è°ƒç”¨è€…ä¿¡æ¯ï¼ˆCaller Informationï¼‰

æœ‰æ—¶ä¸ºäº†è°ƒè¯•æˆ–è€…è¯Šæ–­ï¼Œå¼€å‘è€…å¯èƒ½å¸Œæœ›çŸ¥é“è°ƒç”¨è‡ªå·±ç¼–å†™çš„ç±»çš„æ–¹æ³•çš„è°ƒç”¨è€…æ˜¯è°ã€‚è°ƒç”¨è€…ä¿¡æ¯å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

è°ƒç”¨è€…ä¿¡æ¯é€šè¿‡å‡ ä¸ªé¢„ç½®ç‰¹æ€§æ ‡æ³¨æ–¹æ³•å‚æ•°æ¥å®ç°ï¼Œå…·ä½“è¯´æ¥ï¼š

1. è¢«è°ƒç”¨è€…æ–¹æ³•æä¾›å‡ ä¸ªå‚æ•°ï¼Œç”¨äºæ¥æ”¶è°ƒç”¨è€…ä¿¡æ¯ã€‚è¿™äº›å‚æ•°éƒ½å¿…é¡»æ‹¥æœ‰é»˜è®¤å€¼ã€‚
2. å¯¹è¿™å‡ ä¸ªå‚æ•°æ ‡æ³¨é¢„ç½®çš„ç‰¹æ€§ã€‚
3. è°ƒç”¨è€…æ­£å¸¸è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¹¶ä¸”ä¿æŒç”¨äºæ¥æ”¶è°ƒç”¨è€…ä¿¡æ¯çš„å­—æ®µä¸ºé»˜è®¤å€¼ã€‚
4. æ–¹æ³•åœ¨è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è°ƒç”¨è€…çš„ä¿¡æ¯å¡«å…¥è¢«ç‰¹æ€§æ ‡æ³¨çš„å¯¹åº”å‚æ•°å†…ã€‚æ–¹æ³•çš„ç¼–å†™è€…å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯ã€‚

å¯ç”¨çš„è°ƒç”¨è€…ä¿¡æ¯ç‰¹æ€§ï¼š

- CallerMemberNameAttributeï¼šä¿®é¥°stringç±»å‹å‚æ•°ï¼Œç”¨äºå¡«å…¥è°ƒç”¨è€…çš„æˆå‘˜åç§°ï¼ˆæ–¹æ³•åã€å§”æ‰˜åç­‰ï¼‰ã€‚
- CallerFilePathAttributeï¼šä¿®é¥°stringç±»å‹å‚æ•°ï¼Œç”¨äºå¡«å…¥è°ƒç”¨è€…æ‰€åœ¨çš„æºç æ–‡ä»¶è·¯å¾„ä¿¡æ¯ã€‚
- CallerLineNumberAttributeï¼šä¿®é¥°intç±»å‹å‚æ•°ï¼Œç”¨äºå¡«å…¥è°ƒç”¨è€…æ‰€åœ¨æºç ä¸­çš„è¡Œå·ã€‚
- CallerArgumentExpressionAttributeï¼ˆC#10.0å¼•å…¥ï¼‰ï¼šä¿®é¥°stringç±»å‹å‚æ•°ï¼Œç”¨äºå¡«å…¥æŒ‡å®šçš„æ–¹æ³•å‚æ•°åœ¨è°ƒç”¨ä½¿ç”¨çš„è¡¨è¾¾å¼ä»£ç æ–‡æœ¬ã€‚ï¼ˆè¿™ä¸ªå¾ˆé«˜çº§ï¼Œä¸è¿‡è¿™é‡Œæˆ‘ä»¬ä¸ä¸¾ä¾‹ï¼Œæ”¾åˆ°C#10.0å†ä¸¾ä¾‹ï¼‰

æˆ‘ä»¬ç›´æ¥çœ‹ä¾‹å­ï¼š

```c#
public void TracedMethod(int param1, int param2, 
    [CallerMemberName] string methodName = null,
    [CallerFilePath] string sourceFilePath = null,
    [CallerLineNumber] int sourceLineNumber = 0)
{
    Console.WriteLine("è¯¥æ–¹æ³•è¢«â€œ"+methodName+"â€è°ƒç”¨ã€‚è°ƒç”¨ä½ç½®ï¼šæ–‡ä»¶"+sourceFilePath+"ï¼Œè¡Œå·"+sourceLineNumber+"ã€‚");    
}

//è°ƒç”¨
obj.TracedMethod(1,3);  //è°ƒç”¨è€…ä¿¡æ¯å‚æ•°ä¼šè¢«è‡ªåŠ¨å¡«å……ã€‚
```

## å¼‚æ­¥ç¼–ç¨‹ï¼ˆAsynchronous Programmingï¼‰

å¯ä»¥è¿™æ ·è¯´ï¼Œä»»ä½•CShaperï¼Œéƒ½ç»•ä¸å¼€å¼‚æ­¥ç¼–ç¨‹ã€‚

C#æ”¯æŒçš„å¼‚æ­¥æ¨¡å‹ï¼Œæœ‰ä¸‹é¢å‡ ç§ï¼š

- å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹(Asynchronous Programming Modelï¼ŒAPM)â€”â€”é€šè¿‡æš´éœ²Beginå’ŒEndæ–¹æ³•æ¥å¯åŠ¨å¼‚æ­¥çº¿ç¨‹ã€‚è¿™ç§æ¨¡å¼åœ¨\.Netä¹‹å‰å°±å·²ç»å­˜åœ¨ï¼ŒC# 1.0ä¾¿æä¾›äº†æ”¯æŒã€‚ç°åœ¨ä¸å†æ¨èä½¿ç”¨ã€‚
- åŸºäºäº‹ä»¶çš„å¼‚æ­¥æ¨¡å¼(Event-based Asynchronous Patternï¼ŒEAP)â€”â€”é€šè¿‡æ–¹æ³•å¯åŠ¨çº¿ç¨‹ï¼Œé€šè¿‡äº‹ä»¶æ³¨å†Œå›è°ƒã€‚åœ¨æ–¹æ³•å®Œæˆæ—¶è§¦å‘äº‹ä»¶ï¼Œæ‰§è¡Œå›è°ƒã€‚è¿™ç§æ¨¡å¼äº\.NetFramework2.0å¼•å…¥ï¼Œåœ¨ä¹‹å‰çš„C#ä¸­æ™®éä½¿ç”¨ï¼Œç°åœ¨ä¸å†æ¨èä½¿ç”¨ã€‚
- åŸºäºä»»åŠ¡çš„å¼‚æ­¥æ¨¡å¼(Task-based Asynchronous Patternï¼ŒTAP)â€”â€”é€šè¿‡Taskå¯åŠ¨ä»»åŠ¡ï¼Œå¹¶ç­‰å¾…ä»»åŠ¡è¿”å›ã€‚

æˆ‘ä»¬è®²C#çš„å¼‚æ­¥ç¼–ç¨‹ï¼Œç‰¹æŒ‡TAPï¼Œå¹¶ä¸”ç‰¹æŒ‡ç»“åˆäº†async/awaitçš„TAPã€‚å®ƒæ˜¯ä¸€ç§å…¨æ–°çš„å¼‚æ­¥æ¨¡å‹ï¼Œè€Œä¸”æ˜¯è¯­æ³•çº§åˆ«çš„ã€‚å®ƒçš„å‡ºç°å¯ä»¥è¯´æ˜¯è·¨æ—¶ä»£çš„ã€‚æˆ‘ä»¬è¿™ä¸€ç« åªè®²å®ƒï¼Œå…¶ä»–çš„æ¨¡å¼åœ¨è¿™é‡Œä¸åšä»‹ç»ã€‚

å¦‚æœä½ å†™è¿‡jsï¼Œä¸”ç”¨çš„ES6ä»¥ä¸Šçš„è¯­æ³•ï¼Œä¸€å®šå¯¹asyncã€awaitå…³é”®è¯å’Œpromiseæ¨¡å‹ä¸é™Œç”Ÿã€‚è¿™å…¶å®æ­£æ˜¯ç”±\.NetFramework4.5ï¼ˆå¯¹åº”çš„æ­£æ˜¯C# 5.0ï¼‰é¦–åˆ›çš„ã€‚Taskä¾¿æ˜¯åŸºäºå…è¯ºæ¨¡å‹çš„ã€‚C# 5.0çš„è¯­æ³•æ›´æ–°æ ¸å¿ƒæ›´æ˜¯å‡ ä¹å®Œå…¨å›´ç»•å¼‚æ­¥ç¼–ç¨‹ã€‚å¼‚æ­¥çš„æ€æƒ³å¯¹ä¹‹åè¯¸å¤šè¯­è¨€çš„å‘å±•éƒ½äº§ç”Ÿäº†æ·±è¿œçš„å½±å“ã€‚

### ä¸ºä»€ä¹ˆè¦ç”¨å¼‚æ­¥

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ¥è‡ªå®˜ç½‘çš„ä¾‹å­ï¼š

å‡è®¾æœ‰ABä¸¤å°æœåŠ¡å™¨ï¼Œéƒ½åªæœ‰5ä¸ªçº¿ç¨‹å¯ç”¨ï¼Œä¸”éƒ½åœ¨å¤„ç†è¯·æ±‚ã€‚æ­¤æ—¶ï¼Œè¿™ä¸¤ä¸ªæœåŠ¡å™¨éƒ½æ¥æ”¶åˆ°6ä¸ªå¹¶å‘è¯·æ±‚ã€‚æ¯ä¸ªè¯·æ±‚æ‰§è¡Œä¸€ä¸ªI/Oæ“ä½œã€‚

æœªè¿è¡Œå¼‚æ­¥ä»£ç çš„æœåŠ¡å™¨Aï¼Œ5ä¸ªçº¿ç¨‹å æ»¡ä¹‹åï¼Œä¼šå¯¹ç¬¬6ä¸ªè¯·æ±‚è¿›è¡Œæ’é˜Ÿã€‚å› ä¸ºIOæ“ä½œåœ¨çº¿ç¨‹å†…è¢«åŒæ­¥ç­‰å¾…ï¼ŒAå¿…é¡»ç­‰åˆ°5ä¸ªçº¿ç¨‹ä¸­çš„ä¸€ä¸ªå®Œæˆäº†I/Oå¯†é›†å‹å·¥ä½œå¹¶ç»“æŸçº¿ç¨‹ï¼Œæ‰èƒ½ç»§ç»­å¤„ç†ç¬¬6ä¸ªè¯·æ±‚ã€‚è€Œå½“è¿™ä¸ªæ¡ä»¶è¾¾æˆæ—¶ï¼ŒæœåŠ¡å™¨Aå®é™…å·²ç»æ”¶åˆ°äº†ç¬¬20ä¸ªè¯·æ±‚ï¼Œç”±äºé˜Ÿåˆ—è¿‡é•¿ï¼ŒæœåŠ¡å™¨å“åº”å¼€å§‹å˜æ…¢ã€‚

è¿è¡Œæœ‰å¼‚æ­¥ä»£ç çš„æœåŠ¡å™¨Bï¼Œ5ä¸ªçº¿ç¨‹ä¹Ÿåœ¨å ç”¨ä¸­ï¼Œæ­¤æ—¶ä¹Ÿéœ€å¯¹ç¬¬6ä¸ªè¯·æ±‚æ’é˜Ÿï¼Œä½†ç”±äºä½¿ç”¨äº†å¼‚æ­¥ï¼Œåœ¨I/Oå¯†é›†å‹å·¥ä½œå¼€å§‹æ—¶ï¼Œæ­£åœ¨ç­‰å¾…I/Oå·¥ä½œå®Œæˆçš„çº¿ç¨‹æ§åˆ¶æƒä¼šå¾—åˆ°é‡Šæ”¾ï¼Œè€Œæ— éœ€ç­‰åˆ°I/Oç»“æŸã€‚å› è€Œï¼Œè¯¥çº¿ç¨‹å¯ä»¥è½¬å»å¤„ç†å…¶ä»–è¯·æ±‚ã€‚åœ¨æ”¶åˆ°ç¬¬200ä¸ªè¯·æ±‚æ—¶ï¼Œä¼ å…¥è¯·æ±‚é˜Ÿåˆ—ä¾ç„¶å¾ˆå°ï¼ŒæœåŠ¡å™¨ä¸ä¼šå˜æ…¢ã€‚

### å¦‚ä½•ç†è§£å¼‚æ­¥å’Œçº¿ç¨‹çš„å…³ç³»

æåˆ°å¼‚æ­¥å¤§å®¶æœ€å®¹æ˜“æƒ³åˆ°çš„æ˜¯å¤šçº¿ç¨‹ã€‚ä½†æ˜¯åœ¨ç†è§£C#çš„å¼‚æ­¥æ—¶ï¼Œä¸åº”ç­‰åŒäºçº¿ç¨‹å»æ€è€ƒã€‚äº‹å®ä¸Šåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»åŠ¡ä¼šåœ¨å½“å‰çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œä¸”ä¼šåœ¨é€‚å½“çš„æ—¶å€™å°†å·¥ä½œå§”æ‰˜ç»™æ¡†æ¶ã€CLRã€æ“ä½œç³»ç»Ÿï¼ˆå¦‚intä¸­æ–­ï¼‰ã€‚ï¼ˆå‚è€ƒJSï¼ŒJSå®é™…ä¸Šæ˜¯è·‘åœ¨å•çº¿ç¨‹ä¸Šçš„ï¼Œä½†æ˜¯ä¹Ÿæ”¯æŒå¼‚æ­¥ï¼‰

ä¸è¿‡ï¼Œå¼€å‘è€…ä»ç„¶å¯ä»¥æ˜¾å¼çš„é€šè¿‡ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¯åŠ¨ä¸€ä¸ªä»»åŠ¡ã€‚

å¼‚æ­¥ç¼–ç¨‹é€‚åˆä¸‹åˆ—åœºæ™¯ï¼š

- **I/Oç»‘å®š**ï¼šä»£ç ä¼šâ€œç­‰å¾…â€æŸäº›æ•°æ®ã€‚ä¾‹å¦‚ï¼šä»WebæœåŠ¡ä¸‹è½½æ•°æ®ã€‚å¯ç”¨äºæé«˜çº¿ç¨‹åˆ©ç”¨ç‡ï¼Œé¿å…çº¿ç¨‹å› ç­‰å¾…I/Oä»»åŠ¡è€Œè¢«ç©ºè€—å’Œå¼•èµ·æ’é˜Ÿã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå®ƒçš„ä»£ç å½¢å¼ä¸ºç­‰å¾…ä¸€ä¸ªasyncæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›Taskæˆ–Task\<TResult>ã€‚
- **CPUç»‘å®š**ï¼šä»£ç è¦æ‰§è¡Œå¼€é”€å·¨å¤§çš„è®¡ç®—ã€‚ä¾‹å¦‚ï¼šæ¸¸æˆä¼¤å®³è®¡ç®—ã€‚å¯ç”¨äºé¿å…å ç”¨å¤§é‡CPUæ—¶é—´çš„ä»£ç å¡æ­»UIã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå®ƒçš„ä»£ç å½¢å¼ä¸ºç­‰å¾…ä¸€ä¸ªç”±Task.Runå¯åŠ¨çš„åå°çº¿ç¨‹ã€‚

äº‹å®ä¸Šï¼šIOç»‘å®šçš„å¼‚æ­¥ä»»åŠ¡ä¸€èˆ¬è·‘åœ¨å½“å‰çº¿ç¨‹ä¸Šï¼›CPUç»‘å®šçš„ä»»åŠ¡ä¸€èˆ¬è·‘åœ¨æ–°çš„çº¿ç¨‹ä¸Šã€‚

### Taskã€Task\<TResult>å’Œå¼‚æ­¥æ–¹æ³•

åœ¨\.NetFramework4.0(C#4.0)æ—¶å·²ç»å¼•å…¥Taskç±»ï¼Œä½†é‚£æ—¶å®ƒè¿˜ä»…ä»…æ˜¯\.Netçš„ç±»åº“æ›´æ–°ã€‚è™½ç„¶å·²ç»å¼•å…¥äº†æ–°çš„TAPæ¨¡å¼ï¼Œä½†æ˜¯è¿˜ä¸æ”¯æŒasync/awaitå…³é”®è¯ã€‚åˆ°äº†C#5.0ï¼Œå¼•å…¥å¯ç­‰å¾…æ–¹æ³•åï¼Œå¼‚æ­¥ä¸åœ¨éœ€è¦å›è°ƒçš„åµŒå¥—ï¼Œå¯ä»¥è‡ªç„¶çš„ä¹¦å†™å¼‚æ­¥ä»£ç ã€‚è¿™æ—¶æ‰æ­£å¼å¼•çˆ†äº†å¼‚æ­¥æ—¶ä»£ã€‚

Taskç±»å’ŒTask\<TResult>ç”¨æ¥æè¿°ä¸€ä¸ªä»»åŠ¡ã€‚å…¶ä¸­ï¼ŒTaskå¯æè¿°ä»»æ„è¿”å›ç±»å‹çš„ä»»åŠ¡ï¼›Task\<TResult>åˆ™ç”¨äºæè¿°ä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿”å›TResultç±»å‹æ•°æ®çš„ä»»åŠ¡ã€‚è¿™ä¸¤ä¸ªç±»å¯ä»¥ç”¨äºå®šä¹‰å¯ç­‰å¾…æ–¹æ³•å’Œå¼‚æ­¥æ–¹æ³•ã€‚ä»»åŠ¡å…è®¸è¢«å¼‚æ­¥çš„æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å…è®¸åœ¨å¼‚æ­¥æ–¹æ³•ä¸­è¢«ç­‰å¾…ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªæ¦‚å¿µï¼š

- **å¯ç­‰å¾…æ–¹æ³•**ï¼šæ˜¯æŒ‡è¿”å›å€¼ä¸ºTaskã€Task\<TResult>çš„æ–¹æ³•ã€‚è‹¥æœªæ·»åŠ asyncå…³é”®è¯ï¼Œè¯¥æ–¹æ³•ä¸æ˜¯å¼‚æ­¥æ–¹æ³•ã€‚éå¼‚æ­¥æ–¹æ³•çš„ä¸»ä½“ä¸å¯ä»¥ä½¿ç”¨`await`è¿ç®—ç¬¦ã€‚ä½†æ˜¯ï¼Œè¯¥æ–¹æ³•åœ¨è¢«è°ƒç”¨æ—¶ï¼Œä¾ç„¶å¯ä»¥è¢«ç­‰å¾…ï¼ˆå³ä½œä¸ºawaitè¿ç®—ç¬¦çš„æ“ä½œæ•°ï¼‰ã€‚

- **å¼‚æ­¥æ–¹æ³•**ï¼šæ˜¯æŒ‡åœ¨å®šä¹‰æ—¶æ·»åŠ äº†`async`å…³é”®è¯ï¼Œè¿”å›å€¼ä¸ºTaskã€Task\<TResult>ã€voidï¼ˆä¸æ¨èï¼‰ä¹‹ä¸€çš„æ–¹æ³•ã€‚å¼‚æ­¥æ–¹æ³•å†…å¯ä»¥ä½¿ç”¨`await`è¿ç®—ç¬¦ï¼Œç”¨äºç­‰å¾…å¯ç­‰å¾…æ–¹æ³•çš„æ‰§è¡Œç»“æœã€‚å¼‚æ­¥æ–¹æ³•å¦‚æœè¿”å›ä¸æ˜¯voidï¼Œé‚£ä¹ˆå®ƒä¹Ÿæ˜¯å¯ç­‰å¾…æ–¹æ³•ã€‚

å¼‚æ­¥æ–¹æ³•åç§°ï¼Œä¸€èˆ¬çº¦å®šä»¥Asyncç»“å°¾ã€‚

è¿™é‡Œå¤šè¯´å‡ å¥ï¼šåœ¨C#7.0ä»¥åï¼Œå¯ç­‰å¾…æ–¹æ³•ä¸ä¸€å®šå¿…é¡»è¿”å›Taskç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»»ä½•å…·æœ‰GetAwaiteræ–¹æ³•çš„ç±»ï¼Œè¿™ä¹ŸåŒ…æ‹¬ç”±æ‰©å±•æ–¹æ³•æä¾›çš„GetAwaiterã€‚

å¼‚æ­¥æ–¹æ³•çš„å·¥ä½œåŸç†æ˜¯è¿™æ ·çš„ï¼š

ä»£ç æ‰§è¡Œè‡³awaitè¿ç®—ç¬¦è¯­å¥æ—¶ï¼Œä¼šå°†å½“å‰è¯­å¥çš„æ‰§è¡ŒæŒ‚èµ·ï¼ŒæŠŠåç»­è¦æ‰§è¡Œä»£ç æ³¨å†Œæˆå›è°ƒï¼Œå¹¶åˆ›å»ºä»»åŠ¡çŠ¶æ€æœºï¼Œè®°å½•å½“å‰åŒæ­¥ä¸Šä¸‹æ–‡ä»¥ä¾¿åœ¨Resumeæ—¶èƒ½å¤Ÿå›åˆ°å½“å‰åŒæ­¥ä¸Šä¸‹æ–‡ä¸­ç»§ç»­æ‰§è¡Œã€‚åŒæ—¶å®ƒå°†æ§åˆ¶æƒäº¤å‡ºï¼Œè¿˜ç»™è°ƒç”¨æ–¹ã€‚ç­‰åˆ°awaitæ‰€ç­‰å¾…çš„ä»»åŠ¡ç»“æŸåï¼Œä»£ç ä¼šResumeåˆ°awaitè¯­å¥çš„ä½ç½®ï¼Œå°†ä»»åŠ¡çš„è¿”å›ç»“æœå–å‡ºï¼Œç»§ç»­æ‰§è¡Œå‰©ä¸‹çš„ä»£ç ã€‚

è¿™é‡Œç¨å¾®è§£é‡Šä¸‹awaitè¿ç®—ç¬¦ï¼Œå®ƒçš„è¿”å›ç±»å‹æ˜¯è¢«ç­‰å¾…çš„ä»»åŠ¡çš„ç»“æœç±»å‹ï¼Œå·²å»é™¤äº†Taskå¤–å£³ã€‚å¦‚ï¼šå¯¹äºTask\<int>ç±»å‹çš„ä»»åŠ¡ï¼Œawaitè¿ç®—ç¬¦ç­‰å¾…è¯¥ä»»åŠ¡ï¼Œè¿”å›çš„æ˜¯intç±»å‹ã€‚

å…³äº**åŒæ­¥ä¸Šä¸‹æ–‡**ï¼Œè¿™é‡Œå°±ä¸ä½œä»‹ç»äº†ï¼Œå®ƒåœ¨å¼‚æ­¥ç¼–ç¨‹ä¹‹å‰å°±å·²ç»å­˜åœ¨ã€‚æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡ŒæŸ¥é˜…èµ„æ–™ã€‚æˆ–è€…ï¼Œåœ¨ä¸‹é¢è®²åˆ°å¼‚æ­¥çš„æ­»é”é—®é¢˜æ—¶ï¼Œä¼šæ¨èä¸€ç¯‡æ–‡ç« ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­ä¾ç„¶æ¥è‡ªå®˜æ–¹æ–‡æ¡£ï¼š

```c#
[1]  public async Task<int> GetUrlContentLengthAsync()
[2]  {
[3]      var client = new HttpClient();
[4]      Task<string> getStringTask = client.GetStringAsync("https://docs.microsoft.com/dotnet");
[5]      DoIndependentWork();
[6]      string contents = await getStringTask;
[7]      return contents.Length;
[8]  }
[9]  void DoIndependentWork()
[10] {
[11]     Console.WriteLine("Working...");
[12] }
```

ä¸ºäº†ä¾¿äºæè¿°ï¼Œæˆ‘å°†ä¸Šé¢çš„ä»£ç æ ‡ä¸Šäº†è¡Œå·ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¼‚æ­¥æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼š

1. è°ƒç”¨è€…è°ƒç”¨GetUrlContentLengthAsyncæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä»¥åŒæ­¥æ–¹å¼æ‰§è¡Œåˆ°\[4]ã€‚
2. \[4]çš„ç­‰å¼å³ä¾§ä¸ºä¸€ä¸ªå¯ç­‰å¾…çš„æ–¹æ³•ï¼Œå®ƒè¿”å›Task\<string>ã€‚è¯¥å¥ä¼šç«‹åˆ»è¿”å›ã€‚ç”±äºå°šæœªç­‰å¾…è¯¥ä»»åŠ¡çš„è¿”å›ï¼Œç¨‹åºå¯ä»¥ç»§ç»­å‘ä¸‹æ‰§è¡Œåˆ°\[5]ã€‚
3. \[5]å¤„è°ƒç”¨çš„DoIndependentWorkä¸ºåŒæ­¥çš„æ–¹æ³•ï¼Œå› è€Œä¼šç»§ç»­åŒæ­¥æ‰§è¡Œ\[9]æ–¹æ³•ï¼Œå¹¶æ‰“å°â€œWorking...â€åˆ°å±å¹•ã€‚
4. æ‰§è¡Œå®ŒDoIndependentWorkåï¼Œç»§ç»­åŒæ­¥æ‰§è¡Œåˆ°\[6]ã€‚æ­¤æ—¶ï¼ŒgetStringTaskå¯èƒ½è¿˜æœªè¿”å›ã€‚ç¨‹åºä¼šæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œå¹¶å°†å‰©ä¸‹çš„è¯­å¥\[6]å’Œ\[7]æ³¨å†Œä¸ºgetStringTaskä»»åŠ¡çš„å›è°ƒï¼Œå¹¶åˆ›å»ºä»»åŠ¡çŠ¶æ€æœºã€‚ç„¶åç¨‹åºä¼šè¿”å›ç»™GetUrlContentLengthAsyncçš„è°ƒç”¨è€…ï¼Œäº¤å‡ºçº¿ç¨‹æ§åˆ¶æƒã€‚
5. ç­‰åˆ°getStringTaskä»»åŠ¡å®Œæˆåï¼Œä¼šè§¦å‘å›è°ƒã€‚ç¨‹åºResumeåˆ°\[6]ï¼Œå¹¶å–å‡ºgetStringTaskçš„æ‰§è¡Œç»“æœä½œä¸ºawaitè¡¨è¾¾å¼çš„å€¼ï¼Œç»§ç»­æ‰§è¡Œå‰©ä¸‹æ­¥éª¤ã€‚
6. ç¨‹åºæ‰§è¡Œåˆ°\[7]ï¼Œæ–¹æ³•ç»“æŸï¼Œè¿”å›contents.Lengthã€‚
7. è°ƒç”¨è€…æ‹¿åˆ°GetUrlContentLengthAsyncçš„è¿”å›å€¼ï¼Œå¹¶ç»§ç»­æ‰§è¡Œåç»­æ“ä½œã€‚

è¿™é‡Œæœ‰ä¸ªç»†èŠ‚ï¼Œæ‰€è°“äº¤å‡ºçº¿ç¨‹æ§åˆ¶æƒå¹¶ä¸æ˜¯è®©æ“ä½œç³»ç»Ÿå°†çº¿ç¨‹é‡Šæ”¾æ‰ï¼Œè€Œæ˜¯å°†çº¿ç¨‹äº¤è¿˜ç»™è°ƒç”¨è€…æˆ–è€…çº¿ç¨‹æ± ï¼Œä»¥ä¾¿è°ƒç”¨è€…å¯ä»¥ç»§ç»­å…¶ä»–å·¥ä½œæˆ–è€…çº¿ç¨‹æ± å¯ä»¥å¯¹çº¿ç¨‹è¿›è¡Œé‡æ–°åˆ†é…ã€‚

### ä½¿ç”¨æ–°çº¿ç¨‹å¯åŠ¨ä»»åŠ¡

å¯ä»¥ä½¿ç”¨`Task.Run`æ–¹æ³•æ˜¾å¼çš„ä½¿ç”¨æ–°çº¿ç¨‹å¯åŠ¨ä¸€ä¸ªä»»åŠ¡ã€‚

```c#
var task = Task.Run(() => 
{
    DoSomethingInANewThread();
    AndSoOn();
});
await task;
```

Lambdaè¡¨è¾¾å¼æ‰€æè¿°çš„æ–¹æ³•å°†ä¼šåœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œawaitè¯­å¥ä¼šåœ¨çº¿ç¨‹æ‰§è¡Œç»“æŸæ—¶Rusumeï¼Œå¹¶ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚

ç”±äºçº¿ç¨‹æ± çš„æœºåˆ¶ï¼Œå¯èƒ½å¹¶éæ‰€æœ‰ä»»åŠ¡éƒ½ä¼šç«‹åˆ»å¯åŠ¨ï¼Œæœ‰å¯èƒ½ä¼šæ’é˜Ÿã€‚è¿™å…·ä½“è¦çœ‹çº¿ç¨‹æ± çš„ä½¿ç”¨æƒ…å†µã€‚

### ç­‰å¾…å¤šä¸ªä»»åŠ¡

å¯¹äºå¤šä¸ªæ‰§è¡Œä¸­çš„ä»»åŠ¡ï¼Œå¦‚æœè¦åŒæ—¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡ç»“æŸï¼Œå¯ä»¥ä½¿ç”¨`Task.WhenAll`æ–¹æ³•ã€‚

```c#
var task1 = DoSomethingAsync();
var task2 = Task.Run(()=> Task.Delay(3000));
var task3 = Task.Run(()=> Task.Delay(1000));
await Task.WhenAll(task1, task2, task3); //åŒæ—¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡ç»“æŸ
```

å¯¹äºå¤šä¸ªæ‰§è¡Œä¸­çš„ä»»åŠ¡ï¼Œå¦‚æœè¦ç­‰å¾…è‡³å°‘ä¸€ä¸ªä»»åŠ¡è¿”å›ï¼Œå¯ä»¥ä½¿ç”¨`Task.WhenAny`æ–¹æ³•ã€‚

```c#
var task1 = DoSomethingAsync();
var task2 = Task.Run(()=> Task.Delay(3000));
var task3 = Task.Run(()=> Task.Delay(1000));
await Task.WhenAny(task1, task2, task3); //ç­‰å¾…è‡³å°‘ä¸€ä¸ªä»»åŠ¡è¿”å›
```

### å¼‚æ­¥çš„ä¼˜åŠ¿

- å®ƒæ˜¯è¯­è¨€çº§åˆ«çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ã€‚

    å¼€å‘è€…ä¸å¿…è´¹å¿ƒäºå¼‚æ­¥è®¾è®¡æ¨¡å¼ï¼Œä»¥åŠç±»åº“å¯¹è®¾è®¡æ¨¡å¼çš„æ”¯æŒé—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨ç®€æ´çš„è¯­æ³•å®ç°å¼‚æ­¥ã€‚

- å®ƒè‡ªå¸¦çº¿ç¨‹æ± ç®¡ç†å’Œçº¿ç¨‹å¤ç”¨ï¼Œå´ä¸éœ€è¦ç”¨æˆ·è¿‡å¤šå…³å¿ƒã€‚

    å®ƒå¯ä»¥è½»æ¾åœ°å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥å°†çº¿ç¨‹ä»I/Oç­‰å¾…ä¸­é‡Šæ”¾ã€‚å®ƒè‡ªå¸¦çº¿ç¨‹æ± ç®¡ç†ï¼Œå¯ä»¥é«˜æ•ˆç‡çš„å¤ç”¨çº¿ç¨‹ã€‚

- è·å–ç»“æœå’Œæ•è·å¼‚å¸¸å˜å¾—ååˆ†å®¹æ˜“ã€‚

    åˆ©ç”¨awaitè¿ç®—ç¬¦ï¼Œå¯ä»¥åƒè·å–åŒæ­¥æ–¹æ³•çš„è¿”å›ä¸€æ ·ï¼Œè½»æ¾çš„è·å–å¼‚æ­¥æ–¹æ³•çš„ç»“æœã€‚å¹¶ä¸”ï¼Œä½¿ç”¨äº†awaitè¿ç®—ç¬¦çš„ä»»åŠ¡ï¼Œä¼šå°†æœªæ•è·çš„å¼‚å¸¸æŠ›å‡ºè‡³ç­‰å¾…ä»»åŠ¡çš„æ–¹æ³•ä¸­ï¼Œå¯ä»¥åƒå¤„ç†åŒæ­¥çš„å¼‚å¸¸ä¸€æ ·å¤„ç†å®ƒã€‚

- éå¸¸ä¾¿äºä¹¦å†™ï¼Œé¿å…å›è°ƒçš„åµŒå¥—ï¼Œä½¿ä»£ç å¹²å‡€æ•´æ´ã€‚

    å¼€å‘è€…å¯ä»¥åƒä¹¦å†™åŒæ­¥æ–¹æ³•ä¸€æ ·ï¼ŒæŒ‰ç…§é€»è¾‘é¡ºåºä¹¦å†™å¯¹å¼‚æ­¥æ–¹æ³•çš„è°ƒç”¨ã€‚å°¤å…¶åœ¨ä¸€ä¸ªæ–¹æ³•å†…æœ‰å¤šä¸ªå¼‚æ­¥è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œä¸ç”¨å‡ºç°ä¸€å †å›è°ƒçš„åµŒå¥—è¿™æ ·éš¾çœ‹çš„ä»£ç ã€‚

### å¼‚æ­¥çš„æ­»é”ï¼ˆdeadlockï¼‰é—®é¢˜

å°½é‡ä¸è¦æ··ç”¨await/asyncå’Œ`Task.Wait`ï¼Œä½¿ç”¨ä¸å½“å¯èƒ½å¯¼è‡´æ­»é”é—®é¢˜ã€‚ä¾‹å¦‚ï¼šä½ åœ¨æŸä¸ªæ–¹æ³•ä¸­ä½¿ç”¨`Task.Wait`ç­‰å¾…ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å†…ä½¿ç”¨`await`ç­‰å¾…ä¸€ä¸ªä»»åŠ¡ã€‚

è¿™æ˜¯å› ä¸º`Task.Wait`ä¼šå¯¼è‡´åœ¨çº¿ç¨‹ä¸­åŒæ­¥ç­‰å¾…ï¼ŒåŸå§‹çº¿ç¨‹ä¸ä¼šå¾—åˆ°é‡Šæ”¾ã€‚è€Œè¢«å¯åŠ¨çš„Taskåœ¨ç»“æŸåï¼Œåˆéœ€è¦å›åˆ°åŸå§‹çš„åŒæ­¥ä¸Šä¸‹æ–‡æ‰€åœ¨çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åŸå§‹çº¿ç¨‹ã€‚å› ä¸ºåŸå§‹çº¿ç¨‹è¿˜åœ¨åŒæ­¥é˜»å¡ä¸­ï¼Œæ‰€ä»¥å¯¼è‡´æ­»é”ã€‚

ä¸ä»…`Task.Wait`ã€‚ä½¿ç”¨`task.Result`ï¼Œ`tast.GetAwaiter().GetResult()`ä¹ŸåŒæ ·å­˜åœ¨æ­»é”é—®é¢˜ã€‚

æ¨èé‡‡ç”¨ä»¥ä¸‹æ­¥éª¤é¿å…æ­»é”é—®é¢˜ï¼š

- åœ¨è°ƒç”¨ç¬¬ä¸‰æ–¹è¿”å›Taskçš„æ–¹æ³•æ—¶ï¼Œå¦‚æœä½ ä¸ç¡®å®šå¯¹æ–¹çš„å®ç°æ˜¯å¦è§„èŒƒï¼Œè€Œä½ åˆæƒ³ä½¿ç”¨Task.Waitæ—¶ï¼Œè¯·åœ¨Task.Waitä¹‹å‰è°ƒç”¨`ConfigureAwaiter(false)`ã€‚
- å¦‚æœä½ åœ¨ç¼–å†™å¯èƒ½è¢«å¹¿æ³›è°ƒç”¨çš„å¼‚æ­¥æ–¹æ³•ç±»åº“ï¼Œè¯·åœ¨è¿”å›ä»»åŠ¡å‰ã€awaitæŸä¸ªä»»åŠ¡æ—¶è°ƒç”¨`ConfigureAwaiter(false)`ã€‚
- å¦‚æœä½ æ‰“ç®—ç”¨async/awaitï¼Œå»ºè®®ä¸€è·¯async/awaitåˆ°åº•ã€‚

`ConfigureAwaiter(false)`çš„å«ä¹‰ï¼Œç®€å•è¯´æ¥å°±æ˜¯ï¼šå‘Šè¯‰Awaiterï¼Œåœ¨ç»“æŸåä¸å¿…å›åˆ°è°ƒç”¨å®ƒçš„åŸåŒæ­¥ä¸Šä¸‹æ–‡æ‰€åœ¨çº¿ç¨‹ä¸­ç»§ç»­æ‰§è¡Œï¼Œè€Œæ˜¯å¯ä»¥ä»»æ„é€‰æ‹©ä¸€ä¸ªçº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚

å¦å¤–ï¼Œä¸Šè¿°æ­»é”é—®é¢˜ä»…å­˜åœ¨äºI/Oç»‘å®šçš„æƒ…å†µã€‚ä½¿ç”¨Task.Runå¯åŠ¨çš„ä»»åŠ¡ä¸ä¼šæœ‰æ­»é”çš„é—®é¢˜ã€‚

å¸Œæœ›æ·±å…¥äº†è§£çš„è¯»è€…å¯ä»¥å‚è€ƒå®˜æ–¹åšå®¢ï¼Œ[è¿™ç¯‡](https://devblogs.microsoft.com/dotnet/configureawait-faq/)è®²çš„éå¸¸æ¸…æ¥šã€‚

### å¼‚æ­¥çš„Javaå¯¹ç…§

> çœ‹åˆ°è¿™é‡Œï¼Œå¾ˆå¤šç†Ÿæ‚‰Javaçš„äººåº”è¯¥è”æƒ³èµ·äº†`Future`æ¥å£ã€‚è¯šç„¶ï¼Œå®ƒçš„è¡¨ç°ä¸async/awaitæœ‰äº›åƒï¼Œå°¤å…¶åœ¨å¤§åé¼é¼çš„ç¬¬ä¸‰æ–¹æ¡†æ¶Springæä¾›äº†`@Async`æ³¨è§£åï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç»™ä¸€ä¸ªæ–¹æ³•æ ‡æ³¨ä¸ºå¼‚æ­¥æ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªFutureã€‚è¿™ä½¿å¾—è°ƒç”¨å¼‚æ­¥æ–¹æ³•å¯ä»¥åŒè°ƒç”¨åŒæ­¥æ–¹æ³•ä¸€æ ·ä¹¦å†™ï¼Œä¹Ÿèƒ½æ–¹ä¾¿çš„ç­‰å¾…å¹¶è·å–Futureçš„è¿”å›å€¼ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¸C#çš„ä»»åŠ¡ç¼–ç¨‹æ¨¡å¼å¹¶ä¸ç­‰æ•ˆï¼š
>
> - é€šè¿‡`@Async`æ ‡æ³¨çš„æ–¹æ³•ï¼Œä¸€å®šè·‘åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚è¿™ä¸Taské»˜è®¤è·‘åœ¨ç›¸åŒçº¿ç¨‹ä¸Šä¸åŒã€‚
> - è™½ç„¶ä¹Ÿèƒ½æ¯”è¾ƒæ–¹ä¾¿çš„ä½¿ç”¨Futureçš„getæ–¹æ³•ç­‰å¾…ä»»åŠ¡çš„è¿”å›ç»“æœï¼Œä½†æ˜¯è¿™å°†å¯¼è‡´å½“å‰çº¿ç¨‹é˜»å¡ï¼Œç›´åˆ°Futureæ‰€æŒ‡ç¤ºçš„çº¿ç¨‹è¿”å›åæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚å½“å‰çº¿ç¨‹å¹¶ä¸ä¼šåœ¨è¿è¡Œåˆ°getæ—¶å¾—åˆ°é‡Šæ”¾ï¼Œå®ƒå°†å§‹ç»ˆè¢«å ç”¨ç€ã€‚

> äº‹å®ä¸Šï¼ŒJavaæ²¡æœ‰ä¸async/awaitä¸€è‡´çš„å¼‚æ­¥æœºåˆ¶ã€‚
---

C#çš„æ ¸å¿ƒå¤§ç‰ˆæœ¬åˆ°5.0å°±å‘Šä¸€æ®µè½äº†ã€‚ä»6.0å¼€å§‹ï¼ŒC#è¿›å…¥äº†å°æ­¥å¿«è·‘çš„é˜¶æ®µã€‚æ›´æ–°é€Ÿåº¦æ˜æ˜¾åŠ å¿«ï¼Œæ›´æ–°çš„ç‚¹ä¹Ÿè¶Šæ¥è¶Šç»†è‡´ã€‚

# C# 6.0 â€”â€” è¯­æ³•ç³–æœºæª

ä»6.0èµ·ï¼ŒC#è·Ÿéš\.Net Coreä¸€åŒè¿›å…¥äº†æ•æ·å¼€å‘æ—¶ä»£ã€‚æ¯ä¸ªç‰ˆæœ¬çš„æ›´æ–°ç‚¹çš„æ•°é‡ä¼šå¼€å§‹å˜å¤šï¼Œæ›´æ–°å†…å®¹ä¹Ÿå˜å¾—æ¿€è¿›èµ·æ¥ã€‚ä¸è¿‡å¤§éƒ¨åˆ†æ›´æ–°ç‚¹ä¹Ÿå˜å¾—æ¯”è¾ƒå¾®å°ï¼Œæè¿°å®ƒä»¬çš„ç¯‡å¹…ä¹Ÿå°†ä¼šæ˜æ˜¾å‡å°‘ã€‚æœ¬æ–‡ä¹Ÿä¼šå°æ­¥å¿«è·‘èµ·æ¥ã€‚

## å¼‚å¸¸ç­›é€‰å™¨

try-catchå—ä¸­ï¼Œå¯ä»¥åœ¨catchè¯­å¥æ·»åŠ `when`æ¡ä»¶

```c#
try
{
    doSomething();
}
catch (CustomException e) when (e.Message.Contains("æ•°æ®åº“"))
{
    Console.WriteLine("æ•°æ®åº“é”™è¯¯");
}
catch (CustomException e) when (e.Message.Contains("ç½‘ç»œ"))
{
    Console.WriteLine("ç½‘ç»œé”™è¯¯");
}
catch (CustomException e)
{
    Console.WriteLine("å‡ºç°é”™è¯¯");
}
```

## å±æ€§åˆå§‹åŒ–è¡¨è¾¾å¼

ç°åœ¨å¯ä»¥ç›´æ¥ç»™å±æ€§åˆå§‹åŒ–ï¼š

```c#
public string Name { get; set; } = "å¼ ä¸‰";
```

å¦‚æœå±æ€§åªè¯»ï¼Œç°åœ¨ä¹Ÿå¯ä»¥è¿™æ ·ä¹¦å†™ï¼Œæ­¤æ—¶å±æ€§åªæœ‰getterï¼Œè€Œä¸å¿…æä¾›setterï¼š

```c#
public string Name { get; } = "å¼ ä¸‰";
```

## nullä¼ æ’­è¿ç®—ç¬¦

C# 6.0å¼•å…¥ä¸¤ä¸ªç”¨ä½œäºå¼•ç”¨ç±»å‹çš„è¿ç®—ç¬¦`?.`å’Œ`?[]`ã€‚

- `?.`çš„å¯¹åº”ç‰©æ˜¯æˆå‘˜è®¿é—®è¿ç®—ç¬¦`.`ã€‚
- `?[]`çš„å¯¹åº”ç‰©æ˜¯ç´¢å¼•å™¨è¿ç®—ç¬¦`[]`ã€‚

å®ƒä»¬çš„å«ä¹‰æ˜¯ï¼š

- å¦‚æœaçš„è®¡ç®—ç»“æœä¸ºnullï¼Œåˆ™`a?.x`æˆ–`a?[x]`çš„ç»“æœä¸ºnullã€‚
- å¦‚æœaçš„è®¡ç®—ç»“æœénullï¼Œåˆ™`a?.x`æˆ–`a?[x]`çš„ç»“æœä¸º`a.x`æˆ–`a[x]`ã€‚

å¦‚æœä¸€ä¸ªè¡¨è¾¾å¼ä¸­æœ‰å¤šä¸ªè¿ç»­çš„`?.`æˆ–`?[]`ï¼Œå®ƒä»¬é‡‡ç”¨æœ€å°åŒ–æ±‚å€¼ç­–ç•¥ï¼šä»å·¦ä¾§å¼€å§‹ï¼Œè¿ç®—é“¾ä¸­åªè¦ä¸€ä¸ª`?.`æˆ–`?[]`è¿ç®—è¿”å›nullï¼Œåˆ™é“¾çš„å…¶ä½™éƒ¨åˆ†ä¸ä¼šæ‰§è¡Œã€‚å› è€Œå®ƒä»¬ä¹Ÿå«Nullä¼ æ’­è¿ç®—ç¬¦ã€‚

```c#
obj?[0]?.Property?.Method();  //ä»å·¦åˆ°å³ï¼Œç¬¬ä¸€ä¸ªé‡åˆ°çš„nullï¼Œä¼šå¯¼è‡´åé¢çš„è¿ç®—ç¬¦éƒ½ä¸è¢«è®¡ç®—ï¼Œè¡¨è¾¾å¼ç›´æ¥è¿”å›null
```

å¸¸è§çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è°ƒç”¨å§”æ‰˜æ–¹æ³•

```c#
someDelegate?.Invoke(); //å¦‚æœå§”æ‰˜ä¸ºnullåˆ™ä¸æ‰§è¡Œ
```

## å­—ç¬¦ä¸²å†…æ’ï¼ˆString Interpolationï¼‰

`$`å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥å®ç°å­—ç¬¦ä¸²ä¸­æ’å…¥è¡¨è¾¾å¼ã€‚æ–¹æ³•æ˜¯åœ¨å­—ç¬¦ä¸²å†…é€šè¿‡{}åŒ…è£¹è¡¨è¾¾å¼ã€‚

åŸºç¡€ç”¨æ³•ç¤ºä¾‹ï¼š

```c#
$"ä½ å¥½ï¼Œ{name}ï¼ä»Šå¤©æ˜¯æ˜ŸæœŸ{dayOfWeek}ã€‚å¤©æ°”ï¼š{weather}";
```

å­—ç¬¦ä¸²å†…æ’è¿˜æ”¯æŒæ·»åŠ å¯¹é½æ–¹å¼å’Œæ ¼å¼ä¿¡æ¯æè¿°ï¼Œè¯­æ³•ä¸º

```c#
{<å†…æ’è¡¨è¾¾å¼>[,<å¯¹é½æ–¹å¼>][:<æ ¼å¼å­—ç¬¦ä¸²>]}
```

å…¶ä¸­åé¢ä¸¤éƒ¨åˆ†éƒ½æ˜¯å¯é€‰çš„ã€‚

- å†…æ’è¡¨è¾¾å¼å°±æ˜¯å¯ä»¥åŒ…å«`{}`çš„å­—ç¬¦ä¸²ï¼Œ`{}`ä¸­ä¸ºè¡¨è¾¾å¼ï¼Œä¼šè‡ªåŠ¨è®¡ç®—ToStringã€‚ç‰¹åˆ«çš„ï¼Œå¦‚æœ`{}`ä¸­çš„å€¼ä¸ºnullï¼Œä¼šè¢«è§†ä½œstring.Empty
- å¯¹é½æ–¹å¼ä¸ºæ•´æ•°ã€‚å¦‚æœå€¼ä¸ºæ­£ï¼Œåˆ™ä¸ºå³å¯¹é½ï¼›å¦‚æœå€¼ä¸ºè´Ÿï¼Œåˆ™ä¸ºå·¦å¯¹é½ã€‚å®ƒçš„æ•°å€¼è¡¨ç¤ºè¡¨è¾¾å¼å­—ç¬¦ä¸²çš„æœ€å°å­—ç¬¦æ•°ã€‚ç­‰åŒäºPadLeftå’ŒPadRightæ–¹æ³•ã€‚
- æ ¼å¼å­—ç¬¦ä¸²ä¸ºstringï¼Œå®ƒç”¨äºæè¿°æ ¼å¼ã€‚å¦‚æœæä¾›æ ¼å¼å­—ç¬¦ä¸²ï¼Œåˆ™è¡¨è¾¾å¼ç»“æœå¿…é¡»æ‹¥æœ‰ToString(string format)çš„æ–¹æ³•ã€‚è­¬å¦‚DateTimeç±»å°±æœ‰è¿™ç§æ–¹æ³•ã€‚è¡¨è¾¾å¼ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚

```c#
var date = DateTime.Now;
var dateString = $"ä»Šå¤©æ˜¯{date:yyyyå¹´MMæœˆddæ—¥}";
```

> å­—ç¬¦ä¸²å†…æ’phpã€pythonç­‰è¯­è¨€éƒ½æ”¯æŒã€‚Javaå¹¶ä¸æ”¯æŒã€‚

å†…æ’å­—ç¬¦ä¸²ä¸­ï¼Œå¦‚æœå«æœ‰èŠ±æ‹¬å·å­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ä¸¤ä¸ªç›¸åŒèŠ±æ‹¬å·è¿›è¡Œè½¬ä¹‰ï¼Œå³`{{`å’Œ`}}`

æ³¨æ„ï¼Œå¦‚{}å†…è¡¨è¾¾å¼åŒ…å«æ¡ä»¶è¡¨è¾¾å¼`?:`ï¼Œéœ€è¦å°†æ•´ä¸ªè¡¨è¾¾å¼åŒ…è£¹åœ¨åœ†æ‹¬å·å†…ã€‚è¿™æ˜¯å› ä¸º:åœ¨è¿™é‡Œæœ‰è¯­ä¹‰ï¼Œè¡¨ç¤ºæ ¼å¼å­—ç¬¦ä¸²çš„èµ·å§‹ã€‚

\$ç¬¦å·å’Œ@ç¬¦å·å¯ä»¥ç»„åˆä½¿ç”¨ã€‚åœ¨C#6ä¸­åªèƒ½å…ˆ`$`å`@`ã€‚è€Œåˆ°äº†C#8ï¼Œå¯ä»¥ä»»æ„åˆ‡æ¢é¡ºåºã€‚

```c#
var name = "å¼ ä¸‰";
var str1 = $@"å“ˆå“ˆå“ˆ\å“ˆå“ˆ!\\{{{name}}}";  //åˆæ³•ï¼Œè¾“å‡ºä¸º å“ˆå“ˆå“ˆ\å“ˆå“ˆ!\\{å¼ ä¸‰}
var str2 = @$"å“ˆå“ˆå“ˆ\å“ˆå“ˆ!\\{{{name}}}";  //åœ¨C#6.0ä¸­éæ³•ï¼Œåœ¨C#8.0ä»¥ååˆæ³•
```

## nameofè¿ç®—ç¬¦

nameofè¡¨è¾¾å¼å¯ç”¨äºå–å˜é‡ã€ç±»å‹æˆ–æˆå‘˜çš„åç§°ï¼Œä½œä¸ºå­—ç¬¦ä¸²å¸¸é‡ã€‚

éœ€è¦æ³¨æ„ï¼š

- ç±»å‹ä¸‹å®šä¹‰çš„éé™æ€æˆå‘˜ï¼Œä¹Ÿå¯ä»¥ç”¨`nameof(ç±»å‹.æˆå‘˜)`æ¥å–åå­—ã€‚
- nameofé’ˆå¯¹å˜é‡ã€æˆå‘˜è¿”å›çš„æ˜¯å¯¹è±¡åç§°ï¼Œè€Œéç±»å‹åç§°ã€‚
- nameofæ˜¯ç¼–è¯‘æ—¶æ±‚å€¼ï¼Œè€Œéè¿è¡Œæ—¶ã€‚
- å¦‚ä¹‹å‰æåˆ°è¿‡çš„ï¼Œ`@`å¼€å¤´çš„å˜é‡ï¼Œ`@`å¹¶ä¸æ˜¯å˜é‡åçš„ä¸€éƒ¨åˆ†

```c#
var name1 = nameof(System.DateTime); //å€¼ä¸º DateTime
var name2 = nameof(List<int>);  //ç±»å‹åï¼Œå€¼ä¸º List
var name3 = nameof(List<int>.Count); //å–ç±»å‹çš„Countå±æ€§ï¼ŒCountä¸æ˜¯é™æ€çš„ï¼Œè¿™é‡Œåˆæ³•ï¼Œå€¼ä¸º Count
var name4 = nameof(List<int>.Add); //åŒç†ï¼Œå–ç±»å‹çš„Addæ–¹æ³•ï¼ŒAddä¹Ÿä¸æ˜¯é™æ€çš„ï¼Œå€¼ä¸º Add

var numbers = new List<int> { 1, 2, 3 };
var name5 = nameof(numbers);  //å˜é‡åï¼Œå€¼ä¸º numbers
var name6 = nameof(numbers.Count); //å±æ€§åï¼Œå€¼ä¸º Count

var @new = 5;
var name7 = nameof(@new); //@ä¸æ˜¯åå­—çš„ä¸€éƒ¨åˆ†ï¼Œå€¼ä¸º new
```

## ç´¢å¼•åˆå§‹åŒ–è¡¨è¾¾å¼

åˆå§‹åŒ–å™¨å¾—åˆ°äº†å¢å¼ºï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–å™¨ä¸­ä½¿ç”¨ç´¢å¼•ã€‚

```c#
var matrix = new Matrix
{
    [0, 0] = 1.0,
    [0, 1] = 0.2,
    [1, 0] = 1.1,
    [1, 1] = 3.3
};
var dict = new Dictionary<string, double>
{
    ["PI"] = 3.14,
    ["PHI"] = 0.618
};
```

ç”šè‡³ï¼Œå¯ä»¥è·Ÿå±æ€§ä¸€åŒåˆå§‹åŒ–ï¼š

```c#
var mixed = new Mixed
{
    Title = "æ··ä¹±",
    HelloWord = "ä¾¬å¥½",
    [0] = 1,
    [1] = 1,
    [2] = 2,
    [3] = 3,
    Ok = false,
    ["Top", 1] = 8848
};
```

ååˆ†çš„æ–¹ä¾¿ã€‚

## C# 6.0çš„å…¶ä»–æ”¹è¿›

- **é™æ€å¼•ç”¨**ï¼ˆStatic Using)ï¼šå·²åœ¨C# 1.0æ—¶ä»‹ç»è¿‡ã€‚
- **è¡¨è¾¾å¼ä¸»ä½“**ï¼ˆExpression-Bodied Memberï¼‰ï¼š6.0æ”¯æŒçš„æ¯”è¾ƒå°‘ï¼Œæˆ‘ä»¬ç­‰åˆ°C# 7.0å†ä¸€èµ·è®²ã€‚
- **Catchå’ŒFinallyå—ä¸­**ï¼Œç°åœ¨**æ”¯æŒä½¿ç”¨await**è¿ç®—ç¬¦äº†ã€‚

# C# 7.0â€”â€” Pythonæ˜¯ä¸ªå¥½ä¸œè¥¿

## outå˜é‡å£°æ˜

outå…³é”®è¯åœ¨è°ƒç”¨æ–¹æ³•æ—¶ç°åœ¨å¯ä»¥åŒæ—¶å£°æ˜å˜é‡ã€‚

ä»¥å‰å¿…é¡»è¿™æ ·å†™ï¼š

```c#
//Oldå†™æ³•
int intValue;
var success = int.TryParse("1", out intValue);
```

ç°åœ¨å¯ä»¥åˆå¹¶æˆï¼š

```c#
var success = int.TryParse("1", out var intValue);
```

## å…ƒç»„ï¼ˆTuple Typeï¼‰

å…ƒç»„æ˜¯7.0ä¸­æ¯”è¾ƒæœ‰è¶£çš„æ›´æ–°ï¼Œæˆ‘ä»¬ç¨å¾®å¤šèŠ±ç‚¹æ—¶é—´è®²ä¸€è®²ã€‚

è®¾æƒ³ä¸¤ä¸ªåœºæ™¯ï¼š

- ä½ å‘ç°éœ€è¦å®šä¹‰ä¸€ä¸ªç±»æˆ–ç»“æ„ï¼Œæ¥å°è£…å‡ ä¸ªå˜é‡ã€‚è¿™ä¸ªç±»çš„å±æ€§ä¼šå¾ˆå°‘ï¼Œå› æ­¤ä½ æ‡’å¾—å»å®šä¹‰ã€‚
- ä½ è¦ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•éœ€è¦è¿”å›ä¸æ­¢ä¸€ä¸ªå€¼ï¼Œä½ æ—¢ä¸æƒ³ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»ï¼Œåˆä¸æƒ³ä½¿ç”¨outå…³é”®è¯ï¼ˆä½ è§‰å¾—outä¸å¤Ÿä¼˜ç¾ï¼‰ã€‚

æ­¤æ—¶ï¼Œä½ å½“ç„¶å¯ä»¥è€ƒè™‘åŒ¿åç±»å‹ã€‚ä¸è¿‡C# 7.0æä¾›äº†æ›´å¥½çš„é€‰æ‹©ï¼šå…ƒç»„ã€‚

å…ƒç»„ï¼Œè¿™é‡Œç‰¹æŒ‡C# 7.0å¼•å…¥çš„ValueTupleã€‚éœ€è¦ä¸\.Net Framework 4.0å¼•å…¥çš„Tupleç±»åšåŒºåˆ†ã€‚è¿™é‡Œæ˜æ˜¾æ˜¯å€Ÿé‰´äº†pythonä¸­çš„å…ƒç»„è¯­æ³•ã€‚

å…ƒç»„çš„å®šä¹‰æ ¼å¼ä¸ºåœ†æ‹¬å·ï¼Œä¸­é—´å®šä¹‰ä¸€ç»„æ•°æ®ï¼Œç”¨é€—å·åˆ†éš”ã€‚

```c#
(double, int) tX = (1.0, 2);  //äºŒå…ƒå…ƒç»„ç±»å‹
(double, int, int) tY = (1.0, 2, 77);  //ä¸‰å…ƒå…ƒç»„ç±»å‹
(double, int, int, string) tZ = (1.0, 2, 77, "ä½ å¥½å");  //å››å…ƒå…ƒç»„ç±»å‹
```

ä½¿ç”¨å…ƒç»„ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†æ•°ä¸ªå˜é‡ç»„åˆåœ¨ä¸€èµ·ï¼š

```c#
var a = 1;
var b = 2;
var t = (a, b); //ç”Ÿæˆå…ƒç»„
```

å…ƒç»„å¯ä»¥åˆ†ä¸º**å‘½åå…ƒç»„**å’Œ**æœªå‘½åå…ƒç»„**

- å‘½åå…ƒç»„åœ¨å®šä¹‰æ—¶æŒ‡å®šäº†å…ƒç»„å†…å…ƒç´ çš„åç§°ï¼Œå› è€Œéœ€è¦é€šè¿‡æŒ‡å®šçš„åç§°è®¿é—®å…ƒç»„å†…å…ƒç´ 
- éå‘½åå…ƒç»„æœªæŒ‡å®šå…ƒç»„å†…å…ƒç´ çš„åç§°ï¼Œä½¿ç”¨é»˜è®¤å‘½åè®¿é—®å…ƒç»„å†…å…ƒç´ ã€‚é»˜è®¤å‘½åä¸º`Item1`ã€`Item2`ã€`Item3`...

```c#
(int, int) t1 = (1, 2);  //æœªå‘½åå…ƒç»„
var t1A = t1.Item1; 
var t1B = t1.Item2;

(int A, int B) t2 = (1, 2); //å‘½åå…ƒç»„
var t2A = t2.A;
var t2B = t2.B;
```

å‘½åå…ƒç»„è¿˜å¯ä»¥ç›´æ¥åœ¨èµ‹å€¼æ—¶æŒ‡å®šåç§°ï¼š

```c#
var t3 = (A: 1, B: 2); //èµ‹å€¼å¹¶æŒ‡å®šå…ƒç´ åç§°
```

å…ƒç»„ä¹Ÿæ”¯æŒåµŒå¥—ï¼š

```c#
var t = (1, 2, (3, (4, 5)));
```

æ¯”è¾ƒæœ‰è¶£çš„ä¸€ç‚¹æ˜¯ï¼Œå…ƒç»„è·ŸTupleç±»çš„å®šä¹‰ç±»ä¼¼ï¼Œæœ€å¤šåªæ”¯æŒåˆ°8ä¸ªæ³›å‹å‚æ•°ã€‚ä¸ºäº†å®ç°å¤šäº8ä¸ªå…ƒç´ çš„å…ƒç»„ï¼Œç¬¬8ä¸ªæ³›å‹å‚æ•°ä¼šä½¿ç”¨ValueTuple\<T>ç±»å‹æ¥å®ç°ã€‚æ‰€ä»¥æœ¬è´¨ä¸Šæ˜¯é€šè¿‡å…ƒç»„çš„åµŒå¥—æ¥å®ç°çš„ã€‚ä½†æ˜¯ï¼Œç¼–è¯‘å™¨ç»™æˆ‘ä»¬å˜äº†ä¸ªé­”æœ¯ï¼Œä½ å¯ä»¥å®šä¹‰åœ†æ‹¬å·å†…æœ‰è¶…è¿‡8ä¸ªå…ƒç´ çš„å…ƒç»„ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ä½¿ç”¨`Item9`ã€`Item10`ç­‰è®¿é—®å®ƒçš„å…ƒç´ ï¼Œè€Œä¸ä¼šæœ‰é—®é¢˜ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨ä¼šæŠŠå®ƒè½¬æˆåµŒå¥—çš„ValueTupleã€‚

### å…ƒç»„çš„èµ‹å€¼

çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

```c#
(int, int) t1 = (1, 2);
(int A, int B) t2 = (3, 4);
t2 = t1;  //åˆæ³•
(int C, int D) t3;
t3 = t2;  //ä¹Ÿåˆæ³•
```

å¯è§ï¼Œå…ƒç»„çš„å…ƒç´ åç§°å¹¶ä¸é‡è¦ã€‚äº‹å®ä¸Šï¼Œå…ƒç»„åªæœ‰å…ƒç´ ç±»å‹çš„é¡ºåºæ‰æ˜¯é‡è¦çš„ã€‚

### å…ƒç»„çš„è§£æ„ï¼ˆDeconstructionï¼‰

å…ƒç»„æ”¯æŒè§£æ„è¯­æ³•ã€‚æ‰€è°“è§£æ„ï¼Œå°±æ˜¯å°†å…ƒç»„æ‹†æˆå¤šä¸ªå˜é‡ã€‚

```c#
int left;
int right;
(left, right) = (1, 2); //è§£æ„è¯­æ³•ï¼Œ1å’Œ2åˆ†åˆ«èµ‹å€¼ç»™leftå’Œrightã€‚
```

æˆ–è€…åœ¨å…ƒç»„çš„è§£æ„åŒæ—¶å£°æ˜å˜é‡ï¼š

```c#
(var left, var right) = (1, 2);
```

è¿˜æ”¯æŒä½¿ç”¨å•ç‹¬varå¯¹æ‰€æœ‰å£°æ˜å˜é‡è¿›è¡Œè‡ªåŠ¨çš„ç±»å‹æ¨æ–­ï¼š

```c#
var t = ("a", 1);
var (a, b) = t;  //aä¸ºstringï¼Œ bä¸ºint
```

### è‡ªå®šä¹‰ç±»çš„è§£æ„æ–¹æ³•

ä»»ä½•ä¸€ä¸ªç±»ï¼Œéƒ½å¯ä»¥é€šè¿‡æ·»åŠ Deconstructæ–¹æ³•æ¥è§£æ„æˆå…ƒç»„ã€‚

å®šä¹‰Deconstructéœ€è¦æ»¡è¶³ï¼š

- è¿”å›`void`
- å‚æ•°å…¨éƒ¨ç”¨`out`ä¿®é¥°
- éœ€è¦è§£æ„æˆå‡ å…ƒå…ƒç»„ï¼Œå°±æä¾›å‡ ä¸ªå‚æ•°ã€‚å‚æ•°ç±»å‹é¡ºåºå°±æ˜¯å…ƒç»„å…ƒç´ ç±»å‹çš„é¡ºåºã€‚

```c#
public class Person
{
    //æ­¤å¤„çœç•¥å±æ€§ã€æ„é€ å™¨ç­‰

    public void Deconstruct(out string firstName, out string lastName)  //è§£æ„æˆäºŒå…ƒå…ƒç»„
    {
        firstName = FirstName;
        lastName = LastName;
    }
    public void Deconstruct(out string firstName, out string lastName, out string province, out string city) //è§£æ„æˆå››å…ƒå…ƒç»„
    {
        firstName = FirstName;
        lastName = LastName;
        province = Province;
        city = City;
    }
}

var person = new Person("å¼ ", "ä¸‰", "æ±Ÿè‹", "å—äº¬");
var (firstName, lastName, province, city) = person;  //è‡ªåŠ¨è°ƒç”¨ç±»çš„è§£æ„æ–¹æ³•
```

ç‰¹åˆ«çš„ï¼ŒDeconstructæ–¹æ³•å¯ä»¥æ˜¯æ‰©å±•æ–¹æ³•ã€‚

### ä½•æ—¶ä½¿ç”¨å…ƒç»„

ä»ä¹‹å‰çš„ä»‹ç»å¯è§ï¼Œä½¿ç”¨å…ƒç»„ååˆ†çµæ´»

- æ—¢å¯ä»¥å°†å¤šä¸ªå˜é‡æ‹¼è£…æˆä¸€ä¸ªå…ƒç»„
- ä¹Ÿå¯ä»¥é€šè¿‡è§£æ„å°†å…ƒç»„èµ‹å€¼ç»™å¤šä¸ªå˜é‡
- è¿˜å¯ä»¥é€šè¿‡ç±»çš„è§£æ„å˜æˆå…ƒç»„

è¯­æ³•ååˆ†çµæ´»ã€‚

å›é¡¾ä¹‹å‰C#çš„è¯­è¨€è¯­æ³•ã€‚ç°åœ¨ï¼Œç”¨äºä¸´æ—¶è¿”å›ä¸€ä¸ªç›¸å¯¹ç®€å•çš„æ•°æ®ç»“æ„ç»„åˆä½“ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹çš„æ–¹å¼ï¼š

- ä½¿ç”¨åŒ¿åç±»å‹ï¼ˆC# 3.0å¼•å…¥ï¼‰
- ä½¿ç”¨Tupleç±» ï¼ˆ\.Net Framework 4.0å¼•å…¥ï¼‰
- ä½¿ç”¨ValueTupleç»“æ„ï¼ˆC# 7.0å¼•å…¥ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç°åœ¨èŠçš„å…ƒç»„ï¼‰

æ€æ ·æŠ‰æ‹©å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„è¡¨æ ¼ï¼š

| ç±»å‹ | è®¿é—®ä¿®é¥°ç¬¦ | ç±»å‹ | è‡ªå®šä¹‰æˆå‘˜åç§° | ææ„ï¼ˆç»ˆç»“å™¨ï¼‰æ”¯æŒ | è¡¨è¾¾å¼æ ‘æ”¯æŒ |
| --- | --- | --- | --- | --- | --- |
| åŒ¿åç±»å‹ | internal | class | âœ”ï¸ | âŒ | âœ”ï¸ |
| Tuple | public | class | âŒ | âŒ | âœ”ï¸ |
| ValueTuple | public | struct | âœ”ï¸ | âœ”ï¸ | âŒ |

æ¨èé¦–é€‰å…ƒç»„ã€‚å¦‚æœéœ€è¦è¡¨è¾¾å¼æ ‘æ”¯æŒï¼Œåˆ™æ”¹ç”¨åŒ¿åç±»å‹ã€‚

ä½†æ˜¯ï¼Œå¦‚æœä½ çš„æ•°æ®éœ€è¦åºåˆ—åŒ–ï¼ˆå¦‚è½¬æˆjsonï¼‰ï¼Œæœ€å¥½çš„åšæ³•æ˜¯å®šä¹‰structæˆ–è€…ç±»ï¼Œè€Œéä½¿ç”¨ä¸Šè¿°å‡ ç§ç±»å‹ã€‚

## C# 7.0çš„æ¨¡å¼åŒ¹é…ï¼ˆPattern Matchingï¼‰

æ¨¡å¼ï¼ˆPatternï¼‰å…¶å®æ›´è´´åˆ‡çš„ç¿»è¯‘åº”è¯¥æ˜¯â€œèŒƒå¼â€ã€‚å³ç¼–å†™æä¾›ç”¨äºæ£€æŸ¥çš„èŒƒå¼ã€‚

C#çš„æ¨¡å¼åŒ¹é…åœ¨7.0ã€8.0ã€9.0ä¸­éƒ½æœ‰æ›´æ–°ã€‚7.0è™½ç„¶å·²ç»å¾ˆå¥½ç”¨äº†ï¼Œä½†æ˜¯ä¸æ˜¯å®Œå…¨ä½“ã€‚

æ¨¡å¼åŒ¹é…å¯ä»¥ä½¿ç”¨åœ¨ä»¥ä¸‹è¯­å¥ä¸­ï¼š

- isè¡¨è¾¾å¼
- switchè¯­å¥
- switchè¡¨è¾¾å¼ï¼ˆC# 8.0å¼•å…¥ï¼‰

æ¨¡å¼åŒ¹é…æ”¯æŒçš„ç±»å‹ï¼š

- **å£°æ˜æ¨¡å¼**ï¼ˆDeclaration Patternï¼‰ï¼šç”¨äºæ£€æŸ¥è¡¨è¾¾å¼çš„è¿è¡Œæ—¶ç±»å‹ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™å°†è¡¨è¾¾å¼ç»“æœåˆ†é…ç»™å£°æ˜çš„å˜é‡ã€‚ï¼ˆC# 7.0ï¼‰
- **ç±»å‹æ¨¡å¼**ï¼ˆType Patternï¼‰ï¼šç”¨äºæ£€æŸ¥è¡¨è¾¾å¼çš„è¿è¡Œæ—¶ç±»å‹ã€‚ï¼ˆC# 9.0ï¼‰
- **å¸¸é‡æ¨¡å¼**ï¼ˆConstant Patternï¼‰ï¼šç”¨äºæµ‹è¯•è¡¨è¾¾å¼ç»“æœæ˜¯å¦ç­‰äºæŒ‡å®šå¸¸é‡ã€‚ï¼ˆC# 7.0ï¼‰
- **å…³ç³»æ¨¡å¼**ï¼ˆRelational Patternï¼‰ï¼šç”¨äºå°†è¡¨è¾¾å¼ç»“æœä¸æŒ‡å®šå¸¸é‡è¿›è¡Œå¤§å°å…³ç³»çš„æ¯”è¾ƒã€‚ï¼ˆC# 9.0ï¼‰
- **é€»è¾‘æ¨¡å¼**ï¼ˆLogical Patternï¼‰ï¼šç”¨äºæµ‹è¯•è¡¨è¾¾å¼åœ¨å¤šä¸ªå…³ç³»æ¨¡å¼çš„é€»è¾‘ç»„åˆä¸‹æ˜¯å¦åŒ¹é…ã€‚ï¼ˆC# 9.0ï¼‰
- **å±æ€§æ¨¡å¼**ï¼ˆProperty Patternï¼‰ï¼šç”¨äºæµ‹è¯•è¡¨è¾¾å¼çš„å±æ€§æˆ–å­—æ®µæ˜¯å¦ä¸æ¨¡å¼åŒ¹é…ã€‚ï¼ˆC# 8.0ï¼‰
- **å…ƒç»„æ¨¡å¼**ï¼ˆTuple Patternï¼‰ã€**ä½ç½®æ¨¡å¼**ï¼ˆPositional Patternï¼‰ï¼šç”¨äºè§£æ„è¡¨è¾¾å¼ç»“æœï¼Œå¹¶æµ‹è¯•ç»“æœå€¼æ˜¯å¦ä¸æ¨¡å¼åŒ¹é…ã€‚ï¼ˆC# 8.0ï¼‰
- **varæ¨¡å¼**ï¼ˆVar Patternï¼‰ï¼šç”¨äºåŒ¹é…ä»»ä½•è¡¨è¾¾å¼ï¼Œå¹¶å°†å…¶ç»“æœåˆ†é…ç»™å£°æ˜çš„å˜é‡ã€‚ï¼ˆC# 7.0ï¼‰
- **å¼ƒå…ƒæ¨¡å¼**ï¼ˆDiscard Patternï¼‰ï¼šç”¨äºåŒ¹é…ä»»ä½•è¡¨è¾¾å¼ï¼Œå¹¶ä¸¢å¼ƒç»“æœã€‚ï¼ˆC# 8.0ï¼‰

### å¸¸é‡æ¨¡å¼

```c#
if (book is null)
{
}

switch (book) //ä»»ä½•ç±»å‹éƒ½å¯ä»¥switchäº†
{
    case null:
        break;
}
```

### å£°æ˜æ¨¡å¼

```c#
if (book is ArtBook artBook) //å¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™bookè¢«èµ‹å€¼ç»™artBookï¼Œä¸”artBookä¸ºArtBookç±»å‹
{
}
switch (book)
{
    case ArtBook artBook:
        break;
}
```

> Javaåœ¨14ç‰ˆæœ¬æ—¶ï¼Œå¼•å…¥äº†é¢„è§ˆçš„instanceofè¡¨è¾¾å¼æ¨¡å¼åŒ¹é…ï¼Œå¹¶åœ¨Java 16å˜ä¸ºæ­£å¼è¯­æ³•ã€‚å®ƒç›¸å½“äºC#çš„isè¡¨è¾¾å¼æ¨¡å¼åŒ¹é…ï¼Œå¹¶ä¸”ä»…æ”¯æŒå£°æ˜æ¨¡å¼ã€‚

> ```java
> //==Java==
> if (obj instanceof Cat cat){
>     System.out.println(cat.getName());
> }
> ```
> Javaæ­£å¼æ”¯æŒçš„æ¨¡å¼åŒ¹é…ä¹Ÿå°±åˆ°è¿™å„¿äº†ã€‚Java 17å¼•å…¥äº†switchçš„æ¨¡å¼åŒ¹é…ä¸è¿‡è¿˜æ˜¯é¢„è§ˆç‰ˆã€‚Javaæ”¯æŒæ¨¡å¼ç§ç±»å¤ªå°‘ï¼Œä¸å¤Ÿå®ç”¨ã€‚

### varæ¨¡å¼

```c#
if (book is var anyBook) //è¿™å°†åŒ¹é…ä»»ä½•æƒ…å†µ
{
}
switch (book)
{
    case var anyBook:
        break;
}
```

æ³¨æ„ä¸€ç‚¹ï¼švaræ¨¡å¼åŒ¹é…å‡ºæ¥çš„å˜é‡ï¼Œç±»å‹è·ŸåŸå§‹ç±»å‹ç›¸åŒï¼Œè€Œä¸æ˜¯objectã€‚

### caseçš„whenå­å¥

`switch`çš„`case`ï¼Œç°åœ¨æ”¯æŒ`when`å­å¥ï¼Œç”¨äºæä¾›é™„åŠ æ¡ä»¶ã€‚

```c#
switch (url)
{
    case string str when str.StartsWith("http://"):
        break;
    case string str when str.StartsWith("https://");
        break;
    case null:
        break;
    case var obj:
        break;
    default:   //ç”±äºæœ‰varæ¨¡å¼åœ¨ï¼Œå®ƒå°†åŒ¹é…ä»»ä½•æƒ…å†µï¼Œå› æ­¤defaultæ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œã€‚
        break;
}
```

å‰©ä¸‹çš„æ¨¡å¼ï¼Œæˆ‘ä»¬å°†åœ¨[C#8.0](#C#%208.0çš„æ¨¡å¼åŒ¹é…)å’Œ[C#9.0](#C#%209.0çš„æ¨¡å¼åŒ¹é…)ä¸­ç»§ç»­ä»‹ç»ã€‚

## æœ¬åœ°å‡½æ•°ï¼ˆLocal Functionï¼‰

å¯ä»¥åœ¨æ–¹æ³•ä½“å†…çš„ä»»æ„è¯­å¥ä½ç½®å®šä¹‰æœ¬åœ°å‡½æ•°

- æœ¬åœ°å‡½æ•°å¯ä»¥ä½¿ç”¨å½“å‰ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬å±€éƒ¨å˜é‡ã€‚
- æœ¬åœ°å‡½æ•°ä»…åœ¨æ–¹æ³•ä½“å†…å¯è§ï¼Œæ— æ³•åœ¨æ–¹æ³•å¤–ä½¿ç”¨ã€‚

```c#
public void Print()
{
    string Title = "è¿™æ˜¯æ ‡é¢˜";
    void PrintTitle() //å®šä¹‰æœ¬åœ°å‡½æ•°
    {
        Console.WriteLine(Title); //ä½¿ç”¨æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡
    }

    PrintTitle(); //è°ƒç”¨æœ¬åœ°å‡½æ•°
    Console.WriteLine("è¿™æ˜¯æ­£æ–‡è¿™æ˜¯æ­£æ–‡è¿™æ˜¯æ­£æ–‡è¿™æ˜¯æ­£æ–‡è¿™æ˜¯æ­£æ–‡è¿™æ˜¯æ­£æ–‡");
}
```

## è¡¨è¾¾å¼ä¸»ä½“ï¼ˆExpression-Bodied Memberï¼‰

è¡¨è¾¾å¼ä¸»ä½“åœ¨C# 6.0æ—¶å€™å¼•å…¥ï¼ŒC# 7.0è¿›è¡Œäº†å®Œå–„ã€‚

| æˆå‘˜ | å¼€å§‹æä¾›æ”¯æŒçš„ç‰ˆæœ¬ |
| --- | --- |
| æ–¹æ³• | C# 6.0 |
| åªè¯»å±æ€§ | C# 6.0 |
| å±æ€§ | C# 7.0 |
| æ„é€ å‡½æ•° | C# 7.0 |
| ç»ˆç»“å™¨ | C# 7.0 |
| ç´¢å¼•å™¨ | C# 7.0 |

æ‰€è°“è¡¨è¾¾å¼ä¸»ä½“ï¼Œå°±æ˜¯ç”¨è¡¨è¾¾å¼è¡¨è¿°æ–¹æ³•çš„ä¸»ä½“ã€‚è¯¥æ–¹æ³•åªæœ‰è¡¨è¾¾å¼æ‰€æè¿°çš„ä¸€å¥è¯ï¼Œè¡¨è¾¾å¼çš„å€¼å¯ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚æ˜¯ä¸ºäº†ç®€åŒ–æ–¹æ³•çš„å®šä¹‰ã€‚

è¡¨è¾¾å¼ä¸»ä½“çš„è¯­æ³•ï¼Œç±»ä¼¼Lambdaï¼Œä¹Ÿæ˜¯ç”¨`=>`ç¬¦å·ã€‚ç”±äºä¸»ä½“å†…å®¹å˜æˆäº†è¡¨è¾¾å¼ï¼Œå› è€Œéœ€è¦åœ¨è¡¨è¾¾å¼ä¸»ä½“ç»“æŸæ—¶æ·»åŠ è¯­å¥ç»“æŸç¬¦`;`ï¼š

```c#
public override string ToString() => $"{Name}æ˜¯ä¸ªå¥½äºº";  //æ–¹æ³•è¡¨è¾¾å¼ä¸»ä½“
public string Name => name;  //åªè¯»å±æ€§çš„è¡¨è¾¾å¼ä¸»ä½“ï¼Œè¿™ä¸ªè¯­æ³•æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒå°†åªå…·æœ‰getter
public string Name { get => name; set => name = value; }  //å±æ€§çš„è¡¨è¾¾å¼ä¸»ä½“
public Person(string name) => Name = name; //æ„é€ å™¨è¡¨è¾¾å¼ä¸»ä½“
~Person() => Console.WriteLine($"{Name}å®Œè›‹äº†"); //ææ„æ–¹æ³•ï¼ˆç»ˆç»“å™¨ï¼‰è¡¨è¾¾å¼ä¸»ä½“
public string this[int i] { get => arr[i]; set => arr[i] = value; }; //ç´¢å¼•å™¨è¡¨è¾¾å¼ä¸»ä½“
```

## refè¿”å›å€¼ã€refå±€éƒ¨å˜é‡

ç°åœ¨æ”¯æŒå°†å€¼ç±»å‹çš„å¼•ç”¨ï¼Œä½œä¸ºæ–¹æ³•çš„è¿”å›ã€‚è¯­æ³•æ˜¯åŠ ä¸Š`ref`å…³é”®è¯ã€‚å€˜è‹¥æ–¹æ³•è¿”å›çš„æ˜¯ç±»çš„æˆå‘˜ï¼Œåˆ™è·å¾—è¯¥è¿”å›çš„ä»£ç æœ‰å¯èƒ½ç›´æ¥ä¿®æ”¹è¯¥æˆå‘˜å€¼ã€‚

æ³¨æ„ï¼šåœ¨æ–¹æ³•å®šä¹‰è¿”å›å€¼ä¸Šã€æ–¹æ³•returnæ—¶ã€è°ƒç”¨æ–¹æ³•æ—¶ã€æ¥æ”¶æ–¹æ³•ç»“æœçš„å±€éƒ¨å˜é‡ä¸Šï¼Œéƒ½éœ€è¦æ·»åŠ `ref`å…³é”®è¯ã€‚å€˜è‹¥æ–¹æ³•è°ƒç”¨å’Œæœ€ç»ˆæ¥æ”¶çš„å˜é‡æœªä½¿ç”¨`ref`ï¼Œåˆ™è·å–çš„ä¸æ˜¯å¼•ç”¨ï¼ï¼

```c#
public class RefSample
{
    int number = 3;
    public ref int GetNumber() => ref number; //è¿”å›numberçš„å¼•ç”¨
    public override string ToString() => number.ToString();
}

var sample = new RefSample();
ref var num = ref sample.GetNumber(); //è·å–å¼•ç”¨ï¼Œå·¦å³éƒ½è¦åŠ ä¸Šref
num *= 2;  //å°†å¼•èµ·sampleå¯¹è±¡çš„numberæ”¹å˜
var str = num.ToString();  //ç»“æœä¸º 6 
```

## å¼ƒå…ƒï¼ˆDiscardï¼‰

å¼ƒå…ƒç¬¦å·æ˜¯ä¸€ä¸ªå•ç‹¬çš„`_`ã€‚

å®ƒç”¨äºä¸¢å¼ƒä»»ä½•è®¡ç®—ç»“æœï¼Œä¸å—ç±»å‹é™åˆ¶ã€‚ä½¿ç”¨å¼ƒå…ƒæ¥æ”¶çš„å€¼ä¼šè¢«ä¸¢å¼ƒï¼Œå› è€Œæ— æ³•è·å–å¼ƒå…ƒçš„å€¼ã€‚

å¼ƒå…ƒç”¨äºä¸¢å¼ƒæ–¹æ³•è¿”å›ï¼š

```c#
_ = int.TryParse("1", out var intValue); //ä¸¢å¼ƒæ˜¯å¦è½¬æ¢æˆåŠŸçš„ç»“æœ
```

å¼ƒå…ƒç”¨äºä¸¢å¼ƒoutå‚æ•°ï¼š

```c#
var success = int.TryParse("1", out _); //ä¸¢å¼ƒè½¬æ¢åçš„æ•°å€¼ï¼Œä»…ä»…æµ‹è¯•æ˜¯å¦å¯ä»¥è½¬æ¢
```

å…ƒç»„ä¸­ä½¿ç”¨å¼ƒå…ƒï¼š

```c#
var (_, _, _, name, _, age) = GetPersonInfo("å¼ ä¸‰");  //è¿™é‡Œè·å–çš„æ˜¯å…­å…ƒå…ƒç»„ï¼Œæˆ‘ä»¬åªå¯¹å…¶ä¸­ä¸¤ä¸ªå…ƒç´ æ„Ÿå…´è¶£ï¼Œå…¶ä½™çš„ä½¿ç”¨å¼ƒå…ƒä¸¢å¼ƒ
```

éœ€è¦æ³¨æ„ï¼šå› ä¸º`_`ä¹Ÿæ˜¯åˆæ³•çš„å˜é‡åã€‚ä¸ºäº†å‘ä¸‹å…¼å®¹ï¼Œ`_`ä»ç„¶å¯ä»¥è¢«å®šä¹‰ä¸ºå˜é‡ï¼Œå¹¶ä¸ä¼šæŠ¥é”™ã€‚ä½†è‹¥å¦‚æ­¤å®šä¹‰ï¼Œ`_`ä¼šè¦†ç›–å¼ƒå…ƒå®šä¹‰ï¼Œé€€åŒ–ä¸ºæ™®é€šå˜é‡ã€‚ä½œä¸ºæ™®é€šå˜é‡çš„`_`ï¼Œå¯ä»¥æ­£å¸¸è·å–å…¶å€¼ï¼Œä¹Ÿæ— æ³•å¿½ç•¥ç±»å‹ï¼Œä¸”ä¸å¯é‡å¤å®šä¹‰ã€‚

> Javaæ²¡æœ‰å¼ƒå…ƒã€‚ä¸è¿‡è¿™é‡Œè¿˜æ˜¯è¦è¯´ä¸¤å¥ï¼šJavaåœ¨9ä¹‹å‰å•ä¸ª`_`ä¹Ÿå¯ä»¥ä½œä¸ºå˜é‡åï¼Œä½†æ˜¯Java 9çš„è¯­æ³•æ›´æ–°ç¦æ­¢äº†å•ä¸ª`_`ä½œä¸ºå˜é‡åã€‚

## throwè¡¨è¾¾å¼

throwè¡¨è¾¾å¼ï¼Œåˆå«å¼•å‘è¡¨è¾¾å¼ã€‚æ˜¯throwè¯­å¥çš„è¡¨è¾¾å¼ç‰ˆæœ¬ã€‚å› è€Œå¯ä»¥åµŒå…¥æ›´å¤šåœºæ™¯ä¸­ã€‚

åµŒå…¥æ¡ä»¶è¿ç®—ç¬¦`?:`ä¸­ï¼š

```c#
var arg = args.Length == 0 ? throw new Exception("å¿…é¡»æä¾›å‚æ•°") : arg[0];
```

åµŒå…¥nullåˆå¹¶è¿ç®—ç¬¦`??`ä¸­ï¼š

```c#
this.Name = name ?? throw new Exception("åå­—ä¸å¯ä»¥ä¸ºnull");
```

åµŒå…¥è¡¨è¾¾å¼ä¸»ä½“ï¼š

```c#
public void DoSomething() => throw new NotImplementException();
```

## æ›´å¤šçš„å¯ç­‰å¾…ç±»å‹

ç°åœ¨ï¼Œä½ ä¸ä»…å¯ä»¥ç­‰å¾…Taskå’ŒTask\<TResult>ã€‚

é¦–å…ˆå°±æ˜¯å¼•å…¥äº†æ–°çš„ç»“æ„ä½“ValueTaskå’ŒValueTask\<TResult>ï¼Œç”¨äºå¯ç«‹åˆ»è¿”å›çš„ä»»åŠ¡ï¼Œä»è€Œé¿å…ä½¿ç”¨Taskå’ŒTask\<TResult>é‚£æ ·ä¼šåœ¨å †ä¸Šåˆ†é…ç©ºé—´ï¼Œé€ æˆæ€§èƒ½çš„æµªè´¹ã€‚

```c#
//ä»¥å‰è¿”å›ä¸€ä¸ªä»è¡¨è¾¾å¼ç»“æœæ¥çš„Task
public Task<int> GetOneAsync()
{
    return Task.FromResult(1);   //è¿™ä¼šå¯¼è‡´åœ¨å †ä¸Šåˆ†é…ä¸€ä¸ªTaskå¯¹è±¡
}
//ç°åœ¨å¯ä»¥ç”¨ä¸‹é¢çš„è¯­å¥æ›¿æ¢ï¼š
public ValueTask<int> GetOneAsync()
{
    return new ValueTask<int>(1);
}
```

å…¶æ¬¡ï¼ŒC# 7.0ä»¥åï¼Œå…è®¸ä½ ç­‰å¾…ä»»ä½•ç±»çš„å¯¹è±¡ï¼Œåªéœ€è¦å®ƒå®ç°GetAwaiteræ–¹æ³•ã€‚

GetAwaiteræ–¹æ³•è¿”å›ä¸€ä¸ªINotifyCompletionæˆ–è€…ICriticalNotifyCompletionæ¥å£çš„å¯¹è±¡ï¼Œè¯¥æ¥å£ç”¨äºå®ç°é€šçŸ¥å›è°ƒã€‚

æ­¤æ—¶ä½ å°±æˆåŠŸçš„å®šä¹‰äº†ä¸€ä¸ª**è‡ªå®šä¹‰å¯ç­‰å¾…ç±»**ï¼Œè¯¥ç±»ä¹Ÿæ˜¯å¯ç­‰å¾…çš„ã€‚è¿”å›è¯¥ç±»å‹çš„æ–¹æ³•ä¹Ÿæ˜¯å¯ç­‰å¾…æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨async/awaitå…³é”®è¯å‡çº§ä¸ºå¼‚æ­¥æ–¹æ³•ã€‚

### å¼‚æ­¥æ–¹æ³•æ„å»ºå™¨

ç°åœ¨ï¼Œä½ è¿˜å¯ä»¥å®šä¹‰ä¸€ä¸ªç±»ã€‚è¿™ä¸ªç±»éœ€è¦æ»¡è¶³å…·æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š

- ä¸€ä¸ª`static`çš„Createæ–¹æ³•ï¼Œè¿”å›è¯¥ç±»çš„å¯¹è±¡ã€‚
- ä¸€ä¸ªStartæ–¹æ³•ï¼Œä¼ é€’IAsyncStateMachineæ¥å£ç±»å‹çš„çŠ¶æ€æœºå¼•ç”¨å‚æ•°ã€‚ä¸€ä¸ªSetStateMachineæ–¹æ³•ç”¨äºè®¾ç½®çŠ¶æ€æœºã€‚
- SetExceptionã€SetResultæ–¹æ³•ç”¨äºè®¾ç½®å¼‚å¸¸ã€å†™å…¥ç»“æœã€‚
- AwaitOnCompletedã€AwaitUnsafeOnCompletedæ–¹æ³•ç”¨äºæè¿°æ‰§è¡Œåˆ°awaitè¯­å¥ä¹‹ååº”è¯¥æ€ä¹ˆåšï¼Œå¹¶åœ¨ä»»åŠ¡ç»“æŸæ—¶è°ƒç”¨Awaiterçš„å¯¹åº”æ–¹æ³•ï¼Œä»¥åŠStateMachineçš„MoveNextæ–¹æ³•ã€‚

æ­¤æ—¶ï¼Œä½ å°±æˆåŠŸå®šä¹‰äº†ä¸€ä¸ª**è‡ªå®šä¹‰å¼‚æ­¥æ–¹æ³•æ„å»ºå™¨**ã€‚

ä½ å¯ä»¥ç»™ä½ åˆšåˆšè‡ªå®šä¹‰çš„å¯ç­‰å¾…ç±»ä¸Šæ·»åŠ ç‰¹æ€§AsyncMethodBuilderAtrributeï¼Œå¹¶åœ¨å‚æ•°é‡ŒæŒ‡å®šä½¿ç”¨`typeof(ä½ å®šä¹‰çš„å¼‚æ­¥æ–¹æ³•æ„å»ºå™¨)`ã€‚è¿™æ ·è¿”å›ä½ å®šä¹‰çš„å¯ç­‰å¾…ç±»å‹çš„å¼‚æ­¥æ–¹æ³•ï¼Œä¼šä½¿ç”¨ä½ å®šä¹‰çš„æ„å»ºç±»æ›¿ä»£ç³»ç»Ÿé»˜è®¤çš„æ„å»ºç±»ï¼Œå»å®Œæˆå¼‚æ­¥æ–¹æ³•çš„æ„å»ºã€‚

## C# 7.0çš„å…¶ä»–æ”¹è¿›

- **äºŒè¿›åˆ¶æ–‡æœ¬**ï¼šç°åœ¨å¯ä»¥ç›´æ¥å®šä¹‰äºŒè¿›åˆ¶å¸¸é‡ï¼Œè¯­æ³•ä¸º0bxxxxxxã€‚ä¾‹å¦‚ï¼š`0b101011100`
- **æ•°å­—åˆ†éš”ç¬¦**ï¼šæ•°å­—ä¹‹é—´å¯ä»¥ç”¨`_`åˆ†éš”ã€‚`_`å¯ä»¥æœ‰ä»»æ„å¤šä¸ªï¼Œå¯ä»¥åŠ åœ¨é™¤äº†ç¬¬ä¸€ä½ã€æœ€åä¸€ä½å’Œå°æ•°ç‚¹å‰åçš„ä»»ä½•ä½ç½®ï¼ŒåŒ…æ‹¬æ”¾åœ¨`_`æ—ã€‚ä¾‹å¦‚ï¼š`var n = 1_2__3___4____5_____6_______7;`ï¼Œå®ƒç­‰ä»·äº`var n = 1234567;`ã€‚

> Javaå¼•å…¥äºŒè¿›åˆ¶æ–‡æœ¬å’Œæ•°å­—åˆ†éš”ç¬¦è¦æ—©å¾—å¤šï¼Œåœ¨Java 7ä¾¿æä¾›äº†æ”¯æŒã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼šC#è‡³ä»Šè¿˜æ˜¯ä¸æ”¯æŒå…«è¿›åˆ¶æ–‡æœ¬ï¼Œè€ŒJavaå’ŒC++å‡æ”¯æŒã€‚å¯èƒ½æ˜¯å…«è¿›åˆ¶å®åœ¨æ˜¯ç”¨çš„å¤ªå°‘äº†ã€‚

# C# 7.1ã€7.2ã€7.3 â€”â€” å°ç¢æ­¥

åœ¨C# 7.0çš„åŸºç¡€ä¸Šï¼Œåˆæ¨å‡ºäº†7.1ã€7.2ã€7.3ã€‚éƒ½ä¸æ˜¯å¤ªå¤§çš„æ›´æ–°ï¼Œä½†æ˜¯å†…å®¹ä¸å°‘ã€‚

## C# 7.1çš„æ”¹è¿›

C# 7.1çš„æ›´æ–°å¦‚ä¸‹ï¼š

- å¼‚æ­¥Mainæ–¹æ³•ï¼šç°åœ¨å…è®¸ç¨‹åºå…¥å£ç‚¹çš„Mainæ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œä»è€ŒCMDåº”ç”¨ä¹Ÿå¯ä»¥async/awaitåˆ°åº•ã€‚
- defaultæ–‡æœ¬è¡¨è¾¾å¼ï¼šdefaultè¿ç®—ç¬¦å¾—åˆ°äº†è¿›åŒ–ï¼Œå¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹

    ```c#
    string def1 = default(string);  //ä»¥å‰çš„å†™æ³•ã€‚
    string def2 = default;  //æ–°çš„è¯­æ³•ï¼Œè‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚
    var def3 = default;  //NOT OKã€‚æŠ¥é”™ï¼Œå› ä¸ºæ— æ³•è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚
    ```

- å…ƒç»„å…ƒç´ åç§°çš„è‡ªåŠ¨æ¨æ–­ï¼šè·ŸåŒ¿åç±»å‹ä¸€æ ·ï¼Œç°åœ¨å…ƒç»„çš„å…ƒç´ åç§°ä¹Ÿæ”¯æŒè‡ªåŠ¨æ¨æ–­äº†ã€‚

    ```c#
    int n = 100;
    Cat cat new Cat { Name = "å–µå‘œ" };
    var tp = (n, cat.Name);   //å…ƒç»„çš„å…ƒç´ åç§°åˆ†åˆ«ä¸º nã€Name
    _ = tp.n;
    _ = tp.Name;
    ```

- æ³›å‹å‚æ•°çš„æ¨¡å¼åŒ¹é…ï¼š7.0çš„æ¨¡å¼åŒ¹é…ä¸æ”¯æŒæ³›å‹å‚æ•°çš„æ¨¡å¼åŒ¹é…ï¼Œ7.1æ”¯æŒäº†ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰æ³›å‹æ–¹æ³•`DoSomething<T>(IEnumerable<T> serial)`ï¼Œåœ¨ä»£ç ä¸­å¯ä»¥å¯¹`serial`è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œä¾‹å¦‚`if (serial is List<T>)`ã€‚

## C# 7.2çš„æ”¹è¿›

C# 7.2æˆ‘ä»¬è¿˜æ˜¯éœ€è¦å±•å¼€æ¥è®²ä¸€è®²ï¼Œå®ƒåŒ…å«ä¸€äº›å’Œåˆ‡ç‰‡ï¼ˆSliceï¼‰æœ‰å…³çš„æ›´æ–°ï¼ˆåˆ‡ç‰‡æ˜¾ç„¶åˆæ˜¯å€Ÿé‰´äº†pythonï¼‰ï¼Œä¹Ÿä¸ºC# 8.0çš„ç´¢å¼•ã€èŒƒå›´æä¾›äº†åŸºç¡€ã€‚

### inå‚æ•°ã€readonly structã€ref structã€ref readonlyè¿”å›å€¼ã€ref readonly struct

è¿™ä¸€å †ç»„åˆæ˜¯ä¸æ˜¯çœ‹ç€çœ¼èŠ±ç¼­ä¹±ã€‚äº‹å®ä¸Šå®ƒä»¬éƒ½æ˜¯ä¸ºäº†ä¸‹é¢çš„Span\<T>åšå‡†å¤‡çš„ã€‚è™½ç„¶è¿™äº›ä¿®é¥°ç¬¦éƒ½å¯ä»¥ç”¨äºå¼•ç”¨ç±»å‹ï¼Œä½†å°±å…¶åŠŸèƒ½è€Œè¨€ï¼Œä¸€èˆ¬è¿˜æ˜¯è¢«ç”¨ä½œ**ä¿®é¥°å€¼ç±»å‹**ã€‚æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªè¯´ï¼š

**inå‚æ•°**ï¼šç°åœ¨å¯ä»¥ç”¨inä¿®é¥°æ–¹æ³•çš„å‚æ•°ã€‚è¡¨ç¤ºï¼š

1. è¯¥å‚æ•°åœ¨æ–¹æ³•ä¸­ä¼šè¢«ä»¥å¼•ç”¨ä¼ é€’ï¼ˆåŒrefå’Œoutï¼‰ã€‚
2. æ–¹æ³•ä¸­ä¸ä¼šä¿®æ”¹è¯¥å‚æ•°ã€‚

```c#
public void SampleMethod(in int number)
{
    number = 7;   //NOT OKï¼Œ ä¼šå¯¼è‡´ç¼–è¯‘å™¨æŠ¥é”™
}
```

ä¸refå’Œoutä¸åŒï¼Œåœ¨è°ƒç”¨å«inå‚æ•°çš„æ–¹æ³•æ—¶ï¼Œinå…³é”®è¯å¯ä»¥çœç•¥ã€‚

```c#
int n = 10;
SampleMethod(n); //OK
SampleMethod(in n);  //ä¹ŸOK
```

**readonly struct**ï¼šè¡¨æ˜æ‰€å®šä¹‰çš„ç»“æ„ä¸å¯å˜ã€‚è¯•å›¾åœ¨åˆå§‹åŒ–ä¹‹åå¯¹ç»“æ„æœ¬èº«å’Œå…¶ä¸­çš„ä»»ä½•å­—æ®µé‡æ–°èµ‹å€¼éƒ½ä¼šå¯¼è‡´æŠ¥é”™ã€‚ä½¿ç”¨è¯¥ç»“æ„ä½œä¸ºæ–¹æ³•çš„å‚æ•°ä¼ é€’æ—¶ï¼Œæ¨èæ–¹æ³•çš„å‚æ•°ç”¨inä¿®é¥°ï¼Œä»¥æç¤ºå¼€å‘è€…è¯¥ç»“æ„ä¸å¯ä¿®æ”¹ã€‚å®šä¹‰åœ¨readonly structä¸­çš„å­—æ®µã€å±æ€§ï¼Œéƒ½å¿…é¡»æ˜¯readonlyçš„ï¼šå­—æ®µéœ€è¦æ·»åŠ readonlyä¿®é¥°ï¼›å±æ€§åˆ™åªèƒ½æœ‰getterï¼Œä¸èƒ½æœ‰setterï¼ˆåœ¨C# 9.0ä¹‹åï¼Œå±æ€§å¯ä»¥æœ‰initè®¿é—®å™¨ï¼‰ã€‚

**ref readonlyè¿”å›å€¼**ï¼šç”¨ref readonlyæ¥ä¿®é¥°æ–¹æ³•çš„è¿”å›ï¼Œè¡¨æ˜æ–¹æ³•çš„è¿”å›æ˜¯è¯¥ç±»å‹çš„å¼•ç”¨ï¼Œå¹¶ä¸”ä¸å…è®¸è¢«ä¿®æ”¹ã€‚

**ref struct**ï¼šæ˜¯ä¸€ç§æ–°çš„ç»“æ„ç±»å‹ã€‚è¯¥ç±»å‹çš„ç»“æ„ä»**è¢«åˆ†é…åˆ°æ ˆç©ºé—´ä¸Š**ï¼Œå´æ˜¯å¼•ç”¨ç±»å‹çš„ã€‚å®ƒä¸»è¦ç”¨æ¥è§£å†³structä½œä¸ºå‚æ•°ä¼ é€’æ—¶ä¼šè¿›è¡Œæ•°æ®æ‹·è´çš„é—®é¢˜ï¼Œstructè¿‡å¤§ä¼šå¯¼è‡´æ€§èƒ½å¼€é”€ã€‚ref structä¸å…è®¸å®ç°æ¥å£ã€‚ï¼ˆå½“ç„¶ï¼Œå› ä¸ºæ˜¯structï¼Œä¹Ÿä¸å…è®¸ç»§æ‰¿ã€‚ï¼‰

ref structæœ‰å¾ˆå¤š**é™åˆ¶**ï¼š

- å®ƒä¸å¯ä»¥è¢«è£…ç®±ï¼Œå› è€Œæ— æ³•èµ‹å€¼ç»™objectå¯¹è±¡
- å®ƒæ— æ³•è¢«èµ‹å€¼ç»™æ¥å£ç±»å‹å¯¹è±¡ï¼Œå› ä¸ºå®ƒæ— æ³•å®ç°æ¥å£
- å®ƒä¸å¯ä»¥ä½œä¸ºä¸€èˆ¬ç±»æˆ–è€…ç»“æ„çš„æˆå‘˜ï¼ˆä½†å¯ä»¥ä½œä¸ºref structçš„æˆå‘˜ï¼‰
- å®ƒä¸å¯ä»¥ç”¨äºLambdaè¡¨è¾¾å¼æˆ–è€…æœ¬åœ°å‡½æ•°
- å®ƒä¸å¯ä»¥ç”¨äºå¼‚æ­¥æ–¹æ³•

æœ‰äº†ä¸Šé¢çš„ä¸€å †ï¼Œè‡ªç„¶å°±æœ‰äº†**readonly ref struct**ï¼Œè¡¨ç¤ºè¿™ä¸ªç»“æ„æ˜¯åˆ†é…åœ¨æ ˆä¸Šçš„ã€å¼•ç”¨ç±»å‹çš„ã€ä¸å¯ä¿®æ”¹çš„ã€‚

å¥½äº†ï¼Œåˆ°è¿™å„¿ä¸ºæ­¢ï¼ŒSpan\<T>çš„å‡†å¤‡å·¥ä½œéƒ½åšå¥½äº†ã€‚

### Span\<T>ã€ReadOnlySpan\<T>

Span\<T>ã€ReadOnlySpan\<T>æ˜¯æ–°å¢çš„åªè¯»å¼•ç”¨ç»“æ„ï¼ˆreadonly ref structï¼‰ã€‚å®ƒä»¬æ˜¯é’ˆå¯¹ä»»æ„è¿ç»­çš„å†…å­˜åŒºåŸŸçš„æŠ½è±¡ã€‚

å®ƒä»¬å¯ä»¥æŒ‡å‘å„ç§å†…å­˜åŒºåŸŸï¼š

- æŒ‡å‘æ‰˜ç®¡å†…å­˜ï¼ˆåˆ†é…äºå †ç©ºé—´ï¼‰æ•°ç»„çš„å…¨éƒ¨æˆ–è€…ä¸€éƒ¨åˆ†ï¼ˆåˆ‡ç‰‡ï¼‰
- æŒ‡å‘æ ˆç©ºé—´çš„æ•°ç»„ï¼ˆstackallocåˆ†é…çš„æ•°ç»„ï¼‰
- æŒ‡å‘åŸç”Ÿï¼ˆnativeï¼‰å†…å­˜åŒºåŸŸï¼ˆå¦‚`int*`æŒ‡é’ˆï¼‰

è®¾è®¡å®ƒä»¬çš„ç›®çš„æœ‰äºŒï¼š

1. å®ç°é«˜æ€§èƒ½çš„è¿ç»­å†…å­˜æ“ä½œâ€”â€”å®ƒä»¬çœŸçš„éå¸¸çš„å¿«ã€‚
2. ä¸ºæ”¯æŒåˆ‡ç‰‡ï¼ˆSliceï¼‰æä¾›åŸºç¡€ã€‚

Span\<T>ã€ReadOnlySpan\<T>å«Enumeratorï¼Œå¯ä»¥ç”¨ä½œ`foreach`ã€‚å®ƒä»¬ä¹Ÿæ”¯æŒä½¿ç”¨ç´¢å¼•å™¨ã€‚`foreach`å’Œç´¢å¼•å™¨è¿”å›çš„éƒ½æ˜¯å¯¹å…ƒç´ çš„å¼•ç”¨ã€‚å› è€Œå…è®¸ä½¿ç”¨`ref`å˜é‡æ¥æ”¶ï¼Œä»è€Œé¿å…å¤åˆ¶ã€‚

ReadOnlySpan\<T>ä¸Span\<T>çš„å”¯ä¸€ä¸åŒæ˜¯ï¼šé€šè¿‡`foreach`æˆ–è€…ç´¢å¼•å™¨è¿”å›çš„å¼•ç”¨å˜é‡ï¼ŒReadOnlySpan\<T>æ˜¯åªè¯»çš„ï¼Œè€ŒSpan\<T>æ˜¯å…è®¸ä¿®æ”¹çš„ã€‚ï¼ˆSpan\<T>è¿”å›çš„å˜é‡ç”¨`ref`ä¿®é¥°ï¼Œè€ŒReadOnlySpan\<T>çš„ç”¨`ref readonly`ä¿®é¥°ï¼‰

éœ€è¦æ³¨æ„ï¼Œå¦‚æœ`foreach`æ—¶æœªä½¿ç”¨`ref`å˜é‡æ¥æ”¶ï¼ŒåŒæ ·è·å–çš„ä¸æ˜¯å¼•ç”¨ï¼Œæ— æ³•å¯¹å®ƒä»¬è¿›è¡Œä¿®æ”¹ã€‚

Span\<T>ã€ReadOnlySpan\<T>å…è®¸ç›´æ¥ä½¿ç”¨`stackalloc`å…³é”®è¯è¿›è¡Œåˆ†é…ï¼Œä»è€Œä½¿å¾—`stackalloc`å…³é”®è¯ç°åœ¨å¯ä»¥ç”¨äºéunsafeçš„ä¸Šä¸‹æ–‡ä¸­ã€‚

```c#
Span<int> span = length <= 1024 ? stackalloc int[length] : new int [length];  //æŒ‡å‘æ ˆæˆ–è€…æ‰˜ç®¡å †ç©ºé—´ï¼Œä¸å¿…åœ¨unsafeä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨stackalloc
```

Span\<T>å’ŒReadOnlySpan\<T>ç±»å‹æ”¯æŒåˆ‡ç‰‡æ–¹æ³•ï¼š

```c#
Span<int> span2 = span.Slice(1, 3); //è·å–ä»åºå·1å¼€å§‹ï¼Œé•¿åº¦ä¸º3çš„åˆ‡ç‰‡
```

### æ–°å¢äº†å‡ ç§æ³›å‹çº¦æŸç±»å‹

- Enumï¼šç”¨äºçº¦æŸæ³›å‹ç±»å‹å¿…é¡»ä¸ºæšä¸¾
- Delegateï¼šç”¨äºçº¦æŸæ³›å‹ç±»å‹å¿…é¡»ä¸ºå§”æ‰˜
- MulticastDelegateï¼šç”¨äºçº¦æŸæ³›å‹ç±»å‹å¿…é¡»ä¸ºå¤šæ’­å§”æ‰˜

```c#
public class SampleClass1<T> where T : Enum {}
public class SampleClass2<T> where T : Delegate {}
public class SampleClass3<T> where T : MulticastDelegate {}
```

### å‘½åå‚æ•°ä¸å¿…è·Ÿåœ¨å°¾éƒ¨

è¿™æ˜¯å‘½åå‚æ•°çš„è¯­æ³•æ”¹è¿›ï¼Œä»å‰çš„å‘½åå‚æ•°å¿…é¡»è·Ÿéšåœ¨ä½ç½®å‚æ•°çš„å°¾éƒ¨ã€‚è¿˜æ˜¯ä½¿ç”¨ä¹‹å‰çš„ä¾‹å­ï¼š

```c#
public class Shop
{
    public void Sell(string userName, string goodsName, int amount) {...}
}

Shop shop = new shop();

shop.Sell("å¼ ä¸‰", goodsName: "æ¯›å·¾", amount: 10);  //ä»å‰çš„è¯­æ³•ã€‚userNameä½¿ç”¨ä½ç½®å‚æ•°ï¼Œå¦å¤–ä¸¤ä¸ªå‚æ•°ä½¿ç”¨å‘½åå‚æ•°ã€‚å‘½åå‚æ•°åªèƒ½æ˜¯å°¾éƒ¨çš„å‚æ•°ã€‚

shop.Sell(userName: "å¼ ä¸‰", "æ¯›å·¾", amount: 10);  //ç°åœ¨å¯ä»¥è¿™æ ·å†™ã€‚æ”¯æŒåœ¨ä»»æ„å‚æ•°ä¸Šä½¿ç”¨ä½ç½®å‚æ•°ï¼Œæˆ–è€…å‘½åå‚æ•°ã€‚æ­¤å¤„goodsNameä½¿ç”¨ä½ç½®å‚æ•°ã€‚
shop.Sell(amount: 10, "æ¯›å·¾", userName: "å¼ ä¸‰");  //è¿˜å¯ä»¥è¿™æ ·ç”¨ï¼Œä»ç„¶æ˜¯goodsNameä½¿ç”¨ä½ç½®å‚æ•°ï¼Œå…¶ä½™ä½¿ç”¨å‘½åå‚æ•°
```

### C# 7.2çš„å…¶ä»–æ”¹è¿›

- **`private protected`è®¿é—®ä¿®é¥°ç¬¦**ï¼šè¡¨ç¤ºprotect and internalï¼Œè¿™ä¸ªå·²ç»åœ¨C# 1.0çš„å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ä¸­ä»‹ç»è¿‡äº†ã€‚
- **æ•°å€¼æ–‡å­—ä¸­çš„å‰å¯¼ä¸‹åˆ’çº¿**ï¼šC#7.0æ–°å¢çš„æ•°å­—ä¸‹åˆ’çº¿ï¼Œä¸æ”¯æŒç›´æ¥ç´§è·Ÿåœ¨0xæˆ–è€…0bçš„åé¢ï¼Œä¾‹å¦‚`0x_8f7d`åœ¨ä¹‹å‰æ˜¯éæ³•çš„ï¼Œä½†æ˜¯ç°åœ¨åˆæ³•äº†ã€‚
- **æ¡ä»¶refè¡¨è¾¾å¼**ï¼šrefèµ‹å€¼è¯­å¥ï¼Œç°åœ¨å¯ä»¥æ”¯æŒæ¡ä»¶è¿ç®—ç¬¦`?:`ã€‚ä¾‹å¦‚ï¼š`ref var r = ref (arr != null ? ref arr[0] : ref otherArr[0]);`ã€‚æ³¨æ„åœ¨æ¡ä»¶è¡¨è¾¾å¼è¿ç®—ç»“æœä¸Šè¿˜è¦åŠ `ref`ã€‚

## C# 7.3çš„æ”¹è¿›

### å…ƒç»„çš„`==`å’Œ`!=`æ”¯æŒ

å…ƒç»„ç°åœ¨å¯ä»¥ç›´æ¥ç”¨`==`å’Œ`!=`è¿›è¡Œæ¯”è¾ƒäº†ã€‚

å¯¹äºå…ƒç»„t1å’Œt2ï¼š

- `t1==t2`ï¼Œç›¸å½“äº`t1.Item1 == t2.Item1 && t1.Item2 == t2.Item2 && ...`
- `t1!=t2`ï¼Œç›¸å½“äº`t1.Item1 != t2.Item1 || t1.Item2 != t2.Item2 || ...`

åŒ`&&`å’Œ`||`çš„ç‰¹ç‚¹ä¸€æ ·ï¼Œéƒ½æ˜¯çŸ­è·¯æ–¹å¼ã€‚ä¸Šè¿°`==`æ¯”è¾ƒä¸­ï¼Œä»å·¦åˆ°å³åªè¦æœ‰ä¸€é¡¹ä¸ç›¸ç­‰è¡¨è¾¾å¼å°±ä¼šè¿”å›falseï¼Œä»è€Œè·³è¿‡åé¢çš„æ¯”è¾ƒï¼›ä¸Šè¿°`!=`æ¯”è¾ƒä¸­ï¼Œåªè¦æœ‰ä¸€é¡¹ç›¸ç­‰å°±ä¼šè¿”å›falseï¼Œä»è€Œè·³è¿‡åé¢çš„æ¯”è¾ƒã€‚

æ³¨æ„ï¼Œ`==`å’Œ`!=`æ¯”è¾ƒéƒ½ä¸ä¼šè€ƒè™‘å­—æ®µåï¼Œä»…ä»…è€ƒè™‘é¡ºåºã€‚

### é’ˆå¯¹outå˜é‡å£°æ˜çš„æ”¹è¿›

å¯¹C#7.0å¼•å…¥çš„å…è®¸åœ¨è°ƒç”¨å«outå‚æ•°æ–¹æ³•æ—¶åŒæ­¥å£°æ˜å˜é‡çš„è¯­æ³•è¿›è¡Œäº†æ‰©å……ã€‚å…è®¸ä¸€äº›ä¹‹å‰ä¸å…è®¸ä½¿ç”¨è¯¥è¯­æ³•çš„åœ°æ–¹ä½¿ç”¨è¯¥è¯­æ³•ï¼š

- å¯ä»¥ç”¨åœ¨å­—æ®µã€å±æ€§çš„åˆå§‹åŒ–è¡¨è¾¾å¼ä¸­ä½¿ç”¨
- å¯ä»¥åœ¨æ„é€ å™¨ä¸²è”ä¸­ä½¿ç”¨
- å¯ä»¥åœ¨æŸ¥è¯¢å­å¥ä¸­ä½¿ç”¨

ä¸¾ä¾‹ï¼š

```c#
public class A 
{
    public A(out int a) { a = 1; }
}
public class B : A
{
    public A A { get; set; } = new A(out var a);   //åˆå§‹åŒ–è¡¨è¾¾å¼æ”¯æŒoutå˜é‡å£°æ˜
    public B()
        :base(out var a)    //æ„é€ å™¨ä¸²è”æ”¯æŒoutå˜é‡å£°æ˜
    {
        Console.WriteLine(a);
    }
}
```

å½“ç„¶ï¼Œè¿™å¯èƒ½æ²¡å•¥ç”¨ã€‚

### stackallocåˆå§‹åŒ–å™¨

stackallocç°åœ¨æ”¯æŒåˆå§‹åŒ–å™¨ï¼ˆInitializerï¼‰è¯­æ³•ï¼š

```c#
Span<int> span1 = stackalloc int[4];  //OK
Span<int> span2 = stackalloc int[4] { 1, 2, 3, 4 };  //OK
Span<int> span3 = stackalloc int[] { 1, 2, 3, 4 };  //OK
Span<int> span4 = stackalloc[] { 1, 2, 3, 4 };  //OKï¼ŒC# 8.0å¼•å…¥
```

### ç‰¹æ€§å¯ä½œç”¨äºè‡ªåŠ¨å±æ€§çš„å­—æ®µ

ç‰¹æ€§ç°åœ¨å¯ä»¥æŒ‡å®šä½œç”¨äºç”¨äºå®ç°è‡ªåŠ¨å±æ€§çš„æ”¯æ’‘å­—æ®µã€‚æ–¹æ³•æ˜¯åœ¨å±æ€§å‰ä½¿ç”¨ç‰¹æ€§æ—¶ï¼ŒæŒ‡æ˜ä½œç”¨åŸŸä¸º`field`ã€‚

```c#
public class Some
{
    [field:NotNull]  //ä½œç”¨äºå±æ€§èƒŒåçš„å­—æ®µ
    public string Name { get; set; }
}
```

### å«inå‚æ•°çš„æ–¹æ³•çš„æ”¹è¿›

å®šä¹‰å«inå’Œä¸å«inå‚æ•°çš„åŒåæ–¹æ³•ä¸ä¼šå¼•èµ·äºŒä¹‰æ€§äº†ï¼Œå¯ä»¥å¹¶å­˜ã€‚ä¸è¿‡è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨inæ–¹æ³•å¿…é¡»å¸¦ä¸Š`in`å…³é”®è¯ã€‚

```c#
//ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¹¶å­˜
public void Some(int x){}
public void Some(in int x){}

int x = 1;
Some(x);  //è¿™å°†è°ƒç”¨ç¬¬ä¸€ä¸ªæ–¹æ³•
Some(in x); //è¿™å°†è°ƒç”¨ç¬¬äºŒä¸ªæ–¹æ³•
```

### C# 7.3çš„å…¶ä»–æ”¹è¿›

- **refå±€éƒ¨å˜é‡å¯å†åˆ†é…**ï¼šrefçš„å˜é‡ä¹‹å‰åªèƒ½èµ‹å€¼ä¸€æ¬¡ï¼Œç°åœ¨å¯ä»¥åœ¨èµ‹å€¼åé‡æ–°è¢«èµ‹å€¼äº†ã€‚
- **æ³›å‹çº¦æŸåˆæ–°å¢äº†ä¸€ç§ï¼š`unmanaged`**ã€‚çº¦æŸä¸ºéæ‰˜ç®¡ç±»å‹ï¼ˆå€¼ç±»å‹ï¼Œå¹¶ä¸”å¦‚æœæ˜¯structåˆ™æ¯ä¸ªå­—æ®µéƒ½ä¸èƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¦‚æœæœ‰structåµŒå¥—ï¼ŒåµŒå¥—çš„structä¹Ÿæ˜¯ï¼‰ã€‚ä¾‹å¦‚ï¼š`public void Test<T>(T arg) where T : unmanaged {}`
- **åŸºäºæ¨¡å¼çš„fixedè¯­å¥**ï¼šä»å‰çš„`fixed`åªèƒ½ç”¨æ¥å›ºå®šæ•°ç»„æˆ–è€…stringç±»å‹ã€‚ç”±äºç°åœ¨æ–°å¢äº†Span\<T>ç­‰ç±»å‹ï¼Œå¦‚æœè¿˜æŒ‰ç…§ä¹‹å‰çš„æ¥åˆ™æ— æ³•ç”¨`fixed`å›ºå®šã€‚ç°åœ¨ï¼Œåªè¦ä½ çš„structæ‹¥æœ‰ä¸€ä¸ªæ–¹æ³•ï¼š`ref [readonly] T GetPinnableReference()`ï¼Œå¹¶ä¸”å…¶ä¸­`T`æ˜¯éæ‰˜ç®¡ç±»å‹çš„ã€‚è¯¥å¼•ç”¨ç±»å‹çš„structå°±å¯ä»¥ç›´æ¥ä½¿ç”¨fixedè¯­å¥å›ºå®šã€‚
- **è®¿é—®fixedæ•°ç»„çš„ç´¢å¼•å¯ä»¥ä¸ç”¨fixed**ï¼šä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼Œunsafeçš„structå¯ä»¥å£°æ˜fixedçš„æ•°ç»„ã€‚ç°åœ¨å¦‚æœæŸä¸ªæŒ‡é’ˆæƒ³è¦æŒ‡å‘è¯¥æ•°ç»„çš„æŸä¸ªå…ƒç´ ï¼Œå¯ä»¥ä¸ç”¨fixedå—å›ºå®šï¼Œä½†ä»ç„¶éœ€è¦ä½¿ç”¨unsafeä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚`unsafe struct S`åŒ…å«fixedçš„æ•°ç»„å­—æ®µ`public fixed int FixedField[100];`ï¼Œåˆ™`int* ptr = s.FixedField[5];`è¯­å¥ä¸å¿…ä½¿ç”¨fixedå—ã€‚
- **å¯¹æ–¹æ³•é‡è½½ï¼ˆOverloadï¼‰çš„ç¼–è¯‘å™¨è§£ææ”¹è¿›**ï¼šå¯¹æ–¹æ³•é‡è½½åœ¨å„ç§æƒ…å†µä¸‹ç¼–è¯‘å™¨å¦‚ä½•è§£æåšå‡ºäº†æ”¹è¿›ã€‚è¿™ä½¿å¾—äºŒä¹‰æ€§é”™è¯¯å˜å¾—æ›´å°‘å‘ç”Ÿã€‚è§„åˆ™æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ã€‚

# C# 8.0 â€”â€” å½“è¯­æ³•å‡çº§æˆä¸ºæ—¥å¸¸

C# 8.0æ”¯æŒä»¥ä¸‹è¯­æ³•ï¼š

## readonlyæˆå‘˜

é’ˆå¯¹structï¼Œç°åœ¨æ”¯æŒç»™å±æ€§ã€æ–¹æ³•è¿”å›å€¼æ·»åŠ `readonly`ä¿®é¥°ç¬¦ã€‚è¡¨æ˜å±æ€§ã€æ–¹æ³•ä¸ä¼šä¿®æ”¹ä»»ä½•å…¶ä»–å±æ€§ã€å­—æ®µçš„å€¼ã€‚

```c#
public struct Sample
{
    private string name;
    public readonly string Name  //OKï¼Œè¯¥å±æ€§ä¸ä¼šä¿®æ”¹ä»»ä½•å­—æ®µã€å±æ€§
    {
        get
        {
            return name;
        }
    }

    public readonly void Set()  //NOT OK
    {
        name = "å¼ ä¸‰";  //ç¼–è¯‘å™¨æŠ¥é”™ï¼Œreadonlyæ–¹æ³•ä¸å…è®¸ä¿®æ”¹æˆå‘˜
    }
}
```

ç‰¹åˆ«æ³¨æ„ï¼šreadonlyæˆå‘˜åªå¯ç”¨äºstructï¼Œä¸æ”¯æŒç”¨äºclassã€‚

## æ¥å£çš„é»˜è®¤å®ç°

åœ¨ä»å‰ï¼Œæ¥å£å†…çš„æ–¹æ³•ï¼Œä¸æ”¯æŒæ·»åŠ å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼ˆå¦‚`public`ï¼Œ`private`ï¼‰ï¼Œä¸æ”¯æŒå£°æ˜ä¸º`static`ï¼Œä¹Ÿä¸æ”¯æŒæä¾›é»˜è®¤çš„å®ç°ã€‚

ç°åœ¨è¿™äº›é™åˆ¶éƒ½æ²¡æœ‰äº†ã€‚æ¥å£çš„æ–¹æ³•å¯ä»¥æŒ‡å®šä¿®é¥°ç¬¦ï¼Œè¿˜å¯ä»¥æä¾›é»˜è®¤å®ç°ã€‚

å¯¹äºå®ç°æ¥å£çš„ç±»ï¼Œå¦‚æœæ¥å£ä¸­æœ‰æ–¹æ³•çš„é»˜è®¤å®ç°ï¼Œè¯¥ç±»å¯ä»¥ä¸å¿…å†æä¾›æ­¤æ–¹æ³•çš„å®ç°ï¼Œå°†ç»§æ‰¿æ¥å£çš„å®ç°ã€‚

> æ—¶éš”è¿™ä¹ˆä¹…ï¼Œç»ˆäºåˆå¯ä»¥å¯¹æ¯”äº†ã€‚æ—©åœ¨Java 8ï¼ˆ2014å¹´ï¼‰æ—¶ï¼Œä¸ºäº†å¼•å…¥å‡½æ•°å¼æ¥å£ï¼Œä»¥ä¾¿æ”¯æŒStreamç¼–ç¨‹ï¼Œå°±å·²ç»å¼•å…¥äº†æ¥å£çš„é»˜è®¤å®ç°ã€‚è€ŒC#åˆ™è¶³è¶³ç­‰åˆ°C# 8.0ï¼ˆ2019å¹´ï¼‰æ‰å¼•å…¥ã€‚è¿™æ¯”Javaæ™šäº†5å¹´ã€‚ä¸è¿‡Java 8çš„æ¥å£æ–¹æ³•ä¸æ”¯æŒprivateï¼Œè¦åˆ°Java 9ä»¥åæ‰æ”¯æŒã€‚

## C# 8.0çš„æ¨¡å¼åŒ¹é…

æ¿€åŠ¨äººå¿ƒçš„æ—¶åˆ»åˆ°äº†ã€‚C# 8.0å¯¹æ¨¡å¼åŒ¹é…è¿›è¡Œäº†å¢å¼ºï¼Œä¸è¿‡å®ƒä»ç„¶ä¸æ˜¯å®Œå…¨ä½“ã€‚åœ¨C# 9.0ä¼šå†æ¬¡å¢å¼ºã€‚C# 8.0çš„æ¨¡å¼åŒ¹é…æ”¯æŒï¼š

### switchè¡¨è¾¾å¼

switchè¡¨è¾¾å¼å¯ä»¥è¯´æ˜¯switchè¯­å¥å—çš„è¡¨è¾¾å¼å½¢å¼ã€‚å®ƒå…·æœ‰è¿”å›å€¼ã€‚

switchè¡¨è¾¾å¼æ ¹æ®æ¨¡å¼åŒ¹é…çš„ç»“æœï¼Œä»ä¸åŒåˆ†æ”¯è·¯å¾„è¿”å›ä¸åŒå†…å®¹ï¼Œæ¯æ¡è·¯å¾„ä¸Šä¹Ÿéƒ½æ˜¯è¡¨è¾¾å¼ï¼Œä¸”è¡¨è¾¾å¼çš„å€¼éƒ½æ˜¯åŒä¸€ç§ç±»å‹çš„ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªswitchè¡¨è¾¾å¼çš„è¿”å›ç±»å‹ã€‚åˆ†æ”¯çš„è¡¨è¾¾å¼å¯ä»¥è¿”å›voidï¼Œæ­¤æ—¶æ•´ä¸ªswitchè¡¨è¾¾å¼ä¹Ÿä¸ºvoidï¼Œä¸èƒ½èµ‹å€¼ç»™å˜é‡ã€‚

switchè¡¨è¾¾å¼çš„è¯­æ³•è¾ƒswitchè¯­å¥æœ‰æ‰€è°ƒæ•´ï¼šå°†å¾…åˆ¤æ–­çš„è¡¨è¾¾å¼å‰ç½®ï¼Œå¹¶ä¸”åˆ å»åŸæ¥switchçš„åœ†æ‹¬å·ã€‚ç´§éšå…¶åçš„èŠ±æ‹¬å·ä¸­ä¸å†æœ‰caseè¯­å¥ï¼Œå–è€Œä»£ä¹‹æ˜¯`æ¨¡å¼=>è¡¨è¾¾å¼`çš„å½¢å¼ï¼Œå¹¶ç”¨é€—å·åˆ†éš”ã€‚

çœ‹å¦‚ä¸‹ä¾‹å­ï¼š

```c#
Animal animal = new Cat();
var name = animal switch
{
    Cat cat => "çŒ«çŒ«",
    Dog dog => dog.Name,
    var anything => "å•¥å•Š", //è·Ÿenumã€åˆå§‹åŒ–å™¨ä¸€æ ·ï¼Œè¿™é‡Œçš„é€—å·ä¹Ÿæ˜¯å¯åˆ å¯ä¸åˆ 
};
```

ä¸Šä¾‹ä¸­ï¼Œä½¿ç”¨äº†ä¹‹å‰æåˆ°çš„å£°æ˜æ¨¡å¼ã€varæ¨¡å¼ã€‚

switchè¡¨è¾¾å¼ä¸­ä½¿ç”¨å£°æ˜æ¨¡å¼ã€varæ¨¡å¼æ—¶ï¼Œå¯ä»¥ç»“åˆå¼ƒå…ƒï¼Œä¸¢å¼ƒè¯¥å£°æ˜ï¼š

```c#
var isStr = obj switch
{
    string _ => true,
    var _ => false
};
```

ä¸Šè¿°ä¾‹å­ä¸­ï¼Œvaræ¨¡å¼ç”¨æ¥æ¥æ”¶æ‰€æœ‰å…¶ä»–æƒ…å†µï¼Œä¿è¯äº†è¡¨è¾¾å¼è¦†ç›–æ‰€æœ‰å¯èƒ½è·¯å¾„ã€‚ä¸è¿‡ï¼Œswitchè¡¨è¾¾å¼æœ‰ä¸ªæœ‰å‘çš„è®¾å®šï¼šå®šä¹‰è¡¨è¾¾å¼æ—¶ä¸å¿…è¦†ç›–æ‰€æœ‰åˆ†æ”¯æƒ…å†µã€‚å¦‚æœä½ çš„åˆ†æ”¯æ— æ³•è¦†ç›–æ‰€æœ‰æƒ…å†µï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºè­¦å‘Šï¼Œä½†ä¸ä¼šæŠ¥é”™ã€‚ä½†æ˜¯è¿™æ ·åšæ˜¯æœ‰é£é™©çš„ï¼šswtichè¡¨è¾¾å¼çš„å€¼å¦‚æœèµ‹å€¼ç»™å˜é‡ï¼Œåœ¨è¿è¡Œæ—¶å¦‚æœæ‰¾ä¸åˆ°åˆ†æ”¯å¯¹åº”ï¼Œä¼šåœ¨æŠ›å‡º`SwitchExpressionException`å¼‚å¸¸ã€‚

```c#
object obj = 1;
var isStr = obj switch //æœªèƒ½è¦†ç›–æ‰€æœ‰æƒ…å†µï¼Œç¼–è¯‘å™¨ç»™å‡ºè­¦å‘Š
{
    string _ => true,  
};   //è¿™å°†å¯¼è‡´æŠ›å‡ºå¼‚å¸¸

```

switchè¡¨è¾¾å¼ä¹ŸåŒæ ·æ”¯æŒwhenå­å¥ï¼š

```c#
public bool IsHttp(string url) => url switch    //åœ¨æ­¤ä¾‹å­ä¸­ï¼Œæ–¹æ³•ä½¿ç”¨äº†è¡¨è¾¾å¼ä¸»ä½“ï¼Œè€Œä¸»ä½“æ­£æ˜¯swtichè¡¨è¾¾å¼
{
    string httpUrl when httpUrl.StartsWith("http://") => false,
    string httpsUrl when httpsUrl.StartsWith("https://") => true,
    var other => throw new Exception("ä¸æ˜¯HTTP(s)åè®®çš„åœ°å€") //è¿™é‡Œä½¿ç”¨äº†throwè¡¨è¾¾å¼
};
```

å¾ˆæ˜¾ç„¶ï¼Œå› ä¸ºswitchè¡¨è¾¾å¼æ˜¯è¡¨è¾¾å¼ï¼Œè€Œå®ƒçš„åˆ†æ”¯ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼Œå› è€Œï¼Œswitchè¡¨è¾¾å¼æ˜¯å¯ä»¥åµŒå¥—çš„ï¼š

```c#
var areYouOk = obj1 switch //R U OK? 
{
    string _ => obj2 switch
    { 
        Cat _ => obj3 switch
        {
            var _ => obj4 switch
            {
                var _ => true
            }
        },
    },  
};
//è¿™ä¸ªè¯¥æ­»çš„è¡¨è¾¾å¼ä¼šåœ¨obj1ä¸ºstringï¼Œobj2ä¸ºCatçš„æƒ…å†µä¸‹è¿”å›trueï¼Œå…¶ä»–æƒ…å†µä¸‹æŠ›å‡ºå¼‚å¸¸ã€‚
```

å®é™…é¡¹ç›®ä¸­å»ºè®®ä¸è¦è¿™ä¹ˆå¹²ã€‚

> Javaåœ¨12å¼•å…¥äº†å¢å¼ºswitchçš„é¢„è§ˆç‰ˆï¼›ååœ¨13æ”¯æŒäº†switchçš„è¿”å›å€¼ä»è€Œè¿›åŒ–ä¸ºswitchè¡¨è¾¾å¼ï¼ŒåŒæ—¶æ”¯æŒåœ¨è¯­å¥å—å†…é€šè¿‡`yield`è¿”å›åˆ†æ”¯ç»“æœï¼›æœ€ç»ˆåœ¨14æ”¾å‡ºæ­£å¼ç‰ˆã€‚ä½†æ˜¯ï¼Œæ­¤æ—¶switchè¡¨è¾¾å¼ä»ä¸æ”¯æŒæ¨¡å¼åŒ¹é…ã€‚

> Javaçš„å¢å¼ºswitch/switchè¡¨è¾¾å¼å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š
>
> - ä¸å°†switchç»“æœèµ‹å€¼ç»™å˜é‡æ—¶ï¼Œå®ƒæ˜¯å¢å¼ºswitchã€‚åˆ†æ”¯å†…å¿…é¡»æ˜¯è¯­å¥ã€‚
> - å°†switchçš„ç»“æœèµ‹å€¼ç»™å˜é‡æ—¶ï¼Œå®ƒæ˜¯switchè¡¨è¾¾å¼ï¼Œåˆ†æ”¯å†…å¿…é¡»æ˜¯è¡¨è¾¾å¼ï¼Œæˆ–è€…ä½¿ç”¨yieldè¿”å›å€¼çš„è¯­å¥å—ã€‚

> Javaçš„å¢å¼ºswitch/switchè¡¨è¾¾å¼è¯­æ³•è·ŸC#çš„ä¹Ÿæ˜¯æœ‰äº›ä¸åŒçš„ï¼Œå®ƒæ›´åƒåŸå§‹çš„switchå—ï¼š
>
> - å®ƒçš„è¯­åºè·ŸåŸæ¥switchè¯­å¥åŸºæœ¬ä¸€è‡´ï¼š`switch`å…³é”®è¯åœ¨å‰ï¼Œå¾…æ£€æµ‹è¡¨è¾¾å¼åœ¨åï¼Œå¹¶ä¸”ç”¨åœ†æ‹¬å·åŒ…è£¹ã€‚åˆ†æ”¯ä½¿ç”¨`case`å…³é”®è¯ã€‚é»˜è®¤åˆ†æ”¯ä½¿ç”¨`default`å…³é”®è¯ã€‚
> - å®ƒçš„åˆ†æ”¯ï¼Œä½¿ç”¨`->`ç¬¦å·ï¼Œè€Œä¸æ˜¯`=>`ã€‚
> - åˆ†æ”¯ç»“æŸæ—¶ç”¨åˆ†å·ï¼Œè¿™æ„å‘³ç€åˆ†æ”¯ä¸»ä½“æ˜¯è¯­å¥ã€‚è¿™ä¹Ÿä¸ºæ”¯æŒä»£ç å—æä¾›äº†æ–¹ä¾¿ã€‚
> - æ¯ä¸ªåˆ†æ”¯æ˜¯å¯ä»¥æ”¯æŒè¯­å¥å—çš„ï¼Œæ–¹æ³•æ˜¯`->`åé¢ä½¿ç”¨èŠ±æ‹¬å·`{}`ï¼Œå¯ä»¥åœ¨èŠ±æ‹¬å·å†…ä¹¦å†™å¤šè¡Œè¯­å¥ã€‚ä½œä¸ºè¡¨è¾¾å¼æ—¶ï¼Œå¯ä»¥åœ¨åˆé€‚çš„æ—¶æœºä½¿ç”¨`yield å€¼`è¯­å¥æ¥è¿”å›è¯¥åˆ†æ”¯çš„å€¼ã€‚
> - switchä½œä¸ºè¡¨è¾¾å¼æ—¶ï¼Œè¦æ±‚å¿…é¡»æœ‰`default`åˆ†æ”¯ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚è¿™ç‚¹æ¯”C#è¦ä¸¥æ ¼ã€‚

> ```java
> //==Java==
> //ä½œä¸ºå¢å¼ºswitch
> switch (exp) {
>     case 1 -> System.out.println("å‘½ä¸­"); //åˆ†æ”¯å¿…é¡»æ˜¯è¯­å¥
> }  //å¯ä»¥æ²¡æœ‰defaultåˆ†æ”¯
> 
> //ä½œä¸ºswitchè¡¨è¾¾å¼
> boolean rsl = switch (exp) {
>     case 1 -> true;      //åˆ†æ”¯æ˜¯è¡¨è¾¾å¼ï¼Œ
>     case 2 -> false;     //ä½†æ˜¯ä»ç„¶ä½¿ç”¨åˆ†å·
>     case 3 -> {         //å¯ä»¥æ”¯æŒè¯­å¥å—
>         if (System.currentTimeMillis() % 2 == 0) {
>             yield true;   //è¯­å¥å—ä¸­é€šè¿‡yieldè¿”å›è¯¥åˆ†æ”¯çš„å€¼
>         }
>         else {
>             yield false;  //è¯­å¥å—å†…å¦‚æœä¹Ÿæœ‰åˆ†æ”¯ï¼Œæ‰€æœ‰åˆ†æ”¯éƒ½å¿…é¡»æœ‰yield
>         }
>     }
>     default -> false;  //å¿…é¡»æœ‰defaultåˆ†æ”¯ï¼Œå¦åˆ™ç¼–è¯‘å™¨æŠ¥é”™
> };
> ```

> åˆ°äº†Java 17ï¼ŒåŠ å…¥äº†switchè¯­å¥å’Œswitchè¡¨è¾¾å¼çš„æ¨¡å¼åŒ¹é…é¢„è§ˆç‰ˆï¼Œä½†ä»ç„¶éæ­£å¼è¯­æ³•ã€‚å› è€Œæˆªæ­¢è‡³ä»Šæ—¥ï¼ŒJavaä»æ²¡æœ‰æ­£å¼æ”¯æŒswitchçš„æ¨¡å¼åŒ¹é…ã€‚

### å¼ƒå…ƒæ¨¡å¼

æ–°å¢äº†ä¸€ç§æ¨¡å¼ï¼Œå«å¼ƒå…ƒæ¨¡å¼ã€‚å¯¹äºswitchè¡¨è¾¾å¼ï¼Œå®ƒåŒ¹é…ä»»ä½•æƒ…å†µï¼Œç›¸å½“äºswitchå—ä¸­çš„defaultã€‚

è¿˜æ˜¯ä¹‹å‰çš„ä¾‹å­ï¼Œå¯ä»¥å†™æˆï¼š

```c#
var isHttps = url switch
{
    string httpUrl when httpUrl.StartsWith("http://") => false,
    string httpsUrl when httpsUrl.StartsWith("https://") => true,
    _ => throw new Exception("ä¸æ˜¯HTTP(s)åè®®çš„åœ°å€") //è¿™é‡Œä½¿ç”¨äº†throwè¡¨è¾¾å¼
};
```

varæ¨¡å¼å’Œå¼ƒå…ƒæ¨¡å¼éƒ½å¯ä»¥åŒ¹é…ä»»ä½•æƒ…å†µï¼ŒåŒºåˆ«æ˜¯ï¼šå¼ƒå…ƒæ¨¡å¼æ— æ³•è·å–åŒ¹é…å€¼ï¼Œè€Œvaræ¨¡å¼å¯ä»¥ã€‚

### å±æ€§æ¨¡å¼

ç°åœ¨æ”¯æŒå¯¹å±æ€§çš„å€¼è¿›è¡ŒåŒ¹é…ã€‚

```c#
Cat cat = new Cat();
if (cat is { Name: "å–µå–µ", Age: 13, Hobby: "çˆ¬é«˜ä¸Šä½" })  //åŒ¹é…å¯¹åº”çš„å±æ€§å€¼ç›¸ç­‰
{
}
```

å¦‚æœæœ‰åµŒå¥—å‘¢ï¼Ÿ

```c#
Cat cat = new Cat();
if (cat is { Name: "å–µå–µ", Looks: { Shape: "Fat", Color: Color.White } })  //ç±»çš„åµŒå¥—
{
}
```

### å…ƒç»„æ¨¡å¼

å¯¹äºå…ƒç»„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…ï¼š

```c#
var value = (a, b) switch
{
    ("a1", "b1") => 1,
    ("a2", "b1") => 2,
    ("a1", "b2") => 3,
    ("a2", "b2") => 4,
    (_, "b3") => 5,
    (_, _) => -1
};
```

### ä½ç½®æ¨¡å¼

ä½ç½®æ¨¡å¼ç±»ä¼¼äºå…ƒç»„æ¨¡å¼ï¼Œå¯¹äºæ”¯æŒè§£æ„çš„ç±»ï¼Œå¯ä»¥ç”¨ç±»ä¼¼å…ƒç»„æ¨¡å¼çš„æ–¹å¼è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼š

```c#
public class Rect
{
    public double LeftTop{ get; set; }
    public double LeftBottom{ get; set; }
    public double RightTop{ get; set; }
    public double RightBottom{ get; set; }

    public void Deconstruct(out double leftTop, out double leftBottom, out double rightTop, out double rightBottom)
    {
        leftTop = LeftTop;
        leftBottom = LeftBottom;
        rightTop = RightBottom;
        rightBottom = RightBottom;
    }
}

var test = rect switch
{
    (1.0, 2.0, 3.0, 4.0) => true,
    (5.0, 6.0, 7.0, 8.0) => false,
    _ => throw new Exception()
};
```

## usingå£°æ˜

ä½¿ç”¨usingè¿›è¡Œè‡ªåŠ¨é‡Šæ”¾çš„è¯­æ³•ï¼Œç°åœ¨å¤šäº†ä¸€ç§ã€‚usingå¯ä»¥ç›´æ¥ä½œä¸ºä¸€æ¡è¯­å¥ï¼Œä¸ç”¨å¼€å¯ä¸€ä¸ªä»£ç å—äº†ã€‚ä½¿ç”¨usingå£°æ˜æ—¶ï¼Œå¿…é¡»åŒæ­¥å£°æ˜å˜é‡ï¼ŒåŒæ—¶éœ€è¦å»é™¤usingåé¢çš„åœ†æ‹¬å·ï¼Œä¸å†éœ€è¦èŠ±æ‹¬å·ï¼Œä½†æ˜¯éœ€è¦æ·»åŠ è¯­å¥ç»“æŸç¬¦å·`;`ã€‚å¦‚æœä½¿ç”¨usingå£°æ˜ï¼Œåˆ™ä¼šåœ¨å½“å‰è¯­å¥æ‰€åœ¨ä»£ç å—ç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾ï¼Œå£°æ˜çš„å˜é‡çš„æœ‰æ•ˆæœŸä¹Ÿä¼šæŒç»­åˆ°å½“å‰ä»£ç å—ç»“æŸã€‚

```c#
public void DoWithUsing()
{
    using var file = File.Open("/root/1.txt", FileMode.Open);  //æ­¤å¤„ä½¿ç”¨usingå£°æ˜ï¼Œfileå˜é‡çš„ç”Ÿå­˜å‘¨æœŸä¸ºæ–¹æ³•ä½“å†…ï¼Œä¸”æ–¹æ³•ç»“æŸæ—¶ä¼šè‡ªåŠ¨é‡Šæ”¾fileã€‚ç”¨æ­¤è¯­æ³•å¿…é¡»åŒæ­¥å£°æ˜å˜é‡ï¼Œä¸èƒ½ä½¿ç”¨å·²æœ‰å˜é‡ã€‚

    //çœç•¥
}
```

ç”±äºæ­¤è¯­æ³•ï¼Œç°åœ¨å¤šé‡usingå¯ä»¥ä¸å¿…å‡ºç°åµŒå¥—äº†ï¼š

```c#
public int Compute()
{
    using var a = new A();
    using var b = new B();
    using var c = new C();
    return a.Number + b.Number + c.Number;  
}  //æ–¹æ³•ä½“ç»“æŸæ—¶ä¼šè‡ªåŠ¨é‡Šæ”¾aã€bã€c
```

usingå£°æ˜å¯ä»¥æœ‰æ•ˆé¿å…å¤šä¸ªusingè¯­å¥å—çš„åµŒå¥—ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚

## å¯nullå¼•ç”¨ç±»å‹

è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ›´æ–°ã€‚å®ƒçš„å‡ºç°ï¼Œæ˜¯ä¸ºäº†å½»åº•è§£å†³NullReferenceExcpetionçš„é—®é¢˜ã€‚

ç°åœ¨å¼•ç”¨ç±»å‹ä¹Ÿæ”¯æŒåœ¨ç±»å‹ååé¢åŠ ?äº†ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¾‹å¦‚`string?`ï¼Œæ˜¯ç‹¬ç‰¹çš„â€œå¯nullå¼•ç”¨ç±»å‹â€è¯­æ³•ï¼Œå®ƒè·Ÿå€¼ç±»å‹çš„`int?`ç­‰åŒäº`Nullable<int>`ä¸åŒï¼Œå¹¶ä¸å­˜åœ¨`Nullable<string>`è¿™ç§ç±»å‹ã€‚

å¯ç”¨äº†å¯nullå¼•ç”¨ç±»å‹çš„ä»£ç è¢«ç§°ä¸ºå¤„äº**å¯nullä¸Šä¸‹æ–‡**ï¼ˆNullable Contextï¼‰ä¸­ã€‚å¤„äºå¯nullä¸Šä¸‹æ–‡ä¸­æ—¶ï¼š

- å¼•ç”¨ç±»å‹`T`çš„å˜é‡å¿…é¡»ç”¨é`null`å€¼è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¸èƒ½èµ‹å€¼ä¸ºå¯èƒ½ä¸º`null`çš„è¡¨è¾¾å¼ã€‚å¦åˆ™ä¼šäº§ç”Ÿç¼–è¯‘å™¨è­¦å‘Šã€‚
- å¼•ç”¨ç±»å‹`T?`çš„å˜é‡å¯ä»¥ç”¨`null`è¿›è¡Œåˆå§‹åŒ–ï¼Œä¹Ÿå¯ä»¥è¢«èµ‹å€¼ä¸ºå¯èƒ½ä¸º`null`çš„è¡¨è¾¾å¼ã€‚ä½†åœ¨å–æ¶ˆå¼•ç”¨ï¼ˆDereferenceï¼Œå³å°†`T?`èµ‹å€¼ç»™`T`ï¼‰ä¹‹å‰ï¼Œå¿…é¡»è¿›è¡Œ`null`æ£€æŸ¥ã€‚å¦åˆ™å°†ç”Ÿæˆç¼–è¯‘å™¨è­¦å‘Šã€‚
- å¯ä»¥ä½¿ç”¨**nullå®¹å¿è¿ç®—ç¬¦**`!`æ¥é˜»æ­¢ç¼–è¯‘å™¨ç”Ÿæˆè­¦å‘Šï¼Œç¼–è¯‘å™¨ä¼šè®¤ä¸ºä½¿ç”¨äº†è¯¥è¿ç®—ç¬¦çš„è¡¨è¾¾å¼å¿…å®šä¸ä¸º`null`ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯nullä¸Šä¸‹æ–‡å¼€å¯çš„æ˜¯ä¸€ç³»åˆ—ç¼–è¯‘å™¨è­¦å‘Šï¼Œä½†æ˜¯ä¸ä¼šå¼•èµ·ç¼–è¯‘å™¨æŠ¥é”™ï¼ˆé‚£æ ·çš„è¯å¤šå°‘æœ‰ç‚¹BTäº†ï¼‰ã€‚

ä¸ºæ­¤ï¼Œé¡¹ç›®è¿˜æ–°å¢äº†ä¸€ä¸ªè®¾ç½®é€‰é¡¹ï¼Œç”¨äºè®¾ç½®å¯nullä¸Šä¸‹æ–‡çš„æ„ŸçŸ¥ç­‰çº§ã€‚å¯ç”¨çš„æ„ŸçŸ¥ç­‰çº§æœ‰ï¼šç¦ç”¨ã€å¯ç”¨ã€è­¦å‘Šã€æ³¨é‡Šã€‚

å…·ä½“åŒºåˆ«å¦‚ä¸‹è¡¨ï¼š

| å¯nullä¸Šä¸‹æ–‡æ„ŸçŸ¥ç­‰çº§ | å–æ¶ˆå¼•ç”¨ï¼ˆDereferenceï¼‰è­¦å‘Š | èµ‹å€¼è­¦å‘Š | å¼•ç”¨ç±»å‹ | ?åç¼€ | !è¿ç®—ç¬¦ |
| --- | --- | --- | --- | --- | --- |
| **ç¦ç”¨** | ç¦ç”¨ | ç¦ç”¨ | å‡å¯null | ä¸å¯ç”¨ | æ— æ•ˆæœ |
| **å¯ç”¨** | å¯ç”¨ | å¯ç”¨ | ä¸å¯nullï¼Œé™¤éä½¿ç”¨?åç¼€ | å£°æ˜å¯nullç±»å‹ | å½“èµ‹å€¼å¯èƒ½ä¸ºnullæ—¶é˜»æ­¢è­¦å‘Šäº§ç”Ÿ |
| **è­¦å‘Š** | å¯ç”¨ | ä¸é€‚ç”¨ | å‡å¯null, ä½†æ˜¯åœ¨æ–¹æ³•å¼€å§‹æ—¶ï¼Œç±»çš„æˆå‘˜ä¼šè¢«è§†ä½œénullçš„ | ç”Ÿæˆè­¦å‘Š | å½“èµ‹å€¼å¯èƒ½ä¸ºnullæ—¶é˜»æ­¢è­¦å‘Šäº§ç”Ÿ |
| **æ³¨é‡Š**ï¼ˆannotationsï¼‰ | ç¦ç”¨ | ç¦ç”¨ | ä¸å¯nullï¼Œé™¤éä½¿ç”¨?åç¼€ | å£°æ˜å¯nullç±»å‹ | æ— æ•ˆæœ |

å…¶ä¸­ï¼Œâ€œå–æ¶ˆå¼•ç”¨è­¦å‘Šâ€æ˜¯æŒ‡T?èµ‹å€¼ç»™Tæ—¶çš„è­¦å‘Šï¼Œâ€œèµ‹å€¼è­¦å‘Šâ€æ˜¯æŒ‡Tèµ‹å€¼ä¸ºå¯èƒ½ä¸ºnullçš„è¡¨è¾¾å¼æ—¶çš„è­¦å‘Šã€‚

```c#
//å½“å¼€å¯å¯nullä¸Šä¸‹æ–‡æ—¶
string str1 = "abcdefg"; //ok
string? str2 = null; //ok
string str3 = null;  //ç¼–è¯‘å™¨äº§ç”Ÿè­¦å‘Š
str3 = str2; //ç¼–è¯‘å™¨äº§ç”Ÿè­¦å‘Š
str3 = str2!; //ä½¿ç”¨nullå®¹å¿è¿ç®—ç¬¦ï¼Œç¼–è¯‘å™¨ä¸ä¼šäº§ç”Ÿè­¦å‘Š
```

é™¤äº†é¡¹ç›®è®¾ç½®ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡`#nullable`é¢„å¤„ç†æŒ‡ä»¤ï¼Œæ¥å¼€å¯æˆ–è€…å…³é—­å¯nullä¸Šä¸‹æ–‡ã€‚

## å¼‚æ­¥è¿­ä»£å™¨

C# 8.0æ”¯æŒå¼‚æ­¥çš„è¿­ä»£å™¨ï¼Œå¯ç”¨äºå¼‚æ­¥çš„æµå¼å¤„ç†ã€‚

å®šä¹‰å¼‚æ­¥è¿­ä»£å™¨æ–¹æ³•ï¼Œéœ€è¦è¿”å›`IAsyncEnumerable\<T>`æˆ–è€…`IAsyncEnumerator\<T>`ã€‚

ç„¶åï¼Œä½ å¯ä»¥æ”¾å¿ƒçš„ç»™æ–¹æ³•åŠ ä¸Š`async`ã€‚å› æ­¤æ–¹æ³•å†…å¯ä»¥ä½¿ç”¨`await`ã€‚åŒæ—¶æ–¹æ³•å†…æ­£å¸¸ä½¿ç”¨`yield`è¯­å¥è¿”å›è¿­ä»£å€¼ã€‚

ä½¿ç”¨å¼‚æ­¥è¿­ä»£å™¨æ—¶ï¼Œéœ€è¦ç”¨`await foreach`ã€‚

```c#
public async IAsyncEnumerable<int> GetAll()   //è¯¥æ–¹æ³•å®ç°æ¯éš”100msè¿”å›ä¸€ä¸ªè¿­ä»£å€¼
{
    for (int i = 0; i < 100; i++)
    {
        await Task.Delay(100);
        yield return i;
    }
}

await foreach (var i in GetAll())
{
}
```

## å¼‚æ­¥å¯é‡Šæ”¾

C# è¿˜æ”¯æŒäº†å¼‚æ­¥å¯é‡Šæ”¾ï¼Œæ–¹æ³•æ˜¯å®ç°`IAsyncDisposable`æ¥å£ã€‚

å®ç°æ­¤æ¥å£çš„ç±»å¯ä»¥ä½¿ç”¨`await using`è¯­å¥è¿›è¡Œå¼‚æ­¥è‡ªåŠ¨é‡Šæ”¾ã€‚

```c#
var asyncDisposableObject = new SomeAsyncDisposableClass();
await using (asyncDisposableObject) //å¼‚æ­¥è‡ªåŠ¨é‡Šæ”¾
{
}
```

IAsyncDisposableæ¥å£æ‹¥æœ‰ä¸IDisposableç±»ä¼¼çš„é‡Šæ”¾æ¨¡å¼ã€‚ä¹Ÿå¯ä»¥é€šè¿‡IDEç”ŸæˆèŒƒå¼ä»£ç ã€‚

IAsyncDisposableå’ŒIDisposableæ¥å£å¯ä»¥åŒæ—¶å®ç°ï¼Œä»è€Œå¯ä»¥åŒæ—¶æ”¯æŒ`using`å’Œ`await using`ã€‚è¿™ä¸¤è€…ä¸å†²çªã€‚

## ç´¢å¼•ï¼ˆIndexï¼‰ã€èŒƒå›´ï¼ˆRangeï¼‰

è¿™åˆæ˜¯ä¸€ä¸ªå€¼å¾—çµ®å¨ä¸€ä¸‹çš„æ›´æ–°ã€‚

C# 8.0å¢åŠ äº†ä¸¤ç§æ–°çš„æ•°æ®ç±»å‹ï¼Œä»¥åŠå¯¹åº”çš„æ–°è¯­æ³•ã€‚

Indexï¼Œè¡¨ç¤ºç´¢å¼•ã€‚å®ƒåˆ†ä¸ºæ­£å‘ç´¢å¼•å’Œåå‘ç´¢å¼•ã€‚

- æ­£å‘ç´¢å¼•ï¼Œå°±æ˜¯ç›´æ¥ç»™ç´¢å¼•èµ‹å€¼ä¸€ä¸ªintå€¼ï¼Œè¡¨ç¤ºä»å·¦ä¾§å¼€å§‹å¾€å³æ•°çš„åºå·ï¼Œä»0å¼€å§‹ã€‚
- åå‘ç´¢å¼•ï¼Œå°±æ˜¯ç»™ç´¢å¼•èµ‹å€¼`^`ç¬¦å·+ä¸€ä¸ªintå€¼ï¼Œè¡¨ç¤ºä»å³ä¾§å¼€å§‹å¾€å·¦æ•°çš„åºå·ï¼Œä»Lengthå¼€å§‹ã€‚

```c#
Index idx1 = 0; //æŒ‡ä»£åºå·0
Index idx2 = ^0; //æŒ‡ä»£åºå·Length
```

Rangeï¼Œè¡¨ç¤ºèŒƒå›´ã€‚å®ƒç”±ä¸¤ä¸ªIndexç»„æˆï¼Œåˆ†åˆ«è¡¨ç¤ºå¼€å§‹å’Œç»“æŸçš„ä½ç½®ã€‚è¯­æ³•æ˜¯å¼€å§‹å’Œç»“æŸçš„ç´¢å¼•ä¹‹é—´ä½¿ç”¨`..`ç¬¦å·è¿æ¥ã€‚

èŒƒå›´ä¸­çš„ç´¢å¼•å¯ä»¥çœç•¥ã€‚çœç•¥å¼€å§‹å¤„çš„ç´¢å¼•ï¼Œè¡¨ç¤ºä»ç¬¬ä¸€ä¸ªå¼€å§‹ï¼›çœç•¥ç»“æŸå¤„çš„ç´¢å¼•ï¼Œè¡¨ç¤ºåˆ°æœ€åä¸€ä¸ªç»“æŸã€‚

éå¸¸é‡è¦ï¼šèŒƒå›´æ˜¯**å·¦é—­å³å¼€**çš„ï¼Œå®ƒåŒ…å«èµ·å§‹Indexçš„ä½ç½®ï¼Œ**ä¸åŒ…å«ç»“æŸIndexçš„ä½ç½®**ã€‚è¿™æ˜¯ä¸ºäº†åº”å¯¹æ•°ç»„ã€åˆ—è¡¨ä¸­ä¸‹æ ‡ä»0å¼€å§‹ï¼Œä»è€Œå¯¼è‡´çš„é•¿åº¦ä¼šæ¯”æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡å¤š1çš„é—®é¢˜ã€‚

```c#
Range rng1 = 1..3;   //1åˆ°2         ï¼ˆè¡¨ç¤ºç¬¬2ä¸ªåˆ°ç¬¬3ä¸ªå…ƒç´ ï¼‰
Range rng2 = 3..^1;  //3åˆ°length-2  ï¼ˆè¡¨ç¤ºç¬¬4ä¸ªåˆ°å€’æ•°ç¬¬2ä¸ªå…ƒç´ ï¼‰
Range rng3 = ..7;    //0åˆ°6         ï¼ˆè¡¨ç¤ºç¬¬1ä¸ªåˆ°ç¬¬7ä¸ªå…ƒç´ ï¼‰
Range rng4 = 3..;    //3åˆ°length-1  ï¼ˆè¡¨ç¤ºç¬¬4ä¸ªåˆ°æœ€å1ä¸ªå…ƒç´ ï¼‰
Range rng5 = ..;     //0åˆ°length-1  ï¼ˆè¡¨ç¤ºå…¨éƒ¨å…ƒç´ ï¼‰
```

å¥½äº†ï¼Œå‡†å¤‡å·¥ä½œåšå¥½äº†ï¼Œæ¥ä¸‹æ¥å®ƒä»¬è¦æœ‰ç‚¹æ­£ç»ç”¨é€”äº†ï¼š

### ç´¢å¼•å®šä½

å¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°ç»„ã€stringã€Span\<T>ã€ReadOnlySpan\<T>çš„å…ƒç´ ï¼Œå®ç°ç´¢å¼•å®šä½ã€‚

```c#
var names = {
    "å¼ ä¸‰",
    "æå››",
    "ç‹äº”",
    "èµµå…­",
    "å®‹ä¸ƒ",
    "é’±å…«",
};

var qian = names[^1]; //å–length-1ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ã€‚æ³¨æ„ä¸è¦è·ŸèŒƒå›´æ··äº†ï¼èŒƒå›´ä¸åŒ…å«ç»“æŸä½ç½®ï¼Œæ‰€ä»¥è¦å–åˆ°æœ€åä¸€ä¸ªå…ƒç´ éœ€è¦ä½¿ç»“æŸç´¢å¼•ä¸º^0ï¼›ä½†æ˜¯ç´¢å¼•æœ¬èº«ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œæ­¤å¤„å–æœ€åä¸€ä¸ªå…ƒç´ è¿˜æ˜¯ç”¨^1ã€‚
```

æ³¨æ„ï¼šä½¿ç”¨ç´¢å¼•å–å‡ºæ¥çš„æ˜¯å•ä¸ªå…ƒç´ ã€‚

### èŒƒå›´åˆ‡ç‰‡

å¯ä»¥ä½¿ç”¨èŒƒå›´å¯¹æ•°ç»„ã€stringã€Span\<T>ã€ReadOnlySpan\<T>è¿›è¡Œåˆ‡ç‰‡ã€‚è¿™å°±æ¯”è¾ƒå®ç”¨äº†ã€‚

```c#
var names = {
    "å¼ ä¸‰",
    "æå››",
    "ç‹äº”",
    "èµµå…­",
    "å®‹ä¸ƒ",
    "é’±å…«",
};

var subNames1 = names[..];   //è·å–å…¨éƒ¨åˆ—è¡¨
var subNames2 = names[..4];  //è·å–ä»0å·å…ƒç´ åˆ°3å·å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯â€œå¼ ä¸‰â€åˆ°â€œèµµå…­â€
var subNames3 = names[4..];  //è·å–ä»4å·å…ƒç´ åˆ°æœ€å1ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯â€œå®‹ä¸ƒâ€åˆ°â€œé’±å…«â€
var subNames4 = names[^3..^0]; //è·å–å€’æ•°ç¬¬3åˆ°æœ€å1ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯â€œèµµå…­â€åˆ°â€œé’±å…«â€
```

æ³¨æ„ï¼ŒèŒƒå›´å–å‡ºæ¥çš„æ˜¯åˆ‡ç‰‡ï¼Œè·ŸåŸæ¥çš„ç±»å‹ä¿æŒä¸€è‡´ã€‚ä¹Ÿå°±æ˜¯ä»æ˜¯æ•°ç»„ã€stringã€Span\<T>æˆ–è€…ReadOnlySpan\<T>ç±»å‹ã€‚

### è‡ªå®šä¹‰ç±»å‹æ”¯æŒç´¢å¼•å’ŒèŒƒå›´

é™¤äº†ä¸Šè¿°ç³»ç»Ÿé¢„ç½®æ”¯æŒç´¢å¼•å’ŒèŒƒå›´çš„ç±»å‹å¤–ï¼Œæˆ‘ä»¬ä»å¯ä»¥é€šè¿‡ä¸€äº›æ‰‹æ®µè®©è‡ªå·±å®ç°çš„ç±»å‹æ”¯æŒç´¢å¼•å’ŒèŒƒå›´ã€‚

ä¸è¿‡è¦æ³¨æ„ï¼šå®ƒä»¬çš„æ•ˆç‡è¦çœ‹å…·ä½“çš„ä»£ç å®ç°ã€‚å®˜æ–¹æ”¯æŒçš„ç´¢å¼•å’ŒèŒƒå›´å¤„ç†æ•ˆç‡æ˜¯å¾ˆé«˜çš„ï¼Œè‡ªå·±å†™çš„ç±»å‹èƒ½å¦è¾¾åˆ°é«˜æ•ˆç‡å°±è¦çœ‹å¼€å‘è€…çš„åŠŸåº•äº†ã€‚

#### æ˜¾å¼æ”¯æŒIndexå’ŒRange

å…¶å®ï¼Œå› ä¸ºä½ å¯ä»¥å®šä¹‰ç´¢å¼•å™¨ï¼Œå› è€Œä½ å®Œå…¨å¯ä»¥åœ¨è‡ªå·±å®ç°çš„ç±»ä¸­å®šä¹‰keyä¸ºIndexå’ŒRangeçš„ç´¢å¼•å™¨ã€‚è¿™ç§°ä¸º**æ˜¾å¼æ”¯æŒ**äº†ç´¢å¼•å’ŒèŒƒå›´ã€‚

ä½†å¯¹äºä½¿ç”¨è€…ï¼Œéœ€è¦æ³¨æ„ï¼šè‡ªå®šä¹‰çš„ç´¢å¼•å™¨æ˜¯å¯ä»¥è¿”å›ä»»æ„ç±»å‹çš„ã€‚å› è€Œï¼š

- ç”¨Indexæ‹¿åˆ°çš„æœªå¿…æ˜¯å…ƒç´ ç±»å‹
- ç”¨Rangeæ‹¿åˆ°çš„ä¹Ÿæœªå¿…æ˜¯åŸåºåˆ—ç±»å‹
- ç”šè‡³ç”¨Indexåˆ—è¡¨ï¼ŒRangeè¿”å›å•ä¸ªå¯¹è±¡ä¹Ÿæ˜¯å…è®¸çš„

ä½¿ç”¨è€…éœ€è¦çœ‹æ¸…å…·ä½“å®šä¹‰ã€‚

#### éšå¼æ”¯æŒIndexå’ŒRange

å…ˆçœ‹ä¸€ä¸ªå®šä¹‰ï¼š

**å¯æ•°ç±»å‹**æ˜¯æŒ‡ä¸€ä¸ªç±»å‹æ‹¥æœ‰å¯è®¿é—®çš„ã€`int`ç±»å‹çš„`Length`æˆ–è€…`Count`å±æ€§ã€‚

å¯æ•°ç±»å‹å¯ä»¥å®ç°å¯¹Indexå’ŒRangeçš„éšå¼æ”¯æŒã€‚

**éšå¼æ”¯æŒIndex**ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

- è¯¥ç±»å‹æ˜¯å¯æ•°ç±»å‹
- è¯¥ç±»å‹å…·æœ‰Keyä¸º`int`çš„ç´¢å¼•å™¨
- è¯¥ç±»å‹æ²¡æœ‰Keyä¸ºå•ä¸ª`Index`çš„ç´¢å¼•å™¨å®šä¹‰ï¼ˆå¦åˆ™å°±æ˜¯æ˜¾å¼æ”¯æŒäº†ï¼‰

è¿™æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æä¾›ç´¢å¼•çš„æ”¯æŒï¼Œä½¿ç”¨ç´¢å¼•å°†å®é™…è°ƒç”¨
Keyä¸ºintçš„ç´¢å¼•å™¨ã€‚

**éšå¼æ”¯æŒRange**ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

- è¯¥ç±»å‹æ˜¯å¯æ•°ç±»å‹
- è¯¥ç±»å‹å…·æœ‰ä¸¤ä¸ª`int`å‚æ•°çš„Sliceæ–¹æ³•
- è¯¥ç±»å‹æ²¡æœ‰Keyä¸ºå•ä¸ª`Range`çš„ç´¢å¼•å™¨å®šä¹‰ï¼ˆå¦åˆ™å°±æ˜¯æ˜¾å¼æ”¯æŒäº†ï¼‰

è¿™æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æä¾›èŒƒå›´çš„æ”¯æŒï¼Œä½¿ç”¨èŒƒå›´å°†å®é™…è°ƒç”¨ä¸Šè¿°Sliceæ–¹æ³•ã€‚

## nullåˆå¹¶èµ‹å€¼è¿ç®—ç¬¦

æ–°å¢äº†`??=`è¿ç®—ç¬¦ï¼Œç”¨äºåˆ¤æ–­å¹¶ç»™å¯nullç±»å‹èµ‹å€¼ã€‚è¿ç®—ç¬¦å·¦ä¾§å¿…é¡»æ˜¯å·¦å€¼ç±»å‹ï¼Œå³å˜é‡ã€‚

- å¦‚æœå·¦ä¾§å˜é‡å€¼ä¸ºnullï¼Œåˆ™èµ‹å€¼ä¸ºå³ä¾§å€¼
- å¦‚æœåˆ™æµ‹å˜é‡å€¼ä¸ä¸ºnullï¼Œåˆ™ä¿æŒå·¦ä¾§å€¼ä¸å˜

```c#
public void DoSomething(string word)
{
    word ??= "ä½ å¥½";  //å¦‚æœä¼ å…¥çš„wordä¸ºnullï¼Œåˆ™èµ‹å€¼ä¸º ä½ å¥½
}
```

## C# 8.0çš„å…¶ä»–æ”¹è¿›

- **å­—ç¬¦ä¸²å†…æ’å¢å¼º**ï¼šåŒæ—¶å­˜åœ¨`$`å’Œ`@`æ—¶ï¼Œä¹‹å‰åªèƒ½`$`åœ¨å‰ï¼Œç°åœ¨å“ªä¸ªç¬¦å·åœ¨å‰éƒ½å¯ä»¥ã€‚
- **é™æ€æœ¬åœ°å‡½æ•°**ï¼šæœ¬åœ°å‡½æ•°ç°åœ¨å¯ä»¥ç”¨`static`ä¿®é¥°ã€‚ä½¿ç”¨`static`ä¿®é¥°çš„é™æ€å‡½æ•°æ— æ³•è·å–å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„å±€éƒ¨å˜é‡å’Œå½“å‰ç±»å†…çš„éé™æ€å­—æ®µã€å±æ€§ã€‚
- **å¯é‡Šæ”¾çš„`ref struct`**ï¼š`ref struct`å› ä¸ºæ— æ³•å®ç°æ¥å£ï¼Œæ‰€ä»¥ä¹‹å‰æ— æ³•å®ç°IDisposableã€‚ç°åœ¨ï¼Œåªéœ€è¦`ref struct`å®ç°Disposeæ–¹æ³•ï¼Œä¾¿å¯ä»¥ä½¿ç”¨usingè¿›è¡Œè‡ªåŠ¨é‡Šæ”¾ã€‚è¿™å¯¹`ref readonly struct`åŒæ ·é€‚ç”¨ã€‚
- **æŠ˜å çš„`stackalloc`åˆå§‹åŒ–è¡¨è¾¾å¼**ï¼šä¹‹å‰å·²ç»æè¿‡ï¼Œç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨`stackalloc [] { 1, 2 }`çš„è¯­æ³•æ¥åˆå§‹åŒ–æ ˆä¸Šæ•°ç»„ã€‚
- **éæ‰˜ç®¡æ„é€ ç±»å‹**ï¼šä»»ä½•éæ‰˜ç®¡ç±»å‹çš„æ•°ç»„ï¼Œç°åœ¨éƒ½å¯ä»¥ä½¿ç”¨`stackalloc`åˆ†é…äº†ã€‚

# C# 9.0 â€”â€” æ–°çš„å¾ç¨‹

C# 9.0åŒ\.Net 5ä¸€åŒå‘å¸ƒã€‚è¿™æ˜¯\.Netåˆå¹¶åçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œå› è€ŒC#ä¹Ÿå¼€å¯äº†æ–°çš„å¾ç¨‹ã€‚

C# 9.0æ”¯æŒä»¥ä¸‹è¯­æ³•ï¼š

## initè®¿é—®å™¨

ç°åœ¨ï¼Œå±æ€§é™¤äº†getterå’Œsetterï¼Œå¢åŠ äº†ä¸€ç§æ–°çš„è®¿é—®å™¨ã€‚`init`è®¿é—®å™¨ã€‚

```c#
public string Name { get; init; }
```

æ‹¥æœ‰`init`è®¿é—®å™¨çš„å±æ€§ï¼Œåªèƒ½åœ¨åˆå§‹åŒ–è¡¨è¾¾å¼æˆ–æ„é€ æ–¹æ³•ä¸­èµ‹å€¼ã€‚ä¹‹åï¼Œè¯¥å±æ€§å˜æˆåªè¯»ï¼Œåœ¨å…¶ä»–ä½ç½®ä¸å¯å†æ¬¡èµ‹å€¼ã€‚

`init`è®¿é—®å™¨è·Ÿgetterã€setterä¸€æ ·ï¼Œå¯ä»¥è‡ªåŠ¨å®ç°ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨å®ç°ã€‚

éœ€è¦æ³¨æ„ï¼Œ`set`è®¿é—®å™¨å’Œ`init`è®¿é—®å™¨æ˜¯å†²çªçš„ï¼Œåªèƒ½æä¾›ä¸€ä¸ªã€‚

å®šä¹‰`init`è®¿é—®å™¨ï¼Œæ˜¯ä¸ºäº†å¼•å…¥å¦ä¸€ä¸ªé‡è¦çš„è¯­æ³•æ¦‚å¿µï¼šè®°å½•ã€‚

## è®°å½•ï¼ˆRecordï¼‰

å¼•å…¥è®°å½•ï¼Œä¹Ÿæ˜¯åœ¨å‘å‡½æ•°å¼ç¼–ç¨‹çœ‹é½ã€‚ä¹Ÿæ˜¯æå‡ä¸F#çš„å¯äº¤äº’æ€§ã€‚

è®°å½•æ˜¯ä¸€ç§æ–°çš„ç±»å‹ã€‚å®ƒæ˜¯å¼•ç”¨ç±»å‹çš„ã€‚å£°æ˜å…³é”®è¯ä¸º`record`ã€‚

è®°å½•ä¸­çš„å±æ€§é»˜è®¤å¸¦æœ‰`init`è®¿é—®å™¨ï¼Œå› è€Œé»˜è®¤æ˜¯ä¸å¯æ›´æ”¹çš„ã€‚

è®°å½•å£°æ˜æ—¶ï¼Œå¯ä»¥åœ¨ä¸¤ä¸ªåœ°æ–¹å®šä¹‰å±æ€§ï¼š

- åœ†æ‹¬å·ï¼šå°†è®°å½•çš„å±æ€§ç›´æ¥æ”¾åœ¨åœ†æ‹¬å·å†…ï¼Œæ­¤æ—¶è¦æ±‚newçš„æ—¶å€™å¿…é¡»æä¾›è¿™äº›å±æ€§å€¼ã€‚ç­‰åŒäºè®°å½•çš„æ„é€ å™¨ã€‚
- èŠ±æ‹¬å·ï¼šé€šè¿‡èŠ±æ‹¬å·å±•å¼€ï¼Œåœ¨èŠ±æ‹¬å·å†…å®šä¹‰å±æ€§ã€‚è¿™è·Ÿå¸¸è§„çš„å±æ€§å®šä¹‰ç±»ä¼¼ã€‚

å¦‚æœä¸éœ€è¦ï¼Œåœ†æ‹¬å·å’ŒèŠ±æ‹¬å·éƒ½å¯ä»¥çœç•¥ã€‚å½“çœç•¥èŠ±æ‹¬å·æ—¶ï¼Œå¿…é¡»åœ¨ç»“æŸæ—¶åŠ ä¸Š`;`ã€‚

```c#
public record Person1(string FirstName, string LastName); //åªæœ‰åœ†æ‹¬å·çš„è¯­æ³•ï¼Œå¿…é¡»åŠ ä¸Šåˆ†å·ã€‚å®ƒåŒ…å«ä¸¤ä¸ªå±æ€§ï¼Œå®ƒä»¬é»˜è®¤å¸¦æœ‰initè®¿é—®å™¨ã€‚newæ—¶å¿…é¡»æä¾›è¿™ä¸¤ä¸ªå€¼ã€‚

public record Person2  //åªæœ‰èŠ±æ‹¬å·çš„è¯­æ³•ï¼Œåœ†æ‹¬å·è¢«çœç•¥ã€‚æ­¤æ—¶newä¾¿æ˜¯æ— å‚çš„ã€‚å®ƒä¹ŸåŒ…å«äº†ä¸¤ä¸ªå±æ€§
{
    public string FirstName { get; init; }
    public string LastName { get; init; }
}

public record Person3 (string FirstName)   //ç»“åˆäº†ä¸¤ç§è¯­æ³•ï¼Œnewæ—¶å¿…é¡»æä¾›FirstNameçš„å€¼ã€‚å®ƒä¹ŸåŒ…å«äº†ä¸¤ä¸ªå±æ€§ã€‚
{
    public string LastName { get; init; }
}
```

è®°å½•ä¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”ŸæˆEqualsæ–¹æ³•ï¼Œå¹¶é‡è½½`==`è¿ç®—ç¬¦ã€‚å®ƒçš„**ç›¸ç­‰æ¯”è¾ƒæ•ˆç‡å¾ˆé«˜**ã€‚

æ¯”è¾ƒæœ‰æ„æ€çš„ä¸€ç‚¹æ˜¯ï¼šC#å¹¶æ²¡æœ‰å°†è®°å½•é™æ­»ä¸ºåªè¯»ã€‚ä½ ä»ç„¶å¯ä»¥å£°æ˜è®°å½•å†…çš„å±æ€§å…·æœ‰`set`è®¿é—®å™¨ã€‚ä½†æ˜¯ä¸€èˆ¬æˆ‘ä»¬ä¸ä¼šè¿™ä¹ˆå¹²ï¼Œè¿™è¿åäº†è®°å½•è®¾è®¡çš„æœ¬æ„ã€‚

è®°å½•è·Ÿç±»å’Œç»“æ„ä¸€æ ·ï¼Œå¯ä»¥å®šä¹‰æ–¹æ³•ï¼Œä¹Ÿèƒ½å®ç°æ¥å£ã€‚è®°å½•è¿˜æ”¯æŒä»è®°å½•ç»§æ‰¿ã€‚

> Javaåœ¨14ç‰ˆæœ¬å¼•å…¥äº†è®°å½•ç±»å‹çš„é¢„è§ˆï¼Œå¹¶åœ¨Java 16æ­£å¼å‘å¸ƒã€‚

> Javaçš„è®°å½•æ•´ä½“ä¸C#çš„ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸ºäº†ç»™åªè¯»æ•°æ®è§£æ„æä¾›ä¾¿åˆ©ã€‚Javaä¹Ÿé’ˆå¯¹è®°å½•é‡å†™äº†equalsæ–¹æ³•ï¼Œä»¥å®ç°æ›´å¿«çš„æ¯”å¯¹ã€‚Javaä¹Ÿå¯ä»¥åœ¨è®°å½•å†…å®šä¹‰æ–¹æ³•ã€‚

> ä¸è¿‡ï¼Œå®ƒä»¬çš„åŒºåˆ«ä¹Ÿä¸å°ï¼š
>
> - Javaçš„è®°å½•ï¼Œæ‰€æœ‰å­—æ®µåªèƒ½å®šä¹‰åœ¨åœ†æ‹¬å·ä¸­ï¼Œä¸å…è®¸å®šä¹‰åœ¨èŠ±æ‹¬å·å†…ã€‚C#è®°å½•çš„å±æ€§å¯ä»¥æ”¾åœ¨åœ†æ‹¬å·å†…ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨èŠ±æ‹¬å·å†…ã€‚
> - Javaçš„è®°å½•ï¼Œä¼šç”Ÿæˆå…¨å­—æ®µçš„æ„é€ å™¨ã€‚è€ŒC#ä¼šæ ¹æ®æ”¾åœ¨åœ†æ‹¬å·é‡Œçš„å±æ€§ï¼Œç”ŸæˆåªåŒ…å«æŒ‡å®šå±æ€§çš„æ„é€ å™¨ã€‚
> - Javaçš„è®°å½•å®šä¹‰æ—¶ï¼ŒèŠ±æ‹¬å·ä¸å¯ä»¥çœç•¥ã€‚è€ŒC#åœ¨ä¸éœ€è¦èŠ±æ‹¬å·æ—¶ï¼Œå¯ä»¥çœç•¥å¹¶æ›¿æ¢ä¸º`;`ã€‚
> - Javaçš„è®°å½•ä¸­çš„å­—æ®µï¼Œè·å–ä¸æ˜¯ç”¨getæ–¹æ³•ï¼Œè€Œæ˜¯ç”¨ä¸å­—æ®µåŒåçš„æ–¹æ³•ã€‚è€ŒC#è®°å½•çš„å±æ€§åˆ™è·Ÿæ™®é€šå±æ€§æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚
> - Javaçš„è®°å½•ä¸­çš„å­—æ®µéƒ½æ˜¯åªè¯»çš„ã€‚è€ŒC#è™½ç„¶é»˜è®¤æ˜¯åªè¯»çš„ï¼Œä½†ä»å¯ä»¥è¢«å£°æ˜ä¸ºå¯å†™ã€‚
> - Javaçš„è®°å½•ä¸èƒ½ç»§æ‰¿ç±»ï¼Œä¹Ÿä¸èƒ½è¢«ç»§æ‰¿ã€‚C#åˆ™å¯ä»¥ç»§æ‰¿å…¶ä»–è®°å½•ï¼Œä¹Ÿå¯ä»¥è¢«å…¶ä»–è®°å½•ç»§æ‰¿ã€‚ï¼ˆä¸è¿‡æˆ‘è§‰å¾—ä¸è®©ç»§æ‰¿æ˜¯å¯¹çš„ï¼Œå¾€ä¸‹çœ‹å°±æ˜ç™½äº†ã€‚ï¼‰
>
> å¯è§ï¼ŒJavaä¹Ÿåœ¨å‘å‡½æ•°å¼ç¼–ç¨‹é æ‹¢ã€‚

### è®°å½•çš„ç»§æ‰¿

è®°å½•æ”¯æŒç»§æ‰¿ã€‚ä½†æ˜¯è®°å½•çš„ç»§æ‰¿æœ‰äº›å¥‡æ€ªã€‚å‡è®¾è®°å½•Aç»§æ‰¿äº†è®°å½•Bï¼Œåˆ™ï¼š

- Açš„åœ†æ‹¬å·å†…çš„å±æ€§ä¸ªæ•°ï¼Œä¸èƒ½å°‘äºBçš„åœ†æ‹¬å·å†…çš„å±æ€§ä¸ªæ•°
- Açš„åœ†æ‹¬å·å†…å¦‚æœæœ‰ä¸Bå†…ä»»æ„ä½ç½®å®šä¹‰çš„å±æ€§ç›¸åŒåç§°çš„å±æ€§ï¼Œåˆ™å®ƒä»¬çš„ç±»å‹ä¹Ÿå¿…é¡»ç›¸åŒ
- Açš„åœ†æ‹¬å·å†…å¦‚æœæœ‰ä¸Bå†…ä»»æ„ä½ç½®å®šä¹‰çš„å±æ€§ç›¸åŒçš„å±æ€§ï¼Œå®ƒä¼šè¢«Bçš„å±æ€§è¦†ç›–ã€‚é€šè¿‡Aè·å–è¯¥åç§°çš„å±æ€§æ—¶ï¼Œå®é™…è·å–çš„æ˜¯Bä¸­è¯¥åç§°å±æ€§çš„å€¼
- Açš„èŠ±æ‹¬å·å†…å¦‚æœæœ‰ä¸Bå†…ä»»æ„ä½ç½®å®šä¹‰çš„å±æ€§ç›¸åŒçš„å±æ€§ï¼Œåˆ™ä¼šå°†Bçš„å±æ€§éšè—ã€‚è¿™ä¸ä¸€èˆ¬çš„å±æ€§éšè—ä¸€è‡´ã€‚å¯ä»¥è€ƒè™‘æ·»åŠ `new`å…³é”®è¯ã€‚
- åœ¨ä¹¦å†™Aç»§æ‰¿Bçš„è¯­æ³•æ—¶ï¼Œå¦‚æœBæœ‰å«å‚çš„æ„é€ å™¨ï¼Œåˆ™éœ€è¦åœ¨Båé¢ä¹¦å†™åœ†æ‹¬å·ï¼Œå¹¶ä»¥Aåœ†æ‹¬å·å†…çš„å±æ€§å¡«å……Bçš„æ„é€ å™¨ï¼Œä»¥è¡¨æ˜åº”è¯¥å¦‚ä½•åˆå§‹åŒ–B

è¿™æ®µä½ å¯èƒ½å·²ç»çœ‹æ™•äº†ï¼Œæˆ‘æ¥ä¸¾ä¾‹è¯´æ˜ä¸‹ï¼Œä½ ä¸€å®šä¼šæ›´æ™•çš„ï¼š

```c#
public record Person (string FirstName)
{
    public string LastName { get; init; }
}

//Person1ç”¨FirstNameæ¥åˆå§‹åŒ–Personçš„FirstNameï¼Œè€ŒLastNameçš„å€¼ä¼šè¢«ä¸¢å¼ƒã€‚
//Personçš„LastNameè¦†ç›–äº†Person1çš„LastNameã€‚
//é€šè¿‡Person1çš„å¯¹åƒè·å–FirstNameå’ŒLastNameï¼Œå®é™…è·å–çš„æ˜¯Personçš„FirstNameå’ŒLastNameã€‚å…¶ä¸­FirstNameæœªè¢«åˆå§‹åŒ–ã€‚
public record Person1(string FirstName, string LastName) : Person(FirstName);  

//è¿™é‡Œæˆ‘ä¸¾äº†ä¸€ä¸ªè¾ƒä¸ºå¥‡è‘©çš„ä¾‹å­ã€‚
//Person2çš„LastNameçš„å€¼ä¼šè¢«ç”¨æ¥ç»™Personçš„FirstNameèµ‹å€¼ï¼Œè€ŒPerson2æä¾›çš„FirstNameçš„å€¼ä¼šè¢«ä¸¢å¼ƒã€‚
//é€šè¿‡Person1çš„å¯¹åƒè·å–FirstNameå’ŒLastNameï¼Œå®é™…è·å–çš„æ˜¯Personçš„FirstNameå’ŒLastNameã€‚å…¶ä¸­LastNameæœªè¢«åˆå§‹åŒ–ã€‚
public record Person2(string FirstName, string LastName) : Person(LastName); 

//è¿™ä¸ªä¾‹å­æ›´ä¸ºå¥‡è‘©ã€‚
//ä½¿ç”¨Person3çš„LastNameåˆå§‹åŒ–Personçš„FirstNameï¼Œä½†æ˜¯Personçš„FirstNameåˆè¢«Person3çš„FirstNameéšè—ã€‚
//æ­¤æ—¶ï¼Œä¸¤ä¸ªFirstNameåŒæ—¶å­˜åœ¨ã€‚
//å¯¹äºPerson3å¯¹è±¡è€Œè¨€ï¼ŒFirstNameå’ŒLastNameéƒ½æœªè¢«åˆå§‹åŒ–ï¼›è€ŒPersonçš„FirstNameè¢«æˆåŠŸåˆå§‹åŒ–ï¼Œç„¶åè¢«éšè—ã€‚
public record Person3(string LastName) : Person(LastName) 
{
    public new string FirstName{ get; init; }
}

//è¿™ä¸ªç»ˆäºæ­£å¸¸ä¸€ç‚¹äº†
//Person3ä¼šä½¿ç”¨FirstNameåˆå§‹Personçš„FirstNameï¼Œå¹¶ä¸”è‡ªå·±åŒ…å«ä¸€ä¸ªæ–°çš„å±æ€§NickNameï¼Œä¹Ÿå¾—åˆ°äº†åˆå§‹åŒ–ã€‚
public record Person4(string FirstName, string NickName) : Person(FirstName);


//ä¸Šè¿°è®°å½•ç±»å‹åˆå§‹åŒ–ç»“æœï¼š
var person = new Person("1");           //FirstName:1ï¼ŒLastName:null
var person1 = new Person1("1", "2");    //FirstName:1ï¼ŒLastName:nullï¼Œ2è¢«ä¸¢å¼ƒäº†
var person2 = new Person2("1", "2");    //FirstName:2ï¼ŒLastName:nullï¼Œ1è¢«ä¸¢å¼ƒäº†
var person3 = new Person3("2");         //FirstName:nullï¼ŒLastName:nullï¼ŒPerson.LastName:2ï¼Œä½†Person.LastNameè¢«éšè—ï¼Œéœ€è¦å°†ç±»å‹è½¬æ¢ä¸ºPersonæ‰å¯è¯»å–
var person4 = new Person4("1", "3");    //FirstName:1ï¼ŒLastName:nullï¼ŒNickName:3
```

å’‹æ ·ï¼Œæ˜¯ä¸æ˜¯æ›´æ™•äº†ã€‚

ä¸è¿‡ä¸ç”¨æ€•ï¼ç°å®å¼€å‘ä¸­ä½ ä¸€å®šä¸ä¼šè¿™ä¹ˆç”¨ã€‚å¦‚æœä½ ç»§æ‰¿äº†ä¸€ä¸ªè®°å½•ï¼Œä½ ä¼šæä¾›ä¸€æ¨¡ä¸€æ ·çš„åœ†æ‹¬å·å±æ€§ï¼Œå¹¶ä¸”ç²¾ç¡®çš„ç”¨è¿™äº›å±æ€§åˆå§‹åŒ–è¢«ç»§æ‰¿è®°å½•é‡Œçš„å¯¹åº”å±æ€§ã€‚ç„¶åå†åœ¨å®ƒçš„åŸºç¡€ä¸Šæ‰©å±•å±æ€§ã€‚

### è®°å½•ä¸structæ¯”è¾ƒ

è®°å½•è®¾è®¡ä¸ºç”¨äºåªè¯»æ•°æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚è¿™ç§è½»é‡çš„æ•°æ®ç»“æ„ï¼Œè®©æˆ‘ä»¬è”æƒ³åˆ°äº†structã€‚æ¯”è¾ƒrecordå’Œstructï¼Œå®ƒä»¬æœ‰ä»¥ä¸‹ä¸åŒï¼š

- structä¸æ”¯æŒç»§æ‰¿ï¼ˆå®ƒä»¬æ˜¯sealedï¼‰ï¼Œrecordæ”¯æŒç»§æ‰¿ã€‚recordåªèƒ½ä»recordç»§æ‰¿ï¼Œä¸å¯ä»¥ä»ç±»ç»§æ‰¿ã€‚åä¹‹äº¦ç„¶ã€‚
- structçš„ç›¸ç­‰æ“ä½œæ•ˆç‡æ¯”è¾ƒä½ã€‚å®ƒæ˜¯ä½¿ç”¨åå°„ï¼Œè·å–å¯¹è±¡çš„æ‰€æœ‰å­—æ®µåé€ä¸€æ¯”è¾ƒã€‚è€Œrecordå°†ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”ŸæˆEqualsæ–¹æ³•ï¼Œå¹¶é‡è½½==è¿ç®—ç¬¦ï¼Œæ¯”è¾ƒæ•ˆç‡å¾ˆé«˜ã€‚
- structèµ‹å€¼ä¼šå¯¼è‡´å¤åˆ¶ï¼Œå› ä¸ºå…¶æ˜¯å€¼ç±»å‹ã€‚recordæ˜¯å¼•ç”¨ç±»å‹ï¼Œèµ‹å€¼åªæ˜¯å¤åˆ¶å¼•ç”¨åœ°å€ï¼ˆé©¬ä¸Šè¦è®²çš„`with`è¡¨è¾¾å¼é™¤å¤–ï¼‰ã€‚

### withè¡¨è¾¾å¼

è®°å½•æ”¯æŒä½¿ç”¨withè¡¨è¾¾å¼è¿›è¡Œèµ‹å€¼ã€‚ä½¿ç”¨`with`è¡¨è¾¾å¼æ—¶ï¼Œå°†ä¸å†æ˜¯å¤åˆ¶å¯¹åŸè®°å½•çš„å¼•ç”¨ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„å‰¯æœ¬ã€‚è¯¥å‰¯æœ¬å…¶ä»–å±æ€§ä¸å‘ç”Ÿå˜åŒ–ï¼Œä»…`with`æŒ‡å®šçš„å±æ€§å‘ç”Ÿå˜åŒ–ï¼ˆç§°ä¹‹ä¸º**éç ´åæ€§å˜åŒ–**ï¼‰ã€‚

å¦‚ä¸‹ç¤ºä¾‹ï¼š

```c#
Person3 person = new Person3("ä¸‰") { LastName = "å¼ " };
Person3 person2 = person with { FirstName = "å…­" };   //ç”Ÿæˆä¸€ä¸ªæ–°çš„å‰¯æœ¬ï¼Œä¸”FirstNameä¸º å…­ï¼ŒLastNameä¸º å¼ ã€‚

bool equal = person == person2;  //ä½¿ç”¨ç¼–è¯‘å™¨ç”ŸæˆEqualsæ–¹æ³•æ¯”è¾ƒï¼Œæ•ˆç‡å¾ˆé«˜
```

## é¡¶çº§è¯­å¥

ç°åœ¨ä¸éœ€è¦Mainæ–¹æ³•äº†ã€‚åœ¨Program.csä¸­ï¼Œä½ å¯ä»¥ç›´æ¥ä¹¦å†™åœ¨ä»»ä½•ç±»ä¹‹å¤–çš„ä»£ç ã€‚è¿™è¢«ç§°ä¸ºé¡¶çº§è¯­å¥ã€‚

```c#
//Program.cs
using System;
Console.WriteLine("Hello World");
```

éœ€è¦æ³¨æ„ï¼Œä¸€æ—¦ä½¿ç”¨é¡¶çº§è¯­å¥ï¼Œå³ä½¿å†å£°æ˜Mainæ–¹æ³•ï¼ŒMainæ–¹æ³•ä¹Ÿä¸å†ä¼šè¢«å½“åšç¨‹åºå…¥å£ç‚¹ï¼Œå®ƒå˜æˆäº†ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•ã€‚

## C# 9.0çš„æ¨¡å¼åŒ¹é…

æ¿€åŠ¨äººå¿ƒçš„æ—¶åˆ»åˆåŒå’å•åˆ°äº†ã€‚C# 9.0æ–°å¢äº†å‡ ç§æ¨¡å¼æ”¯æŒï¼Œä»è€Œè¾¾åˆ°äº†å®Œå…¨ä½“ï¼š

### ç±»å‹æ¨¡å¼

åœ¨switchè¡¨è¾¾å¼ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç±»å‹ï¼Œä¸å¿…åŒæ­¥å£°æ˜å˜é‡ï¼š

```c#
//ä»¥å‰éœ€è¦è¿™æ ·å†™ï¼š
var isCat1 = animal switch
{
    Cat _ => true,
    _ => false
};

//ç°åœ¨å¯ä»¥è¿™æ ·å†™ï¼š
var isCat2 = animal switch
{
    Cat => true,
    _ => false
};
```

ç±»å‹æ¨¡å¼äº‹å®ä¸Šæ˜¯è¡¥é½äº†switchè¡¨è¾¾å¼ç›¸è¾ƒäºswitchè¯­å¥çš„çŸ­æ¿ã€‚

### å…³ç³»æ¨¡å¼

ç°åœ¨å¯¹äºswitchè¯­å¥å’Œswitchè¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨`<`ã€`>`ã€`<=`ã€`>=`è¿™å‡ ç§å…³ç³»æ¨¡å¼ï¼š

```c#
public string Level(int score) => score switch 
{
    >= 80 => "è‰¯å¥½",
    < 60 => "ä¸åŠæ ¼",
    _ => "ä¸€èˆ¬"
};
```

å…³ç³»æ¨¡å¼ä¸­ï¼Œè¢«æ¯”è¾ƒçš„å€¼åªèƒ½æ˜¯ç¼–è¯‘æ—¶å¸¸é‡å€¼ã€‚

### é€»è¾‘æ¨¡å¼

å¯ä»¥é€šè¿‡`not`ã€`and`ã€`or`å¯¹å…³ç³»æ¨¡å¼ã€å¸¸é‡æ¨¡å¼è¿›è¡Œç»„åˆã€‚å¹¶ä¸”ï¼Œå¯ä»¥é€šè¿‡`(`å’Œ`)`æ¥æ”¹å˜é€»è¾‘çš„ä¼˜å…ˆçº§é¡ºåºã€‚

```c#
if (obj is not null)
{
}

var season = month switch
{
    >= 3 and < 6 => "æ˜¥",
    >= 6 and < 9 => "å¤",
    >= 9 and < 12 => "ç§‹",
    12 or (>= 1 and < 3) => "å†¬",
    _ => throw new Exception("æœˆä»½ä¸åˆæ³•")
};
```

é€»è¾‘æ¨¡å¼è·Ÿwhenå­å¥çš„åŒºåˆ«ï¼š

- é€»è¾‘æ¨¡å¼åªèƒ½ä½¿ç”¨`<`ã€`>`ã€`<=`ã€`>=`æ¥æ¯”è¾ƒå…³ç³»ï¼Œå¹¶ç”¨`not`ã€`and`ã€`or`æ¥ç»„åˆå…³ç³»ï¼›`when`å­å¥å¯ä»¥ä½¿ç”¨ä»»æ„è¿”å›`bool`çš„è¡¨è¾¾å¼ã€‚
- é€»è¾‘æ¨¡å¼åªèƒ½æ¯”è¾ƒå¸¸é‡å€¼ï¼Œ`when`å­å¥æ²¡è¿™ä¸ªé™åˆ¶ã€‚
- å®ƒä¿©ä¸å†²çªï¼Œé€»è¾‘æ¨¡å¼ä¸­ä¹Ÿç…§æ ·å¯ä»¥ç”¨`when`å­å¥ã€‚äº‹å®ä¸Šä»»ä½•æ¨¡å¼éƒ½å¯ä»¥ç”¨`when`å­å¥ã€‚

æ˜¯ä¸æ˜¯æ„Ÿè§‰å¥½åƒä¹Ÿæ²¡å•¥ç”¨ï¼Ÿä½†æ˜¯ï¼Œå®ƒçœäº‹å„¿å•Šã€‚å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œç”¨`when`å­å¥æ˜¯ï¼š

```c#
var season = month switch
{
    int m when m >= 3 && m < 6 => "æ˜¥",
    int m when m >= 6 && m < 9 => "å¤",
    int m when m >= 9 && m < 12 => "ç§‹",
    int m when m == 12 || (m >= 1 && m < 6) => "å†¬",
    _ => throw new Exception("æœˆä»½ä¸åˆæ³•")
};
```

å¥½åƒç”¨å…³ç³»æ¨¡å¼è¦çŸ­ä¸€ç‚¹å¯¹å§ã€‚

### æ¨¡å¼åŒ¹é…çš„æ€»ç»“

åˆ°äº†è¿™é‡Œï¼ŒC#çš„æ¨¡å¼åŒ¹é…ç®—æ˜¯å®Œå…¨ä½“äº†ã€‚æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ï¼ŒC#7.0ã€8.0ã€9.0ï¼Œä¸€å…±æœ‰å“ªäº›æ¨¡å¼æ¥ç€ï¼š

- å£°æ˜æ¨¡å¼
- ç±»å‹æ¨¡å¼
- å¸¸é‡æ¨¡å¼
- å…³ç³»æ¨¡å¼
- é€»è¾‘æ¨¡å¼
- å±æ€§æ¨¡å¼
- å…ƒç»„æ¨¡å¼
- ä½ç½®æ¨¡å¼
- varæ¨¡å¼
- å¼ƒå…ƒæ¨¡å¼

è¿™äº›æ¨¡å¼å·²è¶³å¤Ÿå¼ºå¤§ã€‚è€Œä¸”å¾ˆå…³é”®çš„ï¼Œå®ƒä»¬æ˜¯å¯ä»¥æ··ç”¨çš„ã€‚ä¾‹å¦‚ï¼šè¿™äº›æ¨¡å¼å¯ä»¥åŒæ—¶å‡ºç°åœ¨åŒä¸€ä¸ªswitchè¡¨è¾¾å¼é‡Œï¼›ç”šè‡³ï¼Œè¿™äº›æ¨¡å¼çš„åé¢ï¼Œä¹Ÿéƒ½å¯ä»¥å¸¦ä¸Š`when`å­å¥ã€‚

æœ€åä¸€ä¸ªä¾‹å­ï¼š

```c#
var season = month switch
{
    int m when m >= 3 && m < 6 => "æ˜¥",          //å£°æ˜æ¨¡å¼+whenå­å¥
    >= 6 when month < 9 => "å¤",                 //å…³ç³»æ¨¡å¼+whenå­å¥
    >= 9 and < 12 => "ç§‹",                       //å…³ç³»æ¨¡å¼+é€»è¾‘æ¨¡å¼
    12 => "å†¬",                                  //å¸¸é‡æ¨¡å¼
    1 or 2 => "å†¬",                              //å¸¸é‡æ¨¡å¼+é€»è¾‘æ¨¡å¼
    int.MaxValue when 1 == 1 => "æœªçŸ¥",          //å¸¸é‡æ¨¡å¼+whenå­å¥
    var _ => throw new Exception("æœˆä»½ä¸åˆæ³•"),  //varæ¨¡å¼+å¼ƒå…ƒ
    // _ => thrown new Exception()               //å¼ƒå…ƒæ¨¡å¼ï¼Œè¿™é‡Œå› ä¸ºæœ‰varæ¨¡å¼äº†ï¼Œæ‰€ä»¥æ— æ³•è¾¾åˆ°æ­¤åˆ†æ”¯ã€‚æ­¤å¤„å¦‚æœå–æ¶ˆæ³¨é‡Šï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚
};
```

ä¸Šé¢è¿™ä¸ªè®©äººçœ‹äº†å“ªå“ªéƒ½ç–¼çš„ä¾‹å­ï¼Œè‡ªç„¶ä¸ä¼šå‡ºç°åœ¨å®é™…é¡¹ç›®ä¸­ã€‚ä½†ç”¨å®ƒå¯¹æ¨¡å¼åšä¸ªæ€»ç»“è¿˜æ˜¯å¾ˆè´´åˆ‡çš„ï¼Œè¿™é‡Œé¢é™¤äº†æ²¡æœ‰å±æ€§æ¨¡å¼ã€å…ƒç»„å’Œä½ç½®æ¨¡å¼ä¹‹å¤–ï¼Œå…¶ä»–çš„éƒ½æåˆ°äº†ã€‚

## ç›®æ ‡ç±»å‹newè¡¨è¾¾å¼

ä¸varéšå¼ç±»å‹ç”¨äºé€šè¿‡å³ä¾§ç±»å‹æ¨æ–­å·¦ä¾§å˜é‡ç±»å‹ç›¸åï¼Œç›®æ ‡ç±»å‹newè¡¨è¾¾å¼æ˜¯é€šè¿‡å·¦ä¾§å˜é‡ç±»å‹æ¨æµ‹å³ä¾§çš„`new`è¡¨è¾¾å¼ç±»å‹ã€‚

å…·ä½“è¯´æ¥ï¼Œå°±æ˜¯å·¦ä¾§å¦‚æœæ˜¯æ˜ç¡®çš„ç±»å‹ï¼Œå³ä¾§`new`æ—¶å¯ä»¥çœç•¥ç±»å‹ã€‚

è¿™å¯¹å‚æ•°ä¼ é€’ä¹Ÿæœ‰æ•ˆã€‚

å½“ç›®æ ‡ç±»å‹newè¡¨è¾¾å¼ç»“åˆåˆå§‹åŒ–å™¨æ—¶ï¼Œåœ†æ‹¬å·ä¸å¯ä»¥çœç•¥ï¼ˆå¦åˆ™å°±æ˜¯åŒ¿åç±»å‹äº†ï¼‰ã€‚

```c#
Cat cat = new();  //è‡ªåŠ¨æ¨æµ‹newçš„ç±»å‹

Cat cat2 = new()   //è‡ªåŠ¨æ¨æµ‹ï¼Œå¹¶ç»“åˆåˆå§‹åŒ–å™¨
{
    Name = "å–µ"
};

person.Buy(new("æ¯›å·¾"));  //Personç±»çš„Buyæ–¹æ³•ä¼ é€’ä¸€ä¸ªGoodsç±»å‹çš„å‚æ•°ï¼Œè¿™é‡Œnewè‡ªåŠ¨æ¨æµ‹ç±»å‹ä¸ºGoods

//å¤æ‚ä¸€ç‚¹çš„ä¾‹å­ï¼š
Dictionary<string, List<int>> dict = new ()   //è‡ªåŠ¨æ¨æµ‹ç±»å‹ä¸ºDictionary<string, List<int>>
{
    { "åˆ†ç±»1", new () { 1, 2, 3 } }  //è‡ªåŠ¨æ¨æµ‹ç±»å‹ä¸ºList<int>
};
```

## åå˜è¿”å›ç±»å‹

å­ç±»å‹åœ¨é‡å†™çˆ¶ç±»å‹æ–¹æ³•æ—¶ï¼Œç°åœ¨ä¸è¦æ±‚è¿”å›å®Œå…¨ç²¾ç¡®çš„ç›¸åŒè¿”å›ç±»å‹ã€‚åŸºç±»çš„æ–¹æ³•è¿”å›å¯ä»¥ä½œä¸ºåå˜è¿”å›ç±»å‹ï¼Œå­ç±»é‡å†™æ—¶åªéœ€è¦è¿”å›è¯¥è¿”å›ç±»å‹çš„é€†å˜ç±»å‹å³å¯ã€‚

```c#
public class Animal
{
    public virtual Animal Clone() { ... }
}
public class Cat : Animal
{
    public override Cat Clone() { ... } //OK è¿”å›é€†å˜ç±»å‹
}
```

> Javaæ—©åœ¨5æ—¶ä¾¿æ”¯æŒäº†è¯¥è¯­æ³•ã€‚

## Lambdaçš„å¼ƒå…ƒå‚æ•°

Lambdaçš„å‚æ•°ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨å¼ƒå…ƒï¼Œå¦‚æœä½ åœ¨Lambdaä¸­ä¸æ‰“ç®—ä½¿ç”¨è¿™ä¸ªå‚æ•°çš„è¯ã€‚

```c#
(_, _) => true;

(a, _) => 
{

}

delegate(int _, int b) { return 0; } //åŒ¿åæ–¹æ³•ä¸­ä½¿ç”¨å¼ƒå…ƒ
```

è¯·æ³¨æ„ï¼Œå¦‚æœLambdaçš„å‚æ•°åªæœ‰ä¸€ä¸ªï¼Œæ­¤æ—¶ä½¿ç”¨`_`ä¸ä¼šè¢«è§†ä½œå¼ƒå…ƒã€‚è¿™æ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹ï¼Œå› ä¸ºå•ç‹¬çš„`_`ä¹‹å‰ä¹Ÿè¢«è§†ä½œåˆæ³•çš„å˜é‡åã€‚å•ç‹¬çš„`_`ä½œä¸ºLambdaå‚æ•°å¯ä»¥æ­£å¸¸è·å–å…¶å€¼ã€‚

```c#
Action<int> action = _ => Console.WriteLine(_);  //æ­¤å¤„_ä¼šè¢«è§†ä½œæ™®é€šå˜é‡ï¼Œå› è€Œä½œä¸ºæ‰“å°å‚æ•°ä¸ä¼šæŠ¥é”™ã€‚
```

## æ¨¡å—çš„åˆå§‹åŒ–æ–¹æ³•

ç°åœ¨å¯ä»¥é€šè¿‡ModuleInitializerAttributeç‰¹æ€§æ¥æ ‡æ³¨ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¿…é¡»æ»¡è¶³ï¼š

1. æ–¹æ³•å¿…é¡»æ˜¯`static`ã€‚
2. æ–¹æ³•å¿…é¡»æ˜¯æ™®é€šæˆå‘˜ï¼Œä¸èƒ½æ˜¯getterï¼Œsetterï¼Œæ„é€ å™¨ï¼Œæœ¬åœ°å‡½æ•°ã€‚
3. æ–¹æ³•å¿…é¡»æ— å‚æ•°ï¼Œä¸”å¿…é¡»è¿”å›`void`ã€‚
4. ä¸èƒ½æ˜¯æ³›å‹æ–¹æ³•ï¼Œä¹Ÿä¸èƒ½åœ¨æ³›å‹ç±»ä¸­ã€‚
5. å¯è®¿é—®æ€§å¿…é¡»æ˜¯`public`æˆ–è€…`internal`ã€‚

è¿™æ ·ä¿®é¥°çš„æ–¹æ³•ï¼Œè¢«ç¼–è¯‘å™¨è§†ä½œæ¨¡å—ï¼ˆModuleï¼‰åˆå§‹åŒ–æ–¹æ³•ã€‚ä¼šåœ¨æ¨¡å—ç¬¬ä¸€æ¬¡è¢«åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ã€‚

å®ƒæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- å®ƒä¼šåœ¨æ¨¡å—ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶è°ƒç”¨ï¼Œä¾‹å¦‚ï¼šè®¿é—®é™æ€å­—æ®µï¼Œnewä¸€ä¸ªæ¨¡å—å†…ç±»å‹çš„å¯¹è±¡ã€‚
- å®ƒåªä¼šè¢«ç²¾ç¡®è‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡ã€‚ä¸è¿‡ç”¨æˆ·ä»ç„¶å¯ä»¥é€šè¿‡ä»£ç è°ƒç”¨å®ƒã€‚
- å®ƒçš„æ‰§è¡Œæ—¶æœºåœ¨æ‰€æœ‰å…¶å®ƒæ–¹æ³•ä¹‹å‰ï¼Œä½†å®ƒå¯ä»¥è°ƒç”¨å…¶ä»–æ–¹æ³•ã€‚

## æ¡ä»¶è¡¨è¾¾å¼çš„ç›®æ ‡ç±»å‹ä¼˜åŒ–

é’ˆå¯¹æ¡ä»¶è¡¨è¾¾å¼`?:`ï¼Œå¦‚æœå®ƒçš„2ã€3æ“ä½œæ•°æ²¡æœ‰å…¬å…±ç±»å‹ã€æˆ–è€…å®ƒä»¬çš„å…¬å…±ç±»å‹ä¸­æ— æ³•è¢«éšå¼è½¬æ¢ï¼Œç°åœ¨å°†æ ¹æ®æ¥æ”¶å®ƒçš„å˜é‡ç±»å‹ï¼Œå¯¹å®ƒè¿›è¡Œéšå¼ç±»å‹è½¬æ¢ã€‚

ä½†è¿™é‡Œå¼•å…¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šå¦‚æœæ‹¥æœ‰å¤šä¸ªåŒåæ–¹æ³•é‡è½½ï¼Œå…¶é‡è½½çš„å‚æ•°ç±»å‹å‡èƒ½å¤Ÿç”±æ¡ä»¶è¡¨è¾¾å¼è¿›è¡Œéšå¼ç±»å‹è½¬æ¢ã€‚ä½¿ç”¨æ¡ä»¶è¡¨è¾¾å¼ä½œä¸ºå‚æ•°è°ƒç”¨æ–¹æ³•ï¼Œç¼–è¯‘å™¨å°†å¦‚ä½•é€‰æ‹©è°ƒç”¨å“ªä¸ªæ–¹æ³•å‘¢ï¼Ÿ

å…ˆçœ‹ä¸€ä¸ªå®šä¹‰ï¼š

ç»™å®šä»è¡¨è¾¾å¼Eè½¬æ¢ä¸ºç±»å‹`T1`çš„éšå¼è½¬æ¢`C1`ï¼›ä»è¡¨è¾¾å¼Eè½¬æ¢ä¸ºç±»å‹`T2`çš„éšå¼è½¬æ¢`C2`ã€‚å¦‚æœ`E`ä¸èƒ½ç²¾ç¡®åŒ¹é…`T2`ï¼Œå¹¶ä¸”è‡³å°‘æ»¡è¶³ä»¥ä¸‹ä¸€ä¸ªæ¡ä»¶ï¼š

- `E`ç²¾ç¡®åŒ¹é…`T1`ã€‚
- `C1`ä¸æ˜¯æ¡ä»¶è¡¨è¾¾å¼çš„è½¬æ¢ï¼Œ`C2`æ˜¯æ¡ä»¶è¡¨è¾¾å¼çš„è½¬æ¢ã€‚
- `T1`æ˜¯æ¯”`T2`æ›´ä¼˜çš„è½¬æ¢ç›®æ ‡ï¼Œå¹¶ä¸”`C1`å’Œ`C2`éƒ½æ˜¯æ¡ä»¶è¡¨è¾¾å¼çš„è½¬æ¢ï¼Œæˆ–è€…éƒ½ä¸æ˜¯æ¡ä»¶è¡¨è¾¾å¼çš„è½¬æ¢ã€‚

æˆ‘ä»¬ç§°`C1`æ˜¯æ¯”`C2`çš„**æ›´ä¼˜è½¬æ¢**ã€‚

ç¼–è¯‘å™¨ä¼šé‡‡ç”¨å‚æ•°ç±»å‹ä¸ºæ›´ä¼˜è½¬æ¢çš„ç±»å‹çš„é‡è½½è°ƒç”¨ã€‚

ä¸¾ä¾‹è¯´æ˜ï¼š

```c#
M(b ? 1 : 2);

void M(short);
void M(long);
```

Mæœ‰ä¸¤ä¸ªé‡è½½ï¼Œè€Œæ¡ä»¶è¡¨è¾¾å¼ `b ? 1 : 2`ä¼šæ ¹æ®æ›´ä¼˜è½¬æ¢çš„è§„åˆ™ï¼Œé€‰æ‹©è°ƒç”¨`void M(long)`ï¼Œå› ä¸º`long`æ˜¯æ¯”`short`æ›´ä¼˜çš„è½¬æ¢ç›®æ ‡ã€‚

å…³äº**æ›´ä¼˜è½¬æ¢ç›®æ ‡**ï¼Œé‚£åˆæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„è§„åˆ™äº†ã€‚è¿™é‡Œä¸æ‰“ç®—åˆ—ä¸¾å‡ºæ¥ã€‚

å¦‚æœä½ å®åœ¨ä¸æƒ³è´¹å¿ƒè®°ä½æ›´ä¼˜è½¬æ¢ç›®æ ‡çš„é•¿ç¯‡è§„åˆ™ï¼Œåªéœ€è¦ç®€å•çš„åœ¨è°ƒç”¨æ–¹æ³•æ—¶å¯¹æ•´ä¸ªæ¡ä»¶è¡¨è¾¾å¼åšä¸€ä¸‹å¼ºåˆ¶ç±»å‹è½¬æ¢å°±å¥½äº†ã€‚çœå¿ƒåˆçœåŠ›ã€‚

## C# 9.0çš„å…¶ä»–æ”¹è¿›

- **`static`åŒ¿åæ–¹æ³•**ï¼šç°åœ¨åŒ¿åæ–¹æ³•ã€Lambdaï¼Œä¹Ÿæ”¯æŒè®¾ç½®ä¸ºé™æ€çš„äº†ã€‚é™æ€çš„åŒ¿åæ–¹æ³•è·Ÿé™æ€çš„æœ¬åœ°å‡½æ•°ä¸€æ ·ï¼Œæ— æ³•è®¿é—®å½“å‰è¯­å¥æ‰€åœ¨ä¸Šä¸‹æ–‡ä¸­çš„å±€éƒ¨å˜é‡ã€ç±»çš„éé™æ€æˆå‘˜ã€‚
- **`foreach`çš„æ”¹è¿›**ï¼šä¸€ä¸ªç±»çš„GetEnumeratoræ–¹æ³•ç°åœ¨å³ä½¿æ˜¯æ‰©å±•æ–¹æ³•ï¼Œè¯¥ç±»å¯¹è±¡ä¹Ÿå¯ä»¥ä½¿ç”¨`foreach`æ¥éå†äº†ã€‚
- **æœ¬åœ°å‡½æ•°çš„ç‰¹æ€§**ï¼šåº”ç”¨äºæ–¹æ³•ã€æ–¹æ³•å‚æ•°æˆ–æ³›å‹ç±»å‹å‚æ•°çš„ç‰¹æ€§ï¼Œç°åœ¨éƒ½å¯ä»¥åº”ç”¨äºæœ¬åœ°å‡½æ•°ã€‚ä¸ç”¨åœ¨æ–¹æ³•ä¸Šå…·æœ‰ç›¸åŒå«ä¹‰ã€‚
- **æœ¬æœºå¤§å°çš„æ•´æ•°**ï¼šæ–°å¢ä¸¤ä¸ªå…³é”®è¯`nint`å’Œ`nuint`ï¼Œç”¨äºå®šä¹‰æœ¬æœºå¤§å°çš„æ•´æ•°ã€‚
- **å‡½æ•°æŒ‡é’ˆ**ï¼šåœ¨unsafeä¸­æ”¯æŒå‡½æ•°æŒ‡é’ˆï¼Œä»¥ä¾¿äºæ›´æ–¹ä¾¿çš„è°ƒç”¨C++å†™çš„åº“ã€‚æ–¹æ³•æ˜¯ä½¿ç”¨`delegate* <å‚æ•°ç±»å‹1,å‚æ•°ç±»å‹2,...,è¿”å›ç±»å‹>`æ¥å®šä¹‰ã€‚è¿”å›ç±»å‹å¯ä»¥æ˜¯voidã€‚
- **ç¦æ­¢å‘å‡ºlocalsinitæ ‡è®°**ï¼šC#ä¸å…è®¸ä½¿ç”¨æœªèµ‹åˆå€¼çš„å±€éƒ¨å˜é‡ã€‚åˆå§‹åŒ–å±€éƒ¨å˜é‡æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯ç›´æ¥èµ‹å€¼ï¼›å¦ä¸€ç§æ˜¯ç»™å«æœ‰å±€éƒ¨å˜é‡çš„æ–¹æ³•å‘é€localsinitæ ‡è®°ã€‚å‘é€localsinitå¯ç”¨äºåˆå§‹åŒ–åˆ†é…åœ¨æ ˆä¸Šçš„æ•°ç»„ï¼Œä½¿å®ƒä»¬åœ¨ä½¿ç”¨å‰æ‰€æœ‰å†…å­˜å…ƒç´ è¢«å…¨éƒ¨èµ‹å€¼æˆ0ã€‚ç”¨è¿‡C++çš„å°ä¼™ä¼´åº”è¯¥éƒ½çŸ¥é“ï¼Œæ²¡æœ‰åˆå§‹åŒ–çš„å†…å­˜å¯èƒ½æ®‹ä½™ä¹‹å‰çš„æ•°æ®ï¼Œæˆ–è€…å¹²è„†æ˜¯å†…å­˜åˆšåŠ ç”µæ—¶çš„æ··ä¹±çŠ¶æ€ï¼Œç›´æ¥æ‹¿æ¥ä½¿ç”¨æ˜¯ä¸å®‰å…¨çš„ã€‚æ‰€ä»¥ä½¿ç”¨å‰å¯¹å†…å­˜åŒºåŸŸè¿›è¡Œåˆå§‹åŒ–æœ¬æ²¡æœ‰æ¯›ç—…ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ•°ç»„çš„å¤§å°è¾ƒå¤§ï¼Œåˆå§‹åŒ–å¯èƒ½å¸¦æ¥é¢å¤–çš„æ€§èƒ½æŸå¤±ã€‚C#ç°åœ¨æä¾›äº†è·³è¿‡åˆå§‹åŒ–çš„é€‰é¡¹ï¼Œåªéœ€è¦åœ¨ä¸å¸Œæœ›ç»™å±€éƒ¨å˜é‡å‘é€localsinitæ ‡è®°çš„æ–¹æ³•ä¸Šæ ‡æ³¨`SkipLocalsInitAttribute`ç‰¹æ€§å³å¯ã€‚
- **åˆ†éƒ¨æ–¹æ³•çš„ä¼˜åŒ–**ï¼šå¦‚ä¹‹å‰æåˆ°è¿‡çš„ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œpartialçš„æ–¹æ³•çš„é™åˆ¶ï¼ˆä¸èƒ½æŒ‡å®šä¿®é¥°ç¬¦ã€ä¸èƒ½è¿”å›`void`ã€ä¸èƒ½å¸¦`out`å‚æ•°ï¼‰å‡è¢«å–æ¶ˆã€‚ä½†æ˜¯è¦æ±‚å¿…é¡»æä¾›å®ç°ã€‚

# C# 10.0 â€”â€” å­¦æ— æ­¢å°½

C# 10.0ï¼Œåœ¨2021å¹´çš„å¹´æœ«è·Ÿéš\.Net 6å’ŒVisual Studio 2022å‘å¸ƒäº†ã€‚å®ƒæ˜¯ç›®å‰æœ€æ–°çš„C#è¯­è¨€ç‰ˆæœ¬ã€‚

å®ƒæ”¯æŒä»¥ä¸‹è¯­æ³•ï¼š

## è®°å½•ç»“æ„ï¼ˆRecord Structï¼‰

æœ‰è¶£çš„å¾ˆï¼Œåˆšåˆšæå‡ºäº†recordï¼Œç°åœ¨å°±å¼€å§‹å«Œå¼ƒå®ƒäº†ã€‚åŸå› ç«Ÿç„¶æ˜¯ï¼šå®ƒæ˜¯å¼•ç”¨ç±»å‹çš„ã€‚

äºæ˜¯ï¼ŒC# 10.0ï¼Œæ¨å‡ºäº†å€¼ç±»å‹ç‰ˆæœ¬çš„recordã€‚å¹¶å–åä¸ºè®°å½•ç»“æ„ã€‚

å…³é”®è¯ä¸º`record struct`ï¼Œæˆ–è€…`readonly record struct`ã€‚

äºæ­¤åŒæ—¶ï¼Œä¸ºäº†å‘¼åº”ï¼ŒåŸæ¥çš„recordç±»å‹ï¼Œç°åœ¨ç­‰åŒäº`record class`ã€‚å› æ­¤ï¼Œåœ¨C# 10.0ä¹‹åå£°æ˜å¼•ç”¨ç±»å‹çš„è®°å½•ï¼Œå¯ä»¥ç”¨`record`ï¼Œä¹Ÿå¯ä»¥ç”¨`record class`

è¿™é‡Œå°±ä¸ä¸¾ä¾‹äº†ã€‚

## å±æ€§æ¨¡å¼çš„æ”¹è¿›

æ¨¡å¼åŒ¹é…ä¸­çš„å±æ€§æ¨¡å¼ï¼Œåœ¨å«æœ‰åµŒå¥—çš„æ—¶å€™ï¼Œä¹‹å‰åªèƒ½é€šè¿‡`{}`çš„åµŒå¥—å®ç°ï¼Œç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨`.`è¿ç®—ç¬¦ï¼š

```c#
Cat cat = new Cat();
if (cat is { Name: "å–µå–µ", Looks: { Shape: "Fat", Color: Color.White } })  //ä»å‰çš„åµŒå¥—
{
}
if (cat is { Name: "å–µå–µ", Looks.Shape: "Fat", Looks.Color: Color.White })  //ç°åœ¨å¯ä»¥è¿™æ ·
{
}
```

## Lambdaè¡¨è¾¾å¼çš„æ”¹è¿›

- Lambdaè¡¨è¾¾å¼ä»å‰æ˜¯ä¸æ”¯æŒå£°æ˜ç±»å‹çš„ï¼Œç°åœ¨æ”¯æŒäº†ã€‚è¿™æ ·ä¾¿å¯ä»¥èµ‹å€¼ç»™`var`å®šä¹‰çš„å§”æ‰˜äº†ã€‚

    ```c#
    var parse = (string s) => int.Parse(s);  //æŒ‡å®šå‚æ•°ç±»å‹
    var choose = object (bool b) => b ? 1 : "one";  //æŒ‡æ˜å‚æ•°ç±»å‹ã€è¿”å›ç±»å‹
    ```

- Lambdaç°åœ¨ä¹Ÿæ”¯æŒç‰¹æ€§äº†ï¼šåº”ç”¨äºæ–¹æ³•ã€æ–¹æ³•å‚æ•°æˆ–æ³›å‹ç±»å‹å‚æ•°çš„ç‰¹æ€§ï¼Œç°åœ¨éƒ½å¯ä»¥åº”ç”¨äºLambdaã€‚ä¸ç”¨åœ¨æ–¹æ³•ä¸Šå…·æœ‰ç›¸åŒå«ä¹‰ã€‚

    ```c#
    var parse = [SomeMethodAttrubite] ([SomeParamAttribute] string s) => int.Parse(s);  //æŒ‡å®šå‚æ•°ç±»å‹
    var choose = [SomeMethodAttrubite] [return:SomeReturnAttrubite] object (bool b) => b ? 1 : "one";  //æŒ‡æ˜å‚æ•°ç±»å‹ã€è¿”å›ç±»å‹
    ```

## constå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å†…æ’

å¦‚æœä¸€ä¸ª`const`å­—æ®µæ˜¯stringç±»å‹ï¼Œç°åœ¨ç»™å®ƒèµ‹å€¼å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å†…æ’ï¼Œæ¡ä»¶æ˜¯ç»„æˆå†…æ’è¡¨è¾¾å¼çš„å‡æ˜¯`const`çš„å¸¸é‡ã€‚

```c#
const string zhang = "å¼ ä¸‰";
const string li = "æå››";
const string say = $"æˆ‘å«{zhang}ï¼Œä¸å«{li}"; //åˆæ³•ï¼Œå› ä¸ºzhangå’Œliéƒ½æ˜¯å¸¸é‡
```

## å…ƒç»„è§£æ„å£°æ˜çš„ä¼˜åŒ–

æˆ‘ä»¬åœ¨è§£æ„å…ƒç»„çš„æ—¶å€™ï¼Œå¯ä»¥åŒæ­¥å£°æ˜å˜é‡ã€‚ä½†æ˜¯ä¹‹å‰æ‰€æœ‰å˜é‡å¿…é¡»ä¸€åŒå£°æ˜ã€‚ç°åœ¨æ”¯æŒä¸€éƒ¨åˆ†åœ¨è§£æ„æ—¶å£°æ˜ï¼Œä¸€éƒ¨åˆ†åˆ™ä½¿ç”¨ä¹‹å‰çš„å˜é‡ã€‚

```c#
int x = 0;
(x, int y) = (3, 4);   //åˆæ³•ï¼Œæ­¤å¤„åªåœ¨è§£æ„åŒæ—¶å£°æ˜yï¼Œxä½¿ç”¨ä¹‹å‰çš„å˜é‡
```

## è°ƒç”¨è€…ä¿¡æ¯æ”¹è¿›

è°ƒç”¨è€…ä¿¡æ¯ç‰¹æ€§æ–°å¢äº†ä¸€ä¸ªæˆå‘˜`CallerArgumentExpressionAttribute`ã€‚å®ƒç”¨æ¥ä¿®é¥°stringç±»å‹çš„æœ‰é»˜è®¤å€¼çš„å‚æ•°ï¼Œå¯è·å–è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼ŒæŸä¸ªå‚æ•°ä¼ å…¥çš„è¡¨è¾¾å¼çš„æ–‡æœ¬æè¿°ã€‚

```c#
public void TracedMethod(int param1, 
    [CallerArgumentExpression("param1")] string argExpression = null)  //æŒ‡ç¤ºè·å–param1å‚æ•°çš„è¡¨è¾¾å¼
{
    Console.WriteLine($"è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œä¼ é€’çš„param1å‚æ•°çš„è¡¨è¾¾å¼æ˜¯{argExpression}");    
}

obj.TracedMethod(1 + 2 + 3);  //æ­¤æ—¶ï¼Œæ–¹æ³•å†…çš„argExpressionå‚æ•°ä¼šè¢«å¡«å……ä¸º  1 + 2 + 3
```

æ˜¯ä¸æ˜¯ç°å¸¸é«˜çº§ï¼Ÿè¿™åœ¨ç”¨äºè¯Šæ–­ã€è®°å½•Logæ—¶ä¼šå¾ˆæœ‰ç”¨ã€‚

## C# 10.0çš„å…¶ä»–æ”¹è¿›

- **ç»“æ„çš„æ”¹è¿›**ï¼š
    - ç»“æ„ç°åœ¨å¯ä»¥å£°æ˜æ— å‚æ„é€ å™¨äº†
    - ç»“æ„ç°åœ¨ä¹Ÿå¯ä»¥ç”¨withè¿ç®—ç¬¦æ¥èµ‹å€¼äº†ï¼Œä¹‹å‰åªèƒ½ç”¨åœ¨recordä¸Š
    - é’ˆå¯¹åŒ¿åç±»å‹ï¼Œç°åœ¨ä¹Ÿå¯ä»¥ä½¿ç”¨withè¿ç®—ç¬¦

- **å†…æ’å­—ç¬¦ä¸²å¤„ç†ç¨‹åº**ï¼šç°åœ¨ä½ å¯ä»¥ä¸ä½¿ç”¨ç³»ç»Ÿçš„å†…æ’å­—ç¬¦ä¸²å¤„ç†ç¨‹åºï¼Œè€Œå»è‡ªå·±å®šä¹‰ä¸€ä¸ªå†…æ’å­—ç¬¦ä¸²çš„å¤„ç†ç¨‹åºã€‚ä»£ç ä¸­çš„å†…æ’å­—ç¬¦ä¸²ä¼šè½¬äº¤ç”±ä½ å®šä¹‰çš„ç±»æ¥å¤„ç†ã€‚  
- **å…¨å±€å¼•ç”¨**ï¼šå¯ä»¥ä½¿ç”¨`global using`è¯­å¥æ¥å¼•ç”¨å‘½åç©ºé—´ã€‚è¿™æ ·åšæ—¶ï¼Œå½“å‰ç¼–è¯‘ç¯å¢ƒä¸‹çš„æ‰€æœ‰å¾…ç¼–è¯‘æ–‡ä»¶ï¼Œé»˜è®¤éƒ½ä¼šusingè¯¥å‘½åç©ºé—´ã€‚
- **æ–‡ä»¶èŒƒå›´çš„å‘½åç©ºé—´å£°æ˜**ï¼šç°åœ¨`namespace`çš„å£°æ˜å¯ä»¥ä¸å¿…ä½¿ç”¨èŠ±æ‹¬å·`{}`å°†å‘½åç©ºé—´å†…çš„å®šä¹‰åŒ…è£¹èµ·æ¥ï¼Œè€Œæ˜¯å¯ä»¥å°†namespaceä½œä¸ºå•ç‹¬çš„è¯­å¥å£°æ˜ã€‚è¿™æ ·åšæ—¶ï¼Œnamespaceå°†ä¼šå¯¹å½“å‰æ–‡ä»¶ç”Ÿæ•ˆã€‚è¿™æ ·åšå¯ä»¥å‡å°‘ç¼©è¿›ã€‚è¿™è·ŸJavaçš„packageå¾ˆåƒã€‚ä¾‹å¦‚ï¼š`namespace TestApp;`
- **è®°å½•ç±»å‹**ï¼Œç°åœ¨å¯ä»¥åœ¨é‡å†™ToStringæ—¶ï¼Œæ ‡è®°ä¸ºå¯†å°ï¼ˆsealedï¼‰
- **æ˜ç¡®èµ‹å€¼çš„ç¼–è¯‘å™¨æ”¹è¿›**ï¼šåœ¨å¼€å¯å¯nullæ„ŸçŸ¥ä¸Šä¸‹æ–‡æ—¶ï¼Œç¼–è¯‘å™¨å¯¹æŸäº›åœºæ™¯çš„nullåˆ¤æ–­åšäº†ä¼˜åŒ–ï¼Œå˜å¾—æ›´åŠ æ™ºèƒ½äº†ã€‚ä¸»è¦æ˜¯åœ¨ifåˆ¤æ–­ä¸­ï¼Œå¦‚æœifå·²ç»å¯æ˜ç¡®æ¨æ–­æŸå˜é‡ä¸ä¸ºnullæ—¶ï¼Œä¸å†ä¼šç»™å‡ºå¯èƒ½ä¸ºnullè­¦å‘Šã€‚
- **AsyncMethodBuilderAtrributeç°åœ¨å¯ä»¥è¢«æ·»åŠ åˆ°æ–¹æ³•ä¸Šäº†**ï¼Œä¹‹å‰åªèƒ½è¢«æ·»åŠ åˆ°ç±»ä¸Šï¼ˆC# 7.0ï¼Œå¯ä»¥æŸ¥çœ‹ä¹‹å‰çš„ä»‹ç»ï¼‰ã€‚è¿™æ ·åšå¯ä»¥å•ç‹¬æŒ‡å®šæŸä¸ªæ–¹æ³•é‡‡ç”¨ç‰¹å®šçš„å¼‚æ­¥æ–¹æ³•æ„å»ºå™¨ï¼Œè€Œä¸æ˜¯æ‰€æœ‰è¿”å›è¯¥ç±»å‹çš„å¼‚æ­¥æ–¹æ³•éƒ½é‡‡ç”¨æ­¤æ„å»ºå™¨ã€‚
- **é¢„å¤„ç†æŒ‡ä»¤\#lineå¢å¼º**ï¼šç°åœ¨çš„è¯­æ³•æ”¯æŒ`#line (èµ·å§‹è¡Œ,èµ·å§‹åˆ—) - (ç»“æŸè¡Œ,ç»“æŸåˆ—) åˆ—åç§»é‡ "æ–‡ä»¶å"`ï¼Œä¸è¿‡ä¸€èˆ¬ç”¨ä¸ä¸Šã€‚

---

ç»ˆäºï¼ŒC#çš„å†ç¨‹å³å°†è¿›å…¥å°¾å£°äº†ã€‚C#å’Œ\.Netç›®å‰å·²ç»æœ‰äº†æ˜ç¡®çš„æ—¶é—´è¡¨ï¼Œæœªæ¥ä¼šæŒ‰ç…§æ—¶é—´è¡¨è¿­ä»£å’Œæ¨å‡ºæ–°çš„ç‰ˆæœ¬ã€‚åŠ ä¹‹å¼€æº+MITçš„è®¸å¯åè®®ï¼Œç›¸ä¿¡å¯ä»¥è·å¾—æ›´å¤šæŠ•èµ„è€…çš„å…³æ³¨ï¼Œä¹ŸæœŸæœ›æ›´å¤šçš„ä¼˜ç§€å¼€æºé¡¹ç›®å‡ºç°ï¼Œå¡«è¡¥ç”Ÿæ€çš„çŸ­æ¿ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥èŠç‚¹æœ‰æ„æ€çš„è¯é¢˜ï¼š

# ç›¸é¡¾å›çœ¸

ä½œä¸ºCShaperæˆ–è€…Javaerï¼Œä¼šå‘ç°C#å’ŒJavaæœ¬åŒæºï¼Œå´èµ°ä¸Šäº†ä¸åŒçš„å‘å±•é“è·¯ã€‚ç½‘ä¸Šå…³äºJavaerå’ŒCShaperçš„å£èˆŒæˆ˜äº‰å®æ•°ä¸å°‘ï¼Œä½†æ˜¯å¦‚æœä¸¤ç¾¤äººå¯ä»¥ç›¸äº’å¼ æœ›ä¸€ä¸‹ï¼Œåˆä¼šæœ‰ä»€ä¹ˆè¶£äº‹å‘ç”Ÿå‘¢ï¼Ÿ

## æœ‰ä»€ä¹ˆæ˜¯Javaæœ‰ä½†æ˜¯C#æ²¡æœ‰çš„

è¿™ç« æ˜¯å†™ç»™CShperçš„ã€‚ï¼ˆæ­¤ç« èŠ‚ä¸­çš„å¯¹æ¯”éƒ¨åˆ†ï¼Œä¸ä¼šé‡‡ç”¨ä¹‹å‰çš„æ ¼å¼ã€‚ï¼‰

æ²¡æœ‰æ¥è§¦è¿‡Javaçš„CShaperè™½ç„¶è€³é—»C#æ˜¯Javaçš„æ”¹è‰¯å“ç§ï¼Œå´ä¸çŸ¥é“åˆ°åº•æ”¹è‰¯äº†äº›ä»€ä¹ˆã€‚é€šè¿‡ä¸Šé¢çš„æ–‡ç« å’Œå…¶ä¸­çš„å¯¹æ¯”ï¼Œç›¸ä¿¡å·²ç»èƒ½æœ‰æ‰€æ¦‚å¿µäº†ã€‚ä½†æ˜¯ï¼ŒJavaéš¾é“å°±æ²¡æœ‰ä»€ä¹ˆç‰¹æ€§åœ¨C#ä¸­æ‰¾ä¸åˆ°å¯¹åº”çš„å—ï¼Ÿ

ç›¸ä¿¡CShaperæœ€æƒ³äº†è§£çš„å°±æ˜¯è¿™ä¸ªäº†ã€‚

å½“ç„¶æœ‰äº†ã€‚å…¶å®å¤§å¤šæ•°å·²ç»åœ¨ä¹‹å‰æåˆ°è¿‡äº†ï¼Œåœ¨è¿™é‡Œå†ç¨ç¨åšä¸ªæ€»ç»“ï¼š

- æšä¸¾

    Javaçš„æšä¸¾æœ¬è´¨æ˜¯ç±»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å®šä¹‰å¤šä¸ªå­—æ®µã€æ–¹æ³•ã€ç§æœ‰æ„é€ å™¨ï¼Œè¿˜å¯ä»¥å®ç°æ¥å£ã€‚C#å¦‚æœè¦å®ç°ç›¸åŒåŠŸèƒ½ï¼Œå¤§éƒ¨åˆ†æ—¶å€™éœ€è¦å€ŸåŠ©æ‰©å±•æ–¹æ³•ã€‚ï¼ˆä¸è¿‡åœ¨æˆ‘æ‰€ä½¿ç”¨çš„å¤§éƒ¨åˆ†åœºæ™¯ä¸­ï¼Œåè€ŒC#çš„ä¼šæ›´å¥½ç”¨ä¸€äº›ã€‚ï¼‰

- åŒ¿åå†…éƒ¨ç±»

    é€šè¿‡åŒ¿åå†…éƒ¨ç±»ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æä¾›ä¸€ä¸ªæ¥å£çš„ä¸´æ—¶å®ç°ã€‚è€Œåœ¨C#ä¸­å®ç°æ¥å£ä½ ä¸å¾—ä¸å®šä¹‰ä¸€ä¸ªç±»ã€‚ï¼ˆä¸è¿‡C#ä¹Ÿå¯ä»¥é€šè¿‡ä¼ é€’å§”æ‰˜ï¼Œè€Œéæ¥å£ä½œä¸ºå‚æ•°çš„æ–¹å¼ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¹Ÿèƒ½è§£å†³é—®é¢˜ã€‚ï¼‰

- throwå£°æ˜

    å½“æ–¹æ³•æœ‰å¯èƒ½throwå‡ºExceptionæ—¶ï¼ˆæœªåœ¨æ–¹æ³•å†…æ•è·ï¼‰ï¼ŒJavaå¿…é¡»åœ¨æ–¹æ³•å®šä¹‰ä¸Šå£°æ˜å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥é˜²æ­¢é—æ¼å¼‚å¸¸çš„æ•è·ã€‚C#æ²¡æœ‰è¿™æ ·çš„å¼ºåˆ¶è¦æ±‚ï¼Œä½ æ— æ³•çŸ¥é“æ–¹æ³•å¯èƒ½æŠ›å‡ºä»€ä¹ˆå¼‚å¸¸ï¼Œé™¤éä½ åœ¨è¯´æ˜æ³¨é‡Šé‡Œæè¿°å‡ºæ¥ã€‚è¿™å°±çº¯çœ‹ç±»åº“çš„ç¼–å†™è€…äº†ã€‚ï¼ˆè¿™ç‚¹å°±æ˜¯çº¯çº¯çš„ä¸å¦‚ï¼‰

å¥½åƒï¼Œå°±è¿™ä¹ˆå¤šäº†â€¦â€¦

## C# Style

è¿™ç« æ˜¯å†™ç»™Javaerçš„ã€‚ï¼ˆæ­¤ç« èŠ‚ä¸­çš„å¯¹æ¯”éƒ¨åˆ†ï¼Œä¸ä¼šé‡‡ç”¨ä¹‹å‰çš„æ ¼å¼ã€‚ï¼‰

æˆ‘çœ‹åˆ°è¿‡å¾ˆå¤šç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œå› ä¸ºéœ€è¦æä¾›å„ä¸ªè¯­è¨€ç‰ˆæœ¬çš„SDKï¼Œæ‰€ä»¥è‡ªç„¶å°‘ä¸äº†æœ‰C#ç‰ˆæœ¬ã€‚å¯èƒ½å› ä¸ºäººå‘˜æœ‰é™ï¼Œæ— æ³•ç”±åŸç”Ÿçš„CShaperå®Œæˆç¼–å†™ã€‚è¿™äº›C#çš„ç‰ˆæœ¬SDKï¼Œä¸€çœ¼ä¾¿èƒ½çœ‹å‡ºæ˜¯Javaerå†™å‡ºæ¥çš„ã€‚ä½œä¸ºCShperä½¿ç”¨èµ·æ¥ä¼šè§‰å¾—æœ‰äº›è®¸åˆ«æ‰­ï¼Œå› ä¸ºå®ƒä»¬â€œæ»¡æ»¡çš„Javaæ°”æ¯ï¼Œä¸å¤ŸC# Styleâ€ã€‚ä¹‹æ‰€ä»¥æœ‰è¿™æ ·çš„å·®åˆ«ï¼ŒæºäºJavaerå’ŒCShaperçš„æ€ç»´ä¹ æƒ¯ä¸åŒã€‚æˆ‘æŠŠCShaperå…·æœ‰çš„æ€ç»´é£æ ¼ç§°ä½œC# Styleã€‚è¯¥é£æ ¼ä½“ç°åœ¨ä»£ç é‡Œå°±æ˜¯ï¼šç®€çº¦ã€è‡ªç„¶ã€ç›´è§‚ã€è§„èŒƒï¼ˆè§„èŒƒè¿™ç‚¹ä¸Javaæ˜¯ä¸€è‡´çš„ï¼‰ã€‚

æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹äºŒè€…çš„é£æ ¼ç©¶ç«Ÿæœ‰ä»€ä¹ˆå·®å¼‚ã€‚

POIæ˜¯Apacheçš„ä¸€ä¸ªJavaå¼€æºé¡¹ç›®ï¼Œå®ƒæä¾›å¯¹Officeæ–‡ä»¶çš„è¯»å†™èƒ½åŠ›ã€‚

æˆ‘ä»¬ä»¥Excelä¸ºä¾‹ï¼Œçœ‹çœ‹æ€ä¹ˆç”¨å®ƒåˆ›å»ºä¸€ä¸ªexcelæ–‡æ¡£ï¼š

```java
//==Java==
public class ExcelUtil
{
    /**
    * å°†è¡Œæ”¿åŒºåˆ’å­˜å…¥excelæ ¼å¼ï¼Œå¹¶é€šè¿‡byte[]è¿”å›
    * @param divisions åŒºåŸŸå¯¹è±¡åˆ—è¡¨
    * @return Excelçš„å­—èŠ‚æ•°ç»„
    * @throws IOException å†™å…¥å†…å­˜å¼‚å¸¸
    */
    public static byte[] transformToExcel(List<Division> divisions) throws IOException {
        XSSFWorkbook workbook = new XSSFWorkbook();  //åˆ›å»ºå†…å­˜å·¥ä½œç°¿
        XSSFSheet sheet = workbook.createSheet();  //åˆ›å»ºsheet
        //è®¾ç½®è¡¨å¤´
        XSSFRow titlerRow = sheet.createRow(0);
        titlerRow.createCell(0).setCellValue("çœ");
        titlerRow.createCell(1).setCellValue("å¸‚");
        titlerRow.createCell(2).setCellValue("åŒº");
        //å¡«å……è¡¨æ ¼
        for (int rowIndex = 1; rowIndex < divisions.size(); rowIndex++) {
            Division division = divisions.get(rowIndex);
            XSSFRow dataRow = sheet.createRow(rowIndex + 1);
            dataRow.createCell(0).setCellValue(division.getProvince());
            dataRow.createCell(1).setCellValue(division.getCity());
            dataRow.createCell(2).setCellValue(division.getDistrict());
        }
        //å¯¼å‡ºä¸ºbyte[]
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        workbook.write(outputStream);
        workbook.close();
        return outputStream.toByteArray();
    }
}

//ä½¿ç”¨
byte[] excelArr = ExcelUtil.transformToExcel(divisions);
```

åæ¥è¯¥åº“è¢«ç§»æ¤åˆ°äº†\.Netä¸Šï¼Œè¢«å‘½åä¸ºNPOIã€‚ç„¶è€Œï¼Œä½œä¸ºCShaperï¼Œå…¶å®éå¸¸ç”¨ä¸æƒ¯è¿™ä¸ªåº“ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥å¯¹æ¯”ä¸€ä¸‹C#çš„åº“ã€‚

ä»¥EPPlusåº“ä¸¾ä¾‹ï¼Œçœ‹çœ‹ä½¿ç”¨è¿™ä¸ªåº“ï¼Œå¦‚ä½•åˆ›å»ºexcelæ–‡æ¡£ï¼š

```c#
public static class ExcelTool
{
    /// <summary>
    /// å°†è¡Œæ”¿åŒºåˆ’å­˜å…¥excelæ ¼å¼ï¼Œå¹¶é€šè¿‡byte[]è¿”å›
    /// </summary>
    /// <param name="divisions">åŒºåŸŸå¯¹è±¡åˆ—è¡¨</param>
    /// <returns>Excelçš„å­—èŠ‚æ•°ç»„</returns>
    public static byte[] ToExcel(this List<Division> divisions)
    {
        using var package = new ExcelPackage();  //åˆ›å»ºå†…å­˜åŒºåŸŸçš„ExcelåŒ…
        var workbook = package.Workbook;  //è·å–å·¥ä½œç°¿
        var sheet = workbook.Worksheets.Add("sheet1"); //åˆ›å»ºsheet
        //è®¾ç½®è¡¨å¤´
        sheet.Cells[1, 1].Value = "çœ";
        sheet.Cells[1, 2].Value = "å¸‚";
        sheet.Cells[1, 3].Value = "åŒº";
        //å¡«å……è¡¨æ ¼
        for (var rowIndex = 2; rowIndex < divisions.Count; rowIndex++)
        {
            var division = divisions[rowIndex];
            sheet.Cells[rowIndex, 1].Value = division.Province;
            sheet.Cells[rowIndex, 2].Value = division.City;
            sheet.Cells[rowIndex, 3].Value = division.District;
        }
        //å¯¼å‡ºä¸ºbyte[]
        return package.GetAsByteArray();
    }
}

//ä½¿ç”¨
var excelArr = divisions.ToExcel();
```

ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¤§ä¼™å„¿åº”è¯¥å·²ç»æ„Ÿå—åˆ°äº†ä¸¤è€…é£æ ¼çš„å·®å¼‚äº†ã€‚è¿™é‡Œåˆ—ä¸¾å‡ ç‚¹ä¾‹å­ä¸­çš„C#çš„ä»£ç çš„é£æ ¼ç‰¹ç‚¹ï¼š

- ä½¿ç”¨äº†å±æ€§ï¼Œç®€åŒ–getã€setä¹¦å†™
- ä½¿ç”¨äº†ç´¢å¼•å™¨ï¼Œç®€åŒ–getã€setä¹¦å†™
- å®šä¹‰äº†æ‰©å±•æ–¹æ³•ï¼Œä»¥ä¾¿äºå¯ä»¥ä½¿ç”¨`divisions.ToExcel()`çš„æ–¹å¼è°ƒç”¨
- æ–¹æ³•åç”¨å¤§å†™å¼€å¤´ã€å±æ€§åä¹Ÿæ˜¯å¤§å†™å¼€å¤´

è¿˜æ²¡å®Œã€‚æˆ‘ä»¬ç»§ç»­æ‰©å±•ä¸€ä¸‹ï¼Œç»“åˆLINQã€æ¨¡å¼åŒ¹é…å¯¹Excelæ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼š

```c#
//æŸ¥è¯¢æˆç»©ä¸ºä¸­ç­‰çš„å­¦ç”Ÿ
var students = sheet.Cells["c1:c100"]
    .Where(c => c.Value is int i and > 60 and < 80)  //æ¨¡å¼åŒ¹é…
    .Select(c => new Student
    {
        Name = c.Offset(0, -1).GetValue<string>(),
        Score = c.GetValue<int>(),
        ScoreLevel = "ä¸­ç­‰"
    })
    .ToList();  //æ‰§è¡ŒæŸ¥è¯¢
```

è¿™æ¬¡å·®å¼‚æ›´æ˜æ˜¾äº†ã€‚äº‹å®ä¸Šï¼ŒLINQåœ¨æ•°æ®æŸ¥è¯¢çš„åœºæ™¯ä¸­è¢«å¤§é‡ä½¿ç”¨ã€‚

å±å¹•å‰çš„è¯»è€…ï¼Œå¦‚æœä½ æ˜¯ä¸€ä¸ªJavaerï¼Œæ°å·§åˆä¸å¾—ä¸å†™ä¸€äº›C#ç‰ˆæœ¬çš„SDKå°è£…ã€‚ä»¥ä¸‹å»ºè®®èƒ½å¸®åŠ©ä½ å†™å‡ºæ›´C# Styleçš„ä»£ç ï¼š

### æ€æ ·çœ‹èµ·æ¥åƒä¸€ä¸ªåŸç”Ÿçš„CShaper

Soï¼Œhow to getä¸€ä¸ªCShaperçš„ä»£ç Styleå‘¢ï¼Ÿå¦‚æœä½ å·²ç»å¾ˆç†Ÿæ‚‰Javaäº†ï¼Œç°åœ¨å› ä¸ºçœ‹äº†æˆ‘çš„æ–‡ç« è·ƒè·ƒæ¬²è¯•æƒ³ä¸Šæ‰‹å†™å†™C#çš„ä»£ç ï¼Œæˆ–è€…å› ä¸ºç”Ÿæ´»æ‰€è¿«ä¸å¾—ä¸å†™ç‚¹C#çš„åº“ï¼Œé‚£ä¹ˆä¸å¦¨æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤è¯•è¯•ï¼Œè¿™èƒ½å¿«é€Ÿè®©ä½ ä¹¦å†™çš„C#ä»£ç çœ‹èµ·æ¥åƒåŸç”Ÿçš„CShaperå†™çš„ã€‚

1. å‘½åç©ºé—´çš„æ¯ä¸€æ®µéƒ½ä»¥å¤§å†™å¼€å¤´ï¼Œå¹¶ä¸”æ”¾å¼ƒcomå¼€å¤´çš„ä¹ æƒ¯
2. æ¥å£éƒ½åŠ Iå‰ç¼€ï¼Œæ¥å£çš„å®ç°ç±»å»æ‰Implåç¼€
3. å°†æ‰€æœ‰æ–¹æ³•åæ”¹æˆå¤§å†™å¼€å¤´
4. ä½¿ç”¨å±æ€§å’Œç´¢å¼•å™¨ï¼Œæ›¿ä»£getå’Œsetæ–¹æ³•ï¼Œå±æ€§ä¹Ÿç”¨å¤§å†™å¼€å¤´
5. å…¬æœ‰çš„æˆå‘˜å‘½åï¼Œæ— è®ºå¤šé•¿ï¼Œéƒ½æ˜¯ç”¨è‹±æ–‡å…¨æ‹¼ï¼Œä¸åšç¼©å†™
6. å°†æ‰€æœ‰å·¦èŠ±æ‹¬å·å¦æ¢ä¸€è¡Œå†™ï¼Œè€Œä¸æ˜¯åœ¨åŒä¸€è¡Œå†™
7. å æ»¡å±å¹•çš„var
8. ä½¿ç”¨\==æ¥æ›¿ä»£.Equalsåˆ¤æ–­å­—ç¬¦ä¸²ç›¸ç­‰ã€‚ä½¿ç”¨<ã€>ç­‰æ¥åˆ¤æ–­æ—¶é—´å…ˆåï¼Œ+ã€-æ¥è®¡ç®—æ—¶é—´å·®ã€‚å…¶ä»–æœ‰è¿ç®—ç¬¦é‡è½½çš„ç±»ä¹Ÿä¸€æ ·
9. ä½¿ç”¨åˆå§‹åŒ–å™¨æ¥èµ‹å€¼ï¼Œè€Œä¸æ˜¯newå®Œä¹‹åæŒ¨ä¸ªsetå’Œadd
10. å¯¹äºnullçš„åˆ¤æ–­ï¼Œå¤šç”¨??ã€?.ã€?[]ã€??=è¿ç®—ç¬¦
11. ç›¸ä¿¡æˆ‘ï¼Œå­—ç¬¦ä¸²å†…æ’ä½ ä¸€å®šç”¨å¾—ä¸Š
12. asyncå’Œawaitè¯¥ç”¨å°±èµ·æ¥ï¼Œæ—¢é«˜å¤§ä¸Šåˆèƒ½æå‡æ€§èƒ½ã€‚ä¸è¿‡ä¸€æ—¦ä½¿ç”¨ï¼Œè¯·ä¸€è·¯async/awaitåˆ°åº•
13. æŸ¥è¯¢èƒ½LINQåˆ™LINQï¼Œèƒ½Lambdaå°±Lambda
14. å†™ç‚¹è‡ªå®šä¹‰æ‰©å±•æ–¹æ³•ï¼Œæ—¢èƒ½ç®€åŒ–æ“ä½œï¼Œåˆèƒ½æå‡å¯è¯»æ€§ã€‚å†æ•´æ•´è¿ç¼€ï¼Œè¿™å°±å¾ˆLINQ Styleäº†

åšåˆ°è¿™äº›ï¼Œä½ å·²ç»å…«ä¹ä¸ç¦»åäº†ã€‚è€Œä¸”ï¼Œä½ ä¸€æ—¦å¼€å§‹äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¹Ÿä¼šé€ƒä¸è¿‡çœŸé¦™å®šç†çš„ã€‚

# é™„å½•

## å‚è€ƒèµ„æ–™

æœ¬æ–‡çš„ä¸»çº¿ä¸»è¦æ˜¯å‚è€ƒå®˜æ–¹æ–‡æ¡£çš„ä¸€ç¯‡ã€ŠC#å‘å±•å†å²ã€‹ã€‚æ–‡ä¸­çš„ä¾‹å­å¤§éƒ½æ˜¯æˆ‘è‡ªå·±YYå‡ºæ¥çš„ï¼Œä½†æ˜¯åŸºæœ¬ä¹Ÿéƒ½äº²è‡ªè·‘è¿‡æµ‹è¯•ï¼Œä»¥ç¡®ä¿æ— è¯¯ã€‚å¶å°”ä¹Ÿä¼šå¼•ç”¨ä¸‹å®˜æ–¹æ–‡æ¡£é‡Œçš„æè¿°å’Œä¾‹å­ï¼Œä¸è¿‡é‰´äºå®˜ç½‘ä¸­æ–‡æœºç¿»çš„å¯è¯»æ€§å‡ ä¹ç­‰äºæ²¡æœ‰ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯å‚è€ƒè‹±æ–‡ç‰ˆé‡æ–°ç»„ç»‡è¿‡è¯­è¨€çš„ã€‚è™½ç„¶å¤§éƒ¨åˆ†æ˜¯å‡­å€Ÿæ—¢æœ‰çŸ¥è¯†ç¼–å†™ï¼Œä½†æ˜¯ä¸ºäº†ä¸¥è°¨ï¼Œåœ¨é‡åˆ°ä¸ç¡®å®šçš„åœ°æ–¹æ—¶ï¼Œä»æœ‰æŸ¥é˜…ä¸€äº›èµ„æ–™ã€‚

ä¸»è¦å‚è€ƒèµ„æ–™ï¼š

1. å¾®è½¯å®˜æ–¹æ–‡æ¡£ <https://docs.microsoft.com/en-us/dotnet/csharp/>ï¼ŒåŠå…¶ä¸­æ–‡ç‰ˆæœ¬ã€‚å…¶ä¸­ç‰¹åˆ«å‚è€ƒäº†ï¼šC#çš„å‘å±• <https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-version-history>ã€‚è¯·ç›¸ä¿¡æˆ‘ï¼Œä¸­æ–‡ç‰ˆæœ¬çš„æ–‡æ¡£æ ¹æœ¬çœ‹ä¸æ‡‚ã€‚è€Œä¸”ï¼Œæ–‡ç« è¿˜æœ‰é”™è¯¯ï¼
2. åšå®¢å›­çš„æ–‡ç«  <https://www.cnblogs.com/>ï¼Œçœ‹åˆ°\.Net 6.0åˆšå‡ºæ²¡å‡ å¤©ï¼Œç½‘ç«™ç‰ˆæƒçš„æ å°±å˜æˆäº†â€œPowered by .NET 6 on Kubernetesâ€ï¼Œç”šæ˜¯ç‹‚å–œã€‚
3. CSDNçš„æ–‡ç«  <https://blog.csdn.net/>ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å¼€å¯åšå®¢ä¹‹æ—…çš„åœ°æ–¹ã€‚ä½†æ˜¯æˆ‘å¾ˆæ‡’ï¼Œå‡ ä¹ä¸æ€ä¹ˆæ›´æ–°ã€‚
4. æˆ‘è‡ªå·±åšçš„200å¤šé¡µçš„PPTã€‚

è¿™é‡Œå†æ¨èä¸€ä¸ªæœ‰è¶£çš„åœ°æ–¹ï¼š<https://github.com/dotnet/csharplang/discussions>ï¼ŒC#è¯­è¨€è®¨è®ºåŒºã€‚æœ€æ—©ä¹Ÿæ˜¯åœ¨å¾®è½¯è‡ªå®¶å¹³å°CodePlexä¸Šçš„ï¼Œç°åœ¨æŒªåˆ°Githubä¸Šäº†ã€‚åœ¨è¿™é‡Œä½ å¯ä»¥ä½œä¸ºæ™®é€šå¼€å‘è€…ç»™C#è¯­è¨€æå»ºè®®ã€‚å¦‚æœæœ‰å¹¸è¢«å®˜æ–¹é‡‡çº³ï¼Œå¯èƒ½ä¼šå‡ºç°åœ¨æ–°çš„C#ç‰ˆæœ¬ä¸­ã€‚é‚£æ„Ÿè§‰è´¼highã€‚

## ä½œè€…æŒ‰

è¿‘ä¸¤å¹´æ¥ï¼Œæˆ‘åœ¨ç§¯ææ¨è¿›æˆ‘å¸çš„å¾®æœåŠ¡åŒ–æ”¹é€ ã€‚å› æ­¤ï¼Œæˆ‘å¸çš„åç«¯æŠ€æœ¯æ ˆä¹Ÿé€æ¸å·®å¼‚åŒ–ã€å¹¶è¡Œäº†èµ·æ¥ã€‚åœ¨å¾®æœåŠ¡æ¡†æ¶ä¸‹ï¼Œå·®å¼‚åŒ–ä¸ä»…æ˜¯è¢«å…è®¸çš„ï¼Œè€Œä¸”è¿˜æ˜¯æœ€ä¼˜çš„é€‰æ‹©ã€‚æ¯ä¸ªè¯­è¨€ã€æ¡†æ¶æœ‰å®ƒçš„ä¼˜åŠ¿é¢†åŸŸå’Œæ‰€æ“…é•¿äº‹åŠ¡ï¼Œé€‰ç”¨åˆé€‚å·¥å…·å®Œæˆåˆé€‚ä»»åŠ¡æ˜¯æ˜æ™ºçš„åŸåˆ™ã€‚ä½†æ˜¯å¤šæŠ€æœ¯æ ˆå¸¦æ¥çš„é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼šå¸¸ç”¨çš„åŸºç¡€åŠŸèƒ½ã€åçº¦ç±»å‹å®šä¹‰ã€ç­¾åç®—æ³•å®ç°ç­‰è¯¸å¤šåœ¨ä¸åŒæœåŠ¡é—´é€šç”¨çš„ç»„ä»¶ï¼Œå› è¯­è¨€ä¸åŒä¹Ÿè¦åˆ†åˆ«å®ç°ï¼Œéš¾ä»¥åœ¨å¤šä¸ªæœåŠ¡é—´å¤ç”¨ã€‚

åœ¨å¤šè¯­ç§ååŒå·¥ä½œä¸­ï¼Œæœ‰æ—¶è¿˜ä¼šå‡ºç°ç›¸äº’ä¸ç†è§£çš„æƒ…å†µã€‚Pythonç©å®¶å¯èƒ½ä¼šä¸ç†è§£Javaç¨‹åºå‘˜å®ç°ä¸€ä¸ªç®€å•çš„åŠŸèƒ½ä¸ºä»€ä¹ˆéœ€è¦æ•²è¿™ä¹ˆå¤šè¡Œä»£ç ï¼›è€ŒJavaå¼€å‘è€…ä¹Ÿå¯èƒ½ä¸æ˜ç™½JSè¯­è¨€é‚£å˜é­”æœ¯ä¸€æ ·èŠ±å¼çš„å¯¹è±¡å±•å¼€æ“ä½œã€‚å› æ­¤ï¼Œä¿ƒè¿›ä¸åŒæŠ€æœ¯æ ˆé—´çš„ç›¸äº’ç†è§£å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚æ‰€æœ‰ç¼–ç¨‹è¯­è¨€éƒ½å…·æœ‰ä¸€äº›å…±æ€§ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œä¸åº”å½“æŠŠè‡ªå·±å±€é™äºæŸä¸ªè¯­è¨€çš„è¿½éšè€…ï¼Œè€Œåº”å½“å¤šå­¦å¤šçŸ¥ï¼Œè§¦ç±»æ—é€šï¼Œåœ¨å®é™…å·¥ä½œä¸­æ ¹æ®åœºæ™¯çš„æœ€ä¼˜è§£é€‰ç”¨æœ€åˆé€‚çš„è¯­è¨€ã€‚æ­¤å¤–ï¼Œå¯¹å½¼æ­¤é…åˆçš„åŒäº‹æ‰€ä½¿ç”¨çš„è¯­è¨€æœ‰æ‰€äº†è§£ï¼Œä¹Ÿèƒ½æœ‰æ•ˆå¾—æé«˜æ²Ÿé€šé¡ºç•…åº¦ï¼Œæå‡åä½œæ•ˆç‡ã€‚

åŸºäºæ­¤ï¼Œè¿‘æœŸæˆ‘åœ¨æˆ‘å¸å†…éƒ¨ç»„ç»‡äº†ä¸€æ³¢å›´ç»•æˆ‘å¸ä¸»è¦æŠ€æœ¯æ ˆJavaä¸C#çš„è¯­æ³•ç‰¹ç‚¹äº¤æµä¼šã€‚åœ¨æˆ‘åˆ†äº«çš„ç¯èŠ‚ä¸­ï¼Œæˆ‘ä»¥C#å‘å±•ä¸ºä¸»çº¿ï¼Œé˜è¿°äº†C#çš„è¯­æ³•ç‰¹ç‚¹ï¼Œä»¥åŠä¸¤ç§è¯­è¨€çš„ä¸€äº›å·®å¼‚ã€‚åˆ†äº«åï¼Œæˆ‘æ€è€ƒï¼šä½•ä¸ç¼–æ’°æˆæ–‡ã€‚è¿™æ ·æ—¢èƒ½ç»™æˆ‘å¸äººå‘˜æä¾›éšæ—¶å¯æŸ¥çš„èµ„æ–™ï¼Œåˆå¯åˆ†äº«ç»™æ›´å¤šæœ‹å‹ã€‚äºæ˜¯ï¼Œæ­¤æ–‡åº”è¿è€Œç”Ÿã€‚

æœ¬æ–‡åŸæœ¬æ‰“ç®—å‘½åä¸ºã€ŠC#å’ŒJavaçš„çˆ±æ¨æƒ…ä»‡ã€‹ï¼Œä»¥çªå‡ºæœ¬æ–‡åŒ…å«å¤§é‡ä¸¤ç§è¯­è¨€çš„å¯¹æ¯”ã€‚ä½†è€ƒè™‘æ­¤æ–‡ä»æ˜¯ä¸€ç¯‡ä»¥C#çš„å‘å±•ä¸ºä¸»çº¿çš„ä»‹ç»C#çš„æ–‡ç« ï¼Œåå†³å®šå‘½åä¸ºã€ŠC#çš„è¿›åŒ–ã€‹ã€‚

ç»2æœˆæœ‰ä½™çš„æ‰“ç£¨ï¼Œæœ¬æ–‡ç»ˆäºå®Œæˆã€‚éƒ¨åˆ†å¤æ‚ç« èŠ‚ç»åå¤æ–Ÿé…Œï¼Œä¿®æ”¹ä¸ä¸‹10å‡ ç¨¿ã€‚ç„¶è€Œç”±äºæ—¶é—´ä»“ä¿ƒï¼Œéš¾å…ä»ä¼šæœ‰ç–æ¼ã€‚å¯¹æ–‡ä¸­é”™è¯¯ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€æ‰¹è¯„æŒ‡æ­£ã€‚

ä½œè€…æ¬¢è¿å¤§å®¶åˆ†äº«æœ¬æ–‡ã€‚ä½†è¯·å°Šé‡ä½œè€…çš„åŠ³åŠ¨æˆæœå’Œç‰ˆæƒã€‚**å¦‚éœ€è½¬è½½ï¼Œè¯·åœ¨æ˜¾è‘—ä½ç½®æ ‡æ˜å‡ºå¤„ã€‚**
